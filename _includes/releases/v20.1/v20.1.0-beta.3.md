<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160407-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160407.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160407.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160407-backwards-incompatible-changes">Backwards-incompatible Changes</h3>

* Any databases using the [`DECIMAL`](../v1.0/decimal.html) type will need to be deleted and
  created from scratch. Columns of this type were encoded incorrectly
  by `beta-20160330`.
  [#5820](https://github.com/cockroachdb/cockroach/pull/5820)
* [`SELECT`](../v1.0/select.html) statements must now specify one or more columns or
  expressions. Previously, statements such as `SELECT FROM t` were
  allowed but the results would confuse many clients.
  [#5859](https://github.com/cockroachdb/cockroach/pull/5859)
* It is now an error to insert a value that is too large into a column
  with a type of limited length such as [`VARCHAR(n)`](../v1.0/string.html).
  [#5750](https://github.com/cockroachdb/cockroach/pull/5750)

<h3 id="beta-20160407-compatibility">Compatibility</h3>

* Added support for the "flush" message in the PostgreSQL network
  protocol, which improves compatibility with the [node.js driver](../v1.0/install-client-drivers.html).
  [#5740](https://github.com/cockroachdb/cockroach/pull/5740)
* Fixed a panic when handling certain queries sent by the PHP PDO
  library. [#5783](https://github.com/cockroachdb/cockroach/pull/5783)
* Improved parsing of timestamps for compatibility with the Go
  `lib/pq` client library.
  [#5877](https://github.com/cockroachdb/cockroach/pull/5877)

<h3 id="beta-20160407-new-features">New Features</h3>

* Index hints: `SELECT FROM tbl@idx` or `SELECT FROM
  tbl@{FORCE_INDEX=idx}` instructs the query planner to use the given
  index. [#5785](https://github.com/cockroachdb/cockroach/pull/5785)
  and [#5806](https://github.com/cockroachdb/cockroach/pull/5806)
* The `cockroach` command-line client now accepts environment
  variables as default values for many command-line flags. See
  `--help` for details.
  [#5430](https://github.com/cockroachdb/cockroach/pull/5430)
* Added SQL `version()` [function](../v1.0/functions-and-operators.html).
  [#5763](https://github.com/cockroachdb/cockroach/pull/5763)
* Added compiler and platform information to `cockroach version`
  output. [#5766](https://github.com/cockroachdb/cockroach/pull/5766)
* Debugging tools show fractional seconds in timestamps.
  [#5736](https://github.com/cockroachdb/cockroach/pull/5736)
* In secure mode, plain HTTP requests to the [`http-port`](../v1.0/start-a-node.html) used by the
  admin UI are now redirected to HTTPS.
  [#5746](https://github.com/cockroachdb/cockroach/pull/5746)
* Links to debugging pages are available on the HTTP port at
  `/debug/`.
  [#5795](https://github.com/cockroachdb/cockroach/pull/5795)
* The [`cockroach zone set`](../v1.0/configure-replication-zones.html) command now echos the new configuration.
  [#5829](https://github.com/cockroachdb/cockroach/pull/5829)

<h3 id="beta-20160407-bug-fixes">Bug Fixes</h3>

* Improved flow control for raft snapshots, fixing an issue that could
  lead to nodes running out of memory.
  [#5721](https://github.com/cockroachdb/cockroach/pull/5721)
* Fixed a deadlock scenario in which two conflicting transactions
  would both be unable to make progress.
  [#5710](https://github.com/cockroachdb/cockroach/pull/5710)
* Fixed a panic while executing certain [`DELETE`](../v1.0/delete.html) statements.
  [#5840](https://github.com/cockroachdb/cockroach/pull/5840)

<h3 id="beta-20160407-internal-changes">Internal Changes</h3>

* Clock offsets are now measured continuously.
  [#5512](https://github.com/cockroachdb/cockroach/pull/5512)
* Improved caching to avoid redundant range descriptor lookups.
  [#5627](https://github.com/cockroachdb/cockroach/pull/5627)
* Reduced log spam when nodes are down.
  [#5883](https://github.com/cockroachdb/cockroach/pull/5883)

<h3 id="beta-20160407-contributors">Contributors</h3>

This release includes 77 merged PRs by 18 authors. We would like to
thank the following contributors from the CockroachDB community,
especially
[first-time contributor Seif Lotfy](https://github.com/cockroachdb/cockroach/pull/5747).

* Kenji Kaneda
* Seif Lotfy
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160414-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160414.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160414.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160414-backwards-incompatible-changes">Backwards-incompatible Changes</h3>

* Any databases using the [`DECIMAL`](../v1.0/decimal.html) type will need to be deleted and created from scratch. Columns of this type were encoded incorrectly in older beta releases. (Again! We apologize for the inconvenience.) [#5994](https://github.com/cockroachdb/cockroach/pull/5994)
* The [SQL function](../v1.0/functions-and-operators.html) `transaction_timestamp_unique` has been removed in favor of the new `cluster_logical_timestamp` function described below.

<h3 id="beta-20160414-new-features">New Features</h3>

* [`ALTER TABLE`](../v1.0/alter-table.html) supports several new operations: `ADD COLUMN` with a
  default value
  ([#5759](https://github.com/cockroachdb/cockroach/pull/5759)),
  `ALTER COLUMN SET DEFAULT`, `ALTER COLUMN DROP DEFAULT`, and `ALTER
  COLUMN DROP NOT NULL`
  ([#5947](https://github.com/cockroachdb/cockroach/pull/5947))
* The `TIMESTAMPTZ` type is now accepted as an alias for [`TIMESTAMP`](../v1.0/timestamp.html)
  for compatibility with PostgreSQL; our `TIMESTAMP` type already
  supports time zones in the same way as PostgreSQL's `TIMESTAMPTZ`.
  [#5893](https://github.com/cockroachdb/cockroach/pull/5893)
* The [`STRING`](../v1.0/string.html) type now accepts a length parameter (e.g.,
  `STRING(50)`), similar to `CHAR` and `VARCHAR`.
  [#5918](https://github.com/cockroachdb/cockroach/pull/5918)
* The `LIMIT` clause now accepts placeholders.
  [#5977](https://github.com/cockroachdb/cockroach/pull/5977)
* The `RETURNING` clause of [`INSERT`](../v1.0/insert.html), [`DELETE`](../v1.0/delete.html), and [`UPDATE`](../v1.0/update.html)
  statements now accepts placeholders.
  [#5934](https://github.com/cockroachdb/cockroach/pull/5934)
* When sending queries to the `cockroach sql` tool via `stdin`, a
  terminating semicolon is not required and instructions for
  interactive mode are no longer printed (similar to the existing
  behavior of `-e`).
  [#5988](https://github.com/cockroachdb/cockroach/pull/5988)
* The `experimental_uuid_v4()` [SQL function](../v1.0/functions-and-operators.html) has been renamed to
  `uuid_v4()`. The old name remains as a deprecated alias.
  [#5886](https://github.com/cockroachdb/cockroach/pull/5886)

<h3 id="beta-20160414-performance-improvements">Performance Improvements</h3>

* Reduced the number of files created in the data directory, and fixed
  issues in which the process could run out of file descriptors.
  [#5888](https://github.com/cockroachdb/cockroach/pull/5888)
* Introduced a special fast path for transactions that are contained
  entirely within one range. [#5966](https://github.com/cockroachdb/cockroach/pull/5966)
* Reduced the number of unnecessary network round trips by ensuring
  that the range lease holder and the raft leader coincide.
  [#5973](https://github.com/cockroachdb/cockroach/pull/5973)

<h3 id="beta-20160414-bug-fixes">Bug Fixes</h3>

* The gossip system no longer recommends redundant forwarding
  addresses, which could prevent the cluster from fully connecting.
  [#5901](https://github.com/cockroachdb/cockroach/pull/5901)
* Timestamps are now correctly reported in the network protocol as
  having time zone offsets.
  [#5909](https://github.com/cockroachdb/cockroach/pull/5909)
* Buffered data is now flushed to the network immediately on error.
  [#5909](https://github.com/cockroachdb/cockroach/pull/5909)
* Timeseries data no longer diverges across replicas.
  [#5905](https://github.com/cockroachdb/cockroach/pull/5905)

<h3 id="beta-20160414-internal-changes">Internal Changes</h3>

* [SQL functions](../v1.0/functions-and-operators.html) related to the current time (`now`,
  `current_timestamp`, `statement_timestamp`, `statement_timestamp`)
  now use the clock of the node that executed them instead of a
  timestamp derived from the internal hybrid logical clock. This means
  that these functions are less likely to produce duplicate values,
  but it is more likely for one transaction to see a timestamp that is
  less than a timestamp already seen in another transaction.
  Applications that require a globally monotonic timestamp-like value
  can use the new function `cluster_logical_timestamp` instead.
  [#5805](https://github.com/cockroachdb/cockroach/pull/5805)
* New HTTP endpoint `/debug/metrics` exposes internal metric data in
  JSON format.
  [#5894](https://github.com/cockroachdb/cockroach/pull/5894)
* [Logs](../v1.0/debug-and-error-logs.html) are no longer written to `stderr` by default, only to the
  `logs` subdirectory of the data directory.
  [#5979](https://github.com/cockroachdb/cockroach/pull/5979)

<h3 id="beta-20160414-contributors">Contributors</h3>

This release includes 58 merged PRs by 18 authors. We would like to
thank the following contributors from the CockroachDB community,
especially
[first-time contributor Andrey Shinkevich](https://github.com/cockroachdb/cockroach/pull/5956).

* Andrey Shinkevich
* Kenji Kaneda
* Seif Lotfy
* es-chow
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160421-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160421.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160421.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160421-upgrade-procedure">Upgrade Procedure</h3>

* This release cannot be run concurrently with older beta releases.
  Please stop all nodes running older releases before restarting any
  node with this version.

<h3 id="beta-20160421-new-features">New Features</h3>

* [`UPDATE`](../v1.0/update.html) statements may now set columns which are part of the
  primary key.
  [#6043](https://github.com/cockroachdb/cockroach/pull/6043)
* `CHECK` constraints can now be defined when creating tables and will
  be enforced for [`INSERT`](../v1.0/insert.html) statements (but not yet for [`UPDATE`](../v1.0/update.html)
  statements).
  [#6044](https://github.com/cockroachdb/cockroach/pull/6044)
* The `pow()` and `exp()` [functions](../v1.0/functions-and-operators.html) on `DECIMAL` values no longer lose
  precision.
  [#6170](https://github.com/cockroachdb/cockroach/pull/6170)
* In the [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell, the special command `!` can now be used
  to execute a system command and display its output. `|` executes a
  system command and runs its output as a SQL statement.
  [#5961](https://github.com/cockroachdb/cockroach/pull/5961)
* Added `SHOW CREATE TABLE`.
  [#6158](https://github.com/cockroachdb/cockroach/pull/6158)
* The `RETURNING` clause of [`INSERT`](../v1.0/insert.html) statements can now refer to tables
  by aliases defined with `AS`.
  [#5903](https://github.com/cockroachdb/cockroach/pull/5903)
* The SQL parser now accepts the `CASCADE` and `RESTRICT` keywords in
  the [`DROP INDEX`](../v1.0/drop-index.html), [`TRUNCATE TABLE`](../v1.0/truncate.html), [`ALTER TABLE DROP COLUMN`](../v1.0/alter-table.html), and [`ALTER TABLE DROP CONSTRAINT`](../v1.0/alter-table.html) statements. These keywords relate to
  features we have not yet implemented, so they do nothing, but this change
  improves compatibility with frameworks that like to send these
  keywords.
  [#5957](https://github.com/cockroachdb/cockroach/pull/5957)

<h3 id="beta-20160421-admin-ui">Admin UI</h3>

* The time scale used for graphs can now be changed.
  [#6145](https://github.com/cockroachdb/cockroach/pull/6145)
* Some UI elements now include tooltips with additional explanations.
  [#6006](https://github.com/cockroachdb/cockroach/pull/6006)
* A warning is displayed when the cluster is unreachable.
  [#6042](https://github.com/cockroachdb/cockroach/pull/6042)
* There are now fewer unnecessary scrollbars.
  [#6018](https://github.com/cockroachdb/cockroach/pull/6018)

<h3 id="beta-20160421-bug-fixes">Bug fixes</h3>

* The rebalancer is now better at distributing ranges across the nodes
  in a cluster.
  [#6133](https://github.com/cockroachdb/cockroach/pull/6133)
* Fixed a major cause of "timestamp in future" errors.
  [#5845](https://github.com/cockroachdb/cockroach/pull/5845)
* Fixed several potential panics.
  [#6111](https://github.com/cockroachdb/cockroach/pull/6111)
  [#6143](https://github.com/cockroachdb/cockroach/pull/6143)

<h3 id="beta-20160421-performance-improvements">Performance Improvements</h3>

* Improved the performance of schema changes while data is being
  modified.
  [#5996](https://github.com/cockroachdb/cockroach/pull/5996)
* The RPC subsystem is now bypassed for requests to the local node.
  [#6021](https://github.com/cockroachdb/cockroach/pull/6021)
* Information about completed transactions is now cleaned up more
  efficiently.
  [#5882](https://github.com/cockroachdb/cockroach/pull/5882)
* Fixed a leak of goroutines.
  [#6010](https://github.com/cockroachdb/cockroach/pull/6010)
* Reduced memory allocations on the critical path.
  [#6117](https://github.com/cockroachdb/cockroach/pull/6117)
  [#6119](https://github.com/cockroachdb/cockroach/pull/6119)
  [#6140](https://github.com/cockroachdb/cockroach/pull/6140)
  [#6141](https://github.com/cockroachdb/cockroach/pull/6141)
  [#6142](https://github.com/cockroachdb/cockroach/pull/6142)

<h3 id="beta-20160421-doc-improvements">Doc Improvements</h3>

* Overview of [SQL privileges](../v1.0/privileges.html).
* Summaries and required privileges for all supported [SQL statements](../v1.0/sql-statements.html).
* Reference docs for [`DROP DATABASE`](../v1.0/drop-database.html), [`DROP TABLE`](../v1.0/drop-table.html), [`GRANT`](../v1.0/grant.html), [`RENAME DATABASE`](../v1.0/rename-database.html), [`RENAME TABLE`](../v1.0/rename-table.html), [`REVOKE`](../v1.0/revoke.html), and [`SHOW INDEX`](../v1.0/show-index.html).

<h3 id="beta-20160421-contributors">Contributors</h3>

This release includes 74 merged PRs by 21 authors. We would like to
thank the following contributors from the CockroachDB community,
especially first-time contributor
[Andrew NS Yeow](https://github.com/cockroachdb/cockroach/pull/6109).

* Andrew NS Yeow
* Kenji Kaneda
* Kenjiro Nakayama
* Lu Guanqun
* Seif Lotfy
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160428-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160428.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160428.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160428-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

* Time zone offsets are no longer shown when querying columns of type
  `TIMESTAMP`; the new type `TIMESTAMP WITH TIME ZONE` should be used
  instead. This is more consistent with other databases.
  [#6165](https://github.com/cockroachdb/cockroach/pull/6165)

<h3 id="beta-20160428-new-features">New Features</h3>

* `INTERVAL` values accept two new formats: ISO8601 (`P2H30M`) and the
  PostgreSQL format (`2 hours 30 minutes`) in addition to the existing
  Go style (`2h30m`).
  [#6216](https://github.com/cockroachdb/cockroach/pull/6216)
* Tuples can now be compared in SQL expressions.
  [#6217](https://github.com/cockroachdb/cockroach/pull/6217)
* The server now implements the `systemd` `NOTIFY_SOCKET` protocol.
  [#6268](https://github.com/cockroachdb/cockroach/pull/6268)
* The new flag `cockroach start --background` can be used to start a
  server in the background. This is better than appending `&` because
  the process doesn't return until it is ready to receive traffic.
  [#6268](https://github.com/cockroachdb/cockroach/pull/6268)

<h3 id="beta-20160428-bug-fixes">Bug fixes</h3>

* The SQL shell can once again be suspended with `ctrl-z`.
  [#6171](https://github.com/cockroachdb/cockroach/pull/6171)
* Fixed an error in the SQL shell when the history file contains empty
  lines. [#6192](https://github.com/cockroachdb/cockroach/pull/6192)
* The `--store` and `--key-size` command-line flags are no longer
  marked as required.
  [#6229](https://github.com/cockroachdb/cockroach/pull/6229)
* The command line interface is better about printing errors to
  `stderr`, not just the log file.
  [#6258](https://github.com/cockroachdb/cockroach/pull/6258)
* The `INFO` log file is now created in the correct default location
  (`cockroach-data/logs`) instead of `$TMPDIR`.
  [#6265](https://github.com/cockroachdb/cockroach/pull/6265)
* Fixed errors that could be introduced by updating tables while a
  schema change is in progress.
  [#6160](https://github.com/cockroachdb/cockroach/pull/6160)
* Fixed several potential panics.
  [#6187](https://github.com/cockroachdb/cockroach/pull/6187),
  [#6235](https://github.com/cockroachdb/cockroach/pull/6235),
  [#6242](https://github.com/cockroachdb/cockroach/pull/6242)

<h3 id="beta-20160428-performance-improvements">Performance Improvements</h3>

* Raft processing is no longer blocked while generating a snapshot for
  a new replica.
  [#6253](https://github.com/cockroachdb/cockroach/pull/6253)

<h3 id="beta-20160428-contributors">Contributors</h3>

This release includes 89 merged PRs by 19 authors. We would like to
thank the following contributors from the CockroachDB community,
especially first-time contributor
[Karl Southern](https://github.com/cockroachdb/cockroach/pull/4858).

* Karl Southern
* Kenjiro Nakayama
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160505-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160505.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160505.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160505-new-features">New Features</h3>

* New SQL command `UPSERT` is available. This is syntactically similar
  to `INSERT` but will update the row with the supplied columns if
  there is a conflicting row for the primary key.
  [#6456](https://github.com/cockroachdb/cockroach/pull/6456)
* The SQL type system has been overhauled, reducing the number of
  explicit casts required.
  [RFC](https://github.com/cockroachdb/cockroach/blob/master/docs/RFCS/20160203_typing.md)
* Tuples are now considered for index selection, so `SELECT * FROM t
  WHERE (a, b) > ($1, $2)` can use an index defined on `(a, b)`.
  [#6332](https://github.com/cockroachdb/cockroach/pull/6332)

<h3 id="beta-20160505-performance-improvements">Performance improvements</h3>

* Bulk inserts to previously-empty table spans are now faster.
  [#6375](https://github.com/cockroachdb/cockroach/pull/6375),
  [#6414](https://github.com/cockroachdb/cockroach/pull/6414)
* Ranges that have grown above the target size are now split before
  being rebalanced, reducing memory usage.
  [#6447](https://github.com/cockroachdb/cockroach/pull/6447)
* Reduced rapid memory growth during partitions.
  [#6448](https://github.com/cockroachdb/cockroach/pull/6448)
* [`ALTER TABLE`](../v1.0/alter-table.html) now performs backfill operations in chunks.
  [#6056](https://github.com/cockroachdb/cockroach/pull/6056)
* [`DROP TABLE`](../v1.0/drop-table.html) now uses the schema change mechanism intead of
  synchronously deleting all data.
  [#6336](https://github.com/cockroachdb/cockroach/pull/6336)
* Scanning over records that have only one MVCC version is faster.
  [#6351](https://github.com/cockroachdb/cockroach/pull/6351)
* The command queue now uses coarse-grained spans until a conflict has
  occurred.
  [#6412](https://github.com/cockroachdb/cockroach/pull/6412)
* When a replica is rebalanced from one node to another, the old node
  no longer triggers unnecessary Raft elections.
  [#6423](https://github.com/cockroachdb/cockroach/pull/6423)

<h3 id="beta-20160505-production">Production</h3>

* Servers now attempt to drain more gracefully when restarted.
  [#6313](https://github.com/cockroachdb/cockroach/pull/6313)
* Metrics on lease requests are now available internally.
  [#5596](https://github.com/cockroachdb/cockroach/pull/5596)
* The RocksDB cache will no longer use all available memory if
  `cgroups` reports a limit higher than physical memory.
  [#6379](https://github.com/cockroachdb/cockroach/pull/6379)

<h3 id="beta-20160505-bug-fixes">Bug Fixes</h3>

* The range descriptor cache is now invalidated correctly, fixing a
  bug in which requests could be retried repeatedly on the wrong node.
  [#6425](https://github.com/cockroachdb/cockroach/pull/6425)
* Fixed a bug with some queries using aggregate functions like `MIN()`
  and `MAX()`. [#6380](https://github.com/cockroachdb/cockroach/pull/6380)
* Tuple comparisons now work correctly when one tuple contains `NULL`.
  [#6370](https://github.com/cockroachdb/cockroach/pull/6370)

<h3 id="beta-20160505-doc-updates">Doc Updates</h3>

* Community-supported docs and configuration files for [running CockroachDB inside a single VirtualBox virtual machine](http://uptimedba.github.io/cockroach-vb-single/cockroach-vb-single/home.html). [#263](https://github.com/cockroachdb/docs/pull/263)
* Docs on using [environment variables](../v1.0/cockroach-commands.html#environment-variables) as default values for command-line flags. [#235](https://github.com/cockroachdb/docs/pull/235)
* Docs on using the [`version`](../v1.0/view-version-details.html) and [`node`](../v1.0/view-node-details.html) commands.

<h3 id="beta-20160505-contributors">Contributors</h3>

This release includes 66 merged PRs by 18 authors. We would like to
thank the following contributors from the CockroachDB community, especially first-time contributor [Paul Steffensen](https://github.com/uptimeDBA).

* Bogdan Batog
* il9ue
* Kenji Kaneda
* Paul Steffensen
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160512-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160512.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160512.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160512-upgrade-procedure">Upgrade Procedure</h3>

- This release cannot be run concurrently with older beta releases. Please stop all nodes running older releases before restarting any node with this version.

<h3 id="beta-20160512-new-features">New Features</h3>

- The [`INSERT`](../v1.0/insert.html) statement now accepts an `ON CONFLICT` clause, for a more flexible alternative to `UPSERT`. [#6591](https://github.com/cockroachdb/cockroach/pull/6591)
- The new [`EXPLAIN (TYPES)`](../v1.0/explain.html) subcommand prints information about the types of expressions in a statement. [#6482](https://github.com/cockroachdb/cockroach/pull/6482)
- Added the aggregate functions [`BOOL_AND()`](../v1.0/functions-and-operators.html) and [`BOOL_OR()`](../v1.0/functions-and-operators.html). [#6535](https://github.com/cockroachdb/cockroach/pull/6535)
- The aggregate functions [`SUM(INT)`](../v1.0/functions-and-operators.html) and [`AVG(INT)`](../v1.0/functions-and-operators.html) now return `DECIMAL` instead of `INT` and `FLOAT` respectively. [#6532](https://github.com/cockroachdb/cockroach/pull/6532)
- The new command-line flag [`--raft-tick-interval`](../v1.0/start-a-node.html) allows the raft heartbeat frequency to be changed in high-latency deployments. [#6615](https://github.com/cockroachdb/cockroach/pull/6615)
- [`TIMESTAMP`](../v1.0/timestamp.html) values can now be cast to type `STRING`. [#6605](https://github.com/cockroachdb/cockroach/pull/6605)
- The [`CREATE DATABASE`](../v1.0/create-database.html) statement now accepts an `ENCODING` option for compatibility with PostgreSQL, although `UTF8` is the only supported encoding. [#6614](https://github.com/cockroachdb/cockroach/pull/6614)

<h3 id="beta-20160512-bug-fixes">Bug Fixes</h3>

- Fixed a bug when a single [`INSERT`](../v1.0/insert.html) statement inserts multiple values for the same primary key. [#6564](https://github.com/cockroachdb/cockroach/pull/6564)
- Fixed an inconsistency that could occur when a transaction in [`SNAPSHOT` isolation](../v1.0/transactions.html#isolation-levels) used the internal `DeleteRange` operation. [#6548](https://github.com/cockroachdb/cockroach/pull/6548)
- Fixed an integer underflow that could result in log messages like `transport: http2Server received 4294965918-bytes`. [#6567](https://github.com/cockroachdb/cockroach/pull/6567)
- Long-running transactions are no longer allowed to exceed their table descriptor lease. [#6418](https://github.com/cockroachdb/cockroach/pull/6418)
- Subtracting an `INTERVAL` from a `TIMESTAMP WITH TIME ZONE` returns a `TIMESTAMP WITH TIME ZONE` instead of one without a time zone. [#6540](https://github.com/cockroachdb/cockroach/pull/6540)
- Improved type checking of comparisons involving tuples. [#6517](https://github.com/cockroachdb/cockroach/pull/6517)
- [`CREATE TABLE`](../v1.0/create-table.html), [`ALTER TABLE`](../v1.0/alter-table.html), and [`DROP INDEX`](../v1.0/drop-index.html) now do more validation of their arguments. [#6492](https://github.com/cockroachdb/cockroach/pull/6492)

<h3 id="beta-20160512-performance-improvments">Performance improvments</h3>

- Improved tracking of keys modified during a transaction, improving performance of bulk inserts. [#6611](https://github.com/cockroachdb/cockroach/pull/6611)
- Schema changes can now continue past transient errors. [#6552](https://github.com/cockroachdb/cockroach/pull/6552)

<h3 id="beta-20160512-doc-updates">Doc Updates</h3>

- The new [Tech Talks](https://www.cockroachlabs.com/community/tech-talks/) page links to recordings and slides from talks by CockroachDB founders and engineers.
- Docs for the [built-in SQL client](../v1.0/use-the-built-in-sql-client.html) now demonstrate various ways to execute SQL statements from the command line and run external commands from the interactive shell.
- [Data type](../v1.0/data-types.html) docs now provide details about storage size.
- Although it's not possible to access CockroachDB's key-value store directly, the [FAQ](../v1.0/frequently-asked-questions.html#can-i-use-cockroachdb-as-a-key-value-store) now suggests a SQL alternative.
- [Replication recommendations](../v1.0/configure-replication-zones.html#node-replica-recommendations) now address cross-datacenter scenarios.

<h3 id="beta-20160512-contributors">Contributors</h3>

This release includes 87 merged PRs by 18 authors. We would like to
thank the following contributor from the CockroachDB community:

* Kenji Kaneda
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160519-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160519.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160519.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160519-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- [`TIMESTAMP`](../v1.0/timestamp.html) values are now truncated to microsecond resolution when sent over the network for compatibility with the PostgreSQL protocol. The `format_timestamp_ns(ts)` or `extract(nanosecond from ts)` [functions](../v1.0/functions-and-operators.html) can be used to access the full nanosecond precision of a timestamp. The `now()`, `current_timestamp()`, and `statement_timestamp()` functions are truncated to microsecond resolution to avoid confusion when timestamp values are used in unique indexes; the new `current_timestamp_ns()` function can be used to get a non-truncated timestamp. [#6604](https://github.com/cockroachdb/cockroach/pull/6604)

<h3 id="beta-20160519-new-features">New Features</h3>

- `DO NOTHING` is now supported in [`INSERT ... ON CONFLICT`](../v1.0/insert.html) statements. [#6633](https://github.com/cockroachdb/cockroach/pull/6633)
- [`CHECK`](../v1.0/check.html) constraints can now be specified at the table level. [#6625](https://github.com/cockroachdb/cockroach/pull/6625)
- Binary encoding is now supported in the network protocol for `BOOL`, `FLOAT`, `DECIMAL`, and `STRING` types, improving compatiblity with some PostgreSQL drivers. [#6661](https://github.com/cockroachdb/cockroach/pull/6661)
- The new `cockroach freeze-cluster` [command](../v1.0/cockroach-commands.html) has been added to the command-line interface; it will be used in the upgrade process for a future beta release. [#6675](https://github.com/cockroachdb/cockroach/pull/6675)

<h3 id="beta-20160519-bug-fixes">Bug Fixes</h3>

- [`EXPLAIN DELETE`](../v1.0/explain.html) no longer executes the `DELETE` statement. [#6622](https://github.com/cockroachdb/cockroach/pull/6622)
- [`CHECK`](../v1.0/check.html) constraints are now enforced during [`UPDATE`](../v1.0/update.html) statements. [#6753](https://github.com/cockroachdb/cockroach/pull/6753)
- [`CHECK`](../v1.0/check.html) constraints now work correctly when columns have been dropped. [#6730](https://github.com/cockroachdb/cockroach/pull/6730)
- Tuples and the `DEFAULT` keyword now work in [`INSERT ... ON CONFLICT DO UPDATE`](../v1.0/insert.html) statements. [#6636](https://github.com/cockroachdb/cockroach/pull/6636)
- Errors are now reported with standard PostgreSQL error codes in more places. [#6652](https://github.com/cockroachdb/cockroach/pull/6652), [#6554](https://github.com/cockroachdb/cockroach/pull/6554)
- Fixed a panic while a node is attempting a clean shutdown. [#6677](https://github.com/cockroachdb/cockroach/pull/6677)
- Internal retry logic has been improved so requests are no longer stuck retrying endlessly on the wrong replica. [#6688](https://github.com/cockroachdb/cockroach/pull/6688)

<h3 id="beta-20160519-performance-improvements">Performance Improvements</h3>

- Snapshot generation is now throttled to reduce peak memory consumption.
  [#6632](https://github.com/cockroachdb/cockroach/pull/6632)
- Improved performance for transactions with low contention. [#6413](https://github.com/cockroachdb/cockroach/pull/6413)
- Improved performance for `UPSERT` statements (and the equivalent [`INSERT ... ON CONFLICT DO UPDATE`](../v1.0/insert.html) statements) when the table has no secondary indexes and values are supplied for all columns in the table. [#6673](https://github.com/cockroachdb/cockroach/pull/6673)

<h3 id="beta-20160519-doc-updates">Doc Updates</h3>

- [SQL Grammar](../v1.0/sql-grammar.html) diagrams have been streamlined to reduce unnecessary duplication.   
- Docs on SQL [Constraints](../v1.0/constraints.html) are now available. [#280](https://github.com/cockroachdb/docs/pull/280)
- Docs on the [`CREATE TABLE`](../v1.0/create-table.html) statement are now available. [#296](https://github.com/cockroachdb/docs/pull/296)

<h3 id="beta-20160519-contributors">Contributors</h3>

This release includes 65 merged PRs by 18 authors. We would like to
thank the following contributor from the CockroachDB community:

* Kenji Kaneda
* Paul Steffensen
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160526-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160526.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160526.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160526-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- Numeric literals containing a decimal point are now treated as type [`DECIMAL`](../v1.0/decimal.html) instead of type [`FLOAT`](../v1.0/float.html), unless type inference determines that `FLOAT` should be used. In some cases, an explicit `CAST(x AS FLOAT)` may be needed. [#6752](https://github.com/cockroachdb/cockroach/pull/6752)
- The custom error codes `CR000` (indicating a transaction needs to be [retried](../v1.0/transactions.html#transaction-retries)) and `CR001` (indicating a transaction is in an invalid state) have been replaced with the PostgreSQL standard error codes `40001` (serialization failure) and `25000` (invalid transaction state), respectively. [#6797](https://github.com/cockroachdb/cockroach/pull/6797)

<h3 id="beta-20160526-bug-fixes">Bug Fixes</h3>

- Fixed problems when tables are renamed or dropped and recreated in rapid succession. [#6595](https://github.com/cockroachdb/cockroach/pull/6595)
- [`DROP DATABASE`](../v1.0/drop-database.html) now works correctly with quoted names. [#6851](https://github.com/cockroachdb/cockroach/pull/6851)
- Gracefully shutting down a node now completes faster. [#6777](https://github.com/cockroachdb/cockroach/pull/6777)
- [`INSERT ... ON CONFLICT DO NOTHING`](../v1.0/insert.html) no longer crashes the server when no conflicting index is given. [#6795](https://github.com/cockroachdb/cockroach/pull/6795)
- [`INSERT ... ON CONFLICT DO NOTHING`](../v1.0/insert.html) now requires only the `INSERT` permission instead of both `INSERT` and `UPDATE`. [#6827](https://github.com/cockroachdb/cockroach/pull/6827)
- Numeric literals in scientific notation are now case-insensitive. [#6864](https://github.com/cockroachdb/cockroach/pull/6864)
- `TIMESTAMP WITHOUT TIME ZONE` is now recognized as a synonym for [`TIMESTAMP`](../v1.0/timestamp.html). [#6888](https://github.com/cockroachdb/cockroach/pull/6888)
- Attempting to access a database that does not exist now returns PostgreSQL error code `3D000` ("invalid catalog name") instead of a generic error. [#6680](https://github.com/cockroachdb/cockroach/pull/6680)

<h3 id="beta-20160526-internal-changes">Internal Changes</h3>

- Most of the `/_status/` HTTP endpoints now use GRPC internally. [#6702](https://github.com/cockroachdb/cockroach/pull/6702) [#6788](https://github.com/cockroachdb/cockroach/pull/6788)
- The `cockroach exterminate` command (which did not work) has been removed. [#6780](https://github.com/cockroachdb/cockroach/pull/6780)
- Garbage collection now retains the first value outside the configured interval, since it was the current value at the start of the interval. [#6778](https://github.com/cockroachdb/cockroach/pull/6778)

<h3 id="beta-20160526-doc-updates">Doc Updates</h3>

- Docs on the [`INSERT`](../v1.0/insert.html) statement are now available. [#308](https://github.com/cockroachdb/docs/pull/308)
- Docs on the [`UPSERT`](../v1.0/upsert.html) statement are now available. [#308](https://github.com/cockroachdb/docs/pull/308)

<h3 id="beta-20160526-contributors">Contributors</h3>

This release includes 58 merged PRs by 16 authors. We would like to
thank the following contributor from the CockroachDB community:

* Kenji Kaneda
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160602-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160602.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160602.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160602-new-features">New Features</h3>

- String literals can now be parsed as [`DATE`](../v1.0/date.html), [`TIMESTAMP`](../v1.0/timestamp.html), [`TIMESTAMPTZ`](../v1.0/timestamp.html), or [`INTERVAL`](../v1.0/interval.html) without an explicit cast. [#6925](https://github.com/cockroachdb/cockroach/pull/6925)
- Floor division is now supported with a new [operator](../v1.0/functions-and-operators.html#operators), `//`. [#6642](https://github.com/cockroachdb/cockroach/pull/6642)
- Sub-queries are now allowed in `LIMIT`, `OFFSET`, and `RETURNING` expressions. [#6735](https://github.com/cockroachdb/cockroach/pull/6735)

<h3 id="beta-20160602-bug-fixes">Bug Fixes</h3>

- Fixed a missing error check that could result in inconsistencies when transactions conflict. [#6899](https://github.com/cockroachdb/cockroach/pull/6899)

<h3 id="beta-20160602-performance-improvements">Performance Improvements</h3>

- Improved performance of one-phase transactions. [#6857](https://github.com/cockroachdb/cockroach/pull/6857), [#6861](https://github.com/cockroachdb/cockroach/pull/6861)
- Improved the ability of `MIN()` and `MAX()` [functions](../v1.0/functions-and-operators.html) to detect the ordering of the data and read only a single row. [#6891](https://github.com/cockroachdb/cockroach/pull/6891)

<h3 id="beta-20160602-doc-updates">Doc Updates</h3>

- Added a tutorial on [building an Application with CockroachDB and SQLAlchemy](https://www.cockroachlabs.com/blog/building-application-cockroachdb-sqlalchemy-2/)
- Added docs on [how CockroachDB handles `NULL` values](../v1.0/null-handling.html) in various contexts. [#333](https://github.com/cockroachdb/docs/pull/333)
- Improved guidance on [Contributing to CockroachDB docs](https://github.com/cockroachdb/docs/blob/master/CONTRIBUTING.md). [#344](https://github.com/cockroachdb/docs/pull/344)
- Improved [zone configuration examples](../v1.0/configure-replication-zones.html#basic-examples). [#327](https://github.com/cockroachdb/docs/pull/327)

<h3 id="beta-20160602-contributors">Contributors</h3>

This release includes 55 merged PRs by 18 authors. We would like to
thank the following contributors from the CockroachDB community, especially first-time contributors, Sean Loiselle and Thonakom Sangnetra:

- Sean Loiselle
- Thanakom Sangnetra
- Paul Steffensen
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160609-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160609.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160609.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160609-new-features">New Features</h3>

- The [`SERIAL`](../v1.0/serial.html) column type is now supported as an alias for `INT DEFAULT unique_rowid()`. In CockroachDB, this type defaults to a unique 64-bit signed integer that is the combination of the insert timestamp and the ID of the node executing the insert. It therefore differs from similar types in PostgreSQL and MySQL, which auto-increment integers in an approximate sequence. [#7032](https://github.com/cockroachdb/cockroach/pull/7032)
- For client-side [transaction retries](../v1.0/transactions.html#transaction-retries), reissuing the original `SAVEPOINT cockroach_restart` now has the same effect as `ROLLBACK TO SAVEPOINT cockroach_restart`. This improves compatibility with some client drivers. [#6955](https://github.com/cockroachdb/cockroach/pull/6955)
- `FAMILY` is now a reserved word in the SQL dialect in preparation for a future feature. [#7069](https://github.com/cockroachdb/cockroach/pull/7069)

<h3 id="beta-20160609-bug-fixes">Bug Fixes</h3>

- The [command-line SQL shell](../v1.0/use-the-built-in-sql-client.html) is now able to print non-ASCII characters. [#7045](https://github.com/cockroachdb/cockroach/pull/7045), [#7048](https://github.com/cockroachdb/cockroach/pull/7048)
- Commands issued with a timestamp outside the garbage collection window will now always fail. [#6992](https://github.com/cockroachdb/cockroach/pull/6992)
- All aggregate functions now return `NULL` when run on a table with no rows. [#7043](https://github.com/cockroachdb/cockroach/pull/7043)

<h3 id="beta-20160609-performance-improvements">Performance Improvements</h3>

- <a href="http://www.canonware.com/jemalloc/" data-proofer-ignore><code>jemalloc</code></a> is now used as the memory allocator for the C++ portions of the server. The build tag `stdmalloc` can be used to switch back to the standard `malloc`. [#7006](https://github.com/cockroachdb/cockroach/pull/7006)
- Raft logs are now garbage collected more aggressively. This should generally make snapshots smaller, reducing memory pressure, but sometimes it may cause more snapshots to be sent. [#7040](https://github.com/cockroachdb/cockroach/pull/7040)
- Reduced allocations in [`INSERT`](../v1.0/insert.html) and [`UPDATE`](../v1.0/update.html) statements involving secondary indexes. [#7011](https://github.com/cockroachdb/cockroach/pull/7011)
- Improved performance of conditional puts with no existing value. [#7016](https://github.com/cockroachdb/cockroach/pull/7016)
- Improved performance of small transactions. [#7015](https://github.com/cockroachdb/cockroach/pull/7015)

<h3 id="beta-20160609-doc-updates">Doc Updates</h3>

- The [Build an App](../v1.0/build-a-rust-app-with-cockroachdb.html) tutorial now demonstrates connecting to CockroachDB from the [Rust Postgres driver](../v1.0/install-client-drivers.html).
- Docs on the [`CREATE TABLE`](../v1.0/create-table.html) statement now offer both basic and expanded grammar diagrams. [#347](https://github.com/cockroachdb/docs/pull/347)
- Docs on [constraints](../v1.0/constraints.html) now include diagrams of all table-level and row-level constraints. [#361](https://github.com/cockroachdb/docs/pull/361)

<h3 id="beta-20160609-contributors">Contributors</h3>

This release includes 56 merged PRs by 17 authors. We would like to
thank the following contributors from the CockroachDB community, especially first-time contributor Alex Robinson:

- Alex Robinson
- Kenji Kaneda
- Paul Steffensen
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160616-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160616.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160616.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160616-deprecation-notice">Deprecation Notice</h3>

- Integers with a leading zero (e.g., `0755`) are currently treated as octal. In a future release, leading zeros will be ignored and the numbers will be treated as decimal. [#7205](https://github.com/cockroachdb/cockroach/pull/7205)

<h3 id="beta-20160616-new-features">New Features</h3>

- `SELECT` statements now accept an `AS OF SYSTEM TIME` clause to read values from the recent past (up to the GC policy set in the [zone configuration](../v1.0/configure-replication-zones.html)). [#7139](https://github.com/cockroachdb/cockroach/pull/7139)
- [Hexadecimal byte string literals](../v1.0/string.html) of the form `x'f00d'` can now be used to create byte strings containing arbitrary characters. [#7138](https://github.com/cockroachdb/cockroach/pull/7138)
- `BIGSERIAL` and `SMALLSERIAL` are now supported as aliases for [`SERIAL`](../v1.0/serial.html). All three types use the same 64-bit value size. [#7187](https://github.com/cockroachdb/cockroach/pull/7187)

<h3 id="beta-20160616-bug-fixes">Bug Fixes</h3>

- Fixed a panic in some uses of subqueries. [#6994](https://github.com/cockroachdb/cockroach/pull/6994), [#7146](https://github.com/cockroachdb/cockroach/pull/7146)
- [`ALTER TABLE ADD COLUMN`](../v1.0/alter-table.html) now allows the addition of columns with a uniqueness constraint only when the table is empty. [#7094](https://github.com/cockroachdb/cockroach/pull/7094)
- Improved availability when [`--raft-tick-interval`](../v1.0/start-a-node.html#flags) is increased from its default value. [#7086](https://github.com/cockroachdb/cockroach/pull/7086)
- Improved reporting of errors from single statements run outside transactions. [#7080](https://github.com/cockroachdb/cockroach/pull/7080)
- Invalid octal literals (e.g., `09`) no longer crash the server. [#7134](https://github.com/cockroachdb/cockroach/pull/7134)
- When [`ALTER TABLE`](../v1.0/alter-table.html) fails, it now rolls back dependent items in the correct order. [#6789](https://github.com/cockroachdb/cockroach/pull/6789)
- [Aggregate functions](../v1.0/functions-and-operators.html#aggregate-functions) like `SUM()` are no longer allowed in `CHECK` or `DEFAULT` expressions. [#7221](https://github.com/cockroachdb/cockroach/pull/7221)

<h3 id="beta-20160616-performance-improvements">Performance Improvements</h3>

- Improved rate limiting of snapshots during rebalancing, reducing memory usage and improving availability. [#6878](https://github.com/cockroachdb/cockroach/pull/6878)
- Splitting a range that has grown beyond the target size is now faster. [#7118](https://github.com/cockroachdb/cockroach/pull/7118)
- Raft elections are now initiated lazily instead of shortly after server startup. [#7085](https://github.com/cockroachdb/cockroach/pull/7085)
- The raft log is now garbage-collected more eagerly. [#7125](https://github.com/cockroachdb/cockroach/pull/7125)
- Increased RocksDB block size, which reduces memory usage. [#7219](https://github.com/cockroachdb/cockroach/pull/7219)

<h3 id="beta-20160616-doc-updates">Doc Updates</h3>

- Docs on the [Built-in SQL client](../v1.0/use-the-built-in-sql-client.html) now cover pretty-printing to the standard output when executing SQL from the command line. The examples have been improved as well. [#373](https://github.com/cockroachdb/docs/pull/373)
- Docs on the [`STRING`](../v1.0/string.html) and [`INT`](../v1.0/int.html) data types now cover hexadecimal-encoded literal format. Also, the `STRING` docs now cover escape string format. [#392](https://github.com/cockroachdb/docs/pull/392)
- On [Functions and Operators](../v1.0/functions-and-operators.html), functions are now identified as "built-in" or "aggregate". Also, function categorization has been improved. [#379](https://github.com/cockroachdb/docs/pull/379), [#387](https://github.com/cockroachdb/docs/pull/387)
- On [`CREATE INDEX`](../v1.0/create-index.html), the syntax diagram has been clarified and expanded. [#382](https://github.com/cockroachdb/docs/pull/382)

<h3 id="beta-20160616-contributors">Contributors</h3>

This release includes 80 merged PRs by 19 authors. We would like to
thank the following contributors from the CockroachDB community:

- Kenji Kaneda
- Paul Steffensen
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160629-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160629.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160629.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160629-new-features">New Features</h3>

- A prototype implementation of `JOIN` (non-optimized) is now available. [#7202](https://github.com/cockroachdb/cockroach/pull/7202)
- [Column Families](../v1.0/column-families.html) are a new, more efficient representation of SQL tables. Each column family is a group of columns in a table that are stored as a single underlying key-value pair. New tables created with multi-column families will not be compatible with versions of CockroachDB earlier than `beta-20160629`. However, no migration of existing tables is necessary; the previous format corresponds to a separate column family for each column in the table. [#7466](https://github.com/cockroachdb/cockroach/pull/7466), [#7408](https://github.com/cockroachdb/cockroach/pull/7408), [RFC](https://github.com/cockroachdb/cockroach/blob/master/docs/RFCS/20151214_sql_column_families.md)
- [`EXPLAIN`](../v1.0/explain.html) can now be used with `CREATE`, `DROP`, and `ALTER` statements. [#7269](https://github.com/cockroachdb/cockroach/pull/7269)
- The [built-in SQL client](../v1.0/use-the-built-in-sql-client.html) now prints tab-separated values instead of ASCII-art tables when `stdout` is not a TTY (unless `--pretty` is used). [#7268](https://github.com/cockroachdb/cockroach/pull/7268)
- In interactive mode, the [built-in SQL client](../v1.0/use-the-built-in-sql-client.html) now prints the number of rows at the end of a result set. [#7266](https://github.com/cockroachdb/cockroach/pull/7266)
- Prepared statements can now be deallocated with the `DEALLOCATE` command. [#7367](https://github.com/cockroachdb/cockroach/pull/7367)
- Added support for interval types in placeholders. [#7382](https://github.com/cockroachdb/cockroach/pull/7382)
- Added support for hexadecimal-encoded [`STRING`](../v1.0/string.html) literals. [#7138](https://github.com/cockroachdb/cockroach/pull/7138)

<h3 id="beta-20160629-performance-improvements">Performance Improvements</h3>

- The load balancing system now operates at a steadier pace, reducing spikes in memory usage and reaching equilibrium more quickly. [#7147](https://github.com/cockroachdb/cockroach/pull/7147)
- The block cache is now shared across stores on the same node. [#7496](https://github.com/cockroachdb/cockroach/pull/7496)
- Initial replication in a new cluster is now significantly faster. [#7355](https://github.com/cockroachdb/cockroach/pull/7355)
- The Raft log is now more aggressively truncated. [#7125](https://github.com/cockroachdb/cockroach/pull/7125)
- The RocksDB block-size is now set to a more reasonable value. [#7276](https://github.com/cockroachdb/cockroach/pull/7276)
- A new reservation system now ensures that there is enough free space and not too many existing reservations before trying to replicate a range to a new store. This stops the thundering herd that can occur when adding a new node to a cluster. [#7147](https://github.com/cockroachdb/cockroach/pull/7147)
- Miscellaneous performance improvements in the underlying data distribution and replication protocol.

<h3 id="beta-20160629-bug-fixes">Bug Fixes</h3>

- Fixed a bug that could cause a server crash on startup. [#7447](https://github.com/cockroachdb/cockroach/pull/7447)
- Improved the handling of `NULL` values in arithmetic and comparison operations. [#7341](https://github.com/cockroachdb/cockroach/pull/7341)
- Fixed a crash when session arguments could not be parsed. [#7231](https://github.com/cockroachdb/cockroach/pull/7231)
- Improved error messages for parts of the PostgreSQL protocol we do not support. [#7233](https://github.com/cockroachdb/cockroach/pull/7233)
- `AS OF SYSTEM TIME` can now be used in prepared statements. [#7251](https://github.com/cockroachdb/cockroach/pull/7251)
- Raft messages are no longer canceled due to unrelated errors. [#7252](https://github.com/cockroachdb/cockroach/pull/7252)
- [Constraint](../v1.0/constraints.html) names that are specified at the column level are now preserved. [#7271](https://github.com/cockroachdb/cockroach/pull/7271)
- When [`COMMIT`](../v1.0/commit-transaction.html) returns an error, the transaction is considered closed and a separate `ROLLBACK` is no longer necessary. [#7282](https://github.com/cockroachdb/cockroach/pull/7282)
- The [built-in SQL client](../v1.0/use-the-built-in-sql-client.html) now escapes strings in a format that the SQL parser will accept. [#7294](https://github.com/cockroachdb/cockroach/pull/7294)
- Fixed issues when two snapshots were being sent simultaneously. [#7299](https://github.com/cockroachdb/cockroach/pull/7299)
- When a column is [renamed](../v1.0/rename-column.html), any `CHECK` constraints referring to that column are now updated. [#7311](https://github.com/cockroachdb/cockroach/pull/7311)
- When piping commands into the [built-in SQL client](../v1.0/use-the-built-in-sql-client.html), the last line was previously ignored. Now it will be executed if it ends with a semicolon, or report an error if it is non-empty but not a complete statement. [#7328](https://github.com/cockroachdb/cockroach/pull/7328)
- When [`cockroach quit`](../v1.0/stop-a-node.html) fails to drain a node, it is now forced to quit. [#7483](https://github.com/cockroachdb/cockroach/pull/7483)
- Fixed a case in which a removed replica could prevent the rebalance queue from making progress. [#7507](https://github.com/cockroachdb/cockroach/pull/7507)
- Fixed a bug that slowed down population of new replicas. [#7252](https://github.com/cockroachdb/cockroach/pull/7252)

<h3 id="beta-20160629-internal-changes">Internal Changes</h3>

- The Admin UI has been rewritten in a new framework. [#7242](https://github.com/cockroachdb/cockroach/pull/7242)
- The Admin UI now uses serialized protocol buffers when communicating with CockroachDB servers. [#7178](https://github.com/cockroachdb/cockroach/pull/7178), [#7242](https://github.com/cockroachdb/cockroach/pull/7242)

<h3 id="beta-20160629-contributors">Contributors</h3>

This release includes 160 merged PRs by 22 authors. We would like to
thank the following contributors from the CockroachDB community, especially first-time contributor [phynalle](https://github.com/cockroachdb/cockroach/pull/7361):

- Jingguo Yao
- Kenji Kaneda
- phynalle
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160714-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160714.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160714.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160714-upgrade-notes">Upgrade Notes</h3>

- This release cannot be run concurrently with older beta releases. Please stop all nodes running older releases before restarting any node with this version.
- After running this release, it is impossible to downgrade to any release older than [`beta-20160629`](beta-20160629.html).
- This release uses more open file descriptors than older releases. It is recommended to set the process's file descriptor limit to at least 10000. See [Recommended Production Settings](../v1.0/recommended-production-settings.html) for more details.

<h3 id="beta-20160714-new-features">New Features</h3>

- The `cockroach dump` command can now be used to back up the contents of a table. The output of `dump` is a series of SQL statements that can be used to recreate the table. [#7511](https://github.com/cockroachdb/cockroach/pull/7511)
- The `ILIKE` [operator](../v1.0/functions-and-operators.html) for case-insensitive matching is now supported. [#7635](https://github.com/cockroachdb/cockroach/pull/7635)
- Four new [operators](../v1.0/functions-and-operators.html) for regular expression matches are now supported: `~` (regex match), `!~` (negated regex match), `~*` (case-insensitive regex match), `!~*` (negated case-insensitive regex matcH). [#7686](https://github.com/cockroachdb/cockroach/pull/7686)
- The new `SHOW CONSTRAINTS` statement can be used to show the constraints on a table. [#7584](https://github.com/cockroachdb/cockroach/pull/7584)
- `FOREIGN KEY` constraints can now have names. [#7627](https://github.com/cockroachdb/cockroach/pull/7627)
- The [`--http-addr`](../v1.0/start-a-node.html) flag can be used to control the network interface used for the web UI. [#7475](https://github.com/cockroachdb/cockroach/pull/7475)
- [`ALTER TABLE ADD COLUMN`](../v1.0/alter-table.html) can now be used to create [column families](../v1.0/column-families.html). [#7711](https://github.com/cockroachdb/cockroach/pull/7711)
- CockroachDB can now be built on FreeBSD. See this [blog post](https://www.cockroachlabs.com/blog/critters-in-a-jar-running-cockroachdb-in-a-freebsd-jail/) for details. [#7545](https://github.com/cockroachdb/cockroach/pull/7545)
- The `uidebug` `Makefile` target, used for development of the web UI, has been replaced with the environment variable `COCKROACH_DEBUG_UI=1`. [#7601](https://github.com/cockroachdb/cockroach/pull/7601)

<h3 id="beta-20160714-performance-improvements">Performance Improvements</h3>

- [Column families](../v1.0/column-families.html) are now used by default, improving performance of all tables created in this release and beyond. [#7623](https://github.com/cockroachdb/cockroach/pull/7623)
- Removed replicas are now garbage collected more quickly. [#7533](https://github.com/cockroachdb/cockroach/pull/7533)
- RocksDB is now configured to use more, smaller files. This improves performance by reducing the amount of data rewritten during compactions, but increases the number of open file descriptors used by the process. [#7532](https://github.com/cockroachdb/cockroach/pull/7532)
- The server now increases its soft file descriptor limit if it is too low and this is allowed by the hard limit. [#7747](https://github.com/cockroachdb/cockroach/pull/7747)
- The raft log can now be truncated even if a replica is behind, reducing the size of snapshots that must be transmitted over the network (but somewhat increasing the likelihood that a snapshot will be needed instead of replaying the log). [#7438](https://github.com/cockroachdb/cockroach/pull/7438)
- Raft-related messages are now sent in separate streams for each range. [#7534](https://github.com/cockroachdb/cockroach/pull/7534)
- Raft commands for queries that have been abandoned by the client are no longer retried internally. [#7605](https://github.com/cockroachdb/cockroach/pull/7605)
- Table leases are now released when connections are closed, allowing schema changes to proceed without waiting for leases to expire. [#7661](https://github.com/cockroachdb/cockroach/pull/7661)

<h3 id="beta-20160714-bug-fixes">Bug Fixes</h3>

- The [command-line SQL client](../v1.0/use-the-built-in-sql-client.html) is now smarter about semicolons and `` commands inside string literals. [#7510](https://github.com/cockroachdb/cockroach/pull/7510)
- `LIMIT` is now applied correctly on queries that use `JOIN`. [#7546](https://github.com/cockroachdb/cockroach/pull/7546)
- The "CGo Calls" graph in the web UI is now displayed as a rate instead of a cumulative total. [#7597](https://github.com/cockroachdb/cockroach/pull/7597)
- The [`cockroach quit`](../v1.0/stop-a-node.html) command now waits for the server to stop before returning. [#7603](https://github.com/cockroachdb/cockroach/pull/7603)
- Building CockroachDB in a Docker container on Linux with `build/builder.sh` no longer requires the container and host toolchains to be the same. [#7626](https://github.com/cockroachdb/cockroach/pull/7626)
- Fixed a deadlock in table lease acquisition. [#7504](https://github.com/cockroachdb/cockroach/pull/7504)
- The [`TIMESTAMP WITH TIME ZONE`](../v1.0/timestamp.html) type is now reported correctly in the network protocol. [#7642](https://github.com/cockroachdb/cockroach/pull/7642)
- [Constraint](../v1.0/constraints.html) names are now required to be unique. [#7629](https://github.com/cockroachdb/cockroach/pull/7629)
- The "Events" tab in the web UI now includes events for schema changes. [#7571](https://github.com/cockroachdb/cockroach/pull/7571)
- Fixed several server panics in expression normalization. [#7512](https://github.com/cockroachdb/cockroach/pull/7512)
- Fixed a data race when a transaction is abandoned by the client. [#7738](https://github.com/cockroachdb/cockroach/pull/7738)
- Fixed a scenario in which intents could not be resolved. [#7744](https://github.com/cockroachdb/cockroach/pull/7744)
- RocksDB is no longer allowed to use all available file descriptors. [#7747](https://github.com/cockroachdb/cockroach/pull/7747)
- Using `*` as an argument to functions other than `COUNT(*)` no longer causes the server to panic. [#7751](https://github.com/cockroachdb/cockroach/pull/7751)
- Fixed a deadlock during shutdown. [#7770](https://github.com/cockroachdb/cockroach/pull/7770)

<h3 id="beta-20160714-doc-updates">Doc Updates</h3>

- Docs on [installing CockroachDB in Docker](../v1.0/install-cockroachdb.html) now recommend using the new Docker applications for Mac and Windows.
- The new [Start a Cluster in Docker](../v1.0/start-a-local-cluster-in-docker.html) page demonstrates how to run a multi-node cluster across multiple Docker containers on a single host, using Docker volumes to persist node data.
- Docs on the [`DELETE`](../v1.0/delete.html) statement are now available.

<h3 id="beta-20160714-contributors">Contributors</h3>

This release includes 131 merged PRs by 25 authors. We would like to
thank the following contributors from the CockroachDB community, especially first-time contributor [songhao](https://github.com/cockroachdb/cockroach/pull/7692):

- Jason E. Aten
- Jingguo Yao
- Kenji Kaneda
- Sean Loiselle
- songhao
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160721-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160721.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160721.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160721-new-features">New Features</h3>

- Metrics are now exported on `/_status/vars` in a format suitable for aggregation by Prometheus. [#7895](https://github.com/cockroachdb/cockroach/pull/7895)

<h3 id="beta-20160721-build-changes">Build Changes</h3>

- Go 1.6.3 and 1.7rc2 are now supported. [#7811](https://github.com/cockroachdb/cockroach/pull/7811)
- The versions of Docker built for Mac and Windows are now supported. Users of a `docker-machine` VM may need to set environment variables by hand as this case is no longer detected automatically. [#7820](https://github.com/cockroachdb/cockroach/pull/7820)

<h3 id="beta-20160721-ui-changes">UI Changes</h3>

- The Admin UI now displays a warning when there are fewer than three nodes. [#7783](https://github.com/cockroachdb/cockroach/pull/7783)

<h3 id="beta-20160721-performance-improvements">Performance Improvements</h3>

- Writes to different ranges are now performed in parallel. [#7860](https://github.com/cockroachdb/cockroach/pull/7860)
- The first range descriptor is kept more up-to-date. [#7766](https://github.com/cockroachdb/cockroach/pull/7766)
- Ranges are now considered for splits after any replication or rebalancing change. [#7800](https://github.com/cockroachdb/cockroach/pull/7800)
- An existing table lease can now be reused without writing to the lease table as long as it has enough time left before expiration. [#7781](https://github.com/cockroachdb/cockroach/pull/7781)
- The rebalancing system now avoids moving the current leader of a range. [#7918](https://github.com/cockroachdb/cockroach/pull/7918)
- Transaction records related to splits are now garbage-collected promptly. [#7903](https://github.com/cockroachdb/cockroach/pull/7903)

<h3 id="beta-20160721-bug-fixes">Bug Fixes</h3>

- Command history works again in the [command-line SQL interface](../v1.0/use-the-built-in-sql-client.html). [#7818](https://github.com/cockroachdb/cockroach/pull/7818)
- The [`cockroach dump`](../v1.0/sql-dump.html) command now works with tables that have [`DECIMAL`](../v1.0/decimal.html) columns that specify a precision and scale. [#7842](https://github.com/cockroachdb/cockroach/pull/7842)
- Fixed several panics when handling invalid SQL commands. [#7867](https://github.com/cockroachdb/cockroach/pull/7867) [#7868](https://github.com/cockroachdb/cockroach/pull/7868)
- [`ALTER TABLE ADD COLUMN`](../v1.0/alter-table.html) now supports the `IF NOT EXISTS` modifier. [#7898](https://github.com/cockroachdb/cockroach/pull/7898)
- Fixed a race in gossip status logging. [#7836](https://github.com/cockroachdb/cockroach/pull/7836)

<h3 id="beta-20160721-doc-updates">Doc Updates</h3>

- Feedback can now be submitted from the bottom of any page of our docs. [#467](https://github.com/cockroachdb/docs/pull/467)
- Updated [Recommended Production Settings](../v1.0/recommended-production-settings.html) to provide OS-specific instructions for increasing the file descriptors limit. [#459](https://github.com/cockroachdb/docs/pull/459)
- Updated [INTERVAL](../v1.0/interval.html) to cover all supported interval formats: Golang, Traditional Postgres, and ISO 8601. [#462](https://github.com/cockroachdb/docs/pull/462)
- Updated [Start a Cluster in Docker](../v1.0/start-a-local-cluster-in-docker.html) to work for Docker on Windows. [#457](https://github.com/cockroachdb/docs/pull/457)

<h3 id="beta-20160721-contributors">Contributors</h3>

This release includes 76 merged PRs by 21 authors. We would especially like to
thank first-time contributors [Christian Meunier](https://github.com/cockroachdb/cockroach/pull/7937) and [Dharmesh Kakadia](https://github.com/dharmeshkakadia) from the CockroachDB community.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160728-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160728.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160728.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160728-new-features">New Features</h3>

- Foreign keys can now reference multiple columns. [#8033](https://github.com/cockroachdb/cockroach/pull/8033)
- The [`dump`](../v1.0/sql-dump.html) command can now be run by any user with `SELECT` privilege on the table. [#7974](https://github.com/cockroachdb/cockroach/pull/7974)
- [`INTEGER`](../v1.0/int.html) and [`DECIMAL`](../v1.0/decimal.html) types can now be mixed in arithmetic expressions without casts. [#7756](https://github.com/cockroachdb/cockroach/pull/7756)
- The [`--join`](../v1.0/start-a-node.html) flag can now be specified multiple times, as an alternative to specifying a comma-separated list. [#7876](https://github.com/cockroachdb/cockroach/pull/7876)

<h3 id="beta-20160728-bug-fixes">Bug Fixes</h3>

- Range leases are now preserved across splits, fixing a source of inconsistent reads. [#7955](https://github.com/cockroachdb/cockroach/pull/7955)
- Fixed a panic when single-statement [transactions](../v1.0/transactions.html) were aborted after an automatic retry. [#8010](https://github.com/cockroachdb/cockroach/pull/8010)
- Parsing of time zone offsets is now more lenient, improving compatibility with JDBC drivers. [#7929](https://github.com/cockroachdb/cockroach/pull/7929)
- Unbounded columns are now allowed in empty [column families](../v1.0/column-families.html). [#7969](https://github.com/cockroachdb/cockroach/pull/7969)
- The target columns of [`INSERT`](../v1.0/insert.html) and [`UPDATE`](../v1.0/update.html) statements are now required to be given in unqualified form. [#7911](https://github.com/cockroachdb/cockroach/pull/7911)
- Fixed a potential deadlock in the gossip subsystem and SQL leases. [#8011](https://github.com/cockroachdb/cockroach/pull/8011), [#8019](https://github.com/cockroachdb/cockroach/pull/8019)

<h3 id="beta-20160728-performance-improvements">Performance Improvements</h3>

- Snapshots are now sent prior to the Raft configuration change, minimizing the window of reduced availability. [#7833](https://github.com/cockroachdb/cockroach/pull/7833)

<h3 id="beta-20160728-doc-updates">Doc Updates</h3>

- Added docs on the [`cockroach dump`](../v1.0/sql-dump.html) command. [#472](https://github.com/cockroachdb/docs/pull/472)
- Updated [Recommended Production Settings](../v1.0/recommended-production-settings.html) to clarify how CockroachDB allocates file descriptors when the limit is under the recommended amount. [#480](https://github.com/cockroachdb/docs/pull/480)
- [SQL statements](../v1.0/sql-statements.html), [data types](../v1.0/data-types.html), and data definition topics are now available at-a-glance in the sidebar. [#483](https://github.com/cockroachdb/docs/pull/483)

<h3 id="beta-20160728-contributors">Contributors</h3>

This release includes 63 merged PRs by 17 authors. We would like to thank first-time contributor [Rushi Agrawal](https://github.com/cockroachdb/cockroach/pull/7876) from the CockroachDB community.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160829-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160829.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160829.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160829-general-changes">General Changes</h3>

- CockroachDB now uses Go 1.7. [#8579](https://github.com/cockroachdb/cockroach/pull/8579)
- CockroachDB now uses RocksDB 4.9. [#8815](https://github.com/cockroachdb/cockroach/pull/8815)

<h3 id="beta-20160829-command-line-interface-changes">Command-Line Interface Changes</h3>

- The [`cockroach zone set`](../v1.0/configure-replication-zones.html) command no longer takes its input directly on the command line. Instead, it accepts a `--file` flag to read from a file, or `--file=-` to read from standard input. [#7953](https://github.com/cockroachdb/cockroach/pull/7953)

<h3 id="beta-20160829-new-features">New Features</h3>

- `AS OF SYSTEM TIME` can now be used with `JOIN` queries. [#8198](https://github.com/cockroachdb/cockroach/pull/8198)
- The type `BIT` now works correctly (as a shorthand for `BIT(1)`). The length limit is now enforced. [#8326](https://github.com/cockroachdb/cockroach/pull/8326)
- The `SHOW` commands now only show tables that the current user has permission to access. [#8070](https://github.com/cockroachdb/cockroach/pull/8070)
- [Foreign keys](../v1.0/foreign-key.html) can now use a prefix of an index. [#8059](https://github.com/cockroachdb/cockroach/pull/8059)
- The standard `information_schema` database is now partially supported. New tables will be added to this database in future beta releases. [#7965](https://github.com/cockroachdb/cockroach/pull/7965), [#8119](https://github.com/cockroachdb/cockroach/pull/8119)

<h3 id="beta-20160829-bug-fixes">Bug Fixes</h3>

- Clusters with a large number of ranges no longer experience persistently broken connections on node restarts. [#8828](https://github.com/cockroachdb/cockroach/pull/8828)
- The `RENAME` command now requires the `DROP` privilege on the table or database. It is no longer possible to rename the `system` database. [#7998](https://github.com/cockroachdb/cockroach/pull/7998)
- The `repeat()` and `substr()` [functions](../v1.0/functions-and-operators.html) with very large numeric arguments will no longer crash the server as easily. [#8073](https://github.com/cockroachdb/cockroach/pull/8073), [#8078](https://github.com/cockroachdb/cockroach/pull/8078)
- Certain errors now cause a replica to be marked as corrupt so the corruption will not be replicated to other nodes. [#7684](https://github.com/cockroachdb/cockroach/pull/7684)
- A `CloseComplete` packet is now sent in response to a `Close` command, improving compatibility with come PostgreSQL client drivers (including the Elixir driver). [#8309](https://github.com/cockroachdb/cockroach/pull/8309)
- SQL name parsing has been improved to fix several panics and allow foreign key constraints that span databases. [#8152](https://github.com/cockroachdb/cockroach/pull/8152)
- Fixed some panics. [#8283](https://github.com/cockroachdb/cockroach/pull/8283), [#8282](https://github.com/cockroachdb/cockroach/pull/8282)
- Fixed a deadlock if a range grew too large. [#8387](https://github.com/cockroachdb/cockroach/pull/8387)
- Fixed a race in which multiple conflicting snapshots could be accepted at the same time. [#8365](https://github.com/cockroachdb/cockroach/pull/8365)
- Decimal values are now represented correctly in the binary protocol. [#8319](https://github.com/cockroachdb/cockroach/pull/8319)

<h3 id="beta-20160829-performance-improvements">Performance Improvements</h3>

- Snapshots are now sent synchronously during replica changes. This controls the rate of the replication process and prevents spikes in memory usage that often caused servers to crash. [#8613](https://github.com/cockroachdb/cockroach/pull/8613)
- Raft logs are now truncated less aggressively, reducing the chance that replication will need to send a snapshot instead of the log. [#8343](https://github.com/cockroachdb/cockroach/pull/8343), [#8629](https://github.com/cockroachdb/cockroach/pull/8629), [#8656](https://github.com/cockroachdb/cockroach/pull/8656)
- Snapshots and the raft log are now written more efficiently. [#8644](https://github.com/cockroachdb/cockroach/pull/8644)
- Raft log entries are now cached. [#8494](https://github.com/cockroachdb/cockroach/pull/8494)
- Raft groups are now created lazily at startup. [#8592](https://github.com/cockroachdb/cockroach/pull/8592)
- Raft heartbeats are now sent less often by default. [#8695](https://github.com/cockroachdb/cockroach/pull/8695)
- Improved performance and reliability of clusters with large numbers of ranges. [#8125](https://github.com/cockroachdb/cockroach/pull/8125), [#8162](https://github.com/cockroachdb/cockroach/pull/8162), [#8495](https://github.com/cockroachdb/cockroach/pull/8495)
- The heuristics used by the rebalancing system have been improved. [#8124](https://github.com/cockroachdb/cockroach/pull/8124)
- Some noisy log messages have been removed or reduced. [#8071](https://github.com/cockroachdb/cockroach/pull/8071), [#8021](https://github.com/cockroachdb/cockroach/pull/8021), [#8240](https://github.com/cockroachdb/cockroach/pull/8240), [#8292](https://github.com/cockroachdb/cockroach/pull/8292), [#8529](https://github.com/cockroachdb/cockroach/pull/8529), [#8687](https://github.com/cockroachdb/cockroach/pull/8687), [#8689](https://github.com/cockroachdb/cockroach/pull/8689)
- The gossip network reconnects more reliably after a failure. [#8128](https://github.com/cockroachdb/cockroach/pull/8128)
- RPC connections to failed nodes are now detected sooner. [#8163](https://github.com/cockroachdb/cockroach/pull/8163)
- The cache of the first range descriptor is now properly invalidated. [#8163](https://github.com/cockroachdb/cockroach/pull/8163)
- Removed replicas are now garbage-collected sooner in many cases. [#8172](https://github.com/cockroachdb/cockroach/pull/8172)
- The resolution of the block profiler has been reduced, saving CPU. [#8384](https://github.com/cockroachdb/cockroach/pull/8384)
- Range lease extensions no longer block concurrent reads. [#8352](https://github.com/cockroachdb/cockroach/pull/8352)

<h3 id="beta-20160829-ui-changes">UI Changes</h3>

- The "capacity used" is now computed correctly. [#8048](https://github.com/cockroachdb/cockroach/pull/8048)
- The CPU and garbage-collection graphs now display averages. [#8048](https://github.com/cockroachdb/cockroach/pull/8048)
- The Databases section now includes more details. [#8364](https://github.com/cockroachdb/cockroach/pull/8364)

<h3 id="beta-20160829-doc-updates">Doc Updates</h3>

- The new [SQL Feature Support](../v1.0/sql-feature-support.html) page explains which standard SQL features are supported by CockroachDB. [#550](https://github.com/cockroachdb/docs/pull/550)
- The new Features on Develop Branch page tracks features that are available on the `develop` branch but not yet on `master`. [#552](https://github.com/cockroachdb/docs/pull/552) (Page no longer available.)
- Added docs on [foreign key constraints](../v1.0/foreign-key.html). [#528](https://github.com/cockroachdb/docs/pull/528)
- Added docs on the [`TRUNCATE`](../v1.0/truncate.html) statement. [#542](https://github.com/cockroachdb/docs/pull/542)
- Updated [Recommended Production Settings](../v1.0/recommended-production-settings.html) to include cache size recommendations for machines running multiple applications and `systemd`-specific instructions for increasing the file descriptors limit. [#532](https://github.com/cockroachdb/docs/pull/532), [#554](https://github.com/cockroachdb/docs/pull/554)
- Fixed errors in the commands for [starting CockroachDB in Docker](../v1.0/start-a-local-cluster-in-docker.html). [#567](https://github.com/cockroachdb/docs/pull/567)

<h3 id="beta-20160829-contributors">Contributors</h3>

This release includes 280 merged PRs by 26 authors. We would like to thank the following contributors from the CockroachDB community:

- Christian Koep
- Dolf Schimmel
- songhao
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160908-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160908.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160908.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160908-general-changes">General Changes</h3>

- CockroachDB has reverted to RocksDB 4.8. [#9118](https://github.com/cockroachdb/cockroach/pull/9118)
- The logging format has changed to include a goroutine ID. [#8977](https://github.com/cockroachdb/cockroach/pull/8977)
- CockroachDB now builds correctly when Git worktrees are used; as a consequence Git version 2.5 or newer is now required when [building from source](../v1.0/install-cockroachdb.html). [#9072](https://github.com/cockroachdb/cockroach/pull/9072)

<h3 id="beta-20160908-command-line-interface-changes">Command-Line Interface Changes</h3>

- The `--from` and `--to` arguments of debugging commands now support backslash-escaped keys. [#8903](https://github.com/cockroachdb/cockroach/pull/8903)
- If any [environment variables](../v1.0/cockroach-commands.html#environment-variables) are used to configure the server, the names of those variables are printed to the logs. [#9069](https://github.com/cockroachdb/cockroach/pull/9069)

<h3 id="beta-20160908-bug-fixes">Bug fixes</h3>

- Fixed a bug that would result in the server locking up after a few hours on a machine or VM with only one CPU. [#8908](https://github.com/cockroachdb/cockroach/pull/8908)
- Fixed another cause of persistently broken connections on node restarts. [#8947](https://github.com/cockroachdb/cockroach/pull/8947)
- [`CREATE TABLE`](../v1.0/create-table.html) now reports errors correctly instead of failing silently. [#9011](https://github.com/cockroachdb/cockroach/pull/9011)
- The replica garbage collection process is no longer confused by uninitialized replicas. [#9021](https://github.com/cockroachdb/cockroach/pull/9021)
- Fixed various data races. [#8865](https://github.com/cockroachdb/cockroach/pull/8865), [#8933](https://github.com/cockroachdb/cockroach/pull/8933)
- Fixed a panic in the time-series query system. [#9038](https://github.com/cockroachdb/cockroach/pull/9038)

<h3 id="beta-20160908-performance-improvements">Performance Improvements</h3>

- Internal locking mechanisms have been refactored to improve parallelism. [#8941](https://github.com/cockroachdb/cockroach/pull/8941)
- GRPC request tracing has been disabled due to its memory cost. [#9113](https://github.com/cockroachdb/cockroach/pull/9113)
- Raft leadership is more reliably transferred to coincide with the range lease. [#8932](https://github.com/cockroachdb/cockroach/pull/8932)
- Raft snapshots are now limited to one at a time on both the receiving and sending nodes. [#8974](https://github.com/cockroachdb/cockroach/pull/8974)
- Node startup time has been improved. [#9020](https://github.com/cockroachdb/cockroach/pull/9020)
- Reduced memory usage of the timestamp cache. [#9102](https://github.com/cockroachdb/cockroach/pull/9102)
- Old replicas are now garbage-collected with higher priority. [#9019](https://github.com/cockroachdb/cockroach/pull/9019)
- Transaction records for splits and replica changes are now garbage-collected sooner. [#9036](https://github.com/cockroachdb/cockroach/pull/9036)

<h3 id="beta-20160908-doc-updates">Doc Updates</h3>

- Added docs on [deploying CockroachDB on Google Cloud Platform GCE](../v1.0/deploy-cockroachdb-on-google-cloud-platform.html). [#574](https://github.com/cockroachdb/docs/pull/574)
- Added docs on [orchestrating CockroachDB with Kubernetes](../v1.0/orchestrate-cockroachdb-with-kubernetes.html). [#584](https://github.com/cockroachdb/docs/pull/584)
- Updated [troubleshooting](../v1.0/troubleshoot.html) docs to cover cases when nodes will not join a cluster. [#610](https://github.com/cockroachdb/docs/pull/610)
- Each version's release notes now link to the corresponding Mac and Linux binaries. [#604](https://github.com/cockroachdb/docs/pull/604)
- Updated docs on [secure local](../v1.0/secure-a-cluster.html) and [secure distributed](../v1.0/manual-deployment.html) deployment to show how to stop nodes. [#619](https://github.com/cockroachdb/docs/pull/619)  

<h3 id="beta-20160908-contributors">Contributors</h3>

This release includes 180 merged PRs by 17 authors. We would like to thank first-time contributor [Henry Escobar](https://github.com/HenryEscobar) from the CockroachDB community.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160915-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160915.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160915.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160915-general-changes">General Changes</h3>

- CockroachDB is now built with Go 1.7.1. [#9288](https://github.com/cockroachdb/cockroach/pull/9288)
- CockroachDB no longer requires Git 2.5; the minimum supported version is now 1.8. [#9325](https://github.com/cockroachdb/cockroach/pull/9325)

<h3 id="beta-20160915-bug-fixes">Bug Fixes</h3>

- Fixed an inconsistency that could occur when two conflicting transactions were assigned the same timestamp. [#9100](https://github.com/cockroachdb/cockroach/pull/9100)
- Nodes with multiple stores now export metrics in a format that works with Prometheus. [#9322](https://github.com/cockroachdb/cockroach/pull/9322)

<h3 id="beta-20160915-performance-improvements">Performance Improvements</h3>

- Improved concurrency of Raft processing so snapshots and replica garbage collection do not block other ranges. [#9176](https://github.com/cockroachdb/cockroach/pull/9176) [#9299](https://github.com/cockroachdb/cockroach/pull/9299)
- The rebalancing system is now more tolerant of small imbalances, making the range distribution more likely to reach a steady state. [#9230](https://github.com/cockroachdb/cockroach/pull/9230)
- Reduced memory used by debugging traces. [#9258](https://github.com/cockroachdb/cockroach/pull/9258)
- Ranges now become responsive sooner after startup. [#9276](https://github.com/cockroachdb/cockroach/pull/9276)
- Removed an internal timeout that caused unnecessary retry loops. [#9234](https://github.com/cockroachdb/cockroach/pull/9234)
- Try harder to ensure that the range lease and raft leadership are co-located. [#8834](https://github.com/cockroachdb/cockroach/pull/8834)
- Reduced memory used by Raft. [#9193](https://github.com/cockroachdb/cockroach/pull/9193)
- The consistency checker now uses less memory when an inconsistency is found. [#9159](https://github.com/cockroachdb/cockroach/pull/9159)
- The internal replica queues can now time out and recover from a replica that gets stuck. [#9312](https://github.com/cockroachdb/cockroach/pull/9312)
- Removed a redundant verification process that periodically scanned over all data. [#9333](https://github.com/cockroachdb/cockroach/pull/9333)

<h3 id="beta-20160915-doc-updates">Doc Updates</h3>

- Added docs for [deploying CockroachDB on AWS](../v1.0/deploy-cockroachdb-on-aws.html). [#640](https://github.com/cockroachdb/docs/pull/640)
- Added a "back to top" feature to improve the usability of longer pages. [#638](https://github.com/cockroachdb/docs/pull/638)
- Updated [Start a Local Cluster](../v1.0/start-a-local-cluster.html) to suggest manually setting each node's cache size to avoid memory errors when testing against a local cluster in a serious way. [#652](https://github.com/cockroachdb/docs/pull/652)
- Updated docs on [transaction retries](../v1.0/transactions.html#transaction-retries) to provide the correct error code. [#647](https://github.com/cockroachdb/docs/pull/647)

<h3 id="beta-20160915-contributors">Contributors</h3>

This release includes 66 merged PRs by 17 authors.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20160929-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160929.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20160929.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20160929-new-features">New Features</h3>

- The [`--advertise-host`](../v1.0/start-a-node.html#flags) flag can now be used to override the address to advertise to other CockroachDB nodes. [#9503](https://github.com/cockroachdb/cockroach/pull/9503)
- The [`--http-host`](../v1.0/start-a-node.html#flags) flag sets the address to bind to for HTTP requests. Together with `--http-port`, it will replace `--http-addr` in a future release. [#9573](https://github.com/cockroachdb/cockroach/pull/9573)
- More metrics are now exported about the internal garbage collection of deleted values. [#9571](https://github.com/cockroachdb/cockroach/pull/9571)
- More metrics are now exported about file descriptor usage. [#9582](https://github.com/cockroachdb/cockroach/pull/9582)
- The system now uses OpenTracing's new key-value style logging APIs. [#9578](https://github.com/cockroachdb/cockroach/pull/9578)

<h3 id="beta-20160929-bug-fixes">Bug Fixes</h3>

- Fixed an inconsistency that could occur when transactions race with garbage collection. [#9377](https://github.com/cockroachdb/cockroach/pull/9377)
- Retried `BeginTransaction` operations no longer leak internal errors to the client. [#9305](https://github.com/cockroachdb/cockroach/pull/9305)
- Brief service interruptions are now avoided after shard splits. [#9550](https://github.com/cockroachdb/cockroach/pull/9550)

<h3 id="beta-20160929-ui-changes">UI Changes</h3>

- The UI no longer crashes when a tab is reopened after being in the background for a long time. [#9042](https://github.com/cockroachdb/cockroach/pull/9042)

<h3 id="beta-20160929-performance-improvements">Performance Improvements</h3>

- Ranges which are not receiving traffic now stop sending raft heartbeats. [#9383](https://github.com/cockroachdb/cockroach/pull/9383)
- Raft snapshots are now sent as a stream instead of one large message. [#9292](https://github.com/cockroachdb/cockroach/pull/9292)
- The rebalancer is now better about noticing under-full stores. [#9415](https://github.com/cockroachdb/cockroach/pull/9415)
- Raft messages are now sent in batches. [#9485](https://github.com/cockroachdb/cockroach/pull/9485)
- Nodes are now quicker to fail over to other replicas when one is unresponsive. [#9239](https://github.com/cockroachdb/cockroach/pull/9239)
- Dropping a table or index is now faster. [#9419](https://github.com/cockroachdb/cockroach/pull/9419)
- Re-enabled consensus-level optimizations for network i/o. [#9606](https://github.com/cockroachdb/cockroach/pull/9606)

<h3 id="beta-20160929-doc-updates">Doc Updates</h3>

- Improved the SQL docs for granting privileges on databases and tables: [`GRANT`](../v1.0/grant.html). [#687](https://github.com/cockroachdb/docs/pull/687)
- Completed the SQL docs for:
    - Getting user privileges on databases and tables: [`SHOW GRANTS`](../v1.0/show-grants.html). [#687](https://github.com/cockroachdb/docs/pull/687)
    - Setting and getting the default database for a session: [`SET DATABASE`](../v1.0/set-vars.html) and [`SHOW DATABASE`](../v1.0/show-vars.html). [#671](https://github.com/cockroachdb/docs/pull/671), [#683](https://github.com/cockroachdb/docs/pull/683)
    - Setting and getting the default time zone for a session: [`SET TIME ZONE`](../v1.0/set-vars.html) and [`SHOW TIME ZONE`](../v1.0/show-vars.html). [#680](https://github.com/cockroachdb/docs/pull/680)
    - Changing the name of a table column or index: [`RENAME COLUMN`](../v1.0/rename-column.html) and [`RENAME INDEX`](../v1.0/rename-index.html). [#678](https://github.com/cockroachdb/docs/pull/678), [#679](https://github.com/cockroachdb/docs/pull/679)
- Updated high-level overviews of primary [CockroachDB features](../v1.0/strong-consistency.html) and added related links. [#699](https://github.com/cockroachdb/docs/pull/699)

<h3 id="beta-20160929-contributors">Contributors</h3>

This release includes 78 merged PRs by 19 authors. We would like to thank the following contributors from the CockroachDB community, especially first-time contributor Haines Chan:

- Haines Chan
- Jingguo Yao
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

There aren't many user-visible changes in this week's release - an artifact of our recent stability efforts, which funneled user-visible changes to a secondary development branch. Our concerted stability effort is nearing its end, and we are preparing to include these features in next week's release.

<h3 id="beta-20161006-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161006.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161006.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20161006-internal-changes">Internal Changes</h3>

- Nodes now periodically compare their configured maximum clock offset and exit fatally if they find another node operating with a different configuration. [#9612](https://github.com/cockroachdb/cockroach/pull/9612)
- Internal low-level instrumentation has been added for debugging performance bottlenecks. [#9638](https://github.com/cockroachdb/cockroach/pull/9638)
- General improvements have been made to the tracing infrastructure. [#9641](https://github.com/cockroachdb/cockroach/pull/9641)

<h3 id="beta-20161006-doc-updates">Doc Updates</h3>

- Updated various aspects of the CockroachDB [design document](https://github.com/cockroachdb/cockroach/blob/master/docs/design.md):
    - [Overview](https://github.com/cockroachdb/cockroach/blob/master/docs/design.md#overview) [#9648](https://github.com/cockroachdb/cockroach/pull/9648), [#9653](https://github.com/cockroachdb/cockroach/pull/9653)
    - [Lock-Free Distributed Transactions](https://github.com/cockroachdb/cockroach/blob/master/docs/design.md#lock-free-distributed-transactions) and [Logical Map Content](https://github.com/cockroachdb/cockroach/blob/master/docs/design.md#logical-map-content) [#9646](https://github.com/cockroachdb/cockroach/pull/9646)
    - [Strict Serializability (Linearizability)](https://github.com/cockroachdb/cockroach/blob/master/docs/design.md#strict-serializability-linearizability) [#9644](https://github.com/cockroachdb/cockroach/pull/9644)
    - [Node and Cluster Metrics](https://github.com/cockroachdb/cockroach/blob/master/docs/design.md#node-and-cluster-metrics) [#9647](https://github.com/cockroachdb/cockroach/pull/9647)
    - [SQL](https://github.com/cockroachdb/cockroach/blob/master/docs/design.md#sql) [#9651](https://github.com/cockroachdb/cockroach/pull/9651)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This week's release includes many user-visible changes and features that have been in development since our [stability-focused "code yellow"](https://www.cockroachlabs.com/blog/cant-run-100-node-cockroachdb-cluster/) started back in August. When we entered "code yellow", all work unrelated to stability was done in a secondary development environment. Since then, we've made great progress, and so have moved many of these new features back into our main development environment.

<h3 id="beta-20161013-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161013.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161013.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20161013-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- [`TIMESTAMP`](../v1.0/timestamp.html) values are now stored with microsecond precision instead of nanoseconds. All nanosecond-related functions have been removed. An existing table `t` with nanosecond timestamps in column `s` can round them to microseconds with `UPDATE t SET s = s + '0s'`. However, note that this could potentially cause uniqueness problems if the timestamp is a primary key. [#8864](https://github.com/cockroachdb/cockroach/pull/8864)
- [`TIMESTAMP`](../v1.0/timestamp.html) values (without `TIME ZONE`) are now parsed in UTC, not in the session time zone. [#9444](https://github.com/cockroachdb/cockroach/pull/9444)
- The deprecated `--http-addr` flag has been removed. When [starting a node](../v1.0/start-a-node.html), use the `--http-host` flag instead to specify the address to listen on for Admin UI HTTP requests. [#9725](https://github.com/cockroachdb/cockroach/pull/9725)

<h3 id="beta-20161013-sql-language-changes">SQL Language Changes</h3>

- Tables can now be [interleaved](../v1.0/interleave-in-parent.html) into other tables. Interleaving tables improves query performance by optimizing the key-value structure of closely related tables, attempting to keep data on the same key-value range if it’s likely to be read and written together. [#7985](https://github.com/cockroachdb/cockroach/pull/7985)
- The [`CREATE TABLE AS`](../v1.0/create-table-as.html) statement can now be used to create a table based on the results of a `SELECT` statement. [#8802](https://github.com/cockroachdb/cockroach/pull/8802), [#9278](https://github.com/cockroachdb/cockroach/pull/9278)
- The [`ALTER TABLE ... SPLIT AT`](../v1.0/alter-table.html) command can now be used to force a range split at a specified key. [#8938](https://github.com/cockroachdb/cockroach/pull/8938)
- Added new `information_schema` metatables as well as initial support for the `pg_catalog` database. This work is part of our ongoing effort to provide standard database introspection required by popular ORMs. [#8433](https://github.com/cockroachdb/cockroach/pull/8433), [#8498](https://github.com/cockroachdb/cockroach/pull/8498), [#9565](https://github.com/cockroachdb/cockroach/pull/9565), [#9114](https://github.com/cockroachdb/cockroach/pull/9114), [#9104](https://github.com/cockroachdb/cockroach/pull/9104)
- [`CHECK`](../v1.0/check.html) constraints can now be added with the [`ALTER TABLE ADD CHECK`](../v1.0/alter-table.html) and `ALTER TABLE VALIDATE` statements. [#9127](https://github.com/cockroachdb/cockroach/pull/9127) [#9152](https://github.com/cockroachdb/cockroach/pull/9152)
- The [`ALTER TABLE DROP CONSTRAINT`](../v1.0/alter-table.html) statement can now drop [`CHECK`](../v1.0/check.html) and [`FOREIGN KEY`](../v1.0/foreign-key.html) constraints. [#8747](https://github.com/cockroachdb/cockroach/pull/8747)
- The [`SHOW CONSTRAINTS`](../v1.0/show-constraints.html) statement now requires the user to have privileges for the requested table. [#8658](https://github.com/cockroachdb/cockroach/pull/8658)
- The [`EXPLAIN`](../v1.0/explain.html) statement now works correctly for `VALUES` statements containing subqueries. [#8970](https://github.com/cockroachdb/cockroach/pull/8970)
- The [`TRUNCATE`](../v1.0/truncate.html) statement now implements the `CASCADE` modifier. [#9240](https://github.com/cockroachdb/cockroach/pull/9240)
- [`TIMESTAMP`](../v1.0/timestamp.html) values that include a time zone can now omit the minutes field of the time zone offset, for compatibility with PostgreSQL. [#8666](https://github.com/cockroachdb/cockroach/pull/8666)
- [`INTERVAL`](../v1.0/interval.html) values can now be input in a colon-delimited format (H:M or H:M_S), for compatibility with PostgreSQL. [#8603](https://github.com/cockroachdb/cockroach/pull/8603)
- The `INT8` type is now supported as an alias for [`INT`](../v1.0/int.html). [#8858](https://github.com/cockroachdb/cockroach/pull/8858)
- [`INTERVAL`](../v1.0/interval.html), [`TIMESTAMP`](../v1.0/timestamp.html), [`TIMESTAMPTZ`](../v1.0/timestamp.html), and [`DATE`](../v1.0/date.html) values can now be casted to/from more types. [#9731](https://github.com/cockroachdb/cockroach/pull/9731)
- The window functions `row_number()`, `rank()`, `dense_rank()`, `percent_rank()`, `cume_dist()`, `ntile()`, `lead()`, `lag()`, `first_value()`, `last_value()`, `nth_value()` are now supported. [#8928](https://github.com/cockroachdb/cockroach/pull/8928), [#9321](https://github.com/cockroachdb/cockroach/pull/9321), [#9335](https://github.com/cockroachdb/cockroach/pull/9335)
- The `exp()` [function](../v1.0/functions-and-operators.html) returns an error if its argument is greater than 1024 instead of performing excessively expensive computation. [#8822](https://github.com/cockroachdb/cockroach/pull/8822)
- The `round()` [function](../v1.0/functions-and-operators.html) now breaks ties by rounding to the nearest even value (also known as bankers' rounding). It is now faster, and returns an error when given an excessively large number of digits. [#8822](https://github.com/cockroachdb/cockroach/pull/8822)
- The `concat_agg` [aggregate function](../v1.0/functions-and-operators.html#aggregate-functions) is now supported. [#9690](https://github.com/cockroachdb/cockroach/pull/9690)
- New [date/time functions](../v1.0/functions-and-operators.html), `extract_duration()`, `experimental_strptime()` and `experimental_strftime()`, are now supported. [#9734](https://github.com/cockroachdb/cockroach/pull/9734), [#9762](https://github.com/cockroachdb/cockroach/pull/9762)

<h3 id="beta-20161013-protocol-changes">Protocol Changes</h3>

- The `COPY` protocol is now supported on the server side with the `COPY FROM` statement. The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) command-line tool does not yet recognize this command but it can be used with other client interfaces. [#8756](https://github.com/cockroachdb/cockroach/pull/8756)
- [`DECIMAL`](../v1.0/decimal.html) values are now encoded correctly for drivers that use the binary format. [#8319](https://github.com/cockroachdb/cockroach/pull/8319)
- [`TIMESTAMP`](../v1.0/timestamp.html), [`TIMESTAMPTZ`](../v1.0/timestamp.html) and [`DATE`](../v1.0/date.html) values can now use the binary protocol format for clients that support it. [#8590](https://github.com/cockroachdb/cockroach/pull/8590), [#8762](https://github.com/cockroachdb/cockroach/pull/8762)
- [`NULL` values](../v1.0/null-handling.html) are now sent with the correct type OID, which is required by some PostgreSQL drivers. [#9331](https://github.com/cockroachdb/cockroach/pull/9331)
- The [`CREATE TABLE`](../v1.0/create-table.html) and [`CREATE DATABASE`](../v1.0/create-database.html) statements now return the standard PostgreSQL error code when the table or database already exists. [#9235](https://github.com/cockroachdb/cockroach/pull/9235)

<h3 id="beta-20161013-command-line-interface-changes">Command-line Interface Changes</h3>

- The [`cockroach start`](../v1.0/start-a-node.html#standard-output) command now prints additional fields to `stdout`: `clusterID`, `nodeID`, and `status`, which indicates whether the node started a new cluster, joined an existing cluster for the first time, or rejoined an existing cluster. [#9066](https://github.com/cockroachdb/cockroach/pull/9066)
- The [`cockroach start`](../v1.0/start-a-node.html) command now terminates with a non-zero exit status if it was interrupted with **Ctrl+C** or a signal. [#9051](https://github.com/cockroachdb/cockroach/pull/9051)
- The [`cockroach zone set`](../v1.0/configure-replication-zones.html) command now supports the `--disable-replication` flag, which sets the desired replication factor to 1. [#9253](https://github.com/cockroachdb/cockroach/pull/9253)
- The [`cockroach gen example-data`](../v1.0/generate-cockroachdb-resources.html) command can now be used to generate SQL for example databases. [#9231](https://github.com/cockroachdb/cockroach/pull/9231), [#9475](https://github.com/cockroachdb/cockroach/pull/9475)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell now presents a new prompt when **Ctrl+C** is pressed after the user starts entering a statement. [#9704](https://github.com/cockroachdb/cockroach/pull/9704)
- When using **Ctrl+R** in the [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell to recall a previous statement from the shell history, the search is now case-insensitive. [#9704](https://github.com/cockroachdb/cockroach/pull/9704)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell now reports unterminated final statements as errors instead of ignoring them. [#8838](https://github.com/cockroachdb/cockroach/pull/8838)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell now reports when the connection to the server is lost and a new connection is opened. [#9613](https://github.com/cockroachdb/cockroach/pull/9613)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell now ignores lines that contain only whitespace (e.g., comments). [#9243](https://github.com/cockroachdb/cockroach/pull/9243)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell now prints expressions in [`EXPLAIN`](../v1.0/explain.html) and the shell history such as `E::T` or `E:::T` in the same format entered instead of using the longer `CAST` or `TYPE_ANNOTATE` syntax. [#9739](https://github.com/cockroachdb/cockroach/pull/9739)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell now stops processing statements at the first error encountered when reading from a file (non-interactively). This behavior is customizable with the new [`unset errexit`](../v1.0/use-the-built-in-sql-client.html#sql-shell-commands) shell command. [#9610](https://github.com/cockroachdb/cockroach/pull/9610)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell now checks if a statement or query is syntactically valid on the client side before it is sent to the server. This ensures that a typo or mistake during user entry does not inconveniently abort an ongoing transaction previously started interactively. This behavior is customizable with the new [`unset check_syntax`](../v1.0/use-the-built-in-sql-client.html#sql-shell-commands) shell command. [#9610](https://github.com/cockroachdb/cockroach/pull/9610)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell now works better with multi-line statements. In particular, users will find it easier to recall and edit previously entered multi-line statements. This behavior is customizable with a new command [`unset normalize_history`](../v1.0/use-the-built-in-sql-client.html#sql-shell-commands). [#9610](https://github.com/cockroachdb/cockroach/pull/9610)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell now works correctly under `kubectl` and other environments that hide the size of the terminal. [#9097](https://github.com/cockroachdb/cockroach/pull/9097)

<h3 id="beta-20161013-ui-changes">UI Changes</h3>

- The time scale selector in the UI now works more reliably. [#8573](https://github.com/cockroachdb/cockroach/pull/8573)
- Additional database and table-level details are now available. [#9621](https://github.com/cockroachdb/cockroach/pull/9621)
- Displaying graphs for a longer timescales is now much faster. [#8805](https://github.com/cockroachdb/cockroach/pull/8805)
- The default graph time scale is now chosen based on the age of the cluster. [#9340](https://github.com/cockroachdb/cockroach/pull/9340)
- Node logs are now accessible in the UI. [#8572](https://github.com/cockroachdb/cockroach/pull/8572)
- The UI can now be built with live reload support. [#8679](https://github.com/cockroachdb/cockroach/pull/8679)
- Exposed idiomatic bucketed histograms on prometheus endpoint. [#9810](https://github.com/cockroachdb/cockroach/pull/9810)
- Exposed Mutex timing metrics. [#9769](https://github.com/cockroachdb/cockroach/pull/9769)

<h3 id="beta-20161013-bug-fixes">Bug Fixes</h3>

- Fixed some panics in handling invalid SQL statements. [#9049](https://github.com/cockroachdb/cockroach/pull/9049), [#9050](https://github.com/cockroachdb/cockroach/pull/9050)
- Fixed an issue that sometimes caused transactions to restart twice in a row. [#8596](https://github.com/cockroachdb/cockroach/pull/8596)
- [`STRING`](../v1.0/string.html) literals containing non-UTF-8 data are now rejected. [#9094](https://github.com/cockroachdb/cockroach/pull/9094)
- The [`UPSERT`](../v1.0/upsert.html) statement now works correctly during online schema changes.[#9481](https://github.com/cockroachdb/cockroach/pull/9481)
- Aggregate and window functions in `GROUP BY` ordinal expressions are now rejected without crashing. [#9629](https://github.com/cockroachdb/cockroach/pull/9629)
- The unsupported `ALTER TABLE ... ALTER COLUMN ... SET TYPE ...` statement now reports an error to the client instead of crashing the server. [#8747](https://github.com/cockroachdb/cockroach/pull/8747)
- Slightly improved support for 32-bit systems. Note that 32-bit architectures remain officially unsupported. [#9491](https://github.com/cockroachdb/cockroach/pull/9491)
- The admin UI now propagates timeouts to the server to avoid dangling requests. [#8546](https://github.com/cockroachdb/cockroach/pull/8546)
- Fixed issues with duplicate column qualifications in `CREATE TABLE` statements [#9868](https://github.com/cockroachdb/cockroach/pull/9868)
- Empty statements are now handled correctly in prepared statements. [#9811](https://github.com/cockroachdb/cockroach/pull/9811)
- Fixed a Raft assertion caused by insufficient locking. [#9814](https://github.com/cockroachdb/cockroach/pull/9814)

<h3 id="beta-20161013-performance-improvements">Performance Improvements</h3>

- Tuned RocksDB settings to reduce write stalls. [#9663](https://github.com/cockroachdb/cockroach/issues/9663)
- Minor performance optimization to avoid reading an internal metadata key that will be immediately overwritten. [#9263](https://github.com/cockroachdb/cockroach/pull/9263)
- Improved concurrency to prevent certain slow operations from dramatically impacting overall performance. [#9622](https://github.com/cockroachdb/cockroach/pull/9622)
- [`DROP INDEX`](../v1.0/drop-index.html) and [`DROP TABLE`](../v1.0/drop-table.html) are now performed in chunks instead of one big transaction. [#8870](https://github.com/cockroachdb/cockroach/pull/8870), [#8885](https://github.com/cockroachdb/cockroach/pull/8885)
- The SQL query processor now tracks its memory usage. Soon it will return errors for queries that use too much memory. [#8691](https://github.com/cockroachdb/cockroach/pull/8691)
- [Aggregate functions](../v1.0/functions-and-operators.html#aggregate-functions) like `sum()` are now faster. [#8680](https://github.com/cockroachdb/cockroach/pull/8680)
- For [production deployments](../v1.0/recommended-production-settings.html), at least 10000 file descriptors are now recommended per store, with a minimum of 2000 required. [#9679](https://github.com/cockroachdb/cockroach/pull/9679)
- Improved scheduling of Raft work. [#9831](https://github.com/cockroachdb/cockroach/pull/9831)
- Replaced per-request checks with a per-batch check. [#9848](https://github.com/cockroachdb/cockroach/pull/9848)
- Micro-optimizations for writing time series data. [#9862](https://github.com/cockroachdb/cockroach/pull/9862)
- Narrowed the use of a lock during Raft log truncation. [#9840](https://github.com/cockroachdb/cockroach/pull/9840)
- Refactored a common locking pattern for better performance. [#9771](https://github.com/cockroachdb/cockroach/pull/9771)

<h3 id="beta-20161013-doc-updates">Doc Updates</h3>

- Added docs on [orchestrating CockroachDB with Docker Swarm](../v1.0/orchestrate-cockroachdb-with-docker-swarm.html). [#676](https://github.com/cockroachdb/docs/pull/676)
- Added docs on the [`cockroach gen`](../v1.0/generate-cockroachdb-resources.html) command, which can be used to generate `man` pages, a `bash` autocompletion script, and example SQL data suitable to populate test databases. [#755](https://github.com/cockroachdb/docs/pull/755)
- Updated the `cockroach sql` command docs to include more details about supported [SQL shell shortcuts](../v1.0/use-the-built-in-sql-client.html#sql-shell-shortcuts).

<h3 id="beta-20161013-contributors">Contributors</h3>

This release includes 338 merged PRs by 28 authors. We would like to
thank the following contributors from the CockroachDB community, especially first-time contributors Francis Bergin and Yan Long:

- Francis Bergin
- Daniel Theophanes
- Yan Long
- songhao
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20161027-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161027.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161027.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20161027-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- Functions that return the current time - including `now()` - now return values of type [`TIMESTAMP WITH TIME ZONE`](../v1.0/timestamp.html) instead of `TIMESTAMP`, unless called from a context that expects the latter type. [#9618](https://github.com/cockroachdb/cockroach/pull/9618)

<h3 id="beta-20161027-sql-language-changes">SQL Language Changes</h3>

- [Views](../v1.0/views.html) are now supported. Views are stored queries, represented as virtual tables, that produce a result set when requested. They can be used to hide query complexity, limit access to underlying data, or simplify the process of supporting legacy code.  
- Tables in the `pg_catalog` database can now be accessed with unqualified names if no table of the same name exists in the current database. [#9927](https://github.com/cockroachdb/cockroach/pull/9927)
- `AS OF SYSTEM TIME` queries now support the decimal format returned by `cluster_logical_timestamp()` for maximum precision. [#9934](https://github.com/cockroachdb/cockroach/pull/9934)
- The `CASCADE` option of [`DROP TABLE`](../v1.0/drop-table.html) and [`ALTER TABLE DROP COLUMN`](../v1.0/alter-table.html) now drops views that depend on the table or column; it is now an error to attempt to drop a table or column with dependent views without either using this option or dropping the views first. [#9724](https://github.com/cockroachdb/cockroach/pull/9724), [#10124](https://github.com/cockroachdb/cockroach/pull/10124)
- `SET DEFAULT_TRANSACTION_ISOLATION` is now supported, improving compatibility with `psycopg2`. [#10087](https://github.com/cockroachdb/cockroach/pull/10087)
- The `pg_catalog.pg_indexes` and `pg_catalog.pg_constraint` tables are now supported. [#9869](https://github.com/cockroachdb/cockroach/pull/9869), [#9991](https://github.com/cockroachdb/cockroach/pull/9991)
- [`EXPLAIN`](../v1.0/explain.html) can now be used with `SHOW`, `HELP`, and `ALTER TABLE ... SPLIT`. [#10013](https://github.com/cockroachdb/cockroach/pull/10013)
- The `current_schemas()` [function](../v1.0/functions-and-operators.html) is now supported, improving compatibility with ActiveRecord. [#9604](https://github.com/cockroachdb/cockroach/pull/9604)
- The [`SHOW ALL`](../v1.0/show-vars.html) statement is now supported. [#10195](https://github.com/cockroachdb/cockroach/pull/10195)
- The [`DROP INDEX`](../v1.0/drop-index.html) and [`ALTER INDEX`](../v1.0/rename-index.html) statements can now use unqualified index names. [#10091](https://github.com/cockroachdb/cockroach/pull/10091)

<h3 id="beta-20161027-command-line-interface-changes">Command-Line Interface Changes</h3>

- The `--host` flag in [client commands](../v1.0/cockroach-commands.html) such as [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) now defaults to `localhost` in both secure and insecure modes. [#10134](https://github.com/cockroachdb/cockroach/pull/10134)
- Improved error messages when a server is down or certificates are not configured correctly. [#9917](https://github.com/cockroachdb/cockroach/pull/9917)
- The `--key` flag can now be passed via the [environment variable](../v1.0/cockroach-commands.html#environment-variables) `COCKROACH_KEY`, matching other similar flags. [#10092](https://github.com/cockroachdb/cockroach/pull/10092)

<h3 id="beta-20161027-performance-improvements">Performance Improvements</h3>

- RocksDB bloom filters now use 10x less memory, with a negligible reduction in speed. [#10085](https://github.com/cockroachdb/cockroach/pull/10085)
- Old time-series data is now garbage collected. [#9959](https://github.com/cockroachdb/cockroach/pull/9959)
- Reduced overhead of the internal time-series metric system. [#9889](https://github.com/cockroachdb/cockroach/pull/9889)
- Reduced impact of schema changes on regular queries. [#9798](https://github.com/cockroachdb/cockroach/pull/9798)
- In the event of a node failure, schema changes now save their progress and can resume from their last checkpoint instead of restarting from the beginning. [#10036](https://github.com/cockroachdb/cockroach/pull/10036)
- Ranges are now split more eagerly when tables are created or data is growing rapidly. [#10232](https://github.com/cockroachdb/cockroach/pull/10232)

<h3 id="beta-20161027-bug-fixes">Bug Fixes</h3>

- Certain network- and timeout-related errors will now return the error "transaction commit result is ambiguous" when it cannot be determined whether a transaction committed or not. This fixes bugs in which statements outside of transactions could be applied twice, and other transactions may incorrectly report unique constraint violations. [#10207](https://github.com/cockroachdb/cockroach/pull/10207)
- [`SET TIME ZONE 0`](../v1.0/set-vars.html#set-time-zone) now sets the session time zone to UTC (other numbers already worked). [#9992](https://github.com/cockroachdb/cockroach/pull/9992)
- `SHOW` statements for session variables now work correctly when prepared and executed separately. [#10013](https://github.com/cockroachdb/cockroach/pull/10013)
- Columns that are a part of the primary key can now be renamed. [#10018](https://github.com/cockroachdb/cockroach/pull/10018)
- Fixed a panic during transaction rollback. [#9961](https://github.com/cockroachdb/cockroach/pull/9961)
- Float comparisons involving `NaN` are now correct in all cases. [#10112](https://github.com/cockroachdb/cockroach/pull/10112)
- Clock offset monitoring is now more sensitive. [#10185](https://github.com/cockroachdb/cockroach/pull/10185)
- The rebalancer is now better able to avoid placing a replica on a store that has previously had a corrupted replica of the same range. [#10141](https://github.com/cockroachdb/cockroach/pull/10141)
- More complex expressions involving window functions are now supported. [#10186](https://github.com/cockroachdb/cockroach/pull/10186)
- Fixed a deadlock that could occur when using the Prometheus metrics endpoint. [#10228](https://github.com/cockroachdb/cockroach/pull/10228)

<h3 id="beta-20161027-contributors">Contributors</h3>

This release includes 182 merged PRs by 24 authors. We would like to thank the following contributors from the CockroachDB, including first-time contributor Haines Chan.

- Haines Chan
- songhao
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20161103-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161103.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161103.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20161103-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- Users (other than `root`) must now be created with the `CREATE USER` statement or `cockroach user set` command before they can be used for TLS certificate- or password-based authentication.  [#9794](https://github.com/cockroachdb/cockroach/pull/9794)
- The `ambiguous result` error message introduced in `beta-20161027` is now simply `result is ambiguous` since it may be returned outside of transactions. [#10279](https://github.com/cockroachdb/cockroach/pull/10279)

<h3 id="beta-20161103-sql-language-changes">SQL Language Changes</h3>

- Password-based authentication is now supported. Clients can authenticate with either a TLS certificate or a password. Documentation coming soon.[#9794](https://github.com/cockroachdb/cockroach/pull/9794)
- The `SHOW USERS` statement is now supported. [#10088](https://github.com/cockroachdb/cockroach/pull/10088)
- The `pg_catalog.pg_type`, `pg_catalog.pg_database`, `pg_catalog.pg_views`, `pg_catalog.pg_proc`, and `pg_catalog.pg_am` tables are now supported. [#10209](https://github.com/cockroachdb/cockroach/pull/10209), [#10284](https://github.com/cockroachdb/cockroach/pull/10284), [#10276](https://github.com/cockroachdb/cockroach/pull/10276), [#10217](https://github.com/cockroachdb/cockroach/pull/10217), [#10363](https://github.com/cockroachdb/cockroach/pull/10363)
- The `information_schema.statistics` and `information_schema.views` tables are now supported. [#10220](https://github.com/cockroachdb/cockroach/pull/10220), [#10288](https://github.com/cockroachdb/cockroach/pull/10288)
- [`SHOW TABLES`](../v1.0/show-tables.html) now adds a `(dropped)` suffix to tables that are being dropped. [#10063](https://github.com/cockroachdb/cockroach/pull/10063)
- [`SHOW CREATE VIEW`](../v1.0/show-create-view.html) now only requires permissions on the view, not the underlying tables. [#10270](https://github.com/cockroachdb/cockroach/pull/10270)

<h3 id="beta-20161103-command-line-interface-changes">Command-Line Interface Changes</h3>

- When entering a transaction in the [built-in sql shell](../v1.0/use-the-built-in-sql-client.html), the statements are not sent to the server until there is either a `COMMIT`, `ROLLBACK`, or two blank lines. This minimizes the lifetime of the transaction and therefore the risk of conflicts. [#10187](https://github.com/cockroachdb/cockroach/pull/10187)

<h3 id="beta-20161103-performance-improvements">Performance Improvements</h3>

- Queries that span multiple ranges are now executed across those ranges in parallel. [#9197](https://github.com/cockroachdb/cockroach/pull/9197)
- Time series data (used in the admin UI) is now loaded in parallel. [#10250](https://github.com/cockroachdb/cockroach/pull/10250)
- Rebalancing now reaches an equilibrium faster. [#10330](https://github.com/cockroachdb/cockroach/pull/10330)

<h3 id="beta-20161103-bug-fixes">Bug Fixes</h3>

- Memory usage of SQL queries is now monitored, and queries that use too much will fail rather than exhaust the server's memory. [#9259](https://github.com/cockroachdb/cockroach/pull/9259)
- Fixed a problem with snapshot error handling that could cause the cluster to be unable to make progress after node failure.
- Computing the `log()` of a very large number no longer causes the server to hang. [#10221](https://github.com/cockroachdb/cockroach/pull/10221)
- Decimal numbers are now parsed correctly in `AS OF SYSTEM TIME` queries. [#10242](https://github.com/cockroachdb/cockroach/pull/10242)
- `concat_ws()` with no arguments no longer crashes the server. [#10309](https://github.com/cockroachdb/cockroach/pull/10309)
- Fixed a bug when a command was executed after its client had disconnected. [#10279](https://github.com/cockroachdb/cockroach/pull/10279)

<h3 id="beta-20161103-doc-updates">Doc Updates</h3>

- Clarified and expanded the [`transactions`](../v1.0/transactions.html) overview documentation, and completed docs on transaction-specific statements: [#672](https://github.com/cockroachdb/docs/pull/672)
    - [`BEGIN`](../v1.0/begin-transaction.html)
    - [`COMMIT`](../v1.0/commit-transaction.html)
    - [`SET TRANSACTION`](../v1.0/set-transaction.html)
    - [`SAVEPOINT cockroach_restart`](../v1.0/savepoint.html)
    - [`RELEASE SAVEPOINT cockroach_restart`](../v1.0/release-savepoint.html)
    - [`ROLLBACK`](../v1.0/rollback-transaction.html)
    - [`SHOW`](../v1.0/show-vars.html)
- Added language-specific examples for [`INSERT` statements with `RETURNING`](../v1.0/insert.html#insert-and-return-values). [#813](https://github.com/cockroachdb/docs/pull/813)
- Updated the [SQL Feature Support](../v1.0/sql-feature-support.html) page to reflect support for [views](../v1.0/views.html) (SQL standard) and [interleaved tables](../v1.0/interleave-in-parent.html) (CockroachDB extensions).

<h3 id="beta-20161103-contributors">Contributors</h3>

This release includes 68 merged PRs by 24 authors. We would like to thank the following contributors from the CockroachDB community, including first-time contributors Johan Brandhorst and MaBo.

- Johan Brandhorst
- MaBo
- Yan Long
- songhao
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
Data corruption has been observed when upgrading to this release from prior versions, so it has been withdrawn.
{{site.data.alerts.end}}

<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20161201-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161201.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161201.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20161201-upgrade-notes">Upgrade Notes</h3>

Due to changes in the on-disk format of internal range leases, this release cannot be run concurrently with any prior release. All servers running older versions must be stopped before starting any node with this version. [#10420](https://github.com/cockroachdb/cockroach/pull/10420)

We realize that "stop the world" upgrades are overly interruptive and are actively working on infrastructure improvements to drastically reduce the need for such upgrades in the future.

<h3 id="beta-20161201-build-changes">Build Changes</h3>

- CockroachDB now *vendors* its dependencies, so building from source no longer interferes with other project in the `$GOPATH`. [#9900](https://github.com/cockroachdb/cockroach/pull/9900)

<h3 id="beta-20161201-sql-language-changes">SQL Language Changes</h3>

- Adding a [`FOREIGN KEY`](../v1.0/foreign-key.html) constraint now automatically creates necessary indexes. [#9572](https://github.com/cockroachdb/cockroach/pull/9572)
- The `pg_catalog.pg_roles`, `pg_catalog.pg_description`, `pg_catalog.pg_settings`, and `pg_catalog.pg_index` tables are now supported. [#10377](https://github.com/cockroachdb/cockroach/pull/10377) [#10381](https://github.com/cockroachdb/cockroach/pull/10381) [#10293](https://github.com/cockroachdb/cockroach/pull/10293) [#10548](https://github.com/cockroachdb/cockroach/pull/10548) [#10592](https://github.com/cockroachdb/cockroach/pull/10592)
- The `pg_catalog.pg_depend` table is now partially supported (just enough to support `pgjdbc`). [#10696](https://github.com/cockroachdb/cockroach/pull/10696)
- `pg_catalog` tables now report databases as belonging to PostgreSQL-compatible namespaces. This is for compatibility only; CockroachDB does not have a notion of namespaces. [#11603](https://github.com/cockroachdb/cockroach/pull/11603)
- The `pg_catalog.pg_get_expr` and `pg_catalog.pg_generate_series` functions are now supported. [#10952](https://github.com/cockroachdb/cockroach/pull/10952) [#11214](https://github.com/cockroachdb/cockroach/pull/11214)
- The `conkey` and `confkey` columns of the `pg_catalog.pg_constraint` table now return real integer arrays. [#10584](https://github.com/cockroachdb/cockroach/pull/10584)
- New [functions](../v1.0/functions-and-operators.html) `from_ip()` and `to_ip()` convert between binary and textual IP address formats. [#10349](https://github.com/cockroachdb/cockroach/pull/10349)
- Tuple types can now be returned by queries. [#10380](https://github.com/cockroachdb/cockroach/pull/10380)
- The SQL standard interval format `Y-M-D` is now supported. [#10499](https://github.com/cockroachdb/cockroach/pull/10499)
- The `array_length`, `array_upper`, and `array_lower` [functions](../v1.0/functions-and-operators.html) are now available. [#10565](https://github.com/cockroachdb/cockroach/pull/10565)
- The `to_uuid` and `from_uuid` [functions](../v1.0/functions-and-operators.html) are now available. [#10541](https://github.com/cockroachdb/cockroach/pull/10541)
- The `pow()` and `div()` [functions](../v1.0/functions-and-operators.html) now work when both arguments are integers. [#10538](https://github.com/cockroachdb/cockroach/pull/10538)
- The `ARRAY[]` constructor syntax is now supported. [#10585](https://github.com/cockroachdb/cockroach/pull/10585)
- The `COLLATE` operator is now supported. Collation support is still incomplete and will be improved in upcoming releases. [#10605](https://github.com/cockroachdb/cockroach/pull/10605)
- The `current_schema` [function](../v1.0/functions-and-operators.html) is now supported. [#10707](https://github.com/cockroachdb/cockroach/pull/10707)
- The `SET APPLICATION_NAME` statement is now supported. This is a write-only variable which is used by some frameworks but has no effect. [#10725](https://github.com/cockroachdb/cockroach/pull/10725)
- The [`CREATE DATABASE`](../v1.0/create-database.html) statement now accepts the options `TEMPLATE`, `LC_COLLATE`, and `LC_CTYPE` for compatibility with PostgreSQL, although the values available for these options are limited. [#10775](https://github.com/cockroachdb/cockroach/pull/10775)
- The [`SELECT`](../v1.0/select.html) statement now supports the `WITH ORDINALITY` modifier to generate row numbers. [#10558](https://github.com/cockroachdb/cockroach/pull/10558)

<h3 id="beta-20161201-command-line-interface-changes">Command-Line Interface Changes</h3>

- Temporary directories are no longer created automatically for logging. Commands other than `cockroach start` log to `stderr` if no `--log-dir` flag is given, and `cockroach start` writes to the directory of the first store. Various combinations of `--log-dir`, `--logtostderr`, and `--alsologtostderr` now work in more sensible ways. [#10675](https://github.com/cockroachdb/cockroach/pull/10675) [#10926](https://github.com/cockroachdb/cockroach/pull/10926) [#10962](https://github.com/cockroachdb/cockroach/pull/10962)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) prompt now indicates the status of the current transaction (if any). [#10866](https://github.com/cockroachdb/cockroach/pull/10866)
- The `--password` flag for the [`cockroach user set`](../v1.0/create-and-manage-users.html) command no longer accepts the new password as a command-line argument; instead this flag is a boolean to determine whether a password should be created for the user. The password is always read from `stdin`. [#10680](https://github.com/cockroachdb/cockroach/pull/10680)
- The [`cockroach user set`](../v1.0/create-and-manage-users.html) command no longer prompts for passwords in insecure mode unless `--password` is given. [#10547](https://github.com/cockroachdb/cockroach/pull/10547)
- The `cockroach debug compact` command now always rewrites all data, allowing it to pick up configuration changes. [#10532](https://github.com/cockroachdb/cockroach/pull/10532)

<h3 id="beta-20161201-admin-ui-changes">Admin UI Changes</h3>

- The design of the navigation elements has been updated. [#10611](https://github.com/cockroachdb/cockroach/pull/10611)
- The design of the Database tab has been updated. [#10552](https://github.com/cockroachdb/cockroach/pull/10552)
- Syntax highlighting is now used when displaying `CREATE TABLE` statements. [#10579](https://github.com/cockroachdb/cockroach/pull/10579)
- The UI no longer attempts to display information about the virtual databases `information_schema` and `pg_catalog`. [#10920](https://github.com/cockroachdb/cockroach/pull/10920)
- Metrics for the fraction of available and fully-replicated ranges are now computed more accurately. [#11213](https://github.com/cockroachdb/cockroach/pull/11213)

<h3 id="beta-20161201-performance-improvements">Performance Improvements</h3>

- Increased the speed of some mathematical operations (Log, Pow) on [`DECIMAL`](../v1.0/decimal.html) values. [#11669](https://github.com/cockroachdb/cockroach/pull/11669)
- Reduced rebalancer thrashing by dynamically adjusting how often store capacities are gossiped. <a href="https://github.com/cockroachdb/cockroach/pull/11662" data-proofer-ignore>#11662</a>
- Adding new replicas is now prioritized over removing dead ones. [#10492](https://github.com/cockroachdb/cockroach/pull/10492) [#10683](https://github.com/cockroachdb/cockroach/pull/10683)
- Replicating ranges to a new node is now more reliably performed back-to-back. [#10440](https://github.com/cockroachdb/cockroach/pull/10440) [#10749](https://github.com/cockroachdb/cockroach/pull/10749)
- The rebalancing system is now less prone to thrashing. [#10761](https://github.com/cockroachdb/cockroach/pull/10761)
- Raft log truncation is now aware of pending snapshots. [#10482](https://github.com/cockroachdb/cockroach/pull/10482)
- Raft snapshots are now applied more efficiently. [#10931](https://github.com/cockroachdb/cockroach/pull/10931)
- Raft now sends log entries in smaller batches. [#10929](https://github.com/cockroachdb/cockroach/pull/10929)
- Replica garbage collection is now triggered more reliably by replication changes. [#10500](https://github.com/cockroachdb/cockroach/pull/10500)
- Old replicas that are blocking other operations are now prioritized for garbage collection. [#10426](https://github.com/cockroachdb/cockroach/pull/10426)
- Small clusters now run their replica scanners more frequently by default. [#10433](https://github.com/cockroachdb/cockroach/pull/10433)
- Reduced contention in the command queue for multi-range operations. [#10470](https://github.com/cockroachdb/cockroach/pull/10470)
- Operations that have already expired are no longer added to the command queue. [#10487](https://github.com/cockroachdb/cockroach/pull/10487)
- Reduced allocations for SQL row data. [#10534](https://github.com/cockroachdb/cockroach/pull/10534)
- Reduced memory allocations when encoding dates and times. [#10531](https://github.com/cockroachdb/cockroach/pull/10531)
- Parsing hexadecimal literals using the `x''` syntax is now more efficient. [#10660](https://github.com/cockroachdb/cockroach/pull/10660)
- Time series pruning is now more efficient. [#10682](https://github.com/cockroachdb/cockroach/pull/10682)
- Commands that have been canceled by clients no longer accumulate in the internal command queue. [#10772](https://github.com/cockroachdb/cockroach/pull/10772)
- When a command that has been retried on multiple replicas succeeds on any of them, any in-flight attempts on the other replicas is canceled. [#10970](https://github.com/cockroachdb/cockroach/pull/10970)
- The fast-path for local "RPCs" now uses goroutines to avoid blocking the caller. [#11196](https://github.com/cockroachdb/cockroach/pull/11196)

<h3 id="beta-20161201-bug-fixes">Bug Fixes</h3>

- Fixed a bug that caused over-aggressive Raft log truncation, which in turn led to an excessive number of Raft initiated snapshots. [#11720](https://github.com/cockroachdb/cockroach/pull/11720)
- Fixed a bug that caused data corruption when upgrading from `beta-20161103` to `beta-20161110`. [#10681](https://github.com/cockroachdb/cockroach/pull/10681) [#10724](https://github.com/cockroachdb/cockroach/pull/10724)
- A node that is stopped and restarted quickly can no longer produce inconsistent results. [#10420](https://github.com/cockroachdb/cockroach/pull/10420)
- Fixed bugs that prevented communication with a node that was previously down. [#10642](https://github.com/cockroachdb/cockroach/pull/10642) [#10652](https://github.com/cockroachdb/cockroach/pull/10652)
- It is now possible for a new node to start up using the same network address as a node that had previously existed. [#10544](https://github.com/cockroachdb/cockroach/pull/10544) [#10699](https://github.com/cockroachdb/cockroach/pull/10699)
- Replication snapshots now release their resources earlier, preventing deadlocks. [#10491](https://github.com/cockroachdb/cockroach/pull/10491)
- Fixed a bug with time series garbage collection when the time series data spans multiple ranges. [#10400](https://github.com/cockroachdb/cockroach/pull/10400)
- Fixed several bugs with very large [`DECIMAL`](../v1.0/decimal.html) values or very small fractions. [#10446](https://github.com/cockroachdb/cockroach/pull/10446) [#10559](https://github.com/cockroachdb/cockroach/pull/10559) [#10570](https://github.com/cockroachdb/cockroach/pull/10570) [#10934](https://github.com/cockroachdb/cockroach/pull/10934)
- The `pow()` [function](../v1.0/functions-and-operators.html) now returns an error when its arguments are too large. [#10525](https://github.com/cockroachdb/cockroach/pull/10525)
- Fixed a crash when the number of placeholders in a query doesn't match the number of arguments. [#10474](https://github.com/cockroachdb/cockroach/pull/10474)
- Improved error handling when a SQL [transaction](../v1.0/transactions.html) exceeds an internal deadline. [#9906](https://github.com/cockroachdb/cockroach/pull/9906)
- Fixed a panic in raft leadership transfers. [#10530](https://github.com/cockroachdb/cockroach/pull/10530)
- Fixed a leak in [`CREATE TABLE AS`](../v1.0/create-table-as.html) and [`CREATE VIEW`](../v1.0/create-view.html). [#10527](https://github.com/cockroachdb/cockroach/pull/10527)
- Fixed a panic "range lookup of meta key found only non-matching ranges". [#10583](https://github.com/cockroachdb/cockroach/pull/10583)
- The consistency checker now runs to completion instead of canceling itself before finishing. [#10625](https://github.com/cockroachdb/cockroach/pull/10625)
- Internal retries no longer cause transaction replay errors. [#10639](https://github.com/cockroachdb/cockroach/pull/10639)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) command no longer crashes when given a URL without a username. [#10862](https://github.com/cockroachdb/cockroach/pull/10862)
- Fixed a deadlock in `RemoveReplica`. [#10875](https://github.com/cockroachdb/cockroach/pull/10875)
- `result is ambiguous` errors are now returned in more situations. [#10703](https://github.com/cockroachdb/cockroach/pull/10703) [#11211](https://github.com/cockroachdb/cockroach/pull/11211)
- The `ALTER TABLE SPLIT AT` command will now retry internally instead of returning errors about conflicting updates. [#10728](https://github.com/cockroachdb/cockroach/pull/10728)
- Fixed a panic that could occur when a node is restarted after an unclean shutdown. [#10690](https://github.com/cockroachdb/cockroach/pull/10690)
- Fixed a panic when replicas are removed and re-added rapidly. [#11699](https://github.com/cockroachdb/cockroach/pull/11699)
- The `sign()` [function](../v1.0/functions-and-operators.html) with a [`DECIMAL`](../v1.0/decimal.html) argument now returns a decimal rather than a float. [#10954](https://github.com/cockroachdb/cockroach/pull/10954)
- Fixed a panic in the raft tick loop. [#11622](https://github.com/cockroachdb/cockroach/pull/11622)
- The `LIMIT` operator now works correctly in [`INSERT ... SELECT`](../v1.0/insert.html). [#11632](https://github.com/cockroachdb/cockroach/pull/11632)

<h3 id="beta-20161201-doc-updates">Doc Updates</h3>

- Expanded the [cloud deployment](../v1.0/cloud-deployment.html) documentation to cover Microsoft Azure and secure deployment on all featured platforms:
    - [AWS](../v1.0/deploy-cockroachdb-on-aws.html)
    - [Azure](../v1.0/deploy-cockroachdb-on-microsoft-azure.html)
    - [Digital Ocean](../v1.0/deploy-cockroachdb-on-digital-ocean.html)
    - [GCE](../v1.0/deploy-cockroachdb-on-google-cloud-platform.html)
- Added interactive asciicasts to getting started tutorials.
- Added tutorials that demonstrate core features of CockroachDB: [#834](https://github.com/cockroachdb/docs/pull/834) [#878](https://github.com/cockroachdb/docs/pull/878) [#899](https://github.com/cockroachdb/docs/pull/899)
    - [Data Replication](../v1.0/demo-data-replication.html)
    - [Fault Tolerance & Recovery](../v1.0/demo-fault-tolerance-and-recovery.html)
    - [Automatic Rebalancing](../v1.0/demo-automatic-rebalancing.html)
- Added documentation on user management and password-based authentication: [#838](https://github.com/cockroachdb/docs/pull/838)
    - [`CREATE USER`](../v1.0/create-user.html) statement
    - [`cockroach user`](../v1.0/create-and-manage-users.html) command
- Added documentation on the [`information_schema`](../v1.0/information-schema.html) built-in database, which provides introspection into database tables, columns, indexes, and views, and which is required for ORM compatibility. [#859](https://github.com/cockroachdb/docs/pull/859)
- Updated [`SELECT`](../v1.0/select.html) statement documentation to cover using "index hints". [#894](https://github.com/cockroachdb/docs/pull/894)
- Updated [`FOREIGN KEY`](../v1.0/foreign-key.html) constraint documentation to clarify that creating a table with a foreign key now automatically creates an index for you. [#895](https://github.com/cockroachdb/docs/pull/895)
- Updated `RENAME` statement documentation to clarify that you cannot rename a [database](../v1.0/rename-database.html), [table](../v1.0/rename-table.html), [column](../v1.0/rename-column.html), or [index](../v1.0/rename-index.html) reference by a [view](../v1.0/views.html). [#873](https://github.com/cockroachdb/docs/pull/873)
- Updated the [`cockroach start`](../v1.0/start-a-node.html) command documentation to cover the `--max-sql-memory` flag. [#868](https://github.com/cockroachdb/docs/pull/868)
- Updated the [`cockroach zone`](../v1.0/configure-replication-zones.html) command documentation to reflect the correct YAML structure. [#902](https://github.com/cockroachdb/docs/pull/902)
- Fixed the Rust code samples on [Build an App](../v1.0/build-a-rust-app-with-cockroachdb.html). [#863](https://github.com/cockroachdb/docs/pull/863)

<h3 id="beta-20161201-contributors">Contributors</h3>

This release includes 292 merged PRs by 30 authors. We would like to thank the following contributors from the CockroachDB community, including first-time contributors Christian Gati, Dustin Hiatt, kiran, and Nathan Johnson.

- Christian Gati
- Dustin Hiatt
- Haines Chan
- kiran
- Nathan Johnson
- songhao
- yznming
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20161208-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161208.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161208.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20161208-sql-language-changes">SQL Language Changes</h3>

- The `pg_catalog` and [`information_schema`](../v1.0/information-schema.html) databases now include information about the current database only, unless the user is `root`. [#11694](https://github.com/cockroachdb/cockroach/pull/11694)
- The `pg_catalog.pg_range` table is now supported. [#11725](https://github.com/cockroachdb/cockroach/pull/11725)
- The `pg_get_userbyid` function is now supported. [#12162](https://github.com/cockroachdb/cockroach/pull/12162)
- The [`SHOW TABLES`](../v1.0/show-tables.html), [`SHOW DATABASES`](../v1.0/show-databases.html), [`SHOW GRANTS`](../v1.0/show-grants.html) and [`SHOW COLUMNS`](../v1.0/show-columns.html) statements are now aliases for queries on the [`information_schema`](../v1.0/information-schema.html) database. [#10196](https://github.com/cockroachdb/cockroach/pull/10196)
- Empty passwords are no longer allowed in the [`CREATE USER WITH PASSWORD`](../v1.0/create-user.html) statement. [#11781](https://github.com/cockroachdb/cockroach/pull/11781)

<h3 id="beta-20161208-command-line-interface-changes">Command-Line Interface Changes</h3>

- Log file names have changed. The new format is `cockroach.kenabook.kena.2016-11-28T20_00_35Z.009524.ERROR.log`. [#11666](https://github.com/cockroachdb/cockroach/pull/11666)

<h3 id="beta-20161208-admin-ui-changes">Admin UI Changes</h3>

- On the **Cluster Overview** page, added a **Summary** section showing total nodes and capacity used, and updated the overall navigation and style. [#11696](https://github.com/cockroachdb/cockroach/pull/11696) [#11754](https://github.com/cockroachdb/cockroach/pull/11754)
- Several "allocator" metrics have been replaced with a new "underreplicated range" metric. [#11733](https://github.com/cockroachdb/cockroach/pull/11733) [#11983](https://github.com/cockroachdb/cockroach/pull/11983)
- The "ranges available" metric has been replaced with a "ranges unavailable" metric, which is computed differently. [#11760](https://github.com/cockroachdb/cockroach/pull/11760)
- New metrics have been added for the replication queue and replica GC queue. [#11753](https://github.com/cockroachdb/cockroach/pull/11753) [#11785](https://github.com/cockroachdb/cockroach/pull/11785)
- New metrics have been added for RPCs. [#11711](https://github.com/cockroachdb/cockroach/pull/11711)
- New metrics have been added to track commands that have been stuck for a long time. [#12106](https://github.com/cockroachdb/cockroach/pull/12106)

<h3 id="beta-20161208-performance-improvements">Performance Improvements</h3>

- Range leases are now balanced across the nodes in a cluster. [#11757](https://github.com/cockroachdb/cockroach/pull/11757)
- Raft heartbeats are once again coalesced into one message per pair of nodes instead of per range. [#11757](https://github.com/cockroachdb/cockroach/pull/11757)
- Persisting the applied index is now faster. [#9993](https://github.com/cockroachdb/cockroach/pull/9993)
- The replication queue no longer tries to reprocess the same range repeatedly. [#11982](https://github.com/cockroachdb/cockroach/pull/11982)
- Limited frequent reprocessing of ranges for time series maintenance and consistency checks. [#10665](https://github.com/cockroachdb/cockroach/pull/10665)
- The time series maintenance queue no longer sends commands when it has nothing to do. [#11762](https://github.com/cockroachdb/cockroach/pull/11762)
- The `pow()` [function](../v1.0/functions-and-operators.html) is now faster when small numbers are raised to very large powers. [#11738](https://github.com/cockroachdb/cockroach/pull/11738)
- `JOIN` queries now only scan the columns they need. [#11736](https://github.com/cockroachdb/cockroach/pull/11736)
- Micro-optimized logging and removed some noisy log events. [#11778](https://github.com/cockroachdb/cockroach/pull/11778)

<h3 id="beta-20161208-bug-fixes">Bug Fixes</h3>

- Fixed a panic when sending a raft message fails. [#11985](https://github.com/cockroachdb/cockroach/pull/11985)
- Fixed a memory spike that could occur during asymmetric partitions. [#12100](https://github.com/cockroachdb/cockroach/pull/12100)
- [`DROP DATABASE`](../v1.0/drop-database.html) now works when foreign key constraints are present. [#12036](https://github.com/cockroachdb/cockroach/pull/12036)
- [`DROP DATABASE`](../v1.0/drop-database.html) no longer hangs when subqueries have been used. [#11730](https://github.com/cockroachdb/cockroach/pull/11730)
- Requests no longer get stuck forever after a timeout. [#12000](https://github.com/cockroachdb/cockroach/pull/12000)
- Comparisons of SQL tuples now work for all types. [#10475](https://github.com/cockroachdb/cockroach/pull/10475)

<h3 id="beta-20161208-contributors">Contributors</h3>

This release includes 101 merged PRs by 19 authors. We would like to thank the following contributors from the CockroachDB community.

- songhao
- yznming
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20161215-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161215.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161215.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20161215-general-changes">General Changes</h3>

- CockroachDB now uses RocksDB version 4.11.2. [#9616](https://github.com/cockroachdb/cockroach/pull/9616)

<h3 id="beta-20161215-sql-language-changes">SQL Language Changes</h3>

- Additional support for standard database introspection required by popular ORMs. These features apply to built-in tables only; eventually, they will be made available for user-generated tables as well.
  - The `array_agg` [aggregate function](../v1.0/functions-and-operators.html#aggregate-functions) is now supported for ints and strings. [#12186](https://github.com/cockroachdb/cockroach/pull/12186)
  - The `ANY`, `SOME` and `ALL` array operators are now supported. [#12102](https://github.com/cockroachdb/cockroach/pull/12102)
  - `GROUP BY` can now be used with columns of type `ARRAY`. [#12198](https://github.com/cockroachdb/cockroach/pull/12198)
- The `SET` command now recognizes the `search_path`, `client_encoding`, `standard_conforming_strings`, and `client_min_messages` variables for compatibility with PostgreSQL. Setting these variables currently has no effect. [#12149](https://github.com/cockroachdb/cockroach/pull/12149)
- The `SHOW server_version` command now returns the version of PostgreSQL that CockroachDB most closely resembles. [#12149](https://github.com/cockroachdb/cockroach/pull/12149)

<h3 id="beta-20161215-admin-ui-changes">Admin UI Changes</h3>

- Aggregated rates are now computed correctly. [#12200](https://github.com/cockroachdb/cockroach/pull/12200)
- Various stylistic improvements. [#12118](https://github.com/cockroachdb/cockroach/pull/12118) [#12152](https://github.com/cockroachdb/cockroach/pull/12152)
- Metrics have been added for lease-related operations. [#12205](https://github.com/cockroachdb/cockroach/pull/12205)

<h3 id="beta-20161215-performance-improvements">Performance Improvements</h3>

- Raft snapshots are now applied one at a time. [#12192](https://github.com/cockroachdb/cockroach/pull/12192)

<h3 id="beta-20161215-bug-fixes">Bug Fixes</h3>

- The repair system now detects unresponsive nodes more accurately in the event of asymmetric partitions. [#12178](https://github.com/cockroachdb/cockroach/pull/12178)
- String arrays are now quoted correctly on the wire. [#12268](https://github.com/cockroachdb/cockroach/pull/12268)

<h3 id="beta-20161215-doc-updates">Doc Updates</h3>

- Each SQL [constraint](../v1.0/constraints.html) now has a dedicated page of documentation. [#901](https://github.com/cockroachdb/docs/pull/901)
- The [`cockroach zone`](../v1.0/configure-replication-zones.html) documentation now offers minimum and maximum recommendations for the `ttlseconds` setting, which defines the number of seconds overwritten values are retained before garbage collection. [#912](https://github.com/cockroachdb/docs/pull/912)

<h3 id="beta-20161215-contributors">Contributors</h3>

This release includes 62 merged PRs by 18 authors.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20170105-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170105.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170105.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20170105-general-changes">General Changes</h3>

- CockroachDB now uses a more recent version of GRPC. [#9697](https://github.com/cockroachdb/cockroach/pull/9697)

<h3 id="beta-20170105-sql-language-changes">SQL Language Changes</h3>

- `FILTER` clauses for [aggregate functions](../v1.0/functions-and-operators.html#aggregate-functions) are now supported. See the [`SELECT`](../v1.0/select.html#filter-columns-fed-into-aggregate-functions) documentation for examples. [#10146](https://github.com/cockroachdb/cockroach/pull/10146)
- Columns can now be created with collated string types, although these columns cannot yet be indexed or part of the primary key. [#12294](https://github.com/cockroachdb/cockroach/pull/12294)
- `INTERVAL` values can now be [added](../v1.0/functions-and-operators.html#operators) to `DATE` values. [#12428](https://github.com/cockroachdb/cockroach/pull/12428)
- `TIMESTAMP` values can now be [compared](../v1.0/functions-and-operators.html#operators) to `DATE` values. [#12431](https://github.com/cockroachdb/cockroach/pull/12431)
- `DATE` literals in [views](../v1.0/views.html) now work correctly. [#12450](https://github.com/cockroachdb/cockroach/pull/12450)
- Parsing of [`INTERVAL`](../v1.0/interval.html) values is now more consistent with PostgreSQL. [#12559](https://github.com/cockroachdb/cockroach/pull/12559) [#12566](https://github.com/cockroachdb/cockroach/pull/12566)
- `ORDER BY` now works correctly when sorting by the result of an [aggregate function](../v1.0/functions-and-operators.html#aggregate-functions). [#12185](https://github.com/cockroachdb/cockroach/pull/12185)
- `ORDER BY` now returns an error in more cases when its arguments are ambiguous. [#12255](https://github.com/cockroachdb/cockroach/pull/12255)
- The `experimental_unique_bytes()` function has been removed. [#12228](https://github.com/cockroachdb/cockroach/pull/12228)
- The `extract()` [function](../v1.0/functions-and-operators.html) now supports `DATE` values. As a consequence, `extract()` no longer supports `STRING` values, which must now be explicitly cast to `TIMESTAMP` or `DATE`. [#12479](https://github.com/cockroachdb/cockroach/pull/12479)
- The `pg_indexes.pg_indexes` now includes the `oid` column. [#12359](https://github.com/cockroachdb/cockroach/pull/12359)
- The `pg_catalog.pg_get_indexdef` [function](../v1.0/functions-and-operators.html) is now supported. [#12359](https://github.com/cockroachdb/cockroach/pull/12359)
- The `array_agg()` [function](../v1.0/functions-and-operators.html) now handles `NULL` values correctly. [#12534](https://github.com/cockroachdb/cockroach/pull/12534)

<h3 id="beta-20170105-admin-ui-changes">Admin UI Changes</h3>

- Metrics for the number of live nodes and the number of Raft commands are now reported. [#12296](https://github.com/cockroachdb/cockroach/pull/12296)
- Improved the time selector. [#12360](https://github.com/cockroachdb/cockroach/pull/12360)
- Added new summary statistics. [#12486](https://github.com/cockroachdb/cockroach/pull/12486)
- Graph axes have been improved. [#12427](https://github.com/cockroachdb/cockroach/pull/12427)
- The event list has been updated. [#12638](https://github.com/cockroachdb/cockroach/pull/12638)

<h3 id="beta-20170105-performance-improvements">Performance Improvements</h3>

- When a node stops responding to heartbeats, non-heartbeat
Raft traffic to that node is suspended until it becomes responsive again. [#12631](https://github.com/cockroachdb/cockroach/pull/12631)
- Improved logic for transferring Raft leadership to coincide with the lease holder. [#12323](https://github.com/cockroachdb/cockroach/pull/12323)
- Fixed a thundering herd problem after a node goes down. [#12352](https://github.com/cockroachdb/cockroach/pull/12352)
- Prevented unnecessary retries of Raft commands. [#12487](https://github.com/cockroachdb/cockroach/pull/12487)
- Improved lease rebalancing in deployments with multiple stores per node. [#12565](https://github.com/cockroachdb/cockroach/pull/12565)
- Reduced the number of `cgo` calls made to RocksDB. [#12343](https://github.com/cockroachdb/cockroach/pull/12343)

<h3 id="beta-20170105-bug-fixes">Bug Fixes</h3>

- Commands are now canceled correctly if the replica tracking them is removed while they are pending. [#12313](https://github.com/cockroachdb/cockroach/pull/12313)
- Raft groups are always initialized when handling messages. [#12465](https://github.com/cockroachdb/cockroach/pull/12465)
- Improved error handling for invalid UTF-8 strings. [#12194](https://github.com/cockroachdb/cockroach/pull/12194)
- Fixed several bugs in `FULL` and `RIGHT OUTER JOIN`. [#12364](https://github.com/cockroachdb/cockroach/pull/12364)
- Fixed a regression in `OUTER JOIN` operations with predicates. [#12350](https://github.com/cockroachdb/cockroach/pull/12350)
- Fixed type checking in `window` definitions. [#12483](https://github.com/cockroachdb/cockroach/pull/12483)
- Fixed a bug when adding columns with families to tables created by certain older beta versions of CockroachDB. [#12475](https://github.com/cockroachdb/cockroach/pull/12475)
- It is now possible to disable logging output to files with `--log-dir=""`. [#12662](https://github.com/cockroachdb/cockroach/pull/12662)
- When logging to both `stderr` and files, all desired logging output is now properly emitted to files, not only to `stderr`. [#12662](https://github.com/cockroachdb/cockroach/pull/12662)

<h3 id="beta-20170105-internal-changes">Internal Changes</h3>

- A framework has been introduced for migrating existing clusters to new definitions for internal tables. [#11658](https://github.com/cockroachdb/cockroach/pull/11658)

<h3 id="beta-20170105-doc-updates">Doc Updates</h3>

- Added a tutorial and sample configs for [Monitoring CockroachDB with Prometheus, Grafana, and Alertmanager](../v1.0/monitor-cockroachdb-with-prometheus.html) [#928](https://github.com/cockroachdb/docs/pull/928), [#12288](https://github.com/cockroachdb/cockroach/pull/12288)
- Updated the [Orchestrate CockroachDB with Kubernetes](../v1.0/orchestrate-cockroachdb-with-kubernetes.html) tutorial and sample configs for Kubernetes 1.5 [#940](https://github.com/cockroachdb/docs/pull/940) [#12536](https://github.com/cockroachdb/cockroach/pull/12536)
- Descriptions have been added to all [built-in functions](../v1.0/functions-and-operators.html). [#12533](https://github.com/cockroachdb/cockroach/pull/12533)
- Added an interactive asciicast to the [Build a Python App with CockroachDB](../v1.0/build-a-python-app-with-cockroachdb.html) tutorial. [#937](https://github.com/cockroachdb/docs/pull/937)
- Added documentation on each [`ALTER TABLE`](../v1.0/alter-table.html) sub-statement: [#950](https://github.com/cockroachdb/docs/pull/950)
    - [`ADD COLUMN`](../v1.0/add-column.html)
    - [`ADD CONSTRAINT`](../v1.0/add-constraint.html)
    - [`ALTER COLUMN`](../v1.0/alter-column.html)
    - [`DROP COLUMN`](../v1.0/drop-column.html)
    - [`DROP CONSTRAINT`](../v1.0/drop-constraint.html)
    - [`RENAME COLUMN`](../v1.0/rename-column.html)
    - [`RENAME TABLE`](../v1.0/rename-table.html)
- Added documentation on the [`SHOW USERS`](../v1.0/show-users.html) statement. [#939](https://github.com/cockroachdb/docs/pull/939)
- Clarified that [password-based authentication](../v1.0/create-and-manage-users.html#user-authentication) cannot be used for the `root` user. [#938](https://github.com/cockroachdb/docs/pull/938)

<h3 id="beta-20170105-contributors">Contributors</h3>

This release includes 122 merged PRs by 25 authors. We would like to thank the following contributors from the CockroachDB community:

- Haines Chan
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20170112-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170112.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170112.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20170112-upgrade-notes">Upgrade Notes</h3>

- This release cannot be run concurrently with older beta releases. Please stop all nodes running older releases before restarting any node with this version.

<h3 id="beta-20170112-sql-language-changes">SQL Language Changes</h3>

- The `ALTER TABLE VALIDATE CONSTRAINT` statement can now be used to validate foreign keys in the `UNVALIDATED` state. [#12682](https://github.com/cockroachdb/cockroach/pull/12682)
- [`ALTER TABLE DROP COLUMN`](../v1.0/drop-column.html) can now drop columns that are involved in indexes. If the index includes columns other than the one being dropped, the `CASCADE` modifier is required. [#12782](https://github.com/cockroachdb/cockroach/pull/12782)
- Leading zeros in numeric literals are now ignored instead of causing the number to be parsed as octal. [#12803](https://github.com/cockroachdb/cockroach/pull/12803)
- Collated strings can now be cast to the non-collated string type. [#12820](https://github.com/cockroachdb/cockroach/pull/12820)
- Arithmetic with [aggregated functions](../v1.0/functions-and-operators.html#aggregate-functions) no longer crashes when the input table is empty. [#12733](https://github.com/cockroachdb/cockroach/pull/12733)
- The [`SHOW COLUMNS`](../v1.0/show-columns.html) statement now works for non-root users with the appropriate permissions. [#12776](https://github.com/cockroachdb/cockroach/pull/12776)
- The `information_schema.statistics.NON_UNIQUE` field is now set correctly. [#12793](https://github.com/cockroachdb/cockroach/pull/12793)
- It is now possible to use `EXPLAIN` statements as an input to other queries using a new square bracket syntax: `SELECT MAX(level) FROM [EXPLAIN SELECT * FROM kv ORDER BY v]`. [#12637](https://github.com/cockroachdb/cockroach/pull/12637)
- The format of SQL error messages has been standardized. [#12401](https://github.com/cockroachdb/cockroach/pull/12401)

<h3 id="beta-20170112-command-line-interface-changes">Command-Line Interface Changes</h3>

- The prototype `cockroach backup` and `cockroach restore` commands have been removed (backup and restore functionality will be provided through SQL statements instead). [#12788](https://github.com/cockroachdb/cockroach/pull/12788)

<h3 id="beta-20170112-admin-ui-changes">Admin UI Changes</h3>

- The set of graphs displayed in the UI has been changed. [#12797](https://github.com/cockroachdb/cockroach/pull/12797)
- The node list and cluster pages has been updated. [#12643](https://github.com/cockroachdb/cockroach/pull/12643) [#12719](https://github.com/cockroachdb/cockroach/pull/12719)
- A new metric `raftlog.behind` is now reported to track how far behind raft processing is on a node. [#12800](https://github.com/cockroachdb/cockroach/pull/12800)

<h3 id="beta-20170112-bug-fixes">Bug Fixes</h3>

- Ranges can no longer be rebalanced away from their current lease holder. [#12598](https://github.com/cockroachdb/cockroach/pull/12598)
- Eliminated a source of incorrect "not lease holder" errors. [#12542](https://github.com/cockroachdb/cockroach/pull/12542)
- Reduced spammy "purgatory" log messages. [#12528](https://github.com/cockroachdb/cockroach/pull/12528)

<h3 id="beta-20170112-performance-improvements">Performance Improvements</h3>

- The maximum allowable clock offset has been increased from 250ms to 500ms. [#12821](https://github.com/cockroachdb/cockroach/pull/12821)
- Replica destruction is now much faster. [#12745](https://github.com/cockroachdb/cockroach/pull/12745)
- Raft snapshots and replica destruction no longer run concurrently. [#12737](https://github.com/cockroachdb/cockroach/pull/12737)
- Raft snapshots are now managed by a new internal queue. [#12686](https://github.com/cockroachdb/cockroach/pull/12686)
- Raft logs are now garbage collected more aggressively. [#12686](https://github.com/cockroachdb/cockroach/pull/12686)
- Replicas that are behind are no longer considered targets for lease rebalancing. [#12736](https://github.com/cockroachdb/cockroach/pull/12736)
- Tuned some RocksDB parameters. [#12677](https://github.com/cockroachdb/cockroach/pull/12677)

<h3 id="beta-20170112-doc-updates">Doc Updates</h3>

- Added a Java code sample for transaction retry logic to the [Build a Java App with CockroachDB](../v1.0/build-a-java-app-with-cockroachdb.html) tutorial. [#987](https://github.com/cockroachdb/docs/pull/987)
- Added documentation on [SQL type conversions](../v1.0/data-types.html#data-type-conversions-casts). [#977](https://github.com/cockroachdb/docs/pull/977)

<h3 id="beta-20170112-contributors">Contributors</h3>

This release includes 60 merged PRs by 22 authors. We would like to thank the following contributors from the CockroachDB community:

- songhao
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20170126-license-change">License Change</h3>

- CockroachDB is now covered by the [CockroachDB Community License](https://github.com/cockroachdb/cockroach/blob/master/LICENSE). A pure open-source (APL2) version can be obtained by building from source with the `make buildoss` build target. See our [blog post](https://www.cockroachlabs.com/blog/how-were-building-a-business-to-last/) for more details.

<h3 id="beta-20170126-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170126.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170126.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20170126-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- TLS 1.2 is now required to communicate with a CockroachDB server in secure mode. [#12898](https://github.com/cockroachdb/cockroach/pull/12898)
- The hex string syntax `X'0d0a'` now produces [byte values](../v1.0/sql-constants.html#hexadecimal-encoded-byte-array-literals) instead of string values, so it can accept non-UTF-8 input. [#13094](https://github.com/cockroachdb/cockroach/pull/13094)

<h3 id="beta-20170126-build-changes">Build Changes</h3>

- Cockroachdb now uses Go 1.7.4. [#12881](https://github.com/cockroachdb/cockroach/pull/12881)

<h3 id="beta-20170126-new-features">New Features</h3>

- The location of replicas, both when first added and when rebalanced to maintain cluster equilibrium, is now influenced by [`--locality`](../v1.0/start-a-node.html) settings at the node-level and more [expressive zone configuration constraints](../v1.0/configure-replication-zones.html#replication-constraints). [#13119](https://github.com/cockroachdb/cockroach/pull/13119)
- Old log files are now garbage collected automatically. [#13083](https://github.com/cockroachdb/cockroach/pull/13083)

<h3 id="beta-20170126-sql-language-changes">SQL Language Changes</h3>

- The `information_schema.statistics` table and the output of [`SHOW INDEXES`](../v1.0/show-index.html) now include columns that are added to the index implicitly (the primary key is an implicit part of secondary indexes). These columns are marked by a new `Implicit` column. [#12801](https://github.com/cockroachdb/cockroach/pull/12801)
- The `COPY` statement is now more compatible with PostgreSQL. [#12723](https://github.com/cockroachdb/cockroach/pull/12723)
- CockroachDB now advertises the `integer_datetimes` parameter, improving compatibility with JDBC. [#12842](https://github.com/cockroachdb/cockroach/pull/12842)
- The `sum()` [function](../v1.0/functions-and-operators.html) now works with [`INTEGER`](../v1.0/int.html) values. [#12938](https://github.com/cockroachdb/cockroach/pull/12938)
- The `format_type()` nd `col_description()` [functions](../v1.0/functions-and-operators.html) are now supported. [#12967](https://github.com/cockroachdb/cockroach/pull/12967) [#12978](https://github.com/cockroachdb/cockroach/pull/12978)
- The `pg_catalog.pg_enum` table now exists (although it is always empty because we do not yet support enum types). [#12972](https://github.com/cockroachdb/cockroach/pull/12972)
- The `pg_catalog.pg_collation` table is now supported, along with the `pg_attribute.attcollation` and `pg_type.typcollation` columns. [#12983](https://github.com/cockroachdb/cockroach/pull/12983)
- The `OID` and `NAME` types are now supported (and used in `pg_catalog`) for compatibility with PostgreSQL. [#12641](https://github.com/cockroachdb/cockroach/pull/12641)
- [`SHOW COLUMNS`](../v1.0/show-columns.html) now includes a summary of indices that the column is a part of. [#12907](https://github.com/cockroachdb/cockroach/pull/12907)

<h3 id="beta-20170126-command-line-interface-changes">Command-Line Interface Changes</h3>

- The [`cockroach dump`](../v1.0/sql-dump.html) command can now dump multiple tables at the same time. [#12759](https://github.com/cockroachdb/cockroach/pull/12759)
- The [`cockroach dump`](../v1.0/sql-dump.html) has a new flag, `--dump-mode`, which can be used to dump the schema or the data for a table separately. [#12759](https://github.com/cockroachdb/cockroach/pull/12759)
- Timestamps are now displayed in a format which is accepted by the SQL parser. [#12886](https://github.com/cockroachdb/cockroach/pull/12886)
- The `--pretty` flag has been removed from commands that never used it. [#12900](https://github.com/cockroachdb/cockroach/pull/12900)
- An error is raised when too many positional command-line arguments are provided. [#12901](https://github.com/cockroachdb/cockroach/pull/12901)

<h3 id="beta-20170126-admin-ui-changes">Admin UI Changes</h3>

- When the cursor is over a graph, a vertical line is shown to mark the same time on all graphs. [#12645](https://github.com/cockroachdb/cockroach/pull/12645)

<h3 id="beta-20170126-performance-improvements">Performance Improvements</h3>

- Table leases are now released when a node shuts down cleanly. [#12501](https://github.com/cockroachdb/cockroach/pull/12501)
- Miscellaneous query optimizations. [#12617](https://github.com/cockroachdb/cockroach/pull/12617)
- The gossip network reaches equilibrium faster in larger clusters. [#12880](https://github.com/cockroachdb/cockroach/pull/12880) [#12920](https://github.com/cockroachdb/cockroach/pull/12920) [#12974](https://github.com/cockroachdb/cockroach/pull/12974)
- When a node is shutting down, SQL connections are closed when they become idle. [#12952](https://github.com/cockroachdb/cockroach/pull/12952)
- Nodes now refuse to accept new ranges if they are falling behind on the ranges they already have. [#13043](https://github.com/cockroachdb/cockroach/pull/13043)

<h3 id="beta-20170126-bug-fixes">Bug Fixes</h3>

- [`UPDATE`](../v1.0/update.html) statements using a secondary index no longer cause server crashes during schema changes. [#12794](https://github.com/cockroachdb/cockroach/pull/12794)
- Improved accuracy and performance of node liveness heartbeats. [#12864](https://github.com/cockroachdb/cockroach/pull/12864)
- Reduced the occurrence of "ambiguous result" errors. [#12557](https://github.com/cockroachdb/cockroach/pull/12557)
- The server no longer ignores signals during initialization. [#12743](https://github.com/cockroachdb/cockroach/pull/12743)
- It is now possible to drop a table with a self-referential foreign key without the `CASCADE` modifier. [#12958](https://github.com/cockroachdb/cockroach/pull/12958)
- Additional data consistency checks have been temporarily enabled. [#12994](https://github.com/cockroachdb/cockroach/pull/12994)
- Fixed a crash when retryable errors are returned inside subqueries. [#13028](https://github.com/cockroachdb/cockroach/pull/13028)
- Node ID allocation is now retried if it fails when a node first starts. [#13107](https://github.com/cockroachdb/cockroach/pull/13107)

<h3 id="beta-20170126-doc-updates">Doc Updates</h3>

- Added documentation on [SQL Value Expressions](../v1.0/sql-expressions.html), [Table Expressions](../v1.0/table-expressions.html), and [Constants](../v1.0/sql-constants.html). [#1008](https://github.com/cockroachdb/docs/pull/1008)
- Added documentation on [String Collation](../v1.0/collate.html). [#974](https://github.com/cockroachdb/docs/pull/974)
- Update the [`cockroach dump`](../v1.0/sql-dump.html) documentation to cover dumping multiple tables as well as choosing whether to dump a table's schema, data, or both. [#1010](https://github.com/cockroachdb/docs/pull/1010)
- Updated the [`cockroach zone`](../v1.0/configure-replication-zones.html) documentation to explain how node-level locality settings and zone configuration constraints influence the location of replicas, and added [scenario-based examples](../v1.0/configure-replication-zones.html#scenario-based-examples). [#1027](https://github.com/cockroachdb/docs/pull/1027)
- Updated cluster topology guidance in [Recommended Production Settings](../v1.0/recommended-production-settings.html#cluster-topology). [#1027](https://github.com/cockroachdb/docs/pull/1027)

<h3 id="beta-20170126-contributors">Contributors</h3>

This release includes 115 merged PRs by 25 authors. We would like to thank the following contributors from the CockroachDB community:

- DiSiqueira
- Jason E. Aten
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20170209-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170209.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170209.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20170209-build-changes">Build Changes</h3>

- Official binaries for Linux now support older Linux distributions, including RHEL 6. [#13102](https://github.com/cockroachdb/cockroach/pull/13102)
- CockroachDB now uses RocksDB 5.0.2. [#12913](https://github.com/cockroachdb/cockroach/pull/12913)

<h3 id="beta-20170209-sql-language-changes">SQL Language Changes</h3>

- The `unnest()` [function](../v1.0/functions-and-operators.html) is now supported. [#13154](https://github.com/cockroachdb/cockroach/pull/13154)
- It is now possible to join a set-returning [function](../v1.0/functions-and-operators.html) like `generate_series()` with itself. [#13140](https://github.com/cockroachdb/cockroach/pull/13140)
- The timestamp parser now accepts an additional format. [#13159](https://github.com/cockroachdb/cockroach/pull/13159)
- The output of [`EXPLAIN`](../v1.0/explain.html) has been improved. [#13216](https://github.com/cockroachdb/cockroach/pull/13216) [#13221](https://github.com/cockroachdb/cockroach/pull/13221)
- Hex string literals (`X''`) can now contain byte sequences that are not valid UTF-8. [#13287](https://github.com/cockroachdb/cockroach/pull/13287)
- `COPY` now works outside transactions. [#13400](https://github.com/cockroachdb/cockroach/pull/13400)
- Fixed some edge cases with the `IN` [operator](../v1.0/functions-and-operators.html#operators). [#13444](https://github.com/cockroachdb/cockroach/pull/13444)
- The `pg_type` table now contains entries with the same names as PostgreSQL, such as `int2`, `int4`, and `int8` instead of just `integer`. [#13355](https://github.com/cockroachdb/cockroach/pull/13355)
- The `pg_backend_pid`, `obj_description`, and `shobj_description` [functions](../v1.0/functions-and-operators.html) and the `pg_inherits`, `pg_foreign_table`, and `pg_foreign_server` tables now have placeholder implementations for compatibility with some clients. [#13097](https://github.com/cockroachdb/cockroach/pull/13097) [#13181](https://github.com/cockroachdb/cockroach/pull/13181)

<h3 id="beta-20170209-command-line-interface-changes">Command-Line Interface Changes</h3>

- The `--pretty` flag of [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) has been removed, and replaced with a `--format` flag that supports multiple output formats. The command `set display_format` can be used to change the format during a session. [#13171](https://github.com/cockroachdb/cockroach/pull/13171)
- The current database name is now shown in the prompt. [#12747](https://github.com/cockroachdb/cockroach/pull/12747) [#13379](https://github.com/cockroachdb/cockroach/pull/13379)
- Non-interactive usage of [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) is much faster when the input file contains very long lines. [#13174](https://github.com/cockroachdb/cockroach/pull/13174)

<h3 id="beta-20170209-admin-ui-changes">Admin UI Changes</h3>

- Introduced a new overview dashboard. [#13348](https://github.com/cockroachdb/cockroach/pull/13348)
- Improved accuracy of histogram data. [#13106](https://github.com/cockroachdb/cockroach/pull/13106)

<h3 id="beta-20170209-performance-improvements">Performance Improvements</h3>

- All columns in newly-created tables are placed in the same [column family](../v1.0/column-families.html) by default. [#13198](https://github.com/cockroachdb/cockroach/pull/13198)
- Scans with a `LIMIT` no longer interfere with writes to rows that match the `WHERE` clause but were not returned due to the `LIMIT`. [#13349](https://github.com/cockroachdb/cockroach/pull/13349)
- Performance is more stable during splits. [#13208](https://github.com/cockroachdb/cockroach/pull/13208)
- Reduced unnecessary disk access in read-only transactions. [#13367](https://github.com/cockroachdb/cockroach/pull/13367)
- Reduced log spam. [#13388](https://github.com/cockroachdb/cockroach/pull/13388)

<h3 id="beta-20170209-bug-fixes">Bug Fixes</h3>

- Nodes now retry at startup if they are unable to allocate a node ID. [#13148](https://github.com/cockroachdb/cockroach/pull/13148)
- Improved gossiping of system configuration data. [#13167](https://github.com/cockroachdb/cockroach/pull/13167)

<h3 id="beta-20170209-doc-updates">Doc Updates</h3>

- Added language-specific tutorials on [building an app with CockroachDB](../v1.0/build-an-app-with-cockroachdb.html).
    - The [Go tutorial](../v1.0/build-a-go-app-with-cockroachdb.html) now covers using the Go pq driver or the GORM ORM. [#1069](https://github.com/cockroachdb/docs/pull/1069)
    - The [Python tutorial](../v1.0/build-a-python-app-with-cockroachdb.html) now covers using the psycopg2 driver or the SQLAlchemy ORM. [#1079](https://github.com/cockroachdb/docs/pull/1079)
    - The [Ruby tutorial](../v1.0/build-a-ruby-app-with-cockroachdb.html) now provides a code sample demonstrating transaction retry logic. [#1068](https://github.com/cockroachdb/docs/pull/1068)
- New documentation on the current methods of [importing data into CockroachDB](../v1.0/import-data.html). [#1076](https://github.com/cockroachdb/docs/pull/1076)
- New documentation on how [name resolution](../v1.0/sql-name-resolution.html) works in CockroachDB. [#1050](https://github.com/cockroachdb/docs/pull/1050)
- New documentation on using the [`EXPLAIN`](../v1.0/explain.html) statement to analyze the query plan of `DELETE`, `INSERT`, `SELECT`, or `UPDATE` statements. [#1073](https://github.com/cockroachdb/docs/pull/1073)
- New FAQ on [how CockroachDB is both highly available and strongly consistent without violating the CAP theorem](../v1.0/frequently-asked-questions.html#how-is-cockroachdb-both-highly-available-and-strongly-consistent). [#1061](https://github.com/cockroachdb/docs/pull/1061)
- Expanded documentation on [simple `CASE` expressions](../v1.0/sql-expressions.html#simple-case-expressions) and [searched `CASE` expressions](../v1.0/sql-expressions.html#searched-case-expressions). [#1036](https://github.com/cockroachdb/docs/pull/1036)

<h3 id="beta-20170209-contributors">Contributors</h3>

This release includes 132 merged PRs by 24 authors. We would like to thank the following contributor from the CockroachDB community:

- Panos Mamatsis
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20170216-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170216.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170216.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20170216-sql-language-changes">SQL Language Changes</h3>

- The [search path](../v1.0/sql-name-resolution.html#search-path) for table names can now be set with `SET SEARCH_PATH`. [#13313](https://github.com/cockroachdb/cockroach/pull/13313)
- All built-in [functions](../v1.0/functions-and-operators.html) are now in the global namespace (instead of `pg_catalog`). [#13404](https://github.com/cockroachdb/cockroach/pull/13404)
- The `pg_extension` table and the `current_database` [function](../v1.0/functions-and-operators.html) are now supported. The `pg_type` and `pg_namespace` tables have had some changes to improve compatibility with ActiveRecord. [#13429](https://github.com/cockroachdb/cockroach/pull/13429)
- The columns used in foreign keys are now tracked more accurately. [#13439](https://github.com/cockroachdb/cockroach/pull/13439)

<h3 id="beta-20170216-admin-ui-changes">Admin UI Changes</h3>

- The correct fonts are now used. [#13539](https://github.com/cockroachdb/cockroach/pull/13539)

<h3 id="beta-20170216-bug-fixes">Bug Fixes</h3>

- Replicas that fall too far behind no longer get stuck in a state in which they can no longer catch up. [#13515](https://github.com/cockroachdb/cockroach/pull/13515)
- The `cockroach.LEVEL` symlinks created in the log directory now work. [#13585](https://github.com/cockroachdb/cockroach/pull/13585)

<h3 id="beta-20170216-performance-improvements">Performance Improvements</h3>

- Reduced memory allocations in various places. [#13466](https://github.com/cockroachdb/cockroach/pull/13466) [#13487](https://github.com/cockroachdb/cockroach/pull/13487) [#13455](https://github.com/cockroachdb/cockroach/pull/13455) [#13579](https://github.com/cockroachdb/cockroach/pull/13579)
- The [minimum number of file descriptors](../v1.0/recommended-production-settings.html) has been reduced to 1956 (1700 per store + 256 for networking) so that CockroachDB can be run more easily on platforms with a default limit of 2048 file descriptors. [#13462](https://github.com/cockroachdb/cockroach/pull/13462)
- [`UPSERT`](../v1.0/upsert.html) is now faster in many cases. [#13488](https://github.com/cockroachdb/cockroach/pull/13488) [#13500](https://github.com/cockroachdb/cockroach/pull/13500)

<h3 id="beta-20170216-doc-updates">Doc Updates</h3>

- The [sample Kubernetes config](../v1.0/orchestrate-cockroachdb-with-kubernetes.html) is now able to recover from a situation in which all nodes are down at once. [#13580](https://github.com/cockroachdb/cockroach/pull/13580)
- The [Build a Java App with CockroachDB](../v1.0/build-a-java-app-with-cockroachdb.html) tutorial now covers using the Hibernate ORM in addition to the jdbc driver. [#1100](https://github.com/cockroachdb/docs/pull/1100)
- The [Start a Cluster in Docker](../v1.0/start-a-local-cluster-in-docker.html) tutorial now offers OS-specific instructions, with specific improvements for running on Windows. [#1095](https://github.com/cockroachdb/docs/pull/1095)

<h3 id="beta-20170216-contributors">Contributors</h3>

This release includes 60 merged PRs by 18 authors. We would like to thank first-time contributor Jason Chu from the CockroachDB community.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20170223-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170223.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170223.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20170223-sql-language-changes">SQL Language Changes</h3>

- Fixed parsing of interval constants with precision modifiers such as `INTERVAL '5' YEARS`. [#13702](https://github.com/cockroachdb/cockroach/pull/13702)
- String literals containing `true`, `false`, or their synonyms (but not placeholders or other expressions of type string) can now be used where a `BOOL` is required. [#13685](https://github.com/cockroachdb/cockroach/pull/13685)
- The underlying implementation of the `DECIMAL` type has been replaced. This may change the results of some calculations. The default rounding behavior for `DECIMAL` values is now "half away from zero", which is consistent with PostgreSQL. [#13551](https://github.com/cockroachdb/cockroach/pull/13551)
- The column headers in the results of `SHOW` commands are now lower-case to match PostgreSQL. [#13484](https://github.com/cockroachdb/cockroach/pull/13484)
- The `pg_index.indkey` column is now an `int2vector`, improving compatibility with Sequelize. [#13484](https://github.com/cockroachdb/cockroach/pull/13484)
- Improved support for arrays (still limited to the `pg_catalog` tables). [#13636](https://github.com/cockroachdb/cockroach/pull/13636) [#13535](https://github.com/cockroachdb/cockroach/pull/13535)
- The output of `SHOW USERS` is now sorted. [#13661](https://github.com/cockroachdb/cockroach/pull/13661)

<h3 id="beta-20170223-admin-ui-changes">Admin UI Changes</h3>

- A new graph displays the execution latency for SQL statements. [#12790](https://github.com/cockroachdb/cockroach/pull/12790)
- A new "All Events" page displays cluster history. [#13093](https://github.com/cockroachdb/cockroach/pull/13093)
- New metrics for round-trip time between nodes are now recorded. [#13533](https://github.com/cockroachdb/cockroach/pull/13533)
- Fixed-width fonts now correctly use Inconsolata. [#13631](https://github.com/cockroachdb/cockroach/pull/13631)

<h3 id="beta-20170223-bug-fixes">Bug Fixes</h3>

- Fixed a bug in error handling that could causes ranges to get stuck if an error occurred during a rebalance. [#13605](https://github.com/cockroachdb/cockroach/pull/13605)
- Retry table lease errors during schema changes, preventing them from getting stuck. [#13606](https://github.com/cockroachdb/cockroach/pull/13606)
- Inter-node connections are now closed on heartbeat timeouts, improving the handling of network partitions. [#13654](https://github.com/cockroachdb/cockroach/pull/13654)

<h3 id="beta-20170223-performance-improvements">Performance Improvements</h3>

- Metadata for queries using unqualified table names is now cached, speeding up these queries by 130%. [#13635](https://github.com/cockroachdb/cockroach/pull/13635)
- Eliminated an unnecessary sort phase in table scans, making `cockroach dump` usable on larger tables. [#13703](https://github.com/cockroachdb/cockroach/pull/13703)
- Leases and replicas will no longer be transferred to nodes that are draining. [#11724](https://github.com/cockroachdb/cockroach/pull/11724) [#13601](https://github.com/cockroachdb/cockroach/pull/13601)
- Reduced unnecessary copying and allocations. [#13660](https://github.com/cockroachdb/cockroach/pull/13660) [#13649](https://github.com/cockroachdb/cockroach/pull/13649)

<h3 id="beta-20170223-contributors">Contributors</h3>

This release includes 57 merged PRs by 19 authors.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20170309-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170309.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170309.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20170309-general-changes">General Changes</h3>

- CockroachDB now uses Go 1.8. [#13673](https://github.com/cockroachdb/cockroach/pull/13673)
- CockroachDB now uses RocksDB 5.1.4. [#13831](https://github.com/cockroachdb/cockroach/pull/13831)

<h3 id="beta-20170309-sql-language-changes">SQL Language Changes</h3>

- Table names are now released as soon as the [`DROP TABLE`](../v1.0/drop-table.html) statement executes, instead of being held until the asynchronous cleanup finishes. [#13908](https://github.com/cockroachdb/cockroach/pull/13908)
- Most write statements now accept a `RETURNING NOTHING` clause to indicate that the query should not return a result (not even the number of rows affected). This will be used in the future to enable optimizations. [#13802](https://github.com/cockroachdb/cockroach/pull/13802)
- PostgreSQL-style duration formats are now parsed case-insensitively. [#13748](https://github.com/cockroachdb/cockroach/pull/13748)
- Tables with no columns are now handled correctly in the network protocol. [#13765](https://github.com/cockroachdb/cockroach/pull/13765)
- `COPY` no longer requires the input data to end in a newline. [#13858](https://github.com/cockroachdb/cockroach/pull/13858)
- [`SHOW CONSTRAINTS`](../v1.0/show-constraints.html) no longer includes constraints involving hidden columns. [#13870](https://github.com/cockroachdb/cockroach/pull/13870)
- It is no longer possible to drop system tables. [#13911](https://github.com/cockroachdb/cockroach/pull/13911)
- The `DESC` modifier can now be applied to columns in a [`PRIMARY KEY`](../v1.0/primary-key.html) or [`UNIQUE`](../v1.0/unique.html) clause during table creation. [#13924](https://github.com/cockroachdb/cockroach/pull/13924)

<h3 id="beta-20170309-command-line-interface-changes">Command-Line Interface Changes</h3>

- The [`cockroach dump`](../v1.0/sql-dump.html) command now takes an `--as-of` flag, which can be used to make a backup as of a particular time.
- When [starting a node](../v1.0/start-a-node.html), the details printed to `stdout` are now written to the node's `INFO` log as well. Also, these details now include node attributes and locality. [#1143](https://github.com/cockroachdb/docs/issues/1143), [#1144](https://github.com/cockroachdb/docs/issues/1144)

<h3 id="beta-20170309-bug-fixes">Bug Fixes</h3>

- Fixed (again) a bug in error handling that could causes ranges to get stuck if an error occurred during a rebalance. [#13763](https://github.com/cockroachdb/cockroach/pull/13763)
- Work around a bug that could cause GRPC connections to get stuck in a broken state. [#13822](https://github.com/cockroachdb/cockroach/pull/13822)
- Panic stack traces are now written to the `INFO` log file by default instead of to `stderr`. [#13890](https://github.com/cockroachdb/cockroach/pull/13890)

<h3 id="beta-20170309-performance-improvements">Performance Improvements</h3>

- Improved performance in high-contention scenarios by introducing a queue to wait for conflicting transactions to finish. This also reduces the likelihood of transaction restarts due to write/write conflicts. [#13501](https://github.com/cockroachdb/cockroach/pull/13501)
- A new lease implementation is now used for most ranges, reducing the number of writes that must be done just to maintain a lease. [#13826](https://github.com/cockroachdb/cockroach/pull/13826)
- Reduced the occurrence of `AmbiguousResultError` by waiting for pending RPCs to complete before returning. [#13800](https://github.com/cockroachdb/cockroach/pull/13800)
- Changed some mutexes to `RWMutexes`. Removed some instrumentation of mutex timing. [#13697](https://github.com/cockroachdb/cockroach/pull/13697)
- `cockroach dump` now works in larger batches. [#13812](https://github.com/cockroachdb/cockroach/pull/13812)
- Failed snapshots no longer disrupt regular raft messages. [#13816](https://github.com/cockroachdb/cockroach/pull/13816)
- Increased flow control parameters for GRPC connections, improving performance on high-latency links. [#13840](https://github.com/cockroachdb/cockroach/pull/13840)
- Increased limits on in-flight raft messages. [#13862](https://github.com/cockroachdb/cockroach/pull/13862)
- Range leases are now proactively transferred away from draining nodes. [#13792](https://github.com/cockroachdb/cockroach/pull/13792)
- Avoid sending redundant PushTxn calls in intent resolution. [#13955](https://github.com/cockroachdb/cockroach/pull/13955)

<h3 id="beta-20170309-doc-updates">Doc Updates</h3>

- Added an FAQ on [auto-generating unique IDs in CockroachDB](../v1.0/sql-faqs.html#how-do-i-auto-generate-unique-row-ids-in-cockroachdb). [#1126](https://github.com/cockroachdb/docs/pull/1126)
- Expanded guidance on [using a SQL table as an alternative to direct key-value access](../v1.0/frequently-asked-questions.html#can-i-use-cockroachdb-as-a-key-value-store). [#1122](https://github.com/cockroachdb/docs/pull/1122)
- Added details about [using the `BIT` type to constrain integers](../v1.0/int.html#size) based on their corresponding binary values. [#1116](https://github.com/cockroachdb/docs/pull/1116)
- Added details about [building a binary](../v1.0/install-cockroachdb.html) that excludes enterprise functionality covered by the CockroachDB Community License (CCL). [#1130](https://github.com/cockroachdb/docs/pull/1130)

<h3 id="beta-20170309-contributors">Contributors</h3>

This release includes 124 merged PRs by 21 authors. We would like to thank first-time contributor Dmitry Vorobev from the CockroachDB community.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20170323-binaries">Binaries</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170323.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170323.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

<h3 id="beta-20170323-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- The `ALTER TABLE SPLIT AT` syntax has changed to support multiple splits with one command. Existing uses of `ALTER TABLE t SPLIT AT (x, y)` should be changed to `ALTER TABLE t SPLIT AT VALUES (x, y)`. [#14281](https://github.com/cockroachdb/cockroach/pull/14281)

<h3 id="beta-20170323-installation-changes">Installation Changes</h3>

- The Homebrew formula has moved; to install CockroachDB with `brew`, use `brew install cockroachdb/cockroach/cockroach`.

<h3 id="beta-20170323-general-changes">General Changes</h3>

- CockroachDB now uses `jemalloc` version 4.5.0. [#14287](https://github.com/cockroachdb/cockroach/pull/14287)

<h3 id="beta-20170323-sql-language-changes">SQL Language Changes</h3>

- [Collated strings](../v1.0/collate.html) are now fully supported and may be stored in columns. [#13609](https://github.com/cockroachdb/cockroach/pull/13609)
- The new `isnan()` [function](../v1.0/functions-and-operators.html) and special syntax `IS NAN` and `IS NOT NAN` can be used to detect floats that are `Not-a-Number`. [#14248](https://github.com/cockroachdb/cockroach/pull/14248)
- Variance and standard deviation calculations for integers and decimals now use additional precision internally. [#14013](https://github.com/cockroachdb/cockroach/pull/14013)
- Decimals with precisions greater than 16 now work correctly. [#14304](https://github.com/cockroachdb/cockroach/pull/14304)
- [`CREATE TABLE AS`](../v1.0/create-table-as.html) now works properly with NULL values. [#14247](https://github.com/cockroachdb/cockroach/pull/14247)
- The `SHOW application_name` statement is now supported. [#14085](https://github.com/cockroachdb/cockroach/pull/14085)
- CockroachDB now reports its version in two new places so that clients can distinguish CockroachDB from PostgreSQL: in the `crdb_version` variable in the network handshake, and in a new table `crdb_internal.build_info`. [#14145](https://github.com/cockroachdb/cockroach/pull/14145)
- `ALTER TABLE SPLIT AT` no longer reports an error if the table is already split at the designated point. [#14273](https://github.com/cockroachdb/cockroach/pull/14273)
- Casts involving OID and `regclass` types now behave more consistently with PostgreSQL. The `oid()` function is now available. [#13965](https://github.com/cockroachdb/cockroach/pull/13965) [#14022](https://github.com/cockroachdb/cockroach/pull/14022) [#14115](https://github.com/cockroachdb/cockroach/pull/14115) [#14260](https://github.com/cockroachdb/cockroach/pull/14260)
- Placeholder syntax may now be used for OID values. [#14255](https://github.com/cockroachdb/cockroach/pull/14255)
- Types with modifiers can now be cast to `::regtype`. [#14030](https://github.com/cockroachdb/cockroach/pull/14030)

<h3 id="beta-20170323-command-line-interface-changes">Command-Line Interface Changes</h3>

- A new command `cockroach gen haproxy` is now available to generate an `haproxy` configuration file that can be used to access the cluster. [#14205](https://github.com/cockroachdb/cockroach/pull/14205)
- The [`cockroach start`](../v1.0/start-a-node.html) command now supports a `--pid-file` flag, which names a file to which the process ID will be written when the server is ready to handle requests. [#13996](https://github.com/cockroachdb/cockroach/pull/13996)
- If any environment variables used by `cockroach` are set but cannot be parsed, this is now treated as a fatal error. [#14124](https://github.com/cockroachdb/cockroach/pull/14124)

<h3 id="beta-20170323-admin-ui-changes">Admin UI Changes</h3>

- The log view now shows logs for the requested node. [#13947](https://github.com/cockroachdb/cockroach/pull/13947)
- The custom time range selector now uses UTC to match the graphs. [#14007](https://github.com/cockroachdb/cockroach/pull/14007)
- The admin UI now uses relative paths for all links and respects cookies, allowing it to be run behind authenticating proxies. [#14039](https://github.com/cockroachdb/cockroach/pull/14039)
- The guideline displayed when hovering over a graph is now positioned correctly. [#14008](https://github.com/cockroachdb/cockroach/pull/14008)

<h3 id="beta-20170323-bug-fixes">Bug Fixes</h3>

- [`UPSERT`](../v1.0/upsert.html) statements no longer incorrectly produce the error "cannot affect row a second time". [#10478](https://github.com/cockroachdb/cockroach/pull/10478)
- The replica allocator now explicitly recognizes when a node's health is unknown, and avoids situations in which a range could become critically under-replicated. [#14206](https://github.com/cockroachdb/cockroach/pull/14206)
- Fixed a problem with transaction conflicts immediately after a split that could cause 100% CPU usage. [#14305](https://github.com/cockroachdb/cockroach/pull/14305)
- The rebalancing system is better able to move replicas to match requested constraints. [#13973](https://github.com/cockroachdb/cockroach/pull/13973)
- Fixed a race that could lead to a panic when replicas are being moved frequently. [#14306](https://github.com/cockroachdb/cockroach/pull/14306)
- [`SHOW TABLES`](../v1.0/show-tables.html) no longer fails while a table is being dropped. [#14278](https://github.com/cockroachdb/cockroach/pull/14278)
- Fixed a crash in some [`EXPLAIN`](../v1.0/explain.html) statements. [#14244](https://github.com/cockroachdb/cockroach/pull/14244)
- [Name resolution](../v1.0/sql-name-resolution.html) no longer fails if non-existent databases are present in the search path. [#14006](https://github.com/cockroachdb/cockroach/pull/14006)
- Logging of "node joined the cluster" events for the UI is more reliable. [#14179](https://github.com/cockroachdb/cockroach/pull/14179)
- Memory accounting on macOS now correctly reports memory allocated by C code. [#14287](https://github.com/cockroachdb/cockroach/pull/14287)

<h3 id="beta-20170323-performance-improvements">Performance Improvements</h3>

- Range leases are now transferred to the replica closest to the source of load, when possible. This improves performance in geographically-distributed clusters. [#14268](https://github.com/cockroachdb/cockroach/pull/14268)
- The replica allocator will now actively attempt to move replicas away from no-longer-valid placements when the [zone configuration](../v1.0/configure-replication-zones.html) changes. [#14106](https://github.com/cockroachdb/cockroach/pull/14106)
- Improved the performance of write-heavy workloads. [#14138](https://github.com/cockroachdb/cockroach/pull/14138)
- Improved caching of range descriptors. [#14217](https://github.com/cockroachdb/cockroach/pull/14217)
- Reduced overhead in the command queue. [#13982](https://github.com/cockroachdb/cockroach/pull/13982)
- CockroachDB now enables TCP keepalives on its sockets, improving responsiveness to clients that have disappeared (or load balancers with short timeouts). [#14063](https://github.com/cockroachdb/cockroach/pull/14063)
- Index backfill now only reads the columns necessary to perform the backfill. [#14271](https://github.com/cockroachdb/cockroach/pull/14271)

<h3 id="beta-20170323-doc-updates">Doc Updates</h3>

- Expanded the tutorial on [orchestrating CockroachDB with Docker Swarm](../v1.0/orchestrate-cockroachdb-with-docker-swarm.html) to cover both secure and insecure clusters. [#1184](https://github.com/cockroachdb/docs/pull/1184)
- Added guidance on [importing data from PostgreSQL](../v1.0/import-data.html#import-from-postgresql-dump). [#1200](https://github.com/cockroachdb/docs/pull/1200)
- Added OS-specific instructions for [starting a local CockroachDB cluster in Docker](../v1.0/start-a-local-cluster-in-docker.html). [#1167](https://github.com/cockroachdb/docs/pull/1167)
- Improved the [install from binary instructions](../v1.0/install-cockroachdb.html) to include moving the binary into the `PATH`. [#1196](https://github.com/cockroachdb/docs/pull/1196)

<h3 id="beta-20170323-contributors">Contributors</h3>

This release includes 156 merged PRs by 23 authors. We would like to thank first-time contributor Jonas from the CockroachDB community.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20170330-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170330.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170330.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170330.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="beta-20170330-sql-language-changes">SQL Language Changes</h3>

- `DEFAULT NULL` column modifiers no longer produce type errors. [#14371](https://github.com/cockroachdb/cockroach/pull/14371)
- Consecutive write statements using the `RETURNING NOTHING` clause are now executed in parallel. [#14188](https://github.com/cockroachdb/cockroach/pull/14188)
- [`DECIMAL`](../v1.0/decimal.html) support for NaN, Inifinity, and negative zero. [#14302](https://github.com/cockroachdb/cockroach/pull/14302)

<h3 id="beta-20170330-command-line-interface-changes">Command-Line Interface Changes</h3>

- The separate `INFO`, `WARNING`, and `ERROR` log files have been
  replaced with a single file. [#14347](https://github.com/cockroachdb/cockroach/pull/14347)

<h3 id="beta-20170330-admin-ui-changes">Admin UI Changes</h3>

- The node list page now includes information about whether nodes are alive or dead. [#14258](https://github.com/cockroachdb/cockroach/pull/14258)
- Changed the names of some metrics related to lease transfers. [#14319](https://github.com/cockroachdb/cockroach/pull/14319)

<h3 id="beta-20170330-bug-fixes">Bug Fixes</h3>

- Fixed an inconsistency that could occur with one-phase transactions using the `SNAPSHOT` [isolation level](../v1.0/transactions.html#isolation-levels). [#14401](https://github.com/cockroachdb/cockroach/pull/14401)
- Prevented unexpected write intents on node liveness records, which could cause the cluster to become unavailable. [#14346](https://github.com/cockroachdb/cockroach/pull/14346)
- Fixed two "span use after Finish()" errors. [#14227](https://github.com/cockroachdb/cockroach/pull/14227)
- Fixed a rare panic in `raft.step()`. [#14344](https://github.com/cockroachdb/cockroach/pull/14344)

<h3 id="beta-20170330-performance-improvements">Performance Improvements</h3>

- Reads with timestamps in the past no longer block writes. [#14342](https://github.com/cockroachdb/cockroach/pull/14342)
- Improved node draining to prevent hanging `DROP` statements after a node restart. [#14341](https://github.com/cockroachdb/cockroach/pull/14341)
- Added support for compressing inter-node traffic with snappy. This will be enabled in a future release. [#14239](https://github.com/cockroachdb/cockroach/pull/14239)

<h3 id="beta-20170330-doc-updates">Doc Updates</h3>

- Expanded the [Build a Node.js App with CockroachDB](../v1.0/build-a-nodejs-app-with-cockroachdb-sequelize.html) tutorial to feature the Sequelize ORM. [#1225](https://github.com/cockroachdb/docs/pull/1225)
- Expanded [Manual Deployment](../v1.0/manual-deployment.html) tutorials to cover HAProxy load balancing. [#1213](https://github.com/cockroachdb/docs/pull/1213)
- Expanded [Digital Ocean](../v1.0/deploy-cockroachdb-on-digital-ocean.html) and [GCE](../v1.0/deploy-cockroachdb-on-google-cloud-platform.html) deployment tutorials to cover cloud platform-managed load balancing. Load balancing guidance for AWS and Azure coming soon. [#1213](https://github.com/cockroachdb/docs/pull/1213)
- Improved guidance on using the `cockroach gen` command to generate CockroachDB resources, including [example SQL data](../v1.0/generate-cockroachdb-resources.html#generate-example-data) and an [HAProxy configuration file](../v1.0/generate-cockroachdb-resources.html#generate-an-haproxy-configuration-file) for a running cluster. [#1213](https://github.com/cockroachdb/docs/pull/1213)

<h3 id="beta-20170330-contributors">Contributors</h3>

This release includes 56 merged PRs by 18 authors.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}Some significant bugs have been observed when upgrading to this release from prior versions, so it has been withdrawn.{{site.data.alerts.end}}
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20170413-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170413.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170413.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170413.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="beta-20170413-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- The implementation of indexing for [collated string columns](../v1.0/collate.html) has changed. Any secondary indexes containing collated strings must be [dropped](../v1.0/drop-index.html) before upgrading to this version and then [re-created](../v1.0/create-index.html) after upgrading. Note that this applies only to secondary indexes, not to primary indexes. [#14528](https://github.com/cockroachdb/cockroach/pull/14528)

- Any row with a `-0` [`FLOAT`](../v1.0/float.html) or [`DECIMAL`](../v1.0/decimal.html) value in a primary key or index must be [deleted](../v1.0/delete.html) before upgrading to this version and then [re-inserted](../v1.0/insert.html) after upgrading. Otherwise, the row containing `-0` will show up during table scans, but it will not be possible to delete it or select it as part of an index scan.

  If you suspect `-0` values are present but do not know where, an alternative approach is to use [`cockroach dump`](../v1.0/sql-dump.html) to back up tables with `FLOAT` or `DECIMAL` columns, drop the tables before upgrading, and then use the backup files to recreate the tables and indexes after upgrading. [#14528](https://github.com/cockroachdb/cockroach/pull/14528)

- The `experimental_strptime` and `experimental_strftime` [functions](../v1.0/functions-and-operators.html) are deprecated and will be removed in a future release. If you are currently using these functions, please let us know [here](https://forum.cockroachlabs.com/t/are-you-using-experimental-strptime-or-experimental-strftime/545).

- Several undocumented environment variables have been removed. [#14786](https://github.com/cockroachdb/cockroach/pull/14786) [#14797](https://github.com/cockroachdb/cockroach/pull/14797)
- Clusters which have used the `COCKROACH_PROPOSER_EVALUATED_KV` environment variable require special care when upgrading to this release; contact us for more information. [#14773](https://github.com/cockroachdb/cockroach/pull/14773)

<h3 id="beta-20170413-build-changes">Build Changes</h3>

- Building CockroachDB from source no longer uses `$GOPATH/bin` for anything except the final binary produced by `make install`. [#14629](https://github.com/cockroachdb/cockroach/pull/14629)
- Developers should use `make generate` instead of `go generate` to ensure the correct tool versions are used. [#14672](https://github.com/cockroachdb/cockroach/pull/14672)

<h3 id="beta-20170413-sql-language-changes">SQL Language Changes</h3>

- SQL variables can now be reset to their default values with the `RESET` statement or `SET x TO DEFAULT`. [#14105](https://github.com/cockroachdb/cockroach/pull/14105)
- Schema changes within [transactions](../v1.0/transactions.html) are now restricted. Certain combinations of schema changes with other statements (which would previously hang) will now return an error. It is recommended that DDL statements be issued outside of transactions, or as the only statement within a transaction. [#14368](https://github.com/cockroachdb/cockroach/pull/14368)
- Subqueries are now supported as the source of `UPDATE` statements. [#14611](https://github.com/cockroachdb/cockroach/pull/14611)
- Timestamp parsing now understands the format used by JDBC's `setTimestamp`. [#14712](https://github.com/cockroachdb/cockroach/pull/14712)
- [`INTERVAL`](../v1.0/interval.html) values larger than a month now use the suffix `mon` instead of `m` (which is also used for minutes). Intervals can now be parsed from strings containing decimals and negative numbers. [#14534](https://github.com/cockroachdb/cockroach/pull/14534)
- [`INTERVAL`](../v1.0/interval.html) values now support multiplication and division by [`FLOAT`](../v1.0/float.html) values. [#14614](https://github.com/cockroachdb/cockroach/pull/14614)
- Arithmetic operations on integers now check for overflow. [#14682](https://github.com/cockroachdb/cockroach/pull/14682)
- Comparisons involving tuples with non-identical types are now allowed whenever the comparison of the individual elements would be allowed. [#14674](https://github.com/cockroachdb/cockroach/pull/14674)
- The implementation of the `experimental_strptime` [function](../v1.0/functions-and-operators.html) is now consistent across platforms. [#14801](https://github.com/cockroachdb/cockroach/pull/14801)
- `BETWEEN` now supports any combination of types that would be supported by individual comparison operators. [#14754](https://github.com/cockroachdb/cockroach/pull/14754)
- Handling of untyped literals during overload resolution is now more consistent. [#14593](https://github.com/cockroachdb/cockroach/pull/14593)
- [`ROLLBACK TO SAVEPOINT`](../v1.0/rollback-transaction.html) is now allowed at any time, not only after receiving a "retry transaction" error. [#14538](https://github.com/cockroachdb/cockroach/pull/14538)
- [`CREATE TABLE AS SELECT`](../v1.0/create-table-as.html) now returns the number of rows affected to the SQL client driver. [#13187](https://github.com/cockroachdb/cockroach/pull/13187)
- [`ALTER TABLE .. ADD CONSTRAINT`](../v1.0/add-constraint.html) can now be used to add a self-referential foreign key. [#14711](https://github.com/cockroachdb/cockroach/pull/14711)
- The `RETURNING NOTHING` clause can now be used outside of a transaction, although it does not provide any performance benefit in this case. [#14551](https://github.com/cockroachdb/cockroach/pull/14551)
- [SQL user names](../v1.0/create-user.html) are now required to start with a letter, contain only letters, numbers, and underscores, and be no longer than 63 characters. [#14525](https://github.com/cockroachdb/cockroach/pull/14525)
- The [`BYTES`](../v1.0/bytes.html) type name is now reported as `bytea` in `pg_catalog.pg_type` for compatibility with PostgreSQL. [#14495](https://github.com/cockroachdb/cockroach/pull/14495)
- The PostgreSQL type IO functions (like `int8in`, `int8out`, `int8send`, and `int8recv`) have placeholder implementations for compatibility with some ORMs. [#14529](https://github.com/cockroachdb/cockroach/pull/14529)

<h3 id="beta-20170413-command-line-interface-changes">Command-Line Interface Changes</h3>

- The [`cockroach zone set`](../v1.0/configure-replication-zones.html) command now recognizes the special zone names `.meta`, `.timeseries`, and `.system` to set configurations for system metadata. [#14740](https://github.com/cockroachdb/cockroach/pull/14740)
- The [`cockroach start`](../v1.0/start-a-node.html) command no longer uses the `COCKROACH_PORT` environment variable; the port must be set on the server's command line (similar to `--host` and other flags). [#14612](https://github.com/cockroachdb/cockroach/pull/14612)
- The [`cockroach quit`](../v1.0/stop-a-node.html) command is now more robust. [#14775](https://github.com/cockroachdb/cockroach/pull/14775)
- Command history no longer corrupts previous commands when normalizing them. [#14496](https://github.com/cockroachdb/cockroach/pull/14496)
- Commands entered as a single line are now saved together in the history. [#14846](https://github.com/cockroachdb/cockroach/pull/14846)
- The config file generated by [`cockroach gen haproxy`](../v1.0/generate-cockroachdb-resources.html) now enables health checks for the server. [#14624](https://github.com/cockroachdb/cockroach/pull/14624)
- The `--store` and `--log-dir` flags now reject arguments starting with `~` that were not expanded by the shell. [#14746](https://github.com/cockroachdb/cockroach/pull/14746)

<h3 id="beta-20170413-admin-ui-changes">Admin UI Changes</h3>

- The **Node List** page has been improved. [#14395](https://github.com/cockroachdb/cockroach/pull/14395)
- A new `node-id` metric with labels for the node's address is now exported for use in external monitoring systems. [#14544](https://github.com/cockroachdb/cockroach/pull/14544)
- The `/debug/` pages are now accessible only from `localhost` by default. Set the environment variable `COCKROACH_REMOTE_DEBUG=any` when running the server to allow remote access. [#14647](https://github.com/cockroachdb/cockroach/pull/14647) [#14675](https://github.com/cockroachdb/cockroach/pull/14675)

<h3 id="beta-20170413-performance-improvements">Performance Improvements</h3>

- A new, more efficient format is now used for indexes with the [`STORING`](../v1.0/create-index.html#store-columns) clause. Existing indexes will still work, but will need to be dropped and recreated to get the benefits of the new format. [#14758](https://github.com/cockroachdb/cockroach/pull/14758)
- A single `TimestampCache` is now shared by all replicas on a store, providing better control over memory usage and better support for large transactions. [#14489](https://github.com/cockroachdb/cockroach/pull/14489)
- Reduced memory used by the `TimestampCache`. [#14516](https://github.com/cockroachdb/cockroach/pull/14516) [#14514](https://github.com/cockroachdb/cockroach/pull/14514)
- Replica garbage collection is now much more efficient. [#14391](https://github.com/cockroachdb/cockroach/pull/14391)
- [Adding](../v1.0/add-column.html) and [dropping](../v1.0/drop-column.html) columns now uses the distributed SQL engine. [#14331](https://github.com/cockroachdb/cockroach/pull/14331)
- The health of inter-node connections is now monitored using HTTP/2 ping frames instead of regular RPCs. This ensures that HTTP flow control cannot cause a connection to be considered unhealthy. [#14424](https://github.com/cockroachdb/cockroach/pull/14424)
- The limit on the number of concurrent inter-node RPCs has been increased. [#14785](https://github.com/cockroachdb/cockroach/pull/14785)
- The bandwidth used by range snapshots is now limited to 2MB/sec by default to reduce impact on live traffic. [#14718](https://github.com/cockroachdb/cockroach/pull/14718)
- If a single row grows larger than the configured maximum range size, the split queue will no longer spin trying to split the range repeatedly. [#14654](https://github.com/cockroachdb/cockroach/pull/14654)
- Several kinds of tracing and logging have been disabled by default. [#14677](https://github.com/cockroachdb/cockroach/pull/14677)

<h3 id="beta-20170413-bug-fixes">Bug Fixes</h3>

- Fixed an issue with [`UPDATE`](../v1.0/update.html) and [`DELETE`](../v1.0/delete.html) on tables with [`STORING`](../v1.0/create-index.html#store-columns) indexes. Indexes affected by this bug will need to be dropped and recreated. [#14643](https://github.com/cockroachdb/cockroach/pull/14643)
- `BETWEEN` now handles `NULL` in the same way as other comparison operators. [#14686](https://github.com/cockroachdb/cockroach/pull/14686)
- Fixed a bug with comparisons involving division with a constant negative divisor. [#14702](https://github.com/cockroachdb/cockroach/pull/14702)
- [`INSERT ON CONFLICT DO UPDATE`](../v1.0/insert.html#update-values-on-conflict) no longer uses an error-prone optimization. The [`UPSERT`](../v1.0/upsert.html) statement is now faster than the equivalent `INSERT ON CONFLICT DO UPDATE` statement. [#14485](https://github.com/cockroachdb/cockroach/pull/14485)
- Schema changes now abort more reliably when encountering errors. [#14025](https://github.com/cockroachdb/cockroach/pull/14025)
- Joining nodes of two different clusters is now detected more reliably. [#14475](https://github.com/cockroachdb/cockroach/pull/14475)
- Fixed a panic during prepared [`UPDATE`](../v1.0/update.html) statements. [#14481](https://github.com/cockroachdb/cockroach/pull/14481)
- [`FLOAT`](../v1.0/float.html) and [`DECIMAL`](../v1.0/decimal.html) values in primary keys and indexes now consider `0` and `-0` equal (although the sign will correctly be retained). [#14528](https://github.com/cockroachdb/cockroach/pull/14528)
- [`DECIMAL`](../v1.0/decimal.html) values in primary keys and indexes no longer have zeros truncated. If a secondary index contains a `DECIMAL` value with trailing zeros, you can [drop](../v1.0/drop-index.html) and [re-create](../v1.0/create-index.html) the index to have the value returned correctly when the index is used. [#14528](https://github.com/cockroachdb/cockroach/pull/14528)
- Fixed a crash when assigning with the `DEFAULT` keyword in [`UPDATE`](../v1.0/update.html) statements. [#14640](https://github.com/cockroachdb/cockroach/pull/14640)

<h3 id="beta-20170413-doc-updates">Doc Updates</h3>

- Updated the [Start a Local Cluster](../v1.0/start-a-local-cluster.html) tutorial to better highlight core CockroachDB capabilities such as automated replications and fault tolerance. [#1257](https://github.com/cockroachdb/docs/pull/1257)
- Expanded the [Build a Ruby App with CockroachDB](../v1.0/build-a-ruby-app-with-cockroachdb-activerecord.html) tutorial to feature the ActiveRecord ORM. [#1234](https://github.com/cockroachdb/docs/pull/1234)
- Clarified the `--store` flag in the [`cockroach start`](../v1.0/start-a-node.html) documentation. [#1243](https://github.com/cockroachdb/docs/pull/1243)
- Updated the [build from source](../v1.0/install-cockroachdb.html) instructions to use a source tarball instead of the `cockroach` GitHub repository. The source tarball downloads faster and doesn't need to be extracted in the `GOPATH`. Developers who want to contribute to CockroachDB should use the instructions in [CONTRIBUTING.md](https://github.com/cockroachdb/cockroach/blob/master/CONTRIBUTING.md) instead. [#1209](https://github.com/cockroachdb/docs/issues/1209)
- Added Google Cloud Spanner to the [CockroachDB in Comparison](../v1.0/cockroachdb-in-comparison.html) chart. [#1264](https://github.com/cockroachdb/docs/pull/1264)

<h3 id="beta-20170413-contributors">Contributors</h3>

This release includes 215 merged PRs by 27 authors. We would like to thank the following contributors from the CockroachDB community, especially first-time contributors Amos Bird and Daniel Upton.

- Amos Bird
- Christian Meunier
- Daniel Upton
- songhao
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="beta-20170420-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170420.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170420.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20170420.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="beta-20170420-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- Security-related command-line arguments have been changed. Instead of using multiple flags, certificates and keys are now loaded from a single [`--certs-dir`](../v1.0/create-security-certificates.html#certificate-directory) flag, which defaults to `~/.cockroach-certs` but can be set to a custom location. The individual flags still work in this release but will be removed in the next one. Also note that the `--insecure` flag is now **required** for insecure mode. [#14703](https://github.com/cockroachdb/cockroach/pull/14703)
- The `--alsologtostderr` argument has been renamed to `--logtostderr`, and now takes an optional argument to specify a threshold. [#14841](https://github.com/cockroachdb/cockroach/pull/14841)
- The `^` operator now means `pow()` instead of bitwise xor (bitwise xor uses the `#` operator; this is consistent with PostgreSQL). Any tables with this operator in a [`DEFAULT`](../v1.0/default-value.html) or [`CHECK`](../v1.0/check.html) expression will need to be updated. [#14882](https://github.com/cockroachdb/cockroach/pull/14882)

<h3 id="beta-20170420-upgrade-notes">Upgrade Notes</h3>

- This release cannot run at the same time as releases prior to [`beta-20170413`](beta-20170413.html). If you are running an older version, you must either upgrade to that version first or take down all servers in the cluster before starting any server with this version. This release includes new functionality to make future upgrades smoother. [#14959](https://github.com/cockroachdb/cockroach/pull/14959)

<h3 id="beta-20170420-build-changes">Build Changes</h3>

- CockroachDB's build system has been rewritten to improve portability. It can no longer be installed with `go get` alone; use of the `Makefile` is now required. GNU Make, CMake, and XZ Utils must also be installed to build from source. As a result, CockroachDB can now be built on a larger variety of systems. [#14840](https://github.com/cockroachdb/cockroach/pull/14840)

<h3 id="beta-20170420-sql-language-changes">SQL Language Changes</h3>

- Type errors in [`CHECK`](../v1.0/check.html) constraints are now detected earlier. [#14984](https://github.com/cockroachdb/cockroach/pull/14984)
- Aggregation functions now work correctly above the windowing level. [#14729](https://github.com/cockroachdb/cockroach/pull/14729)
- The default precision for inexact decimal operations is now 20 digits (up from 16). [#15001](https://github.com/cockroachdb/cockroach/pull/15001)
- Bounds are now checked when converting [`FLOAT`](../v1.0/float.html) or [`DECIMAL`](../v1.0/decimal.html) values to [`INTEGER`](../v1.0/int.html). [#14967](https://github.com/cockroachdb/cockroach/pull/14967)
- The `pg_catalog` data for `int2vector` is now consistent with PostgreSQL. [#14989](https://github.com/cockroachdb/cockroach/pull/14989)

<h3 id="beta-20170420-command-line-interface-changes">Command-Line Interface Changes</h3>

- The [`cockroach cert`](../v1.0/create-security-certificates.html) commands have been updated to reflect the new `--certs-dir` convention. [#14703](https://github.com/cockroachdb/cockroach/pull/14703)
- New flags `--log-file-max-size` (default 10 MiB) and `--log-dir-max-size` (default 100 MiB) can be used to control log rotation and deletion. The `--log-file-verbosity` flag (default `INFO`) can be used to control the verbosity of the log file. [#14841](https://github.com/cockroachdb/cockroach/pull/14841)
- Critical errors are now written to `stderr` regardless of the logging configuration. [#14926](https://github.com/cockroachdb/cockroach/pull/14926) [#15025](https://github.com/cockroachdb/cockroach/pull/15025) [#15040](https://github.com/cockroachdb/cockroach/pull/15040)
- The server will now reload its certificates and keys on a `SIGHUP`. [#14925](https://github.com/cockroachdb/cockroach/pull/14925)
- Some commands which previously required a `node` certificate now work with the `root` client certificate. [#14972](https://github.com/cockroachdb/cockroach/pull/14972)
- The undocumented `cockroach debug kv` commands have been removed. [#14857](https://github.com/cockroachdb/cockroach/pull/14857)
- The [`cockroach quit`](../v1.0/stop-a-node.html) command now has a hard timeout of 1 minute if the cluster has lost quorum. [#14708](https://github.com/cockroachdb/cockroach/pull/14708)

<h3 id="beta-20170420-admin-ui-changes">Admin UI Changes</h3>

- Improved alert banners. [#14915](https://github.com/cockroachdb/cockroach/pull/14915) [#15010](https://github.com/cockroachdb/cockroach/pull/15010)

<h3 id="beta-20170420-bug-fixes">Bug Fixes</h3>

- Transactions no longer get stuck forever when a split occurs while they are waiting for a conflicting transaction. [#14974](https://github.com/cockroachdb/cockroach/pull/14974)
- The Admin UI can now display tables with non-lowercase names. [#14818](https://github.com/cockroachdb/cockroach/pull/14818)
- Fixed a panic with "span and descriptor's range do not overlap". [#14952](https://github.com/cockroachdb/cockroach/pull/14952)
- Fixed a data race in the Prometheus exporter. [#14943](https://github.com/cockroachdb/cockroach/pull/14943)

<h3 id="beta-20170420-performance-improvements">Performance Improvements</h3>

- The timestamp cache is now much more efficient, leading to a 42% speedup on single-node write-only benchmarks. [#14867](https://github.com/cockroachdb/cockroach/pull/14867)
- Transaction deadlocks are now detected faster. [#14789](https://github.com/cockroachdb/cockroach/pull/14789)
- Fixed a memory "leak" in Raft. [#15041](https://github.com/cockroachdb/cockroach/pull/15041)
- Improved performance of concurrent RPCs on a single GRPC connection. [#14939](https://github.com/cockroachdb/cockroach/pull/14939)
- Raft processing now uses more threads. [#14897](https://github.com/cockroachdb/cockroach/pull/14897)
- Improved performance of schema changes that add indexes. [#14937](https://github.com/cockroachdb/cockroach/pull/14937)
- Reduced the number of cgo calls for RocksDB iterators. [#14920](https://github.com/cockroachdb/cockroach/pull/14920)

<h3 id="beta-20170420-doc-updates">Doc Updates</h3>

- Expanded the [`TRUNCATE`](../v1.0/truncate.html) documentation to cover using `CASCADE` to truncate dependent tables. [#1297](https://github.com/cockroachdb/docs/pull/1297)
- Minor improvements to the [`ROLLBACK`](../v1.0/rollback-transaction.html) documentation. [#1296](https://github.com/cockroachdb/docs/pull/1296)

<h3 id="beta-20170420-contributors">Contributors</h3>

This release includes 101 merged PRs by 21 authors. We would like to thank first-time contributor xphoniex from the CockroachDB community.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.0-rc.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0-rc.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0-rc.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0-rc.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.0-rc.1-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- It is not possible to upgrade directly to this version of CockroachDB from a version older than [`beta-20170413`](beta-20170413.html). Upgrade any older clusters to that version first. [#15228](https://github.com/cockroachdb/cockroach/pull/15228)
- The [`cockroach start`](../v1.0/start-a-node.html) command no longer recognizes the `COCKROACH_INSECURE` and `COCKROACH_CERTS_DIR` environment variables which are intended to be client-only. Use the `--insecure` and `--certs-dir` command-line flags instead. [#15196](https://github.com/cockroachdb/cockroach/pull/15196) [#15288](https://github.com/cockroachdb/cockroach/pull/15288)
- Older certificate-related command-line flags have been removed; use `--certs-dir` instead. [#15241](https://github.com/cockroachdb/cockroach/pull/15241)
- Various environment variables have been removed in favor of the new `CLUSTER SETTING` commands described below.
- The undocumented `SET SYNTAX` statement and the "modern" syntax variant have been removed. [#15064](https://github.com/cockroachdb/cockroach/pull/15064)

<h3 id="v1.0-rc.1-general-changes">General Changes</h3>

- [Anonymous diagnostics statistics](../v1.0/diagnostics-reporting.html) are now reported by default. To opt out, set `COCKROACH_SKIP_ENABLING_DIAGNOSTIC_REPORTING=true` in the environment when starting the cluster, or use `SET CLUSTER SETTING diagnostics.reporting.enabled = false` in the SQL shell on clusters already running. [#14901](https://github.com/cockroachdb/cockroach/pull/14901)

<h3 id="v1.0-rc.1-build-changes">Build Changes</h3>

- CockroachDB now builds on Windows. Windows support is currently experimental and is recommended only for development, not production.
- Building from source on macOS 10.11 works again. [#15168](https://github.com/cockroachdb/cockroach/pull/15168)
- Building from source on older CPUs (without SSE4.2) works again. [#15247](https://github.com/cockroachdb/cockroach/pull/15247)

<h3 id="v1.0-rc.1-enterprise-features">Enterprise Features</h3>

- Distributed backup and restore capabilities are now available to [enterprise-license customers](https://www.cockroachlabs.com/cockroachdb-community-license/). Using the new [`BACKUP`](../v1.0/backup.html) SQL statement, a cluster's schema and data can be backed up in full or incrementally as of a given timestamp, and can be stored on the platforms you're already using, including AWS S3, Google Cloud Storage, NFS, or HTTP storage. In the unlikely event of irreparable cluster failure, the new [`RESTORE`](../v1.0/restore.html) SQL statement can be used to restore a cluster from enterprise backups. Importantly, backup and restore operations are distributed across the nodes of a cluster, minimizing the impact on cluster performance.

  For details about pricing, [contact Cockroach Labs](https://www.cockroachlabs.com/get-cockroachdb/).

<h3 id="v1.0-rc.1-sql-language-changes">SQL Language Changes</h3>

- Table names and other identifiers are now case-insensitive in all cases, even when used in double quotes. These identifiers will be shown in lowercase in many introspection interfaces. This is consistent with PostgreSQL and improves compatibility with the PostgreSQL JDBC driver. [#15434](https://github.com/cockroachdb/cockroach/pull/15434)
- New `SHOW ALL CLUSTER SETTINGS` and `SET CLUSTER SETTING` statements can be used to view and change certain [cluster-wide settings](../v1.0/cluster-settings.html). The following cluster settings are available in this release:
  - `diagnostics.reporting.enabled`
  - `diagnostics.reporting.report_metrics`
  - `diagnostics.reporting.send_crash_reports`
  - `kv.allocator.lease_rebalancing_aggressiveness`
  - `kv.allocator.load_based_lease_rebalancing.enabled`
  - `kv.raft.command.max_size`
  - `kv.raft_log.synchronize`
  - `kv.snapshot_rebalance.max_rate`
  - `kv.snapshot_recovery.max_rate`
  - `kv.transaction.max_intents`
  - `server.remote_debugging.mode`
  - `sql.defaults.distsql`
  - `sql.metrics.statement_details.dump_to_logs`
  - `sql.metrics.statement_details.enabled`
  - `sql.metrics.statement_details.threshold`
  - `sql.trace.log_statement_execute`
  - `sql.trace.session_eventlog.enabled`
  - `sql.trace.txn.enable_threshold`
- The `PREPARE` and `EXECUTE` statements can now be used to use prepared statements in a SQL shell. [#15256](https://github.com/cockroachdb/cockroach/pull/15256)
- The `regexp_replace()` [function](../v1.0/functions-and-operators.html) now handles newlines correctly, both with and without the `n` flag. [#15309](https://github.com/cockroachdb/cockroach/pull/15309)
- Precedence for the binary `~` [operator](../v1.0/functions-and-operators.html#operators) (regex match) has been changed. This could cause [`DEFAULT`](../v1.0/default-value.html) or [`CHECK`](../v1.0/check.html) expressions to have different behavior if `~` was used in combination with other operators. These will need to be fixed manually. [#15264](https://github.com/cockroachdb/cockroach/pull/15264)
- Ambiguous results now return the PostgreSQL "statement completion unknown" error code. [#15054](https://github.com/cockroachdb/cockroach/pull/15054)
- Time zones can now be specified in more formats in [`DATE`](../v1.0/date.html) types, including `+0700`, `+07`, `+7`, and `+07:00`. [#15177](https://github.com/cockroachdb/cockroach/pull/15177)
- Set-returning [functions](../v1.0/functions-and-operators.html) (like `generate_series()`) are now supported in more contexts. [#14369](https://github.com/cockroachdb/cockroach/pull/14369)

<h3 id="v1.0-rc.1-admin-ui-changes">Admin UI Changes</h3>

- Tooltips are now shown on graphs. [#15282](https://github.com/cockroachdb/cockroach/pull/15282)
- Fixed elements that overlapped incorrectly. [#15387](https://github.com/cockroachdb/cockroach/pull/15387)
- Improved handling of long strings in table cells. [#15387](https://github.com/cockroachdb/cockroach/pull/15387)
- The SQL statement latency graphs now include some overhead that was not previously accounted for. [#15176](https://github.com/cockroachdb/cockroach/pull/15176)

<h3 id="v1.0-rc.1-command-line-interface-changes">Command-Line Interface Changes</h3>

- The default lifetime of certificates generated by [`cockroach cert`](../v1.0/create-security-certificates.html) has been increased to 10 years. [#15306](https://github.com/cockroachdb/cockroach/pull/15306)
- The output format of [`cockroach cert list`](../v1.0/create-security-certificates.html) has been improved. [#15198](https://github.com/cockroachdb/cockroach/pull/15198)

<h3 id="v1.0-rc.1-bug-fixes">Bug Fixes</h3>

- Table scans over [interleaved tables](../v1.0/interleave-in-parent.html) now work correctly. [#15043](https://github.com/cockroachdb/cockroach/pull/15043)
- Fixed backslash escaping when used with the Python `psycopg2` driver. [#15281](https://github.com/cockroachdb/cockroach/pull/15281)
- Improved certificate validation, fixing compatibility with client certs as used by `psql`. [#15286](https://github.com/cockroachdb/cockroach/pull/15286)
- Fixed a race between lease transfers and repair/rebalance operations. [#15355](https://github.com/cockroachdb/cockroach/pull/15355)
- Creating a table with a bad `DEFAULT` expression no longer panics. [#15170](https://github.com/cockroachdb/cockroach/pull/15170)
- Improved tracking of memory used by aggregate functions. [#14904](https://github.com/cockroachdb/cockroach/pull/14904)
- Rebalancing now only considers ranges for which all replicas are healthy. [#15312](https://github.com/cockroachdb/cockroach/pull/15312)
- Writes to the raft log are now fully synced to disk. [#15366](https://github.com/cockroachdb/cockroach/pull/15366)
- Fixed a hang during node shutdown. [#15465](https://github.com/cockroachdb/cockroach/pull/15465)
- Fixed "requested entry at index" log spam from `raft_log_queue.go`. [#15466](https://github.com/cockroachdb/cockroach/pull/15466)

<h3 id="v1.0-rc.1-performance-improvements">Performance Improvements</h3>

- A new distributed SQL execution engine is now used for a large subset of [`SELECT`](../v1.0/select.html) statements. Instead of returning all table data involved in the query to the gateway node for final computations, computation is distributed between the gateway node and the nodes where the data resides, with just the relevant results returned to the gateway node. This deeper distribution of work significantly improves performance of queries, especially those using [aggregation functions](../v1.0/functions-and-operators.html#aggregate-functions) or [joins](../v1.0/table-expressions.html#join-expressions).
- Smoothed out request stats used by lease rebalancing and reduced thrashing. [#15156](https://github.com/cockroachdb/cockroach/pull/15156) [#15321](https://github.com/cockroachdb/cockroach/pull/15321)
- Improved retry logic after lease failures. [#15199](https://github.com/cockroachdb/cockroach/pull/15199)
- Snapshots that are necessary for recovery are now given higher recovery than those used for rebalancing. [#15279](https://github.com/cockroachdb/cockroach/pull/15279)
- Very large transactions and commands that might cause the server to run out of memory are now rejected earlier. [#15350](https://github.com/cockroachdb/cockroach/pull/15350)
- Node liveness heartbeats are now retried when they fail due to heavy load. [#15362](https://github.com/cockroachdb/cockroach/pull/15362)
- Improved priority adjustments when transactions are pushed. [#7380](https://github.com/cockroachdb/cockroach/pull/7380)

<h3 id="v1.0-rc.1-doc-updates">Doc Updates</h3>

- Expanded documentation on [backing up](../v1.0/back-up-data.html) and [restoring data](../v1.0/restore-data.html) to cover both distributed capabilities covered by our enterprise license as well as non-distributed dump and import functionality. [#1239](https://github.com/cockroachdb/docs/pull/1239)
- Added [SQL-specific FAQs](../v1.0/sql-faqs.html). [#1315](https://github.com/cockroachdb/docs/pull/1315)
- Documented the [order in which operators are evaluated](../v1.0/functions-and-operators.html#operators) within statements. [#1322](https://github.com/cockroachdb/docs/pull/1322)
- Documented the known list of [differences between PostgreSQL and CockroachDB](../v1.0/porting-postgres.html) for identical SQL input, with porting instructions. [#1328](https://github.com/cockroachdb/docs/pull/1328)
- Expanded best practices when [using the `--locality` setting](../v1.0/recommended-production-settings.html) to replicate evenly across datacenters. [#1334](https://github.com/cockroachdb/docs/pull/1334)

<h3 id="v1.0-rc.1-contributors">Contributors</h3>

This release includes 185 merged PRs by 27 authors. We would like to thank the following contributors from the CockroachDB community, including first-time contributors Evgeniy Vasilev and Mahmoud Al-Qudsi.

- Evgeniy Vasilev
- Kenji Kaneda
- Mahmoud Al-Qudsi
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.0-rc.2-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0-rc.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0-rc.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0-rc.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.0-rc.2-general-changes">General Changes</h3>

- [Diagnostics reporting](../v1.0/diagnostics-reporting.html) now includes anonymized query statistics. [#15491](https://github.com/cockroachdb/cockroach/pull/15491)

<h3 id="v1.0-rc.2-sql-language-changes">SQL Language Changes</h3>

- Restrictions on schema changes in transactions with other statements have been relaxed. It is now possible to insert into a table in the same transaction that created it, provided there are no [`FOREIGN KEY`](../v1.0/foreign-key.html) or [`INTERLEAVE`](../v1.0/interleave-in-parent.html) clauses. [#15511](https://github.com/cockroachdb/cockroach/pull/15511)
- The distributed SQL engine supports queries that internally generate rows with no columns. [#15420](https://github.com/cockroachdb/cockroach/pull/15420)
- New variables added to the [cluster-wide settings](../v1.0/cluster-settings.html): `server.declined_reservation_timeout`, `server.failed_reservation_timeout`, and `server.time_until_store_dead`. [#15581](https://github.com/cockroachdb/cockroach/pull/15581)

<h3 id="v1.0-rc.2-command-line-interface-changes">Command-Line Interface Changes</h3>

- If the new flag `--listening-url-file` is passed to [`cockroach start`](../v1.0/start-a-node.html), the server will write its SQL connection URL to the specified file on successful startup, in addition to printing it to `stdout`. This is particularly helpful in identifying the node's port when an unused port is assigned automatically (`--port=0`).[#15468](https://github.com/cockroachdb/cockroach/pull/15468)
- The [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell no longer buffers all results in memory before printing them. [#15277](https://github.com/cockroachdb/cockroach/pull/15277)
- The log file is now flushed more reliably when a node exits. [#15531](https://github.com/cockroachdb/cockroach/pull/15531)
- The new flag `--max-offset` on the [`cockroach start`](../v1.0/start-a-node.html) command defines the maximum allowed clock offset for the cluster and replaces the environment variable `COCKROACH_MAX_OFFSET`. Note that the `--max-offset` value must be the same on all nodes in the cluster. In order to change it, every node in the cluster must be stopped and restarted with the new value. [#15568](https://github.com/cockroachdb/cockroach/pull/15568)
- The `--raft-tick-interval` flag has been removed from the [`cockroach start`](../v1.0/start-a-node.html) command. [#15547](https://github.com/cockroachdb/cockroach/pull/15547)
- Certificate and key loading errors during node startup are now reported to the user via `stdout` as well as being written to the log file. [#15655](https://github.com/cockroachdb/cockroach/pull/15655)

<h3 id="v1.0-rc.2-admin-ui-changes">Admin UI Changes</h3>

- The number of transactions that would be affected by a change in isolation level is now tracked. [#15234](https://github.com/cockroachdb/cockroach/pull/15234)
- Improved style of the single node and log pages. [#15486](https://github.com/cockroachdb/cockroach/pull/15486)
- The event log now refreshes automatically. [#15502](https://github.com/cockroachdb/cockroach/pull/15502)
- Graphs on the overview page now have tooltips. [#15624](https://github.com/cockroachdb/cockroach/pull/15624)

<h3 id="v1.0-rc.2-bug-fixes">Bug Fixes</h3>

- Fixed a panic when a query returning a constant `NULL` uses the new distributed execution engine. [#15530](https://github.com/cockroachdb/cockroach/pull/15530)
- Fixed two issues that could cause requests to get stuck indefinitely. [#15557](https://github.com/cockroachdb/cockroach/pull/15557) [#15573](https://github.com/cockroachdb/cockroach/pull/15573)
- Fixed a rare crash when extending table leases. [#15560](https://github.com/cockroachdb/cockroach/pull/15560)
- Fixed a crash when a transaction that uses [`SAVEPOINT cockroach_restart`](../v1.0/savepoint.html) does something other than `ROLLBACK TO SAVEPOINT` after an error. [#15563](https://github.com/cockroachdb/cockroach/pull/15563)
- Fixed [`RESTORE`](../v1.0/restore.html) for interleaved tables. [#15564](https://github.com/cockroachdb/cockroach/pull/15564)
- Return parse error instead of panic when constant typechecking fails. [#15636](https://github.com/cockroachdb/cockroach/pull/15636)
- Prevent persistent distsql and schema change errors after a node dies. [#15368](https://github.com/cockroachdb/cockroach/pull/15368)
- Previously, [`ALTER TABLE ADD COLUMN`](../v1.0/add-column.html) with a `DEFAULT unique_rowid()` specification could create many duplicate values. This has been corrected. [#15628](https://github.com/cockroachdb/cockroach/pull/15628)
- Fixed a consistency error in [`BACKUP`](../v1.0/backup.html). [#15642](https://github.com/cockroachdb/cockroach/pull/15642)
- Fixed incorrect NULL results when using an aggregation with an empty table. [#15688](https://github.com/cockroachdb/cockroach/pull/15688)

<h3 id="v1.0-rc.2-performance-improvements">Performance Improvements</h3>

- Reduced thrashing in gossip after a rolling restart. [#15533](https://github.com/cockroachdb/cockroach/pull/15533)
- [`RESTORE`](../v1.0/restore.html) performs its pre-splitting less aggressively. [#15548](https://github.com/cockroachdb/cockroach/pull/15548)
- Improved memory accounting in distributed SQL. [#15595](https://github.com/cockroachdb/cockroach/pull/15595), [#15610](https://github.com/cockroachdb/cockroach/pull/15610), [#15623](https://github.com/cockroachdb/cockroach/pull/15623), [#15627](https://github.com/cockroachdb/cockroach/pull/15627)
- Queries using session-dependent variables (e.g., time conversions using the session's timezone) are now executed through the distributed SQL engine. [#15628](https://github.com/cockroachdb/cockroach/pull/15628)

<h3 id="v1.0-rc.2-doc-updates">Doc Updates</h3>

- Added an FAQ on different [ways to log SQL queries](../v1.0/sql-faqs.html). [#1359](https://github.com/cockroachdb/docs/pull/1359)
- Updated [local deployment tutorials](../v1.0/start-a-local-cluster.html) to have nodes listen only on `localhost`. This ensures these tutorials work even on machines whose hostnames aren’t resolvable. [#1358](https://github.com/cockroachdb/docs/pull/1358)

<h3 id="v1.0-rc.2-contributors">Contributors</h3>

This release includes 85 merged PRs by 24 authors. We would like to thank the following contributors from the CockroachDB community:

- Dmitry Vorobev
- Richard Artoul
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.0.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.0.1-bug-fixes">Bug Fixes</h3>

- The command-line interface no longer prompts for a password twice when [password authentication](../v1.0/create-and-manage-users.html#secure-clusters-with-passwords) is used. [#15919](https://github.com/cockroachdb/cockroach/pull/15919)
- [`CREATE USER WITH PASSWORD`](../v1.0/create-user.html) now works correctly in the [`cockroach sql`](../v1.0/use-the-built-in-sql-client.html) shell. [#15911](https://github.com/cockroachdb/cockroach/pull/15911)
- Fixed bugs in the `MIN()` and `MAX()` [aggregate functions](../v1.0/functions-and-operators.html#aggregate-functions) in the presence of `NULL` values. [#15912](https://github.com/cockroachdb/cockroach/pull/15912)
- Administrator privileges are no longer required on Windows. [#15916](https://github.com/cockroachdb/cockroach/pull/15916)
- Favicons now display correctly in the web UI. [#15918](https://github.com/cockroachdb/cockroach/pull/15918)
- A clear error message is now printed when running on Windows versions older than 8 (the oldest version we support). [#15920](https://github.com/cockroachdb/cockroach/pull/15920)
- The `--cache` and `--max-sql-memory` flags of [`cockroach start`](../v1.0/start-a-node.html) now use their default values on OpenBSD. [#15914](https://github.com/cockroachdb/cockroach/pull/15914)
- Attempting to [create a view](../v1.0/create-view.html) involving an array now returns an error instead of crashing the server. [#15913](https://github.com/cockroachdb/cockroach/pull/15913)
- [`cockroach start --insecure`](../v1.0/start-a-node.html) now prints a warning about the consequences of insecure mode. [#15924](https://github.com/cockroachdb/cockroach/pull/15924)
- The `round()` function for floats now works on `arm64` platforms. In some instances this changes the low bits of the result on other platforms. [#15915](https://github.com/cockroachdb/cockroach/pull/15915)
- [Collation](../v1.0/collate.html) locales containing capital letters are now parsed correctly. [#15917](https://github.com/cockroachdb/cockroach/pull/15917)
- Fixed a panic in node ID allocation. [#15937](https://github.com/cockroachdb/cockroach/pull/15937)
- Other errors in node/store ID allocation are now retried automatically. [#15973](https://github.com/cockroachdb/cockroach/pull/15973)
- [Dropping a database](../v1.0/drop-database.html) containing views now works correctly. [#15983](https://github.com/cockroachdb/cockroach/pull/15983)
- Fully-qualified column names referring to [views](../v1.0/views.html) now work correctly. [#15984](https://github.com/cockroachdb/cockroach/pull/15984)
- Fixed a panic when preparing a query with window functions. [#16019](https://github.com/cockroachdb/cockroach/pull/16019)
- Fixed a panic when null arguments are given to the `generate_series()` or `unnest()` function. [#16017](https://github.com/cockroachdb/cockroach/pull/16017)

<h3 id="v1.0.1-admin-ui-changes">Admin UI Changes</h3>

- Fixed the display of timestamps in logs. [#16002](https://github.com/cockroachdb/cockroach/pull/16002)

<h3 id="v1.0.1-performance-improvements">Performance Improvements</h3>

- Disabled RocksDB assertions in release builds. [#15943](https://github.com/cockroachdb/cockroach/pull/15943) [#15960](https://github.com/cockroachdb/cockroach/pull/15960)
- Index joins for queries with limits no longer fetch unnecessary rows. [#15969](https://github.com/cockroachdb/cockroach/pull/15969)
- Fixed an issue causing high CPU usage after data is deleted or overwritten. [#16006](https://github.com/cockroachdb/cockroach/pull/16006)

<h3 id="v1.0.1-doc-updates">Doc Updates</h3>

- Contributing to the docs is now easier. The new **Contribute** options at the top of every page of the docs let you immediately start a PR with page edits or open a GitHub issue to report issues on the page or to request a new topic. [#1440](https://github.com/cockroachdb/docs/pull/1440)
- Added troubleshooting guidance on [common errors](../v1.0/common-errors.html), [cluster and node setup](../v1.0/cluster-setup-troubleshooting.html), [SQL query behavior](../v1.0/query-behavior-troubleshooting.html), [using debug and error logs](../v1.0/debug-and-error-logs.html), [finding support resources](../v1.0/support-resources.html), and [filing issues](../v1.0/file-an-issue.html). [#1370](https://github.com/cockroachdb/docs/pull/1370)
- Added [FAQs](../v1.0/operational-faqs.html) on why memory and disk usage increases steadily in new clusters. [#1450](https://github.com/cockroachdb/docs/pull/1450)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.0.2-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.0.2-general-changes">General Changes</h3>

- CockroachDB now uses Go 1.8.3 (fixing a security issue when elliptic curve certificates are used, as well as a panic). [#16330](https://github.com/cockroachdb/cockroach/pull/16330)

<h3 id="v1.0.2-sql-language-changes">SQL Language Changes</h3>

- The `BEGIN` statement now accepts the `READ WRITE` modifier for compatibility with the Go `lib/pq` driver. [#16348](https://github.com/cockroachdb/cockroach/pull/16348)

<h3 id="v1.0.2-command-line-interface-changes">Command-Line Interface Changes</h3>

- More node configuration details get logged on node initialization. [#16209](https://github.com/cockroachdb/cockroach/pull/16209)

<h3 id="v1.0.2-bug-fixes">Bug Fixes</h3>

- Fixed several bugs with the [`OFFSET`](../v1.0/select.html#paginate-through-limited-results) clause, including incorrect results and a panic when it is used without a `LIMIT`. [#16315](https://github.com/cockroachdb/cockroach/pull/16315)
- Fixed the behavior of `LIMIT` in index joins. [#16340](https://github.com/cockroachdb/cockroach/pull/16340)
- Fixed the behavior of [`DISTINCT`](../v1.0/select.html#select-distinct-rows) with omitted columns. [#16318](https://github.com/cockroachdb/cockroach/pull/16318)
- Fixed decoding of very large [`DECIMAL`](../v1.0/decimal.html) values. [#16284](https://github.com/cockroachdb/cockroach/pull/16284)
- [`ALTER TABLE...ADD FOREIGN KEY`](../v1.0/add-constraint.html#add-the-foreign-key-constraint) no longer attempts to create an index on the source table. [#16333](https://github.com/cockroachdb/cockroach/pull/16333)
- `INT2VECTOR` is now zero-indexed. [#16326](https://github.com/cockroachdb/cockroach/pull/16326)
- Timestamp parsing is now consistent between prepared and non-prepared statements. [#16327](https://github.com/cockroachdb/cockroach/pull/16327)
- If a prepared statement is invalidated by a schema change, it now returns an error instead of an incorrect result. [#16335](https://github.com/cockroachdb/cockroach/pull/16335)
- The replica allocator will no longer remove replicas from a down node if there are no live nodes to receive them. [#16218](https://github.com/cockroachdb/cockroach/pull/16218)
- `ConditionalPut` failures during initial migrations are now handled gracefully. [#16244](https://github.com/cockroachdb/cockroach/pull/16244)
- `EXPLAIN (TRACE)` and the `sql.trace.txn.enable_threshold` cluster setting now work even when the `trace.debug.enable` [cluster setting](../v1.0/cluster-settings.html) is false (the default). [#16217](https://github.com/cockroachdb/cockroach/pull/16217)
- Improved the ability of a cluster to restart with some nodes missing. [#16353](https://github.com/cockroachdb/cockroach/pull/16353)
- [Backup URLs](../v1.0/backup.html#backup-file-urls) are now sanitized before being written to the system jobs table. [#16386](https://github.com/cockroachdb/cockroach/pull/16386)
- [`cockroach zone set`](../v1.0/configure-replication-zones.html) with an incomplete config for the special system ranges now merges the given config with the default instead of using zeros. [#16212](https://github.com/cockroachdb/cockroach/pull/16212)

<h3 id="v1.0.2-performance-improvements">Performance Improvements</h3>

- Improved performance of MVCC garbage collection. [#16219](https://github.com/cockroachdb/cockroach/pull/16219) [#16231](https://github.com/cockroachdb/cockroach/pull/16231)
- Adjusted timeouts for snapshot throttling. [#16328](https://github.com/cockroachdb/cockroach/pull/16328)

<h3 id="v1.0.2-doc-updates">Doc Updates</h3>

- Added [basic hardware recommendations](../v1.0/recommended-production-settings.html#hardware) for a CockroachDB cluster. [#1527](https://github.com/cockroachdb/docs/pull/1527)
- Completed the [`ADD COLUMN`](../v1.0/add-column.html) documentation. [#1483](https://github.com/cockroachdb/docs/pull/1483)
- Improved the [`RENAME TABLE`](../v1.0/rename-table.html) documentation. [#1532](https://github.com/cockroachdb/docs/pull/1532)
- Improved the [`DROP DATABASE`](../v1.0/drop-database.html) documentation. [#1540](https://github.com/cockroachdb/docs/pull/1540)
- Added examples for [creating a replication zone for system ranges](../v1.0/configure-replication-zones.html#create-a-replication-zone-for-system-ranges) and [tweaking the replication of system ranges](../v1.0/configure-replication-zones.html#tweaking-the-replication-of-system-ranges). [#1441](https://github.com/cockroachdb/docs/pull/1441)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.0.3-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.3.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.3.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.3.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.0.3-sql-language-changes">SQL Language Changes</h3>

- `SET client_encoding='unicode'` is now recognized as equivalent to `UTF-8`. [#16513](https://github.com/cockroachdb/cockroach/pull/16513)
- The `IN` operator now works with tuples of `OIDs`. [#16645](https://github.com/cockroachdb/cockroach/pull/16645)

<h3 id="v1.0.3-bug-fixes">Bug Fixes</h3>

- Fixed a consistency problem that could result when a transaction commit races with a lease transfer. [#16775](https://github.com/cockroachdb/cockroach/pull/16775)
- Fixed a panic with message `indexed var linked to different container`. [#16444](https://github.com/cockroachdb/cockroach/pull/16444)
- Casting a string to `regtype` now uses the full type parser. [#16480](https://github.com/cockroachdb/cockroach/pull/16480) [#16792](https://github.com/cockroachdb/cockroach/pull/16792)
- Fixed formatting of some error messages containing `%` characters. [#16617](https://github.com/cockroachdb/cockroach/pull/16617)
- Fixed a panic in the timestamp cache. [#16711](https://github.com/cockroachdb/cockroach/pull/16711)
- Fixed a memory leak when [`EXPLAIN`](../v1.0/explain.html) is used on a query containing [`UNION`](../v1.0/select.html#union-combine-two-queries). [#16775](https://github.com/cockroachdb/cockroach/pull/16775)

<h3 id="v1.0.3-performance-improvements">Performance Improvements</h3>

- The intent resolver now works in smaller batches, reducing memory spikes after large transactions. [#16741](https://github.com/cockroachdb/cockroach/pull/16741)
- MVCC garbage collection now works in smaller batches, avoiding problems with refreshing leases. [#16735](https://github.com/cockroachdb/cockroach/pull/16735)

<h3 id="v1.0.3-doc-updates">Doc Updates</h3>

- Introduced docs for specific versions of CockroachDB. [#1605](https://github.com/cockroachdb/docs/pull/1605)
    - Documentation for the latest [production release](index.html#production-releases) is at https://www.cockroachlabs.com/docs/{{site.versions["stable"]}}/.
    - Documentation for the latest [testing release](index.html#testing-releases) is at https://www.cockroachlabs.com/docs/{{site.versions["dev"]}}/.
    - On any page, you can switch between versions using the version selector in the lower-left.
- Updated the [Deploy CockroachDB on Google Cloud Platform](../v1.0/deploy-cockroachdb-on-google-cloud-platform.html) tutorial to provide guidance on using Google's managed TCP Proxy Load Balancing service. [#1665](https://github.com/cockroachdb/docs/pull/1665)
- Added an [Automatic Cloud Migration](../v1.0/demo-automatic-cloud-migration.html) tutorial that shows you how to use a local cluster to simulate deploying across clouds and migrating from one cloud to another with no downtime. [#1610](https://github.com/cockroachdb/docs/pull/1610)
- Expanded details on [how CockroachDB handles unsynchronized clocks](../v1.0/recommended-production-settings.html#clock-synchronization). [#1636](https://github.com/cockroachdb/docs/pull/1636)
- Updated the [Node.js transaction code sample](../v1.0/build-a-nodejs-app-with-cockroachdb.html) to perform a `SELECT` as part of the transaction and return the results through the transaction wrapper. [#1615](https://github.com/cockroachdb/docs/pull/1615)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.0.4-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.4.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.4.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.4.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.0.4-sql-language-changes">SQL Language Changes</h3>

- [`ROLLBACK TO SAVEPOINT`](../v1.0/rollback-transaction.html) is now accepted at any time. [#16932](https://github.com/cockroachdb/cockroach/pull/16932)

<h3 id="v1.0.4-bug-fixes">Bug Fixes</h3>

- Fixed a race condition that could lead to serializability violations when requests race with a lease transfer. [#17141](https://github.com/cockroachdb/cockroach/pull/17141)
- [`CREATE TABLE AS SELECT`](../v1.0/create-table-as.html) now handles values of type `BOOL`. [#17092](https://github.com/cockroachdb/cockroach/pull/17092)
- Fixed handling of columns names containing special characters in [`SHOW CREATE TABLE`](../v1.0/show-create-table.html), [`CREATE VIEW`](../v1.0/create-view.html), and [`CREATE TABLE AS SELECT`](../v1.0/create-table-as.html). [#16783](https://github.com/cockroachdb/cockroach/pull/16783)
- Fixed issues with [diagnostic reporting](../v1.1/diagnostics-reporting.html). [#17085](https://github.com/cockroachdb/cockroach/pull/17085)
- Fixed a panic with `--vmodule=plan=3` or `--verbosity=3`. [#17093](https://github.com/cockroachdb/cockroach/pull/17093)

<h3 id="v1.0.4-doc-updates">Doc Updates</h3>

- Improved code samples for [building a Rust app with CockroachDB](../v1.0/build-a-rust-app-with-cockroachdb.html). [#1746](https://github.com/cockroachdb/docs/pull/1746)
- Improved documentation for secure [Docker Swarm deployments](../v1.0/orchestrate-cockroachdb-with-docker-swarm.html).  [#1735](https://github.com/cockroachdb/docs/pull/1735)
- Fixed links to Google Cloud Platform documentation in [deployment docs](../v1.0/deploy-cockroachdb-on-google-cloud-platform.html). [#1744](https://github.com/cockroachdb/docs/pull/1744)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.0.5-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.5.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.5.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.5.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.0.5-command-line-interface-changes">Command-Line Interface Changes</h3>

- Fatal error messages are now printed to both `stderr` and the [logs](../v1.0/debug-and-error-logs.html). [#17675](https://github.com/cockroachdb/cockroach/pull/17675)

<h3 id="v1.0.5-bug-fixes">Bug Fixes</h3>

- [Foreign keys](../v1.0/foreign-key.html) that point to a prefix of an existing index now work correctly. Previously, rows could be deleted from the referenced table without recognizing the constraint violation if rows in the referring table pointed to them. These foreign keys are also now shown correctly in [`SHOW CREATE TABLE`](../v1.0/show-create-table.html). [#17653](https://github.com/cockroachdb/cockroach/pull/17653)
- The crash reporter will now time out instead of waiting indefinitely trying to reach the server. [#17689](https://github.com/cockroachdb/cockroach/pull/17689)
- `AS OF SYSTEM TIME 0` is now a normal error instead of a panic. [#17681](https://github.com/cockroachdb/cockroach/pull/17681)
- Fixed a panic caused by unclosed `planNodes`. [#17281](https://github.com/cockroachdb/cockroach/pull/17281)
- 3DES has been removed from the list of supported TLS cipher suites (it would never be selected because we require TLS 1.2, but it could be reported as a false positive by security scanners). [#17237](https://github.com/cockroachdb/cockroach/pull/17237)

<h3 id="v1.0.5-performance-improvements">Performance Improvements</h3>

- Reduced unhelpful retries of slow commands. [#17385](https://github.com/cockroachdb/cockroach/pull/17385)

<h3 id="v1.0.5-doc-updates">Doc Updates</h3>

- Added an [FAQ](../v1.0/frequently-asked-questions.html#why-does-cockroachdb-use-the-postgresql-wire-protocol-instead-of-the-mysql-protocol) on why CockroachDB uses the PostgreSQL wire protocol instead of the MySQL protocol. [#1845](https://github.com/cockroachdb/docs/pull/1845)
- Added a [known limitation](../v1.0/known-limitations.html#dropping-an-index-interleaved-into-another-index-on-the-same-table) around dropping an index interleaved into another index on the same table. [#1859](https://github.com/cockroachdb/docs/pull/1859)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.0.6-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.6.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.6.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.6.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.0.6-bug-fixes">Bug Fixes</h3>

- Fixed a bug in `ReverseScan` that could cause data to be missing from query results. [#17891](https://github.com/cockroachdb/cockroach/pull/17891) [#18385](https://github.com/cockroachdb/cockroach/pull/18385)
- Fixed a potential data corruption bug in RocksDB. [#18397](https://github.com/cockroachdb/cockroach/pull/18397)
- Fixed a panic in some `UNION` queries. [#17933](https://github.com/cockroachdb/cockroach/pull/17933)
- It is no longer possible to set the `kv.raft.command.max_size` cluster setting to a very low value (which could make the cluster inoperable). [#18016](https://github.com/cockroachdb/cockroach/pull/18016)
- Fixed a range lease bug that could make ranges unavailable. [#18218](https://github.com/cockroachdb/cockroach/pull/18218)
- Parallel statement execution is now disabled by default due to issues in handling retryable errors. [#18002](https://github.com/cockroachdb/cockroach/pull/18002) [#18332](https://github.com/cockroachdb/cockroach/pull/18332)
- Fixed a resource leak in diagnostics reporting [#18315](https://github.com/cockroachdb/cockroach/pull/18315)
- Host names are no longer included in diagnostics reports. [#18335](https://github.com/cockroachdb/cockroach/pull/18335)
- Increased logging to help diagnose certain issues. [#18229](https://github.com/cockroachdb/cockroach/pull/18229) [#18272](https://github.com/cockroachdb/cockroach/pull/18272) [#18282](https://github.com/cockroachdb/cockroach/pull/18282) [#18333](https://github.com/cockroachdb/cockroach/pull/18333)

<h3 id="v1.0.6-doc-updates">Doc Updates</h3>

- Updated the [Contribute to CockroachDB](https://wiki.crdb.io/wiki/spaces/CRDB/pages/73204033/Contributing+to+CockroachDB) page to provide guidelines on finding a project, determining its complexity, and learning what to expect in your collaboration with the Cockroach Labs team. [#1881](https://github.com/cockroachdb/docs/pull/1881)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.0.7-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.7.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.7.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.0.7.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.0.7-bug-fixes">Bug Fixes</h3>

- Fixed a leak of table leases that could grow to a point that a cluster becomes unusable. [#22563](https://github.com/cockroachdb/cockroach/pull/22563)
- When the log disk fills up, the process now crashes instead of hanging. [#22563](https://github.com/cockroachdb/cockroach/pull/22563)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-alpha.20170601-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170601.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170601.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170601.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-alpha.20170601-general-changes">General Changes</h3>

- CockroachDB now uses RocksDB 5.3.4 ([#15696](https://github.com/cockroachdb/cockroach/pull/15696)), protobuf 3.3.0 ([#15522](https://github.com/cockroachdb/cockroach/pull/15522)), and a newer version of gRPC ([#15991](https://github.com/cockroachdb/cockroach/pull/15991))
- Non-release binaries no longer send crash reports. [#15823](https://github.com/cockroachdb/cockroach/pull/15823)
- Some `make` targets have changed to follow convention. `make` by default now builds the binary without running tests. `make install` defaults to `/usr/local/bin/` instead of `$GOPATH/bin` (use `make install prefix=/path/` to change). `make check` is now an alias for `make test`; the former `make check` is now called `make lint`. [#15909](https://github.com/cockroachdb/cockroach/pull/15909) [#16030](https://github.com/cockroachdb/cockroach/pull/16030)
- The Kubernetes templates now use the latest production release instead of tracking testing releases. [#15878](https://github.com/cockroachdb/cockroach/pull/15878)

<h3 id="v1.1-alpha.20170601-sql-language-changes">SQL Language Changes</h3>

- The `information_schema.user_privileges` table is now supported. [#15745](https://github.com/cockroachdb/cockroach/pull/15745)
- The `ON UPDATE RESTRICT` and `ON DELETE RESTRICT` modifiers can now be used when creating foreign keys (this behavior is the default, but now it can be specified explicitly). [#15815](https://github.com/cockroachdb/cockroach/pull/15815)
- The hash functions `sha512()`, `fnv32()`, `fnv32a()`, `fnv64()`, `fnv64a()`, `crc32ieee()`, and `crc32c()` are now supported. All hash functions now accept multiple arguments and arguments of type `BYTES`. [#15828](https://github.com/cockroachdb/cockroach/pull/15828) [#15859](https://github.com/cockroachdb/cockroach/pull/15859)
- Casts to type `DECIMAL` now respect specified precision and scale. [#15834](https://github.com/cockroachdb/cockroach/pull/15834)
- A new aggregate function `xor_agg()` is now available. [#15831](https://github.com/cockroachdb/cockroach/pull/15831)
- Schema change commands now wait until the schema change is complete instead of starting it in the background. [#15598](https://github.com/cockroachdb/cockroach/pull/15598)
- It is now possible to `SELECT` from the result of a `SHOW` statement with the syntax `SELECT ... FROM [ SHOW ... ] WHERE ...` [#15590](https://github.com/cockroachdb/cockroach/pull/15590)
- It is now possible to `CREATE` a table and `ALTER` (or `DROP`) it in the same transaction. [#15929](https://github.com/cockroachdb/cockroach/pull/15929)
- The standard SQL syntax `FETCH FIRST N ROWS ONLY` is now supported as an alias for `LIMIT`. [#16083](https://github.com/cockroachdb/cockroach/pull/16083)

<h3 id="v1.1-alpha.20170601-command-line-interface-changes">Command-Line Interface Changes</h3>

- A `raw` mode has been added to the SQL shell's `display_format` options. [#15590](https://github.com/cockroachdb/cockroach/pull/15590)
- `cockroach zone set` with an incomplete config for the special system ranges now merges the given config with the default instead of using zeros. [#16048](https://github.com/cockroachdb/cockroach/pull/16048)
- Commands that create certificates will fail if asked to create a certificate that would expire after the corresponding CA. [#16055](https://github.com/cockroachdb/cockroach/pull/16055)
- The default duration of client and node certificates is now 5 years. [#16055](https://github.com/cockroachdb/cockroach/pull/16055)

<h3 id="v1.1-alpha.20170601-admin-ui-changes">Admin UI Changes</h3>

- The log viewer now shows more than just the first line of multi-line log entries. [#15949](https://github.com/cockroachdb/cockroach/pull/15949)
- A new query plan inspector is available at `/queryplan`. [#15908](https://github.com/cockroachdb/cockroach/pull/15908)
- Metrics are now reported about certificate expiration. [#16045](https://github.com/cockroachdb/cockroach/pull/16045)

<h3 id="v1.1-alpha.20170601-bug-fixes">Bug Fixes</h3>

- `MAX(bool)` and `MIN(bool)` no longer panic. [#15803](https://github.com/cockroachdb/cockroach/pull/15803)
- `SHOW GRANTS *` on an empty database now works correctly. [#15881](https://github.com/cockroachdb/cockroach/pull/15881)
- Fixed a data race involving transaction records. [#15882](https://github.com/cockroachdb/cockroach/pull/15882)
- `DECIMAL` types now report the correct precision and scale for compatibility with JDBC. [#15927](https://github.com/cockroachdb/cockroach/pull/15927)
- Fixed a panic when a removed replica attempts to get the range lease. [#15754](https://github.com/cockroachdb/cockroach/pull/15754)

<h3 id="v1.1-alpha.20170601-performance-improvements">Performance Improvements</h3>

- Raft logs are now cleaned up more aggressively when large commands (such as `RESTORE`) are used. [#15799](https://github.com/cockroachdb/cockroach/pull/15799)
- Reduced allocations when working with `DECIMAL` values. [#15829](https://github.com/cockroachdb/cockroach/pull/15829)
- Reduced lock contention during command evaluation. [#15935](https://github.com/cockroachdb/cockroach/pull/15935)
- Reduced lease durations to improve responsiveness to node failures. [#15331](https://github.com/cockroachdb/cockroach/pull/15331)
- Improved performance of queries that combine aggregate functions and `WHERE` clauses, such as `SELECT MAX(age) FROM customers WHERE name >= 'Albert' AND name <= 'Bernie'`. [#13194](https://github.com/cockroachdb/cockroach/pull/13194)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-alpha.20170608-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170608.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170608.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170608.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-alpha.20170608-general-changes">General Changes</h3>

- CockroachDB now uses Go 1.8.3 (fixing a security issue when elliptic curve certificates are used, as well as a panic). [#16133](https://github.com/cockroachdb/cockroach/pull/16133)

<h3 id="v1.1-alpha.20170608-sql-language-changes">SQL Language Changes</h3>

- The `UUID` type is now supported. [#15930](https://github.com/cockroachdb/cockroach/pull/15930)
- New `SHOW BACKUP` statement displays metadata about a backup. [#16186](https://github.com/cockroachdb/cockroach/pull/16186)
- The `USE` statement is now recognized as an alias for `SET DATABASE =`. [#16293](https://github.com/cockroachdb/cockroach/pull/16293)
- The `SET NAMES 'utf8'` statement is now recognized as an alias for `SET client_encoding 'utf8'`. Encodings other than UTF-8 are still not supported. [#16305](https://github.com/cockroachdb/cockroach/pull/16305)
- [`ALTER TABLE...ADD FOREIGN KEY`](../v1.1/add-constraint.html) no longer attempts to create an index on the source table. [#16175](https://github.com/cockroachdb/cockroach/pull/16175)
- Fixed decoding of very large [`DECIMAL`](../v1.1/decimal.html) values. [#16152](https://github.com/cockroachdb/cockroach/pull/16152)
- If a prepared statement is invalidated by a schema change, it now returns an error instead of an incorrect result. [#16089](https://github.com/cockroachdb/cockroach/pull/16089)
- `INT2VECTOR` is now zero-indexed. [#16289](https://github.com/cockroachdb/cockroach/pull/16289)
- Timestamp parsing is now consistent between prepared and non-prepared statements. [#16049](https://github.com/cockroachdb/cockroach/pull/16049)
- The ANSI SQL syntax `FETCH FIRST N ROWS ONLY` is now supported as an alias for `LIMIT`. [#16114](https://github.com/cockroachdb/cockroach/pull/16114)
- Foreign key constraint errors now return the same error code as PostgreSQL. [#16319](https://github.com/cockroachdb/cockroach/pull/16319)

<h3 id="v1.1-alpha.20170608-admin-interface-changes">Admin Interface Changes</h3>

- The [`cockroach cert list`](../v1.1/create-security-certificates.html) command now lists the number of certificates in the CA cert file. [#16101](https://github.com/cockroachdb/cockroach/pull/16101)
- All pages under the `/debug/` namespace are now guarded by the `server.remote_debugging.mode` setting. [#16238](https://github.com/cockroachdb/cockroach/pull/16238)
- The new `trace.debug.enable` cluster setting controls the collection of tracing data for the `/debug/requests` pages. The setting `trace.lightstep.token` can be used to send tracing data to LightStep. [#16265](https://github.com/cockroachdb/cockroach/pull/16265)
- The sample monitoring configs now include alerts about certificate expiration. [#16329](https://github.com/cockroachdb/cockroach/pull/16329)

<h3 id="v1.1-alpha.20170608-bug-fixes">Bug Fixes</h3>

- Fixed several bugs with the `OFFSET` clause, including incorrect results and a panic when it is used without a `LIMIT`. [#16109](https://github.com/cockroachdb/cockroach/pull/16109)
- Fixed the behavior of `LIMIT` in index joins. [#16339](https://github.com/cockroachdb/cockroach/pull/16339)
- Fixed the behavior of `DISTINCT` with omitted columns. [#16307](https://github.com/cockroachdb/cockroach/pull/16307)
- [Dropping a table](../v1.1/drop-table.html) with a self-referential foreign key no longer results in `broken fk backward reference` errors. [#16316](https://github.com/cockroachdb/cockroach/pull/16316)
- The replica allocator will no longer remove replicas from a down node if there are no live nodes to receive them. [#16139](https://github.com/cockroachdb/cockroach/pull/16139)
- Improved tracking of memory allocated by SQL functions. [#15402](https://github.com/cockroachdb/cockroach/pull/15402)
- Improved thread safety of tracing. [#16114](https://github.com/cockroachdb/cockroach/pull/16114)
- Reverted a change to lease durations from `v1.1-alpha.20170601`. [#16148](https://github.com/cockroachdb/cockroach/pull/16148)
- Fixed an RPC retry that could result in statements being applied twice. [#16181](https://github.com/cockroachdb/cockroach/pull/16181)
- `ConditionalPut` failures during initial migrations are now handled gracefully. [#16224](https://github.com/cockroachdb/cockroach/pull/16224)
- Fixed a `span used after call to Finish` panic during shutdown. [#16277](https://github.com/cockroachdb/cockroach/pull/16277)

<h3 id="v1.1-alpha.20170608-performance-improvements">Performance Improvements</h3>

- Introduced flow control for raft proposals. Slow replicas now apply backpressure instead of allowing the raft log to grow too large. [#15802](https://github.com/cockroachdb/cockroach/pull/15802)
- Improved performance of MVCC garbage collection. [#16129](https://github.com/cockroachdb/cockroach/pull/16129)  [#16166](https://github.com/cockroachdb/cockroach/pull/16166) [#16210](https://github.com/cockroachdb/cockroach/pull/16210)
- Reduced unhelpful retries of slow commands. [#16205](https://github.com/cockroachdb/cockroach/pull/16205)
- Improved performance of `RESTORE`. [#16077](https://github.com/cockroachdb/cockroach/pull/16077) [#15946](https://github.com/cockroachdb/cockroach/pull/15946) [#16140](https://github.com/cockroachdb/cockroach/pull/16140)
- Improved efficiency of SQL planning. [#16040](https://github.com/cockroachdb/cockroach/pull/16040)

<h3 id="v1.1-alpha.20170608-doc-updates">Doc Updates</h3>

- Added a [guide](https://github.com/cockroachdb/cockroach/blob/master/docs/first-pr.md) for new contributors submitting their first PR. [#16078](https://github.com/cockroachdb/cockroach/pull/16078)
- Added a [codelab](https://github.com/cockroachdb/cockroach/blob/master/docs/codelabs/00-sql-function.md) guiding a new contributor through the process of adding a SQL function. [#16259](https://github.com/cockroachdb/cockroach/pull/16259)
- Added an [FAQ](../v1.1/operational-faqs.html#why-does-cockroachdb-collect-anonymized-cluster-usage-details-by-default) about CockroachDB's default diagnostics reporting. [#1514](https://github.com/cockroachdb/docs/pull/1514)
- Clarified that when [`ORDER BY`](../v1.1/select.html#sorting-retrieved-values) is not included in a `SELECT` query, rows are not sorted by any consistent criteria. [#1526](https://github.com/cockroachdb/docs/pull/1526)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-alpha.20170622-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170622.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170622.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170622.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-alpha.20170622-general-changes">General Changes</h3>

- Building from the source repo now works when `$GOPATH` is unset. [#16364](https://github.com/cockroachdb/cockroach/pull/16364)
- CockroachDB now uses `dep` instead of `glide` to manage Go dependencies. <a href="https://github.com/cockroachdb/cockroach/pull/16275" data-proofer-ignore>#16275</a>
- gRPC has been updated to version 1.4.0. [#16496](https://github.com/cockroachdb/cockroach/pull/16496)
- The APD library has been updated, improving performance of [`DECIMAL`](../v1.1/decimal.html) operations. [#16520](https://github.com/cockroachdb/cockroach/pull/16520)

<h3 id="v1.1-alpha.20170622-sql-language-changes">SQL Language Changes</h3>

- New `SHOW SESSIONS` and `SHOW QUERIES` statements display active sessions and queries on a node or cluster. [#16072](https://github.com/cockroachdb/cockroach/pull/16072)
- The `DROP USER` statement is now supported. [#16442](https://github.com/cockroachdb/cockroach/pull/16442)
- The `BEGIN` statement now accepts the `READ WRITE` modifier for compatibility with the Go `lib/pq` driver. [#16387](https://github.com/cockroachdb/cockroach/pull/16387)
- The `pg_catalog.pg_table_is_visible()` function is now implemented, improving compatibility with several ORMs. [#16410](https://github.com/cockroachdb/cockroach/pull/16410)
- A new session-based tracing interface is available with `SET TRACE=(ON|OFF)` and `SELECT * from crdb_internal.session_trace`. [#16253](https://github.com/cockroachdb/cockroach/pull/16253)
- The beginning and end of schema changes are now recorded in the `crdb_internal.jobs` table. [#15936](https://github.com/cockroachdb/cockroach/pull/15936)
- `SET "time zone"` is now recognized as equivalent to `SET TIME ZONE`. [#16459](https://github.com/cockroachdb/cockroach/pull/16459)
- `SET client_encoding='unicode'` is now recognized as equivalent to `UTF-8`. [#16511](https://github.com/cockroachdb/cockroach/pull/16511)

<h3 id="v1.1-alpha.20170622-admin-ui-changes">Admin UI Changes</h3>

- All pages under `/debug/` are now controlled by the `server.remote_debugging.mode` setting. [#16341](https://github.com/cockroachdb/cockroach/pull/16341)
- Several debug pages now work even when the system config is unavailable. [#16423](https://github.com/cockroachdb/cockroach/pull/16423)
- Crash reports no longer include hostnames. [#16332](https://github.com/cockroachdb/cockroach/pull/16332)

<h3 id="v1.1-alpha.20170622-bug-fixes">Bug Fixes</h3>

- [Backup URLs](../v1.1/backup.html#backup-file-urls) are now sanitized before being written to the system jobs table. [#16370](https://github.com/cockroachdb/cockroach/pull/16370)
- Improved the ability of the system to recover when all nodes are stopped at once, then all but one are restarted. [#16347](https://github.com/cockroachdb/cockroach/pull/16347)
- Outer joins no longer incorrectly return extra rows when there are multiple rows with the same value in the joined columns. [#16372](https://github.com/cockroachdb/cockroach/pull/16372)
- [`RESTORE`](../v1.1/restore.html) no longer attempts to split at invalid keys. [#16375](https://github.com/cockroachdb/cockroach/pull/16375)
- Fixed a panic with message `indexed var linked to different container`. [#16434](https://github.com/cockroachdb/cockroach/pull/16434)
- Fixed `quota pool no longer in use` errors when leadership and the range lease are not co-located. [#16413](https://github.com/cockroachdb/cockroach/pull/16413)
- Improved error handling in the `COPY FROM` command. [#16393](https://github.com/cockroachdb/cockroach/pull/16393)
- Casting a string to `regtype` now uses the full type parser. [#16476](https://github.com/cockroachdb/cockroach/pull/16476)
- Some fatal errors now end the process immediately instead of unwinding the stack and allowing new errors to occur and mask the original failure. [#16482](https://github.com/cockroachdb/cockroach/pull/16482)
- The system will try to avoid replicating to unstable two-replica configurations unless a third candidate is also available. [#16411](https://github.com/cockroachdb/cockroach/pull/16411)
- Fixed a panic in the timestamp cache. [#16503](https://github.com/cockroachdb/cockroach/pull/16503)

<h3 id="v1.1-alpha.20170622-performance-improvements">Performance Improvements</h3>

- Adjusted timeouts used in internal retry loops. [#16357](https://github.com/cockroachdb/cockroach/pull/16357)
- Reduced some redundant logging. [#16358](https://github.com/cockroachdb/cockroach/pull/16358)
- Improved performance under high-contention workloads. [#16256](https://github.com/cockroachdb/cockroach/pull/16256)
- Reduced command queue overhead in read-heavy workloads. [#16360](https://github.com/cockroachdb/cockroach/pull/16360)
- Prepared statements are now included in memory accounting. [#16433](https://github.com/cockroachdb/cockroach/pull/16433) [#16470](https://github.com/cockroachdb/cockroach/pull/16470)
- Snappy compression is now enabled by default for inter-node communication. [#16432](https://github.com/cockroachdb/cockroach/pull/16432) [#16451](https://github.com/cockroachdb/cockroach/pull/16451)
- The GC queue now works in smaller chunks. [#16299](https://github.com/cockroachdb/cockroach/pull/16299)
- Smoothed statistics used in rebalancing. [#16464](https://github.com/cockroachdb/cockroach/pull/16464)
- Improved performance of the distSQL row fetcher. [#16446](https://github.com/cockroachdb/cockroach/pull/16446) [#16467](https://github.com/cockroachdb/cockroach/pull/16467)
- OpenTracing spans are now identified by name instead of `file:lineno`. [#16397](https://github.com/cockroachdb/cockroach/pull/16397)
- Read-only batches now reuse iterators when possible. [#16406](https://github.com/cockroachdb/cockroach/pull/16406)
- The hash joiner now looks ahead on both streams to see if one of them is very small. [#16402](https://github.com/cockroachdb/cockroach/pull/16402)

<h3 id="v1.1-alpha.20170622-doc-updates">Doc Updates</h3>

- Improved [basic hardware recommendations](../v1.1/recommended-production-settings.html#hardware) for a CockroachDB cluster. [#1596](https://github.com/cockroachdb/docs/pull/1596)
- Improved the [`REVOKE`](../v1.1/revoke.html) documentation. [#1595](https://github.com/cockroachdb/docs/pull/1595)
- Updated the [Node.js transaction wrapper](../v1.1/build-a-nodejs-app-with-cockroachdb.html#transaction-with-retry-logic) to allow values to be returned to the client. [#1603](https://github.com/cockroachdb/docs/pull/1603)
- Updated the instructions for [orchestrating a local CockroachDB cluster with Kubernetes Minikube](../v1.1/orchestrate-cockroachdb-with-kubernetes.html). [#1616](https://github.com/cockroachdb/docs/pull/1616)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-alpha.20170629-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170629.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170629.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170629.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-alpha.20170629-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- If the server's own hostname cannot be resolved, CockroachDB reports an error at startup instead of starting a node that will be unable to participate in a cluster. Local test clusters may need to pass `--host=localhost` to avoid this error. [#16177](https://github.com/cockroachdb/cockroach/pull/16177)
- The `EXPLAIN (TRACE)` statement has been removed because the query being traced would unintentionally get executed. It has been replaced by `SHOW TRACE FOR ...`, so that the [`EXPLAIN`](../v1.1/explain.html) commands can remain read-only. [#16524](https://github.com/cockroachdb/cockroach/pull/16524)

<h3 id="v1.1-alpha.20170629-known-limitations">Known Limitations</h3>

- This release has a regression in replica balancing. [#16742](https://github.com/cockroachdb/cockroach/issues/16742)

<h3 id="v1.1-alpha.20170629-sql-language-changes">SQL Language Changes</h3>

- The new `SHOW SESSION TRACE` statement can be used to view trace data collected with the `SET TRACE=on|off` statement introduced in a previous alpha. [#16524](https://github.com/cockroachdb/cockroach/pull/16524)
- The new `SHOW KV TRACE FOR ...` or `SET trace=on,kv; ...; SHOW SESSION KV TRACE` statements can be used to trace KV operations. [#16622](https://github.com/cockroachdb/cockroach/pull/16622)
- Schema changes now report their progress in the jobs table. [#16636](https://github.com/cockroachdb/cockroach/pull/16636)
- The `PREPARE` statement and `SELECT ... FROM [...]` syntax now accept any statement that can be `EXPLAIN`ed. [#16524](https://github.com/cockroachdb/cockroach/pull/16524)
- The statement `SET datestyle='ISO'` is now supported for compatibility with PostgreSQL clients. Values other than `ISO` are not supported. [#16557](https://github.com/cockroachdb/cockroach/pull/16557)

<h3 id="v1.1-alpha.20170629-command-line-interface-changes">Command-Line Interface Changes</h3>

- The [`cockroach sql`](../v1.1/use-the-built-in-sql-client.html) command now tracks the current database and will restore it when a connection must be recreated. [#16589](https://github.com/cockroachdb/cockroach/pull/16589)

<h3 id="v1.1-alpha.20170629-admin-interface-changes">Admin Interface Changes</h3>

- The `/health` endpoint can now be accessed over HTTP even when the server is configured for secure mode. This works around limitations of some load balancers. [#16609](https://github.com/cockroachdb/cockroach/pull/16609)

<h3 id="v1.1-alpha.20170629-bug-fixes">Bug Fixes</h3>

- The admin UI no longer intermittently gets stuck until the server is restarted. [#16612](https://github.com/cockroachdb/cockroach/pull/16612)
- The GC threshold is now copied when ranges split. [#16485](https://github.com/cockroachdb/cockroach/pull/16485)
- The `IN` operator now works with tuples of `OIDs`. [#16644](https://github.com/cockroachdb/cockroach/pull/16644)
- The `SHOW {QUERIES,SESSIONS}` statement no longer produces invalid UTF-8 when truncating strings. [#16602](https://github.com/cockroachdb/cockroach/pull/16602)

<h3 id="v1.1-alpha.20170629-performance-improvements">Performance Improvements</h3>

- The intent resolver now works in smaller batches, reducing memory spikes after large transactions. [#16632](https://github.com/cockroachdb/cockroach/pull/16632)
- MVCC garbage collection now works in smaller batches, avoiding problems with refreshing leases. [#16637](https://github.com/cockroachdb/cockroach/pull/16637)
- Added a special case for `COUNT(*)` in the distributed SQL engine. [#16533](https://github.com/cockroachdb/cockroach/pull/16533)
- Reduced overhead of session tracking. [#16543](https://github.com/cockroachdb/cockroach/pull/16543)
- Limited the number of intents printed in logs and traces. [#16560](https://github.com/cockroachdb/cockroach/pull/16560)
- Reduced allocations when tracing is not enabled. [#16545](https://github.com/cockroachdb/cockroach/pull/16545)
- Load balancing is now based on data size instead of range count. [#16575](https://github.com/cockroachdb/cockroach/pull/16575)

<h3 id="v1.1-alpha.20170629-new-rfcs">New RFCs</h3>

- Array value encoding. [#16172](https://github.com/cockroachdb/cockroach/pull/16172)
- Query cancellation. [#16417](https://github.com/cockroachdb/cockroach/pull/16417)
- Algebraic data types. [#16240](https://github.com/cockroachdb/cockroach/pull/16240)

<h3 id="v1.1-alpha.20170629-doc-updates">Doc Updates</h3>

- The new [Automatic Cloud Migration](../v1.1/demo-automatic-cloud-migration.html) tutorial shows you how to use a local cluster to simulate deploying across clouds and then migrating from one cloud to another with no downtime. [#1610](https://github.com/cockroachdb/docs/pull/1610)
- Expanded details on [how CockroachDB handles unsynchronized clocks](../v1.1/recommended-production-settings.html#clock-synchronization). [#1636](https://github.com/cockroachdb/docs/pull/1636)
- Added a "copy to clipboard" option to code samples. [#1624](https://github.com/cockroachdb/docs/pull/1624) [#1632](https://github.com/cockroachdb/docs/pull/1632)
- Updated the [Node.js transaction code sample](../v1.1/build-a-nodejs-app-with-cockroachdb.html) to perform a `SELECT` as part of the transaction and return the results through the transaction wrapper. [#1615](https://github.com/cockroachdb/docs/pull/1615)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-alpha.20170713-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170713.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170713.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170713.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-alpha.20170713-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- The `EXPLAIN (DEBUG)` command has been removed. It is replaced by `SHOW TRACE FOR`. [#16694](https://github.com/cockroachdb/cockroach/pull/16694)

<h3 id="v1.1-alpha.20170713-general-changes">General Changes</h3>

- CockroachDB now uses RocksDB 5.5.1, `jemalloc` 5.0.1, Snappy 1.1.5, and protobuf 3.3.2. [#16852](https://github.com/cockroachdb/cockroach/pull/16852) [#16872](https://github.com/cockroachdb/cockroach/pull/16872) [#16879](https://github.com/cockroachdb/cockroach/pull/16879) [#16909](https://github.com/cockroachdb/cockroach/pull/16909)
- C++ dependencies are now managed via submodules. <a href="https://github.com/cockroachdb/cockroach/pull/16859" data-proofer-ignore>#16859</a>

<h3 id="v1.1-alpha.20170713-sql-language-changes">SQL Language Changes</h3>

- Additional numeric types `INT2`, `INT8`, `FLOAT4`, and `FLOAT8` are now supported. [#16720](https://github.com/cockroachdb/cockroach/pull/16720)
- The new `SHOW JOBS` statement can show the state of backups, restores, and schema changes. [#16733](https://github.com/cockroachdb/cockroach/pull/16733)
- The new `DISCARD ALL` statement can be used to reset all session state. [#16746](https://github.com/cockroachdb/cockroach/pull/16746)
- The new `node_id` session variable contains the ID of the gateway node. [#16703](https://github.com/cockroachdb/cockroach/pull/16703)
- The new `trace.zipkin.collector` [cluster setting](../v1.1/cluster-settings.html) can now be used to report trace data to Zipkin. [#16903](https://github.com/cockroachdb/cockroach/pull/16903)
- The [`SHOW CREATE TABLE`](../v1.1/show-create-table.html) statement and similar introspection mechanisms now remember more precise type information, such as whether the column was created as `INT8` or `INT64`. [#16548](https://github.com/cockroachdb/cockroach/pull/16548)
- It is now possible to query `information_schema` or `pg_catalog` for other databases. [#16760](https://github.com/cockroachdb/cockroach/pull/16760)
- `ROLLBACK TO SAVEPOINT` is now accepted at any time. [#16846](https://github.com/cockroachdb/cockroach/pull/16846)
- Improved type inference for `ON CONFLICT DO UPDATE` clauses. [#16910](https://github.com/cockroachdb/cockroach/pull/16910)

<h3 id="v1.1-alpha.20170713-command-line-interface-changes">Command-Line Interface Changes</h3>

- Colored log output is now used on more terminal types. [#16710](https://github.com/cockroachdb/cockroach/pull/16710)
- The [SQL shell](../v1.1/use-the-built-in-sql-client.html) prints the client and server version number at startup. [#16703](https://github.com/cockroachdb/cockroach/pull/16703)
- Improved handling of multi-line transactions. [#16848](https://github.com/cockroachdb/cockroach/pull/16848)

<h3 id="v1.1-alpha.20170713-bug-fixes">Bug Fixes</h3>

- Fixed a consistency problem that could result when a transaction commit races with a lease transfer. [#16759](https://github.com/cockroachdb/cockroach/pull/16759)
- Fixed a name escaping bug in [`SHOW CREATE TABLE`](../v1.1/show-create-table.html) and [view definitions](../v1.1/create-view.html). [#16782](https://github.com/cockroachdb/cockroach/pull/16782) [#16815](https://github.com/cockroachdb/cockroach/pull/16815)
- Casting a string to `regtype` now uses the full type parser. [#16774](https://github.com/cockroachdb/cockroach/pull/16774)
- Unary operators (`+`, `-`, and `~`) are formatted without a space. [#16658](https://github.com/cockroachdb/cockroach/pull/16658)
- Improved garbage collection of removed replicas. [#16752](https://github.com/cockroachdb/cockroach/pull/16752)
- Fixed an ignored error return. [#13607](https://github.com/cockroachdb/cockroach/pull/13607)
- Fixed incorrect rewrites of long statements in the SQL history. [#16714](https://github.com/cockroachdb/cockroach/pull/16714)
- Improved error handling in node liveness updates. [#16698](https://github.com/cockroachdb/cockroach/pull/16698)
- Added support for `NULL` columns in `UNION`. [#16757](https://github.com/cockroachdb/cockroach/pull/16757)
- Improved error message for `TransactionStatusError`. [#16725](https://github.com/cockroachdb/cockroach/pull/16725)
- Improved truncation of unicode SQL strings. [#16805](https://github.com/cockroachdb/cockroach/pull/16805)
- Fixed a panic when an invalid `SAVEPOINT` name is used. [#16834](https://github.com/cockroachdb/cockroach/pull/16834)
- A failed [`BEGIN`](../v1.1/begin-transaction.html) statement no longer leaves the connection in a broken state. [#16863](https://github.com/cockroachdb/cockroach/pull/16863)
- The [`SHOW CREATE TABLE`](../v1.1/show-create-table.html) statement no longer omits indexes that are used in foreign keys. [#16861](https://github.com/cockroachdb/cockroach/pull/16861)

<h3 id="v1.1-alpha.20170713-performance-improvements">Performance Improvements</h3>

- Increased the GRPC message size limit. [#16685](https://github.com/cockroachdb/cockroach/pull/16685)
- Improved efficiency of non-incremental backups. [#16690](https://github.com/cockroachdb/cockroach/pull/16690)
- Improved performance of incremental backups [#16743](https://github.com/cockroachdb/cockroach/pull/16743)
- Reverted a replica balancing change that led to thrashing. [#16772](https://github.com/cockroachdb/cockroach/pull/16772)
- Replica balancing avoids removing a replica that is a necessary part of the latest quorum. [#16539](https://github.com/cockroachdb/cockroach/pull/16539)
- Improved performance of queries run under `SHOW`. [#16782](https://github.com/cockroachdb/cockroach/pull/16782)
- Table IDs are now generated non-transactionally, reducing the likelihood of transaction retry errors during table creation. [#16704](https://github.com/cockroachdb/cockroach/pull/16704)
- Improve performance of the timestamp cache. [#16801](https://github.com/cockroachdb/cockroach/pull/16801)
- Reduced mutex contention. [#16798](https://github.com/cockroachdb/cockroach/pull/16798) [#16807](https://github.com/cockroachdb/cockroach/pull/16807) [#16822](https://github.com/cockroachdb/cockroach/pull/16822) [#16877](https://github.com/cockroachdb/cockroach/pull/16877) [#16896](https://github.com/cockroachdb/cockroach/pull/16896)
- The first statement of a transaction is now retried automatically instead of returning `transaction retry` errors. [#16719](https://github.com/cockroachdb/cockroach/pull/16719)
- Reduced log spam. [#16900](https://github.com/cockroachdb/cockroach/pull/16900) [#16917](https://github.com/cockroachdb/cockroach/pull/16917)
- Reduced write amplification, improving write performance by 5%. [#16905](https://github.com/cockroachdb/cockroach/pull/16905)
- Increased write buffer size. [#16929](https://github.com/cockroachdb/cockroach/pull/16929)

<h3 id="v1.1-alpha.20170713-doc-updates">Doc Updates</h3>

- Added a sample [secure Kubernetes configuration](https://github.com/cockroachdb/cockroach/tree/master/cloud/kubernetes). [#16486](https://github.com/cockroachdb/cockroach/pull/16486)
- Updated the [`CONTRIBUTING.md`](https://github.com/cockroachdb/docs/blob/master/CONTRIBUTING.md) file to better explain page front-matter options and the docs sidebar. [#1669](https://github.com/cockroachdb/docs/pull/1669)
- Improved the certificate generation workflow in the [Manual Deployment](../v1.1/manual-deployment.html) and [Cloud Deployment](../v1.1/manual-deployment.html) tutorials. [#1691](https://github.com/cockroachdb/docs/pull/1691)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-alpha.20170720-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170720.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170720.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170720.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-alpha.20170720-build-changes">Build changes</h3>

- CockroachDB binary releases are now compatible with older CPUs (previous builds required SSE4.2; new ones only require SSE3). [#16949](https://github.com/cockroachdb/cockroach/pull/16949)
- CockroachDB has reverted from `jemalloc` 5.0.1 to 4.5 due to observed memory leaks. [#17055](https://github.com/cockroachdb/cockroach/pull/17055)

<h3 id="v1.1-alpha.20170720-sql-language-changes">SQL Language Changes</h3>

- New syntax `ORDER BY PRIMARY KEY tbl` or `ORDER BY INDEX tbl@idx` can be used as shorthand to sort results by the columns in an index. [#17023](https://github.com/cockroachdb/cockroach/pull/17023)
- Parentheses are now optional when calling the `current_schema` function, improving compatibility with PostgreSQL. [#16921](https://github.com/cockroachdb/cockroach/pull/16921)
- The text format of [`DECIMAL`](../v1.1/decimal.html) values now uses scientific notation when appropriate. [#17029](https://github.com/cockroachdb/cockroach/pull/17029)

<h3 id="v1.1-alpha.20170720-command-line-interface-changes">Command-Line Interface Changes</h3>

- The [`cockroach sql`](../v1.1/use-the-built-in-sql-client.html) shell now correctly handles errors that occur once some results have been received. [#17042](https://github.com/cockroachdb/cockroach/pull/17042)

<h3 id="v1.1-alpha.20170720-admin-ui-changes">Admin UI Changes</h3>

- New graphs for "live bytes per store" and "keys written per second per store". [#16982](https://github.com/cockroachdb/cockroach/pull/16982)

<h3 id="v1.1-alpha.20170720-bug-fixes">Bug Fixes</h3>

- Fixed spurious errors when updating primary key columns while a schema change is in progress. [#16866](https://github.com/cockroachdb/cockroach/pull/16866)
- Fixed issues with [diagnostic reporting](../v1.1/diagnostics-reporting.html). [#16955](https://github.com/cockroachdb/cockroach/pull/16955)
- Fixed a race in distsql draining. [#17012](https://github.com/cockroachdb/cockroach/pull/17012)

<h3 id="v1.1-alpha.20170720-performance-improvements">Performance Improvements</h3>

- The [`DROP TABLE`](../v1.1/drop-table.html) statement now returns as soon as the table name is no longer in use, instead of waiting for all data to be deleted. [#17016](https://github.com/cockroachdb/cockroach/pull/17016)
- Improved batching of disk syncs, improving write throughput and latency. [#16942](https://github.com/cockroachdb/cockroach/pull/16942) [#16976](https://github.com/cockroachdb/cockroach/pull/16976)
- Queries containing `VALUES` clauses can now use the distributed SQL engine. [#16849](https://github.com/cockroachdb/cockroach/pull/16849)
- Reduced lock contention in node liveness updates. [#16918](https://github.com/cockroachdb/cockroach/pull/16918)
- Improved performance of the raft storage layer. [#16945](https://github.com/cockroachdb/cockroach/pull/16945)
- Improved performance of large batches spanning multiple ranges. [#16946](https://github.com/cockroachdb/cockroach/pull/16946)
- Removed all non-test uses of `reflect.DeepEqual`. [#16960](https://github.com/cockroachdb/cockroach/pull/16960)
- Fixed "context cancellation after 0.0s" log spam. [#17014](https://github.com/cockroachdb/cockroach/pull/17014)
- Improved implementation of `ALTER TABLE SCATTER`. [#16249](https://github.com/cockroachdb/cockroach/pull/16249)

<h3 id="v1.1-alpha.20170720-enterprise-edition-changes">Enterprise Edition Changes</h3>

- New command `cockroach load csv` can convert CSV files into a format compatible with `RESTORE`. [#16611](https://github.com/cockroachdb/cockroach/pull/16611)
- Reduced write amplification in `RESTORE`. [#16990](https://github.com/cockroachdb/cockroach/pull/16990) [#16924](https://github.com/cockroachdb/cockroach/pull/16924)
- Improved performance of SSTable ingestion. [#17018](https://github.com/cockroachdb/cockroach/pull/17018)

<h3 id="v1.1-alpha.20170720-doc-updates">Doc Updates</h3>

- New RFCs: monitor jobs from SQL ([#16688](https://github.com/cockroachdb/cockroach/pull/16688)), resume interrupted backup/restore jobs ([#16633](https://github.com/cockroachdb/cockroach/pull/16633))
- Updated the sample [secure Kubernetes configuration](https://github.com/cockroachdb/cockroach/tree/master/cloud/kubernetes). [#16740](https://github.com/cockroachdb/cockroach/pull/16740)
- Added docs on the [cluster and version details](../v1.1/use-the-built-in-sql-client.html#sql-shell-welcome-changed-in-v1-1) that are printed upon connecting the built-in SQL shell to a node. [#1714](https://github.com/cockroachdb/docs/pull/1714)
- Improved the UX of the [Install CockroachDB](../v1.1/install-cockroachdb.html) page. [#1711](https://github.com/cockroachdb/docs/pull/1711)
- Completed documentation on the [`UPDATE`](../v1.1/update.html) statement. [#1707](https://github.com/cockroachdb/docs/pull/1707)
- Published a [video demo of cross-cloud deployment and migration](../v1.1/demo-automatic-cloud-migration.html#watch-a-live-demo). [#1702](https://github.com/cockroachdb/docs/pull/1702)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-alpha.20170803-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170803.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170803.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170803.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-alpha.20170803-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- Table and column names in double quotes are now case-sensitive (same as in PostgreSQL). [#16884](https://github.com/cockroachdb/cockroach/pull/16884)
- The `SHOW SESSION TRACE` statement is now [`SHOW TRACE FOR SESSION`](../v1.1/show-vars.html). The `SET/SHOW TRACE` statements are now `SET/SHOW TRACING`. [#17033](https://github.com/cockroachdb/cockroach/pull/17033)
- It is no longer possible to drop columns in tables depended on by views. This is an overly-broad change to avoid schema changes that might break views; it will be narrowed in the future. [#17280](https://github.com/cockroachdb/cockroach/pull/17280)

<h3 id="v1.1-alpha.20170803-build-changes">Build Changes</h3>

- It is now possible to build CockroachDB Enterprise Edition for Windows. [#17035](https://github.com/cockroachdb/cockroach/pull/17035)
- `make help` in a source checkout now prints documentation for the available build targets. [#17056](https://github.com/cockroachdb/cockroach/pull/17056)
- CockroachDB now uses gRPC version 1.5.0. [#17166](https://github.com/cockroachdb/cockroach/pull/17166)

<h3 id="v1.1-alpha.20170803-sql-language-changes">SQL Language Changes</h3>

- New statement [`CANCEL QUERY`](../v1.1/cancel-query.html) can be used to cancel a query in progress. [#17003](https://github.com/cockroachdb/cockroach/pull/17003)
- A limited form of one-dimensional `ARRAY` columns are now supported. [#16764](https://github.com/cockroachdb/cockroach/pull/16764) [#17231](https://github.com/cockroachdb/cockroach/pull/17231)
- `OUTER JOIN` statements now use the distributed SQL execution engine. [#17017](https://github.com/cockroachdb/cockroach/pull/17017)
- Some new syntactic forms for table references with aliases are now supported. [#17031](https://github.com/cockroachdb/cockroach/pull/17031)
- Strings within arrays are now formatted consistently with PostgreSQL. [#17069](https://github.com/cockroachdb/cockroach/pull/17069)
- [Transactions](../v1.1/transactions.html) can now see their own changes to table schemas. [#16988](https://github.com/cockroachdb/cockroach/pull/16988)
- `RETURNING` clauses now accept fully-qualified table names. [#17293](https://github.com/cockroachdb/cockroach/pull/17293)
- Improved handling of null as a function argument. [#17264](https://github.com/cockroachdb/cockroach/pull/17264)

<h3 id="v1.1-alpha.20170803-command-line-interface-changes">Command-Line Interface Changes</h3>

- A new `cockroach init` command can be used in place of starting one node without the `--join` flag. [#16371](https://github.com/cockroachdb/cockroach/pull/16371)

<h3 id="v1.1-alpha.20170803-bug-fixes">Bug Fixes</h3>

- We removed a behavior causing statements in the first batch of a transaction to essentially defer their retryable errors until COMMIT; now, instead, we automatically retry statements in the first batch. As a result, fewer retryable errors should be encountered by COMMIT. [#16874](https://github.com/cockroachdb/cockroach/pull/16874)
- Fixed a race condition that could lead to serializability violations when requests race with a lease transfer. [#17109](https://github.com/cockroachdb/cockroach/pull/17109)
- Fixed a potential raft election issue during range splits. [#17051](https://github.com/cockroachdb/cockroach/pull/17051)
- Fixed a use-after-close for parallelized statements. [#17126](https://github.com/cockroachdb/cockroach/pull/17126)
- Fixed some panics in `ORDER BY INDEX`. [#17314](https://github.com/cockroachdb/cockroach/pull/17314)

<h3 id="v1.1-alpha.20170803-performance-improvements">Performance Improvements</h3>

- The [`TRUNCATE`](../v1.1/truncate.html) statement now works by renaming the table and asynchronously garbage collecting the data, so it is much faster but no longer transactional (similar to PostgreSQL). [#17045](https://github.com/cockroachdb/cockroach/pull/17045)
- Fixed a memory leak in the HTTP layer. [#17080](https://github.com/cockroachdb/cockroach/pull/17080)
- Raft log truncations are now more efficient. [#16993](https://github.com/cockroachdb/cockroach/pull/16993)
- Fixed a regression that caused a node to talk to itself over the network. [#17196](https://github.com/cockroachdb/cockroach/pull/17196)
- Improved networking efficiency when tracing is disabled. [#17185](https://github.com/cockroachdb/cockroach/pull/17185)
- Reduced redundant trace messages. [#17182](https://github.com/cockroachdb/cockroach/pull/17182)
- Added a fast path for committing read-only transactions. [#17128](https://github.com/cockroachdb/cockroach/pull/17128)
- Memory footprints of various internal structures have been reduced. [#17089](https://github.com/cockroachdb/cockroach/pull/17089) [#17106](https://github.com/cockroachdb/cockroach/pull/17106) [#17138](https://github.com/cockroachdb/cockroach/pull/17138) [#17137](https://github.com/cockroachdb/cockroach/pull/17137) [#17152](https://github.com/cockroachdb/cockroach/pull/17152)
- Table descriptors are now passed by reference instead of value. [#17100](https://github.com/cockroachdb/cockroach/pull/17100)

<h3 id="v1.1-alpha.20170803-doc-updates">Doc Updates</h3>

- New RFCs: web session authentication ([#16829](https://github.com/cockroachdb/cockroach/pull/16829)), buffering hash router ([#17105](https://github.com/cockroachdb/cockroach/pull/17105)
- Corrected information about how [`TIMESTAMP WITH TIME ZONE`](../v1.1/timestamp.html) works. Previous versions incorrectly said that they stored timestamps; they do not. Instead they simply display timestamps in the client's session time zone.
- [CockroachDB in Comparison](../v1.1/cockroachdb-in-comparison.html) was redesigned.

<h3 id="v1.1-alpha.20170803-enterprise-edition-changes">Enterprise Edition Changes</h3>

- Replayed commands during a [`RESTORE`](../v1.1/restore.html) are now more efficient. [#17079](https://github.com/cockroachdb/cockroach/pull/17079)
- Backup jobs now checkpoint their progress every minutes. [#17070](https://github.com/cockroachdb/cockroach/pull/17070)
- Streamlined concurrency of [`RESTORE`](../v1.1/restore.html) operations, removing most tunable constants. [#17163](https://github.com/cockroachdb/cockroach/pull/17163)
- [`RESTORE`](../v1.1/restore.html) now rate-limits its disk I/O, reducing its impact on other traffic and improving performance on cloud platforms that throttle disk access. [#17239](https://github.com/cockroachdb/cockroach/pull/17239)
- The `enterprise.enabled` setting has been removed. [#17224](https://github.com/cockroachdb/cockroach/pull/17224)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-alpha.20170810-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170810.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170810.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170810.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-alpha.20170810-sql-language-changes">SQL Language Changes</h3>

- The `RETURNING` clause can now be used with [`UPSERT`](../v1.1/upsert.html) and [`INSERT .. ON CONFLICT DO UPDATE`](../v1.1/insert.html) statements. [#17149](https://github.com/cockroachdb/cockroach/pull/17149)

<h3 id="v1.1-alpha.20170810-command-line-interface-changes">Command-Line Interface Changes</h3>

- The [`cockroach sql`](../v1.1/use-the-built-in-sql-client.html) shell now prints the running time of each statement (only in interactive shells using the `pretty` output format). [#17358](https://github.com/cockroachdb/cockroach/pull/17358)

<h3 id="v1.1-alpha.20170810-bug-fixes">Bug Fixes</h3>

- Fix a panic when parsing an interval consisting only of `+` or `-` characters. [#17344](https://github.com/cockroachdb/cockroach/pull/17344)
- Improved responsiveness of query cancellation. [#17219](https://github.com/cockroachdb/cockroach/pull/17219)
- Prepared statements with more than 65535 arguments now return an error instead of crashing the server. [#17380](https://github.com/cockroachdb/cockroach/pull/17380)
- Improved tracing for batches that get split across multiple ranges. [#17414](https://github.com/cockroachdb/cockroach/pull/17414)

<h3 id="v1.1-alpha.20170810-performance-improvements">Performance Improvements</h3>

- Rebalancing now considers data size and write load, not just number of replicas. [#16878](https://github.com/cockroachdb/cockroach/pull/16878)
- The default MVCC garbage collection TTL has been changed from 24 to 25 hours, allowing statements (especially `dump` or `BACKUP`) started at the 24h mark to be completed. [#17366](https://github.com/cockroachdb/cockroach/pull/17366)
- Reduced number of goroutines used in the command queue. [#9448](https://github.com/cockroachdb/cockroach/pull/9448)

<h3 id="v1.1-alpha.20170810-doc-updates">Doc Updates</h3>

- Improved the UX of the documentation version selector on mobile devices. [#1670](https://github.com/cockroachdb/docs/pull/1760)
- Expanded the instructions for [upgrading a cluster's version](../v1.1/upgrade-cockroach-version.html). [#1769](https://github.com/cockroachdb/docs/pull/1769)
- Added an [example](../v1.1/insert.html#update-values-on-conflict) for using a `WHERE` clause to apply an `INSERT .. ON CONFLICT .. DO UPDATE SET` expression conditionally. [#1803](https://github.com/cockroachdb/docs/pull/1803)

<h3 id="v1.1-alpha.20170810-enterprise-edition-changes">Enterprise Edition Changes</h3>

- The `SHOW BACKUPS` statement now includes information about table size. [#17261](https://github.com/cockroachdb/cockroach/pull/17261)
- Backup and restore jobs now restart if their coordinating node dies. [#17301](https://github.com/cockroachdb/cockroach/pull/17301)
- Restoring multiple tables now allocates table IDs in the correct order. [#17412](https://github.com/cockroachdb/cockroach/pull/17412)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-alpha.20170817-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170817.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170817.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-alpha.20170817.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-alpha.20170817-sql-language-changes">SQL Language Changes</h3>

- New statements `PAUSE JOB`, `RESUME JOB`, and `CANCEL JOB` can be used to control enterprise backup/restore jobs. [#17434](https://github.com/cockroachdb/cockroach/pull/17434)
- `ARRAY` values now support the append (`||`) and equality (`=`) operators. [#17318](https://github.com/cockroachdb/cockroach/pull/17318)
- New functions `array_append()`, `array_cat()`, `array_prepend()`, `array_remove()`, `array_replace()`, `array_position()`, and `array_positions()` are now supported. [#17331](https://github.com/cockroachdb/cockroach/pull/17331)
- [Collated strings](../v1.1/collate.html) are now supported in arrays. [#17489](https://github.com/cockroachdb/cockroach/pull/17489)
- Arrays can now be created with the syntax `<type> ARRAY` in addition to `<type>[]`. [#17455](https://github.com/cockroachdb/cockroach/pull/17455)
- [`INSERT ... ON CONFLICT DO UPDATE`](../v1.1/insert.html#update-values-on-conflict) statements now support `WHERE` clauses. [#17435](https://github.com/cockroachdb/cockroach/pull/17435)

<h3 id="v1.1-alpha.20170817-command-line-interface-changes">Command-Line Interface Changes</h3>

- New commands `cockroach node decommission` and `cockroach quit --decommission` can be used to permanently and safely remove nodes from a cluster. [#17272](https://github.com/cockroachdb/cockroach/pull/17272)
- The [`cockroach node status`](../v1.1/view-node-details.html) command now supports several new flags to return subsets of a node's information. [#17555](https://github.com/cockroachdb/cockroach/pull/17555)

<h3 id="v1.1-alpha.20170817-admin-ui-changes">Admin UI Changes</h3>

- Running jobs (schema changes and enterprise backup/restore) now show their estimated time remaining, instead of estimated total running time. [#17559](https://github.com/cockroachdb/cockroach/pull/17559)
- Decommissioned nodes are now reflected in the UI. [#17553](https://github.com/cockroachdb/cockroach/pull/17553)

<h3 id="v1.1-alpha.20170817-bug-fixes">Bug Fixes</h3>

- [View](../v1.1/views.html) dependency analysis (which prevents `DROP` of tables that are used by views) is more accurate for newly-created views. [#17310](https://github.com/cockroachdb/cockroach/pull/17310)
- Range splits are no longer allowed in the `meta2` range; this limits the scalability of a cluster but prevents certain panics in large clusters. [#17565](https://github.com/cockroachdb/cockroach/pull/17565)
- 3DES has been removed from the list of supported TLS cipher suites (it would never be selected because we require TLS 1.2, but it could be reported as a false positive by security scanners). [#17237](https://github.com/cockroachdb/cockroach/pull/17237)
- Fixed a panic in destroyed replicas. [#17303](https://github.com/cockroachdb/cockroach/pull/17303)
- `ALTER TABLE ... SCATTER` once again returns information about the affected ranges. [#17409](https://github.com/cockroachdb/cockroach/pull/17409)
- Fixed a data race in table leases. [#17510](https://github.com/cockroachdb/cockroach/pull/17510)
- [Time-travel queries](../v1.1/select.html#select-historical-data-time-travel) can no longer read tables before they were created. [#17378](https://github.com/cockroachdb/cockroach/pull/17378)

<h3 id="v1.1-alpha.20170817-performance-improvements">Performance Improvements</h3>

- The `rocksdb.min_wal_sync_interval` [cluster setting](../v1.1/cluster-settings.html) now defaults to zero, improving write performance in most cases. [#17601](https://github.com/cockroachdb/cockroach/pull/17601)
- Results are now streamed back to the client as they are produced instead of being buffered. [#17019](https://github.com/cockroachdb/cockroach/pull/17019)
- Query processing can now take advantage of on-disk storage, rather than erroring out when the working set of the query is too large to fit in memory. This is turned off by default in this release, but can be enabled by setting the `sql.defaults.distsql.tempstorage` [cluster setting](../v1.1/cluster-settings.html) to true.
- Improved diversity-based rebalancing of replicas. [#17570](https://github.com/cockroachdb/cockroach/pull/17570)
- Stats-based rebalancing handles empty stores and ranges better. [#17593](https://github.com/cockroachdb/cockroach/pull/17593)

<h3 id="v1.1-alpha.20170817-doc-updates">Doc Updates</h3>

- Updated the [Go-specific transaction code sample](../v1.1/build-a-go-app-with-cockroachdb.html#transaction-with-retry-logic). [#1816](https://github.com/cockroachdb/docs/pull/1816)
- Updated the flag and response field definitions for the [`cockroach version`](../v1.1/view-version-details.html) command.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-beta.20170907-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-beta.20170907.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-beta.20170907.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-beta.20170907.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-beta.20170907-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- [`DROP DATABASE`](../v1.1/drop-database.html) no longer drops non-empty databases unless the `CASCADE` modifier is added. [#17926](https://github.com/cockroachdb/cockroach/pull/17926)
- The `--cache` and `--max-sql-memory` flags for the [`cockroach start`](../v1.1/start-a-node.html) command now default to 128MiB instead of 25% of physical memory to avoid using too much memory by default. Production deployments are encouraged to set `--cache` explicitly to 25-50% of the memory allocated to CockroachDB for best performance. [#18040](https://github.com/cockroachdb/cockroach/pull/18040)

<h3 id="v1.1-beta.20170907-sql-language-changes">SQL Language Changes</h3>

- The new [`IMPORT`](../v1.1/import.html) statement provides a fast way to import an entire table's data into CockroachDB by loading CSV files. Although this feature uses [CCL-licensed code](https://www.cockroachlabs.com/cockroachdb-community-license/), and is therefore available only in builds that include CCL-licensed code, using it is free and does not require an enterprise license. [#17539](https://github.com/cockroachdb/cockroach/pull/17539)
- The [`DELETE`](../v1.1/delete.html) and [`UPDATE`](../v1.1/update.html) statements now support `ORDER BY` and `LIMIT` clauses. [#18023](https://github.com/cockroachdb/cockroach/pull/18023)
- The `sql_safe_updates` [session variable](../v1.1/set-vars.html) can be set to disable certain "dangerous" SQL statements, such as `DELETE` or `UPDATE` without a `WHERE` clause. This is set by default in the `cockroach sql` shell. [#17604](https://github.com/cockroachdb/cockroach/pull/17604) [#17889](https://github.com/cockroachdb/cockroach/pull/17889)
- Parsing of the [`DATE`](../v1.1/date.html) type is no longer affected by the session time zone. [#18164](https://github.com/cockroachdb/cockroach/pull/18164)
- Type hints are now permitted even when they are imprecise, improving compatibility with some drivers and frameworks. [#16672](https://github.com/cockroachdb/cockroach/pull/16672)
- Untyped string literals can now be implicitly cast to numbers, improving compatibility with Javascript clients. [#15903](https://github.com/cockroachdb/cockroach/pull/15903)
- [Query cancellation](../v1.1/cancel-query.html) is now supported for queries using the distributed SQL engine. [#17527](https://github.com/cockroachdb/cockroach/pull/17527)
- The output of [`SHOW SESSIONS`](../v1.1/show-sessions.html) now includes a `last_active_query` column. [#17579](https://github.com/cockroachdb/cockroach/pull/17579)
- The [`SET TRANSACTION`](../v1.1/set-transaction.html) statement no longer requires commas when multiple directives are given. [#17723](https://github.com/cockroachdb/cockroach/pull/17723)
- The PostgreSQL-compatible `e'\x0d0a...'` syntax for hex-encoded byte literals is now supported. [#17693](https://github.com/cockroachdb/cockroach/pull/17693)
- Star expansion is now supported in more cases. [#17833](https://github.com/cockroachdb/cockroach/pull/17833)
- The [`information_schema.sequences`](../v1.1/information-schema.html) table is now supported; it is always empty as sequences are not yet supported. [#17804](https://github.com/cockroachdb/cockroach/pull/17804)
- Improved support for `GROUP BY` and `ORDER BY` with tuples. [#17888](https://github.com/cockroachdb/cockroach/pull/17888)
- Statements that spawn jobs ([`BACKUP`](../v1.1/backup.html), [`RESTORE`](../v1.1/restore.html), schema changes) no longer appear in [`SHOW QUERIES`](../v1.1/show-queries.html). [#17786](https://github.com/cockroachdb/cockroach/pull/17786)
- The `CANCEL`, `RESUME`, `PAUSE`, `BACKUP`, `RESTORE`, and `IMPORT` statements are now valid in prepared statements. The `SET` statement now supports placeholders for values in prepared statements. [#17805](https://github.com/cockroachdb/cockroach/pull/17805) [#17591](https://github.com/cockroachdb/cockroach/pull/17591)

<h3 id="v1.1-beta.20170907-command-line-interface-changes">Command-Line Interface Changes</h3>

- Fatal error messages are now printed to both `stderr` and the logs. [#17588](https://github.com/cockroachdb/cockroach/pull/17588)
- The [`cockroach dump`](../v1.1/sql-dump.html) command now understands [views](../v1.1/views.html) and orders tables to satisfy [foreign key constraints](../v1.1/foreign-key.html) (as long as there are no cycles). [#17581](https://github.com/cockroachdb/cockroach/pull/17581)
- The [`cockroach dump`](../v1.1/sql-dump.html) command correctly represents values such as `NaN` and `Inf`. [#18031](https://github.com/cockroachdb/cockroach/pull/18031)
- The [`cockroach sql`](../v1.1/use-the-built-in-sql-client.html) shell now supports a `h` command for "help". Context-sensitive syntax help is available by typing a question mark followed by the tab key while typing a command. [#13540](https://github.com/cockroachdb/cockroach/pull/13540)
- The [`cockroach sql`](../v1.1/use-the-built-in-sql-client.html) shell now sets a default `application_name` of `cockroach`. [#17602](https://github.com/cockroachdb/cockroach/pull/17602)
- The [`cockroach sql`](../v1.1/use-the-built-in-sql-client.html) shell now prints hints and warnings when available from the server. [#17604](https://github.com/cockroachdb/cockroach/pull/17604)
- The [`cockroach sql`](../v1.1/use-the-built-in-sql-client.html) shell has new debugging options `set echo` (and an equivalent command-line flag `--echo-sql`) and `unset smart_prompt`. [#18127](https://github.com/cockroachdb/cockroach/pull/18127)

<h3 id="v1.1-beta.20170907-admin-ui-changes">Admin UI Changes</h3>

- Various debugging pages are now available at `/#/debug`. [#17635](https://github.com/cockroachdb/cockroach/pull/17635)
- Changes to [cluster settings](../v1.1/cluster-settings.html) are now recorded in the event log. [#17619](https://github.com/cockroachdb/cockroach/pull/17619) [#17866](https://github.com/cockroachdb/cockroach/pull/17866)
- The **Live Bytes per Store** graph has been replaced with **Logical Bytes per Store**, which includes the size of old MVCC values waiting to be garbage collected. [#17782](https://github.com/cockroachdb/cockroach/pull/17782)
- The `/debug/vmodule/` endpoint has been removed; use the SQL function `crdb_internal.set_vmodule()` instead. [#17792](https://github.com/cockroachdb/cockroach/pull/17792) [#17914](https://github.com/cockroachdb/cockroach/pull/17914)
- When [diagnostic reporting](../v1.1/diagnostics-reporting.html) is enabled, anonymous web analytics are also collected in the admin UI. [#17937](https://github.com/cockroachdb/cockroach/pull/17937) [#18046](https://github.com/cockroachdb/cockroach/pull/18046) [#18125](https://github.com/cockroachdb/cockroach/pull/18125)
- Local tracing is now always enabled when nodes start up (even though it will be disabled by default when the node is fully initialized). This helps diagnose problems that keep a node from joining its cluster. [#17944](https://github.com/cockroachdb/cockroach/pull/17944)
- Various adjustments to fonts and margins. [#16773](https://github.com/cockroachdb/cockroach/pull/16773) [#17673](https://github.com/cockroachdb/cockroach/pull/17673)

<h3 id="v1.1-beta.20170907-bug-fixes">Bug Fixes</h3>

- Fixed a regression in the command queue (introduced in `alpha-20170810`) that could result in data inconsistencies. [#17939](https://github.com/cockroachdb/cockroach/pull/17939)
- Fixed a bug in range quiescence that could result in some ranges getting stuck indefinitely. [#18184](https://github.com/cockroachdb/cockroach/pull/18184)
- [Foreign keys](../v1.1/foreign-key.html) that point to a prefix of an existing index now work correctly. Previously, rows could be deleted from the referenced table without recognizing the constraint violation if rows in the referring table pointed to them. These foreign keys are also now shown correctly in [`SHOW CREATE TABLE`](../v1.1/show-create-table.html). [#17638](https://github.com/cockroachdb/cockroach/pull/17638)
- Fixed a bug in `ReverseScan` that could cause data to be missing from query results. [#17868](https://github.com/cockroachdb/cockroach/pull/17868)
- Fixed a build error on FreeBSD. [#17650](https://github.com/cockroachdb/cockroach/pull/17650)
- Windows builds no longer fail with `SyncWAL` errors. [#17735](https://github.com/cockroachdb/cockroach/pull/17735)
- Improved error handling to reduce panics when unsupported SQL features are attempted. [#17521](https://github.com/cockroachdb/cockroach/pull/17521)
- Corrected computation of lease type metrics. [#17615](https://github.com/cockroachdb/cockroach/pull/17615)
- More errors now return the correct PostgreSQL error code, and use the protocol's "hint" and "detail" fields. [#17630](https://github.com/cockroachdb/cockroach/pull/17630) [#17708](https://github.com/cockroachdb/cockroach/pull/17708) [#18028](https://github.com/cockroachdb/cockroach/pull/18028) [#13540](https://github.com/cockroachdb/cockroach/pull/13540)
- Improved error message for parse errors containing funny characters like carriage returns. [#18095](https://github.com/cockroachdb/cockroach/pull/18095)
- Queries are not removed from [`SHOW QUERIES`](../v1.1/show-queries.html) or [`SHOW SESSIONS`](../v1.1/show-sessions.html) until all their results have been sent to the client. [#17579](https://github.com/cockroachdb/cockroach/pull/17579)
- The crash reporter will now time out instead of waiting indefinitely to reach the server. [#17683](https://github.com/cockroachdb/cockroach/pull/17683)
- gRPC no longer closes inter-node connections unnecessarily. [#17706](https://github.com/cockroachdb/cockroach/pull/17706)
- Fixed `duplicate key value` errors when performing large number of splits. [#17763](https://github.com/cockroachdb/cockroach/pull/17763)
- Fixed a deadlock in `quotaPool`. [#17796](https://github.com/cockroachdb/cockroach/pull/17796)
- Fixed a deadlock in `RangeLookup` during `SCATTER`. [#17760](https://github.com/cockroachdb/cockroach/pull/17760)
- The distributed SQL engine avoids scheduling work on nodes running an incompatible version. [#17747](https://github.com/cockroachdb/cockroach/pull/17747)
- `AS OF SYSTEM TIME 0` is now a normal error instead of a panic. [#17680](https://github.com/cockroachdb/cockroach/pull/17680)
- Fixed a panic in `distSQLPlanner`. [#17852](https://github.com/cockroachdb/cockroach/pull/17852)
- Fixed a flow control leak that could lead to deadlock. [#17856](https://github.com/cockroachdb/cockroach/pull/17856)
- Parallelized queries now handle retryable errors correctly. [#17627](https://github.com/cockroachdb/cockroach/pull/17627)
- Nodes now panic if they fail a consistency check. The `server.consistency_check.interval` [cluster setting](../v1.1/cluster-settings.html) replaces the `COCKROACH_CONSISTENCY_CHECK_INTERVAL` environment variable for configuring the consistency checker. [#17853](https://github.com/cockroachdb/cockroach/pull/17853)
- [Dropping an interleaved index](../v1.1/drop-index.html) no longer leaves the table in a broken state. [#17860](https://github.com/cockroachdb/cockroach/pull/17860)
- Changed "flow already registered" from a panic to a regular error. [#17876](https://github.com/cockroachdb/cockroach/pull/17876)
- Certain code paths that used to panic on invalid UTF-8 inputs now return an error instead. [#17935](https://github.com/cockroachdb/cockroach/pull/17935)
- Fixed a memory accounting panic in top-K sorting. [#17984](https://github.com/cockroachdb/cockroach/pull/17984)
- It is no longer possible to set the `kv.raft.command.max_size` cluster setting to a very low value (which could make the cluster inoperable). [#17991](https://github.com/cockroachdb/cockroach/pull/17991)

<h3 id="v1.1-beta.20170907-performance-improvements">Performance Improvements</h3>

- Stats-based rebalancing is now disabled by default. [#17968](https://github.com/cockroachdb/cockroach/pull/17968)
- Reduced unnecessary rebalancing. [#17613](https://github.com/cockroachdb/cockroach/pull/17613)
- The rebalancer now avoids removing the most recently-added replica. [#17930](https://github.com/cockroachdb/cockroach/pull/17930)
- Increased the size of the leaseholder cache. [#17623](https://github.com/cockroachdb/cockroach/pull/17623)
- The new `kv.range_descriptor_cache.size` [cluster setting](../v1.1/cluster-settings.html) can be used to control the size of the range descriptor and leaseholder caches. [#17940](https://github.com/cockroachdb/cockroach/pull/17940)
- Reduced the size of the timestamp cache by 50%. [#17983](https://github.com/cockroachdb/cockroach/pull/17983)
- Replaced several `sync.Maps` with a faster specialized `IntMap`. [#17625](https://github.com/cockroachdb/cockroach/pull/17625)
- Improved job recovery after node restarts. [#17590](https://github.com/cockroachdb/cockroach/pull/17590)
- Reduced synchronization overhead for quiesced replicas. [#17617](https://github.com/cockroachdb/cockroach/pull/17617)
- Increased the number of allowed gossip connections to reduce thrashing. [#17633](https://github.com/cockroachdb/cockroach/pull/17633)
- The `ALTER TABLE ... SCATTER` statement is more efficient. [#17644](https://github.com/cockroachdb/cockroach/pull/17644)
- Attempting to [add a column](../v1.1/add-column.html) with the `NOT NULL` constraint but no default value now fails earlier. [#17634](https://github.com/cockroachdb/cockroach/pull/17634)
- The `sql.defaults.distsql.tempstorage` [cluster setting](../v1.1/cluster-settings.html) now defaults to true. [#17665](https://github.com/cockroachdb/cockroach/pull/17665)
- Improved rebalancing on clusters with little data. [#17733](https://github.com/cockroachdb/cockroach/pull/17733)
- Improved performance of raft log truncation. [#17818](https://github.com/cockroachdb/cockroach/pull/17818)
- The "node liveness" span is now split by default to minimize interactions with the timeseries span. [#17810](https://github.com/cockroachdb/cockroach/pull/17810)
- "Slow timer" log messages are no longer repeated. [#17828](https://github.com/cockroachdb/cockroach/pull/17828)
- Set-returning functions used without a `FROM` clause no longer generate a cross-join. [#17835](https://github.com/cockroachdb/cockroach/pull/17835)
- Memory needed for the RocksDB memtable now counts towards the cache memory budget. [#17865](https://github.com/cockroachdb/cockroach/pull/17865)
- Reduced log spam for distSQL memory usage. [#17807](https://github.com/cockroachdb/cockroach/pull/17807)
- Tracing no longer records the transaction ID multiple times. [#17954](https://github.com/cockroachdb/cockroach/pull/17954)
- MVCC garbage collection is now faster when there are many records to collect. [#17986](https://github.com/cockroachdb/cockroach/pull/17986)
- Reduced occurrence of `AmbiguousResultError` due to RPC failures. [#18000](https://github.com/cockroachdb/cockroach/pull/18000)
- Outer joins with filters are now more efficient. [#18017](https://github.com/cockroachdb/cockroach/pull/18017)
- Added a timeout to heartbeat requests. [#18005](https://github.com/cockroachdb/cockroach/pull/18005)
- Sideloaded data is now correctly accounted for in raft log truncation decisions, reducing disk usage after a `RESTORE` completes. [#18090](https://github.com/cockroachdb/cockroach/pull/18090)
- Sideloaded raft log storage avoids creating too many subdirectories in one parent directory. [#17787](https://github.com/cockroachdb/cockroach/pull/17787)
- Fixed integer overflow in `generate_series()`. [#18066](https://github.com/cockroachdb/cockroach/pull/18066)
- `INSERT` statements using `RETURNING NOTHING` that target different rows in the same table can now be parallelized. [#17757](https://github.com/cockroachdb/cockroach/pull/17757)
- The timeout used for intent resolution has been increased to reduce the probability of failed resolutions that need to be retried. [#18155](https://github.com/cockroachdb/cockroach/pull/18155)

<h3 id="v1.1-beta.20170907-doc-updates">Doc Updates</h3>

- Documented why and how to use `RETURNING NOTHING` to [execute statements within a transaction in parallel](../v1.1/parallel-statement-execution.html). [#1790](https://github.com/cockroachdb/docs/pull/1790)
- Documented SQL statements for managing queries and sessions: [`SHOW QUERIES`](../v1.1/show-queries.html), [`CANCEL QUERY`](../v1.1/cancel-query.html), [`SHOW SESSIONS`](../v1.1/show-sessions.html). [#1828](https://github.com/cockroachdb/docs/pull/1828)
- Added a quick reference on [Managing Long-Running Queries](../v1.1/manage-long-running-queries.html). [#1828](https://github.com/cockroachdb/docs/pull/1828)
- Documented the [`SHOW BACKUP`](../v1.1/show-backup.html) statement. [#1869](https://github.com/cockroachdb/docs/pull/1869)
- Added overview pages for the [`ALTER DATABASE`](../v1.1/alter-database.html) and [`ALTER INDEX`](../v1.1/alter-index.html) statements that point to pages for relevant subcommands, e.g., `RENAME DATABASE` and `RENAME INDEX`. [#1869](https://github.com/cockroachdb/docs/pull/1869)
- Documented the [`ARRAY`](../v1.1/array.html) and [`UUID`](../v1.1/uuid.html) data types. [#1837](https://github.com/cockroachdb/docs/pull/1837) [#1834](https://github.com/cockroachdb/docs/pull/1834)
- The RFC process has been updated. [#17568](https://github.com/cockroachdb/cockroach/pull/17568)
- Updated the [Contribute to CockroachDB](https://wiki.crdb.io/wiki/spaces/CRDB/pages/73204033/Contributing+to+CockroachDB) page to provide guidelines on finding a project, determining its complexity, and learning what to expect in your collaboration with the Cockroach Labs team. [#1881](https://github.com/cockroachdb/docs/pull/1881)

<h3 id="v1.1-beta.20170907-enterprise-edition-changes">Enterprise Edition Changes</h3>

- The initial split/scatter phase of large [`RESTORE`](../v1.1/restore.html) jobs is now much faster. [#18043](https://github.com/cockroachdb/cockroach/pull/18043)
- End times are now recorded correctly in backup descriptors. [#17908](https://github.com/cockroachdb/cockroach/pull/17908)
- Avoided slowdowns when multiple backup/restore goroutines attempt to update their progress simultaneously. [#17934](https://github.com/cockroachdb/cockroach/pull/17934)
- [`RESTORE`](../v1.1/restore.html) now uses larger SSTables to avoid running out of file descriptors. [#17991](https://github.com/cockroachdb/cockroach/pull/17991) [#18037](https://github.com/cockroachdb/cockroach/pull/18037)
- Fixed a deadlock in `RESTORE`. [#18101](https://github.com/cockroachdb/cockroach/pull/18101)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-beta.20170921-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-beta.20170921.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-beta.20170921.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-beta.20170921.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-beta.20170921-admin-ui-changes">Admin UI Changes</h3>

- New debug endpoint `/debug/logspy` can be used to access verbose logging remotely (when remote debugging is enabled). [#18221](https://github.com/cockroachdb/cockroach/pull/18221) [#18415](https://github.com/cockroachdb/cockroach/pull/18415)
- Improvements to debug pages. [#18411](https://github.com/cockroachdb/cockroach/pull/18411) [#18498](https://github.com/cockroachdb/cockroach/pull/18498)

<h3 id="v1.1-beta.20170921-bug-fixes">Bug Fixes</h3>

- Improve diagnostic messages for nodes incorrectly restarted without the `--join` flag. [#18203](https://github.com/cockroachdb/cockroach/pull/18203)
- Ranges can no longer become quiescent while a leadership transfer is in progress. [#18217](https://github.com/cockroachdb/cockroach/pull/18217)
- Fixed an issue with cached raft terms that could result in unavailable ranges. [#18338](https://github.com/cockroachdb/cockroach/pull/18338)
- Fixed serialization of negative integers in the distributed SQL engine. [#18323](https://github.com/cockroachdb/cockroach/pull/18323)
- Fixed bugs in reverse scans. [#18383](https://github.com/cockroachdb/cockroach/pull/18383)
- Fixed bugs in sideloaded raft storage (used by [`RESTORE`](../v1.1/restore.html) and [`IMPORT`](../v1.1/import.html)). [#18409](https://github.com/cockroachdb/cockroach/pull/18409) [#18466](https://github.com/cockroachdb/cockroach/pull/18466) [#18481](https://github.com/cockroachdb/cockroach/pull/18481)
- Improved implementation of the `COPY` protocol. [#18259](https://github.com/cockroachdb/cockroach/pull/18259)
- Failure to find a table name no longer aborts the current transaction. [#18373](https://github.com/cockroachdb/cockroach/pull/18373)
- `pg_table_is_visible` now qualifies table names correctly. [#18373](https://github.com/cockroachdb/cockroach/pull/18373)
- Fixed an interaction between RocksDB DeleteRange operations and snapshots. [#18380](https://github.com/cockroachdb/cockroach/pull/18380) [#18446](https://github.com/cockroachdb/cockroach/pull/18446)

<h3 id="v1.1-beta.20170921-performance-improvements">Performance Improvements</h3>

- Prevented rapid retries of non-queueable "push transaction" operations. [#18196](https://github.com/cockroachdb/cockroach/pull/18196)
- Fixed busy loop in the replication queue. [#18465](https://github.com/cockroachdb/cockroach/pull/18465)
- Rebalancing is no longer disabled temporarily after a lease transfer. [#18230](https://github.com/cockroachdb/cockroach/pull/18230)

<h3 id="v1.1-beta.20170921-doc-updates">Doc Updates</h3>

- Documented how to [perform a rolling upgrade from v1.0.x to v1.1](../v1.1/upgrade-cockroach-version.html). [#1899](https://github.com/cockroachdb/docs/pull/1899)
- Documented how to [decommission and permanently remove nodes](../v1.1/remove-nodes.html) from a cluster. [#1876](https://github.com/cockroachdb/docs/pull/1876)
- Added an explanation of [what happens when a node is temporarily stopped](../v1.1/stop-a-node.html#how-it-works), and improved the [examples for stopping nodes](../v1.1/stop-a-node.html#examples). [#1899](https://github.com/cockroachdb/docs/pull/1899)
- Updated the [default `--cache` and `--max-sql-memory` size](../v1.1/start-a-node.html#flags-changed-in-v1-1) for nodes, and added guidance on [increasing the cache and SQL memory size](../v1.1/recommended-production-settings.html#cache-and-sql-memory-size-changed-in-v1-1) for production deployments. [#1906](https://github.com/cockroachdb/docs/pull/1906)
- Documented the new `--unsafe-updates` flag and new SQL shell options for the [`cockroach sql`](../v1.1/use-the-built-in-sql-client.html) command. [#1905](https://github.com/cockroachdb/docs/pull/1905)
- Documented the new `--echo-sql` flag for the [`cockroach sql`](../v1.1/use-the-built-in-sql-client.html), [`cockroach dump`](../v1.1/sql-dump.html), [`cockroach user`](../v1.1/create-and-manage-users.html), and [`cockroach zone`](../v1.1/configure-replication-zones.html) commands. [#1905](https://github.com/cockroachdb/docs/pull/1905)
- Added the `CASCADE` and `RESTRICT` options to the [`DROP DATABASE`](../v1.1/drop-database.html) documentation. [#1903](https://github.com/cockroachdb/docs/pull/1903)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1-beta.20170928-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-beta.20170928.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-beta.20170928.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1-beta.20170928.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1-beta.20170928-build-changes">Build Changes</h3>

- The release docker images now use Debian 8.9 (instead of 8.7) [#18755](https://github.com/cockroachdb/cockroach/pull/18755)

<h3 id="v1.1-beta.20170928-sql-language-changes">SQL Language Changes</h3>

- The [`IMPORT`](../v1.1/import.html) command is now considered an experimental feature and must be enabled before use with the cluster setting `experimental.importcsv.enabled`. [#18753](https://github.com/cockroachdb/cockroach/pull/18753)
- The [cluster settings](../v1.1/cluster-settings.html) beginning with `sql.defaults.distsql.tempstorage` have been renamed to begin with `sql.distsql.temp_storage`. [#18487](https://github.com/cockroachdb/cockroach/pull/18487)
- The new `sql.distsql.temp_storage.workmem` [cluster setting](../v1.1/cluster-settings.html) sets the memory threshold at which a DistSQL processor falls back to on-disk storage. Defaults to 64MiB. [#18487](https://github.com/cockroachdb/cockroach/pull/18487)
- The [`SHOW JOBS`](../v1.1/show-jobs.html) statement no longer shows numeric descriptor IDs. [#18797](https://github.com/cockroachdb/cockroach/pull/18797)

<h3 id="v1.1-beta.20170928-command-line-interface-changes">Command-Line Interface Changes</h3>

- The new `--max-disk-temp-storage` flag for the [`cockroach start`](../v1.1/start-a-node.html) command controls how much disk space can be used for temporary storage. [#18761](https://github.com/cockroachdb/cockroach/pull/18761)
- The `cockroach load csv` command now increases its soft limit on the number of open file descriptors when possible. [#18678](https://github.com/cockroachdb/cockroach/pull/18678)
- The `cockroach init` command now provides a better error message when run on an already-initialized cluster. [#18548](https://github.com/cockroachdb/cockroach/pull/18548)

<h3 id="v1.1-beta.20170928-admin-ui-changes">Admin UI Changes</h3>

- Reduced false positives when marking nodes as "suspect". [#18563](https://github.com/cockroachdb/cockroach/pull/18563)
- The **Jobs** page can now be limited to import jobs. [#18615](https://github.com/cockroachdb/cockroach/pull/18615)
- The **Keys Written per Second per Store** graph on the **Replication** dashboard is now accurate. [#18800](https://github.com/cockroachdb/cockroach/pull/18800)
- Fixed the display of the number of indexes per table. [#18769](https://github.com/cockroachdb/cockroach/pull/18769)

<h3 id="v1.1-beta.20170928-bug-fixes">Bug Fixes</h3>

- Fixed a bug in which queries using [`DISTINCT`](../v1.1/select.html#select-distinct-rows) or [`GROUP BY`](../v1.1/select.html#create-aggregate-groups) could return incorrect results. [#18727](https://github.com/cockroachdb/cockroach/pull/18727)
- After some results have been streamed to the client, queries are no longer auto-retried. [#18515](https://github.com/cockroachdb/cockroach/pull/18515) [#18569](https://github.com/cockroachdb/cockroach/pull/18569)
- Tables with no columns now work correctly. [#18532](https://github.com/cockroachdb/cockroach/pull/18532)
- The [`cockroach dump`](../v1.1/sql-dump.html) command now supports values of type `UUID`. [#18543](https://github.com/cockroachdb/cockroach/pull/18543)
- The distributed SQL engine now avoids scheduling work on nodes running version 1.0.x in a mixed-version cluster. [#18546](https://github.com/cockroachdb/cockroach/pull/18546)
- The distributed SQL engine no longer attempts to schedule work on [decommissioned nodes](../v1.1/remove-nodes.html). [#18698](https://github.com/cockroachdb/cockroach/pull/18698)
- The [`TRUNCATE`](../v1.1/truncate.html) statement now works correctly on tables in the middle of a schema change (the schema change finishes immediately on the now-empty table). [#18549](https://github.com/cockroachdb/cockroach/pull/18549)
- Fixed a panic in `tableState.findForTimestamp` [#18557](https://github.com/cockroachdb/cockroach/pull/18557)
- Fixed a bug in which importing a CSV would fail to report unique constraint violations. [#18563](https://github.com/cockroachdb/cockroach/pull/18563)
- Fixed a bug when importing a CSV into a table with multiple column families. [#18563](https://github.com/cockroachdb/cockroach/pull/18563)
- [`SHOW TRACE`](../v1.1/show-trace.html) now works correctly when ipv6 is used. [#18567](https://github.com/cockroachdb/cockroach/pull/18567)
- Foreign key checks are now included in [`SHOW KV TRACE`](../v1.1/show-trace.html). [#18568](https://github.com/cockroachdb/cockroach/pull/18568)
- Fixed the display of version numbers. [#18562](https://github.com/cockroachdb/cockroach/pull/18562)
- Improved tracing of range lookups [#18613](https://github.com/cockroachdb/cockroach/pull/18613)
- Fixed an overflow check in key decoding. [#18639](https://github.com/cockroachdb/cockroach/pull/18639)
- Fixed a trace use-after-finish panic. [#18645](https://github.com/cockroachdb/cockroach/pull/18645)
- Fixed a panic in `disk_row_container`. [#18685](https://github.com/cockroachdb/cockroach/pull/18685)
- Improved some error reporting. [#18708](https://github.com/cockroachdb/cockroach/pull/18708)
- Fixed [zone config](../v1.1/configure-replication-zones.html) problems after dropping or truncating a table. [#18781](https://github.com/cockroachdb/cockroach/pull/18781)
- [`SHOW CLUSTER QUERIES`](../v1.1/show-queries.html) and [`SHOW CLUSTER SESSIONS`](../v1.1/show-sessions.html) no longer panic when a node is down. [#18802](https://github.com/cockroachdb/cockroach/pull/18802)
- Fixed a bug with queries using `COUNT(*)` and tables containing multiple column families. [#18805](https://github.com/cockroachdb/cockroach/pull/18805)

<h3 id="v1.1-beta.20170928-performance-improvements">Performance Improvements</h3>

- Improved performance of [foreign key](../v1.1/foreign-key.html) checks. [#18597](https://github.com/cockroachdb/cockroach/pull/18597)
- Table leases are now refreshed asynchronously when near expiration. [#18824](https://github.com/cockroachdb/cockroach/pull/18824)
- Improved performance of `COUNT(*)` queries. [#18524](https://github.com/cockroachdb/cockroach/pull/18524)
- Reduced some noisy log messages. [#18589](https://github.com/cockroachdb/cockroach/pull/18589)
- Distributed CSV import is now aware of the target range size. [#18634](https://github.com/cockroachdb/cockroach/pull/18634)
- The GC queue now gives up earlier after a timeout. [#18672](https://github.com/cockroachdb/cockroach/pull/18672)
- The distributed SQL engine now supports array values. [#18792](https://github.com/cockroachdb/cockroach/pull/18792)
- Improved load-based lease rebalancing for distributed SQL queries. [#18794](https://github.com/cockroachdb/cockroach/pull/18794)

<h3 id="v1.1-beta.20170928-doc-updates">Doc Updates</h3>

- In the [`cockroach dump`](../v1.1/sql-dump.html) documentation, clarified that table and view schemas are dumped in the order in which they can successfully be recreated. Also added this as a [known limitation in CockroachDB v1.0](../v1.0/known-limitations.html#order-of-dumped-schemas-and-incorrect-schemas-of-dumped-views). [#1923](https://github.com/cockroachdb/docs/pull/1923)
- Added a message when searches of the documentation return no results. [#1927](https://github.com/cockroachdb/docs/pull/1927)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1.0-rc.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.0-rc.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.0-rc.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.0-rc.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1.0-rc.1-build-changes">Build Changes</h3>

- Docker images now contain root CA certificates, permitting the use of `BACKUP` and `RESTORE` on cloud storage. [#18959](https://github.com/cockroachdb/cockroach/pull/18959)
- Docker images are now built without caching to ensure they contain the latest packages at the time of release. [#18999](https://github.com/cockroachdb/cockroach/pull/18999)

<h3 id="v1.1.0-rc.1-command-line-interface-changes">Command-Line Interface Changes</h3>

- Timestamps in logs now use UTC regardless of the system time zone. [#18764](https://github.com/cockroachdb/cockroach/pull/18764)
- Added an explanatory message when `--background` is used and the node is waiting to join an existing cluster or for `cockroach init` to be run. [#18840](https://github.com/cockroachdb/cockroach/pull/18840)

<h3 id="v1.1.0-rc.1-bug-fixes">Bug Fixes</h3>

- [`SERIALIZABLE`](../v1.1/transactions.html#serializable-isolation) transactions should no longer return "transaction deadline exceeded". [#18852](https://github.com/cockroachdb/cockroach/pull/18852)
- Transaction deadlines are now updated properly when a transaction restarts. [#18943](https://github.com/cockroachdb/cockroach/pull/18943)
- Fixed a panic when an error was generated in [`COMMIT`](../v1.1/commit-transaction.html) or [`ROLLBACK`](../v1.1/rollback-transaction.html). [#18937](https://github.com/cockroachdb/cockroach/pull/18937)
- Fixed a panic in queries with `JOIN` using the distributed SQL engine. [#18975](https://github.com/cockroachdb/cockroach/pull/18975)
- Reverted a change in [beta-20170928](v1.1-beta.20170928.html) to asynchronously refresh table leases when near expiration. [#18862](https://github.com/cockroachdb/cockroach/pull/18862)
- Casting `TIMESTAMP WITH TIME ZONE` to `TIMESTAMP` respects the [session time zone](../v1.1/set-vars.html#set-time-zone). [#18764](https://github.com/cockroachdb/cockroach/pull/18764)
- Range debug pages now work when a replica is awaiting garbage collection. [#18941](https://github.com/cockroachdb/cockroach/pull/18941)
- Temporary directory cleanup now works correctly on `overlayfs`. [#19000](https://github.com/cockroachdb/cockroach/pull/19000)

<h3 id="v1.1.0-rc.1-doc-updates">Doc Updates</h3>

- Documented the [`cockroach init`](../v1.1/initialize-a-cluster.html) command and updated the [manual](../v1.1/manual-deployment.html) and [cloud](../v1.1/manual-deployment.html) deployment tutorials to use the new cluster initialization workflow. [#1942](https://github.com/cockroachdb/docs/pull/1942)
- Updated various diagrams in our [SQL statement documentation](../v1.1/sql-statements.html). [#1946](https://github.com/cockroachdb/docs/pull/1946)
- Documented the [`DROP USER`](../v1.1/drop-user.html) statement, and updated related docs to clarify that removing a user does not automatically remove the user's privileges; that must be done manually. [#1954](https://github.com/cockroachdb/docs/pull/1954)
- Updated the [Rust transaction code sample](../v1.1/build-a-rust-app-with-cockroachdb.html#transaction-with-retry-logic) to work against PostgreSQL v0.15.1. [#1941](https://github.com/cockroachdb/docs/pull/1941)
- Updated the [ActiveRecord tutorial](../v1.1/build-a-ruby-app-with-cockroachdb-activerecord.html#step-1-install-the-activerecord-orm) to clarify the dependency between the ActiveRecord version and the CockroachDB Ruby adapter. [#1949](https://github.com/cockroachdb/docs/pull/1949)
- Clarified that [window functions](../v1.1/window-functions.html) are supported by CockroachDB (more docs coming soon). [#1948](https://github.com/cockroachdb/docs/pull/1948)
- Updated the [`SHOW CREATE TABLE` example](../v1.1/show-create-table.html#example) to show improved output for foreign key dependencies. [#1953](https://github.com/cockroachdb/docs/pull/1953)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

With the release of CockroachDB v1.1.0, we’ve included support for faster migrations from other databases for developers, simplified cluster management for operators, and improved performance in real-world environments.

- Read more about these changes in the [v1.1 blog post](https://www.cockroachlabs.com/blog/cockroachdb-1dot1/).
- Check out a [summary of backwards-incompatible changes and new features](#summary).
- Then [upgrade to CockroachDB v1.1.0](../v1.1/upgrade-cockroach-version.html). The process of upgrading from v1.0.x to v1.1.0 is different than upgrading within the v1.0.x series, so please follow the upgrade instructions carefully.

<h3 id="v1.1.0-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.0.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.0.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.0.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1.0-summary">Summary</h3>

This section summarizes the most significant user-facing changes in v1.1.0. For a complete list of changes, including bug fixes and performance improvements, see the [release notes](index.html#testing-releases) for previous testing releases.

- [Backwards-Incompatible Changes](#backwards-incompatible-changes)
- [SQL Statements](#sql-statements)
- [SQL Types](#sql-types)
- [Cockroach Commands](#cockroach-commands)
- [Admin UI](#admin-ui)
- [Documentation](#documentation)
- [Known Limitations](#known-limitations)

<style>
    table td:first-child {
        min-width: 225px;
    }
</style>

<h3 id="v1.1.0-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

Change | Description
-------|------------
[`DROP DATABASE`](../v1.1/drop-database.html) | This statement no longer drops non-empty databases unless the `CASCADE` modifier is added.
[`cockroach start`](../v1.1/start-a-node.html) | The `--max-sql-memory` and `--cache` flags now default to 128MiB instead of 25% of physical memory. These new defaults are reasonable for local development clusters. However, for production deployments, they should be increased to 25% or higher. See [Recommended Production Settings](../v1.1/recommended-production-settings.html#cache-and-sql-memory-size-changed-in-v1-1) for more details.<br><br>Also, if the server's own hostname cannot be resolved, CockroachDB reports an error at startup instead of starting a node that will be unable to participate in a cluster. Local test clusters may need to pass `--host=localhost` to avoid this error.
[Various names](../v1.1/keywords-and-identifiers.html#rules-for-identifiers) | Database, table, view, and column names in double quotes are now case-sensitive (as in PostgreSQL).
[`DROP COLUMN`](../v1.1/drop-column.html) | It is no longer possible to drop columns in tables depended on by [views](../v1.1/views.html). This is an overly-broad change to avoid schema changes that might break views; it will be narrowed in the future.
`EXPLAIN (DEBUG)`<br>`EXPLAIN(TRACE)` | These [`EXPLAIN`](../v1.1/explain.html) options have been removed. They have been replaced by the new [`SHOW TRACE`](../v1.1/show-trace.html) statement.

<h3 id="v1.1.0-sql-statements">SQL Statements</h3>

Statement | Description
----------|------------
[`IMPORT`](../v1.1/import.html) | Use this new statement to import an entire table's data into a running cluster by loading CSV files.
[`SHOW QUERIES`](../v1.1/show-queries.html)<br>[`CANCEL QUERY`](../v1.1/cancel-query.html) | Use these new statements to monitor the progress of active queries, and, if necessary, cancel long-running queries causing unwanted resource consumption.
[`SHOW SESSIONS`](../v1.1/show-sessions.html) | Use this new statement to monitor the overall state of client connections and identify those that may need investigation or adjustment.
[`SHOW JOBS`](../v1.1/show-jobs.html) | Use this new statement to monitor the progress of schema changes and enterprise backups and restores.
[`CANCEL JOB`](../v1.1/cancel-job.html)<br>[`PAUSE JOB`](../v1.1/pause-job.html)<br>[`RESUME JOB`](../v1.1/resume-job.html) | Use these new statements to cancel, pause, or resume enterprise backups and restores.
[`SHOW BACKUP`](../v1.1/show-backup.html) | Use this new statement to list the contents of an enterprise backup.
[`SHOW TRACE`](../v1.1/show-trace.html) | Use this new statement to execute a target statement and then return a trace of its actions through all of CockroachDB's software layers.
[`DROP USER`](../v1.1/drop-user.html) | Use this new statement to remove one or more SQL users. This features is equivalent to the existing [`cockroach user rm`](../v1.1/create-and-manage-users.html) command.
[`RESET`](../v1.1/reset-vars.html)<br> | Use this new statement to reset a session variable to its default value. You can also use the new [`SET .. TO DEFAULT`](../v1.1/set-vars.html#reset-a-variable-to-its-default-value) option.
[`RESET CLUSTER SETTING`](../v1.1/reset-cluster-setting.html) | Use this new statement to reset a cluster setting to its default value. You can also use the new [`SET CLUSTER SETTING .. TO DEFAULT`](../v1.1/set-cluster-setting.html#reset-a-setting-to-its-default-value) option.
[`DROP DATABASE`](../v1.1/drop-database.html) | Use the new `CASCADE` option to drop all tables and views in a database as well as all objects that depend on those tables, such as [constraints](../v1.1/constraints.html) and [views](../v1.1/views.html). This option does not list objects it drops, so should be used cautiously.
[`INSERT`](../v1.1/insert.html#update-values-on-conflict) | Use a `WHERE` clause with `ON CONFLICT` to conditionally apply updates that conflict with a Unique constraint on one or more columns.

<h3 id="v1.1.0-sql-types">SQL Types</h3>

Type | Description
-----|------------
[`ARRAY`](../v1.1/array.html) | Use this new data type to store 1-dimensional, 1-indexed, homogeneous arrays of any non-array data type.
[`UUID`](../v1.1/uuid.html) | Use this new data type to store 128-bit values that are globally unique. This type is recommended for [auto-generating unique row IDs](../v1.1/uuid.html#create-a-table-with-auto-generated-unique-row-ids).

<h3 id="v1.1.0-cockroach-commands">Cockroach Commands</h3>

Command | Description
--------|------------
[`init`](../v1.1/initialize-a-cluster.html) | Use this new command to perform a one-time initialization of a new multi-node cluster. For a full walk-through of the cluster startup and initialization process, see [Manual Deployment](../v1.1/manual-deployment.html) or one of the [Cloud Deployment](../v1.1/manual-deployment.html) tutorials.
[`node decommission`](../v1.1/view-node-details.html)<br>[`node recommission`](../v1.1/view-node-details.html) | Use these new subcommands of `cockroach node` to decommission nodes for permanent removal or recommission nodes that were accidentally decommissioned. See [Remove Nodes](../v1.1/remove-nodes.html) for more details.
[`start`](../v1.1/start-a-node.html) | When starting a node, the new `--max-disk-temp-storage` flag lets you set the maximum on-disk storage capacity available to store temporary data for SQL queries that exceed the memory budget. This ensures that JOINs, sorts, and other memory-intensive SQL operations are able to spill intermediate results to disk.
[`sql`](../v1.1/use-the-built-in-sql-client.html) | When starting the built-in SQL client, the new `--echo-sql` flag reveals the SQL statements sent implicitly by the command-line utility, and the new `--unsafe-updates` flag allows potentially unsafe statements, such as `DELETE` without a `WHERE` clause.<br><br>Within the interactive SQL shell, you can now get [interactive help about statements and functions](../v1.1/use-the-built-in-sql-client.html#sql-shell-help-new-in-v1-1) and you can set [new SQL shell options](../v1.1/use-the-built-in-sql-client.html#sql-shell-options-changed-in-v1-1) to control how table rows get printed, to reveal the statements sent implicitly by the SQL shell, to reveal the time a query takes to complete, and to return the current status of a transaction.<br><br>Also, when the built-in SQL client connects or reconnects to a node, the [welcome text](../v1.1/use-the-built-in-sql-client.html#sql-shell-welcome-changed-in-v1-1) it prints now includes version and cluster ID details.
[`dump`](../v1.1/sql-dump.html) | Table and view schemas are now dumped in the order in which they can successfully be recreated.<br><br>Also, the new `--echo-sql` flag reveals the SQL statements sent implicitly by the command-line utility.
[`zone`](../v1.1/configure-replication-zones.html) | The new `--echo-sql` flag reveals the SQL statements sent implicitly by the command-line utility.

<h3 id="v1.1.0-admin-ui">Admin UI</h3>

Area | Description
-----|------------
[Jobs Page](../v1.1/admin-ui-jobs-page.html) | This new page in the Admin UI shows the user, description, creation time, and status of each backup and restore job, as well as schema changes performed across all nodes in the cluster.
[Nodes List](../v1.1/admin-ui-access-and-navigate.html#decommissioned-nodes) | Nodes that have been decommissioned for permanent removal are now listed in a separate table.

<h3 id="v1.1.0-documentation">Documentation</h3>

Topic | Description
------|------------
[CockroachDB Architecture](../v1.1/architecture/overview.html) | This new section of the documentation provides an introduction to CockroachDB internals, with detailed explanations of each layer of the software.
[Admin UI](../v1.1/admin-ui-overview.html) | This new section of the documentation explains how to understand and use the Admin UI to monitor and optimize cluster performance.
[Parallel Statement Execution](../v1.1/parallel-statement-execution.html) | CockroachDB supports parallel execution of independent `INSERT`, `UPDATE`, `UPSERT`, and `DELETE` statements within a single transaction. This new topic explains why, how, and when to use this feature.
[Cross-Cloud Migration](../v1.1/demo-automatic-cloud-migration.html) | This new topic walks you through a local simulation of migrating data from one cloud to another without any service interruption. An accompanying [blog post](https://www.cockroachlabs.com/blog/cross-cloud-migration/) features a live demonstration of the process.
[Recommended Production Settings](../v1.1/recommended-production-settings.html) | This topic now provides improved hardware recommendations for a CockroachDB cluster and expanded details on how CockroachDB handles unsynchronized clocks.
[Rotate Security Certificates](../v1.1/rotate-certificates.html) | This new topic shows you how to rotate security certificates without restarting nodes.
[Stop a Node](../v1.1/stop-a-node.html#how-it-works) | This topic now explains what happens when a node is temporarily stopped.
[Contribute to CockroachDB](https://wiki.crdb.io/wiki/spaces/CRDB/pages/73204033/Contributing+to+CockroachDB) | This topic now gives external contributors guidelines on finding a project, determining its complexity, and learning what to expect in collaborations with the Cockroach Labs team.

<h3 id="v1.1.0-known-limitations">Known Limitations</h3>

For information about limitations we've identified in CockroachDB v1.1, with suggested workarounds where applicable, see [Known Limitations](../v1.1/known-limitations.html).
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1.1-sql-language-changes">SQL Language Changes</h3>

- [`ARRAY`](../v1.1/array.html) values are now more compatible with certain client drivers. [#19273](https://github.com/cockroachdb/cockroach/pull/19273) [#19285](https://github.com/cockroachdb/cockroach/pull/19285)

<h3 id="v1.1.1-bug-fixes">Bug Fixes</h3>

- `SET CLUSTER SETTING version = '1.1'` now works correctly. You issue this command when [finalizing a cluster upgrade from 1.0.x to 1.1.1](../v1.1/upgrade-cockroach-version.html). [#19225](https://github.com/cockroachdb/cockroach/pull/19225)
- Created, dropped, or truncated tables no longer result in non-restorable backups. [#19067](https://github.com/cockroachdb/cockroach/pull/19067)
- Some issues that could cause non-restorable backups are now detected during the backup process. [#19286](https://github.com/cockroachdb/cockroach/pull/19286)
- Fixed a deadlock in the crash reporting code, making more information available about certain fatal errors. [#19287](https://github.com/cockroachdb/cockroach/pull/19287)
- Very large arguments to the SQL `repeat()` function now return an error instead of panicking. [#19066](https://github.com/cockroachdb/cockroach/pull/19066)
- It is now possible to drop a [foreign key constraint](../v1.1/foreign-key.html) on a column that is part of the primary key. [#19092](https://github.com/cockroachdb/cockroach/pull/19092)
- Attempting to use [`SHOW TRACE FOR`](../v1.1/show-trace.html) while session tracing is enabled no longer turns off session tracing. [#19099](https://github.com/cockroachdb/cockroach/pull/19099)
- [`SHOW TRACE FOR`](../v1.1/show-trace.html) no longer includes detailed KV-level information (these messages are included in the separate `SHOW KV TRACE FOR` command). [#19143](https://github.com/cockroachdb/cockroach/pull/19143)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1.2-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1.2-sql-language-changes">SQL Language Changes</h3>

- The new `gen_random_uuid()` [function](../v1.1/functions-and-operators.html) generates and returns a random [`UUID`](../v1.1/uuid.html) value. [#19585](https://github.com/cockroachdb/cockroach/pull/19585)

<h3 id="v1.1.2-bug-fixes">Bug Fixes</h3>

- Reverted the default behavior of [`DROP DATABASE`](../v1.1/drop-database.html) to `CASCADE` for compatibility with PostgreSQL, some schema migration tools, and CockroachDB v1.0. [#19209](https://github.com/cockroachdb/cockroach/pull/19209)

- Fixed a bug preventing crash reports from being submitted with [anonymous diagnostics details](../v1.1/diagnostics-reporting.html). [#19563](https://github.com/cockroachdb/cockroach/pull/19563)

- Important errors such as "writes: no space left on device" are now included in crash reports. [#19314](https://github.com/cockroachdb/cockroach/pull/19314)

- The [`cockroach dump`](../v1.1/sql-dump.html) command now properly supports [`ARRAY`](../v1.1/array.html) values and [primary keys](../v1.1/primary-key.html) named other than "primary". [#19526](https://github.com/cockroachdb/cockroach/pull/19526) [#19400](https://github.com/cockroachdb/cockroach/pull/19400)

- It is now possible to use AWS S3 buckets in any region for [`IMPORT`](../v1.1/import.html) and enterprise [`BACKUP`](../v1.1/backup.html) and [`RESTORE`](../v1.1/restore.html). [#19473](https://github.com/cockroachdb/cockroach/pull/19473)

- Reduced unnecessary log messages when a cluster becomes temporarily unbalanced, for example, when a new node joins. [#19494](https://github.com/cockroachdb/cockroach/pull/19494)

- Fixed a bug causing redundant log messages when running [`SHOW TRACE FOR`](../v1.1/show-trace.html). [#19469](https://github.com/cockroachdb/cockroach/pull/19469)

- [`ARRAY`](../v1.1/array.html) values containing strings with multiple consecutive escapes are now parsed properly. [#19452](https://github.com/cockroachdb/cockroach/pull/19452)

- Fixed a bug causing certain queries with [`ORDER BY`](../v1.1/select.html#sorting-retrieved-values) to return incorrectly ordered results when the ordering columns contain NULL values. [#19419](https://github.com/cockroachdb/cockroach/pull/19419)

- Fixed `NATURAL JOIN` operations (where the join clause is implicit based on the common columns in the tables being joined) when one side of the join is a subquery. [#19544](https://github.com/cockroachdb/cockroach/pull/19544)

- Improved the handling of errors during [range splits](../v1.1/architecture/distribution-layer.html#range-splits). [#19448](https://github.com/cockroachdb/cockroach/pull/19448)

- Fixed a bug causing correctness problems when nodes run out of disk. [#19447](https://github.com/cockroachdb/cockroach/pull/19447)

- Fixed a bug causing the [decommissioning](../v1.1/remove-nodes.html) process to hang when the target node is already decommissioned. [#19279](https://github.com/cockroachdb/cockroach/pull/19279)

- Fixed a bug preventing aborted [transactions](../v1.1/transactions.html) from seeing their own writes. [#19093](https://github.com/cockroachdb/cockroach/pull/19093)

- Improved performance for some transaction conflicts. [#19093](https://github.com/cockroachdb/cockroach/pull/19093)

<h3 id="v1.1.2-doc-updates">Doc Updates</h3>

- Added a [known limitation](../v1.1/known-limitations.html#downgrading-to-v1-1-0-from-a-later-v1-1-x-patch-release) about downgrading to v1.1.0 from a later v1.1.x patch release. [#2095](https://github.com/cockroachdb/docs/pull/2095)
- Corrected the aliases and allowed widths of various [`INT`](../v1.1/int.html) types. [#2116](https://github.com/cockroachdb/docs/pull/2116)
- Corrected the description of the `--host` flag in our insecure [cloud deployment tutorials](../v1.1/manual-deployment.html). [#2117](https://github.com/cockroachdb/docs/pull/2117)
- Minor improvements to the [CockroachDB Architecture Overview](../v1.1/architecture/overview.html) page. [#2103](https://github.com/cockroachdb/docs/pull/2103) [#2104](https://github.com/cockroachdb/docs/pull/2104) [#2105](https://github.com/cockroachdb/docs/pull/2105)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1.3-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.3.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.3.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.3.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1.3-sql-language-changes">SQL Language changes</h3>

- [`SHOW TRACE FOR SELECT`](../v1.1/show-trace.html) now supports [`AS OF SYSTEM TIME`](https://www.cockroachlabs.com/blog/time-travel-queries-select-witty_subtitle-the_future/). [#20187](https://github.com/cockroachdb/cockroach/pull/20187)

<h3 id="v1.1.3-bug-fixes">Bug Fixes</h3>

- [Decommissioned nodes](../v1.1/remove-nodes.html) are now excluded from the staggered version warning. [#19626](https://github.com/cockroachdb/cockroach/pull/19626)

- When an enterprise [`RESTORE`](../v1.1/restore.html) fails or is canceled, partially restored data is now properly cleaned up. [#19653](https://github.com/cockroachdb/cockroach/pull/19653)

- Correctly resume [`RESTORE`](../v1.1/restore.html) jobs that skip [foreign keys](../v1.1/foreign-key.html). [#20168](https://github.com/cockroachdb/cockroach/pull/20168)

- Improved memory usage for certain queries that use [`LIMIT`](../v1.1/select.html#control-quantity-of-returned-rows) at multiple levels. [#19688](https://github.com/cockroachdb/cockroach/pull/19688)

- Fixed a rare panic in [`SET`](../v1.1/set-vars.html). [#19750](https://github.com/cockroachdb/cockroach/pull/19750)

- Fixed a panic in distributed SQL. [#19828](https://github.com/cockroachdb/cockroach/pull/19828)

- Fixed a panic in some [`DELETE`](../v1.1/delete.html) statements. [#19830](https://github.com/cockroachdb/cockroach/pull/19830)

- Fixed grouping of [`ANY/SOME/ALL`](../v1.1/sql-grammar.html#sub_type). [#19831](https://github.com/cockroachdb/cockroach/pull/19831)

- Fixed a panic in [`SHOW KV TRACE`](../v1.1/show-trace.html) with `COUNT(*)`. [#19868](https://github.com/cockroachdb/cockroach/pull/19868)

- Fixed a panic involving the use of the `IN` operator and improperly typed subqueries. [#19878](https://github.com/cockroachdb/cockroach/pull/19878)

- Fixed a bug leading to incorrect results for some queries with [`IN`](../v1.1/functions-and-operators.html#operators) constraints. [#20040](https://github.com/cockroachdb/cockroach/pull/20040)

- Fixed the encoding of indexes that use [`STORING`](../v1.1/create-index.html#store-columns) columns. [#20074](https://github.com/cockroachdb/cockroach/pull/20074)

- Fixed a panic when updating [`COLLATE`](../v1.1/collate.html) and [`DECIMAL`](../v1.1/decimal.html) columns. [#20074](https://github.com/cockroachdb/cockroach/pull/20074)

- Avoid overloading the system during cleanup of large [transactions](../v1.1/transactions.html). [#20083](https://github.com/cockroachdb/cockroach/pull/20083)

- Fixed [`PARTITION BY`](../v1.1/sql-grammar.html#opt_partition_clause) multiple columns with [`WINDOW`](../v1.1/window-functions.html) functions. [#20156](https://github.com/cockroachdb/cockroach/pull/20156)

- Fixed a possible crash due to statements finishing execution after the client connection has been closed. [#20183](https://github.com/cockroachdb/cockroach/pull/20183)

- Write [prometheus vars](../v1.1/monitor-cockroachdb-with-prometheus.html) outside the metrics lock. [#20209](https://github.com/cockroachdb/cockroach/pull/20209)

<h3 id="v1.1.3-doc-updates">Doc Updates</h3>

- Improved Kubernetes guidance:
    - Added a tutorial on [orchestrating a secure CockroachDB cluster with Kubernetes](../v1.1/orchestrate-cockroachdb-with-kubernetes.html), improved the tutorial for [insecure orchstrations](../v1.1/orchestrate-cockroachdb-with-kubernetes-insecure.html), and added a [local cluster tutorial using `minikube`](../v1.1/orchestrate-a-local-cluster-with-kubernetes-insecure.html). [#2147](https://github.com/cockroachdb/docs/pull/2147)
    - Updated the StatefulSet configurations to support rolling upgrades, and added [initial documentation](https://github.com/cockroachdb/cockroach/tree/master/cloud/kubernetes#doing-a-rolling-upgrade-to-a-different-cockroachdb-version). [#19995](https://github.com/cockroachdb/cockroach/pull/19995)
- Added a tutorial on CockroachDB's [follow-the-workload](../v1.1/demo-follow-the-workload.html) capability. [#2194](https://github.com/cockroachdb/docs/pull/2194)
- Documented how to [increase the system-wide file descriptors limit on Linux](../v1.1/recommended-production-settings.html#file-descriptors-limit). [#2139](https://github.com/cockroachdb/docs/pull/2139)
- Clarified that multiple transaction options in a single [`SET TRANSACTION`](../v1.1/set-transaction.html#set-isolation-priority) statement can be space-separated as well as comma-separated. [#2139](https://github.com/cockroachdb/docs/pull/2139)
- Added `e'\x` to the list of supported [hexadecimal-encoded byte array literals](../v1.1/sql-constants.html#hexadecimal-encoded-byte-array-literals) formats. [#2134](https://github.com/cockroachdb/docs/pull/2134)
- Clarified the FAQ on [auto-generating unique row IDs](../v1.1/sql-faqs.html#how-do-i-auto-generate-unique-row-ids-in-cockroachdb). [#2128](https://github.com/cockroachdb/docs/pull/2128)
- Corrected the aliases and allowed widths of various [`INT`](../v1.1/int.html) types. [#2116](https://github.com/cockroachdb/docs/pull/2116)
- Corrected the description of the `--host` flag in our insecure [cloud deployment tutorials](../v1.1/manual-deployment.html). [#2117](https://github.com/cockroachdb/docs/pull/2117)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1.4-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.4.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.4.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.4.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1.4-sql-language-changes">SQL Language Changes</h3>

- For compatibility with PostgreSQL, the `transaction isolation level`, `transaction priority`, and `transaction status` [session variables](../v1.1/set-vars.html) have been renamed `transaction_isolation`, `transaction_priority`, and `transaction_status`. [#20301](https://github.com/cockroachdb/cockroach/pull/20301)
- The [`IMPORT`](../v1.1/import.html) statement now supports `201` and `204` return codes from HTTP storage. [#20516](https://github.com/cockroachdb/cockroach/pull/20516)

<h3 id="v1.1.4-command-line-changes">Command-Line Changes</h3>

- Client [`cockroach` commands](../v1.1/cockroach-commands.html) that use SQL (`cockroach sql`, `cockroach node ls`, etc.) now print a warning if the server is running an older version of CockroachDB than the client. Also, this and other warning messages are now clearly indicated with the "warning:" prefix. [#20945](https://github.com/cockroachdb/cockroach/pull/20945)
- The [`cockroach sql`](../v1.1/use-the-built-in-sql-client.html) command no longer fails when the server is running a version of CockroachDB that does not support the `sql_safe_updates` [session variable](../v1.1/set-vars.html#supported-variables). [#20945](https://github.com/cockroachdb/cockroach/pull/20945)
- The [`cockroach sql`](../v1.1/use-the-built-in-sql-client.html) command now performs client-side syntax checking automatically only if the client and server are running the same version of CockroachDB. This restriction will be lifted in CockroachDB v2.0. [#21135](https://github.com/cockroachdb/cockroach/pull/21135)
- Reduced temporary disk space usage for the `debug compact` command. [#20502](https://github.com/cockroachdb/cockroach/pull/20502)

<h3 id="v1.1.4-bug-fixes">Bug Fixes</h3>

- Improved rebalancing to make thrashing back and forth between nodes much less likely, including when [localities](../v1.1/start-a-node.html#locality) have very different numbers of nodes. [#20934](https://github.com/cockroachdb/cockroach/pull/20934)
- Fixed a scenario where a range that is too big to snapshot can lose availability even with a majority of nodes alive. [#20906](https://github.com/cockroachdb/cockroach/pull/20906)
- Fixed a replica corruption that could occur if a process crashed in the middle of a range split. [#20939](https://github.com/cockroachdb/cockroach/pull/20939)
- Fixed an issue where seemingly irrelevant error messages were being returned for certain [`INSERT`](../v1.1/insert.html) statements.[#20855](https://github.com/cockroachdb/cockroach/pull/20855)
- Crash details are now properly copied to the log file even when a node was started with `--logtostderr` as well as in other circumstances when crash details could be lost previously. [#20842](https://github.com/cockroachdb/cockroach/pull/20842)
- Fixed an issue where wildcards (`_`, `%`) and `` escaped characters in `LIKE` patterns were not handled properly. [#20654](https://github.com/cockroachdb/cockroach/pull/20654)
- Fixed the return type signature of the `array_positions()` [built-in function](../v1.1/functions-and-operators.html). This caused a crash if the function was used in query execution by the distributed execution engine. [#20652](https://github.com/cockroachdb/cockroach/pull/20652)
- Fixed a crash caused by null [collated strings](../v1.1/collate.html). [#20648](https://github.com/cockroachdb/cockroach/pull/20648)
- Fixed a crash caused by `NATURAL JOINS` and `USING` in conjunction with a filter. [#20582](https://github.com/cockroachdb/cockroach/pull/20582)
- Fixed build when new versions of `libgtest` are installed. [#20598](https://github.com/cockroachdb/cockroach/pull/20598)
- Fixed a crash caused by an edge-case when queries are run against a table undergoing a schema change. [#20541](https://github.com/cockroachdb/cockroach/pull/20541)
- Fixed a race condition that would result in some queries hanging after [cancellation](../v1.1/cancel-query.html). [#20534](https://github.com/cockroachdb/cockroach/pull/20534)
- Fixed a crash caused by some corner-case queries containing `ORDER BY`. [#20512](https://github.com/cockroachdb/cockroach/pull/20512)
- Prevented generating empty sstables at the [storage layer](../v1.1/architecture/storage-layer.html), which could cause corruption. [#20284](https://github.com/cockroachdb/cockroach/pull/20284)
- Fixed a crash caused by [`cockroach dump`](../v1.1/sql-dump.html) in the presence of reference cycles. [#20283](https://github.com/cockroachdb/cockroach/pull/20283)
- It is no longer possible to use conflicting `AS OF SYSTEM TIME` clauses in different parts of a query. [#20286](https://github.com/cockroachdb/cockroach/pull/20286)
- Improved S3 resiliency during [`BACKUP`](../v1.1/backup.html)/[`RESTORE`](../v1.1/restore.html)/[`IMPORT`](../v1.1/import.html). [#21003](https://github.com/cockroachdb/cockroach/pull/21003)

<h3 id="v1.1.4-performance-improvements">Performance Improvements</h3>

- Improved garbage collection of very large [transactions](../v1.1/transactions.html) and large volumes of abandoned write intents. [#20446](https://github.com/cockroachdb/cockroach/pull/20446)

<h3 id="v1.1.4-enterprise-edition-changes">Enterprise Edition Changes</h3>

- [`BACKUP`](../v1.1/backup.html)/[`RESTORE`](../v1.1/restore.html) jobs now support `201` and `204` return codes from HTTP storage. [#20516](https://github.com/cockroachdb/cockroach/pull/20516)

<h3 id="v1.1.4-doc-updates">Doc Updates</h3>

- Improved the [initial steps for troubleshooting a problem](../v1.1/troubleshooting-overview.html), and added a list of [common errors with recommended solutions](../v1.1/common-errors.html). [#2311](https://github.com/cockroachdb/docs/pull/2311)
- Updated docs styling to increase information density. [#2304](https://github.com/cockroachdb/docs/pull/2304)
- Documented how to [request and set trial and enterprise license keys for CockroachDB](../v1.1/enterprise-licensing.html). [#2278](https://github.com/cockroachdb/docs/pull/2278)
- Fixed the placement of `AS OF SYSTEM TIME` in enterprise [`BACKUP` examples](../v1.1/backup.html#examples). [#2324](https://github.com/cockroachdb/docs/pull/2324)
- Updated the [secure Kubernetes](../v1.1/orchestrate-cockroachdb-with-kubernetes.html) tutorial with RBAC support. [#2281](https://github.com/cockroachdb/docs/pull/2281)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1.5-downloads">Downloads</h3>

    <div id="os-tabs" class="clearfix">
        <a href="https://binaries.cockroachdb.com/cockroach-v1.1.5.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
        <a href="https://binaries.cockroachdb.com/cockroach-v1.1.5.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
        <a href="https://binaries.cockroachdb.com/cockroach-v1.1.5.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
    </div>

<h3 id="v1.1.5-general-changes">General Changes</h3>

- Removed error messages from SQL execution statistics included in [diagnostic reporting](../v1.1/diagnostics-reporting.html). [#21827][#21827]

<h3 id="v1.1.5-enterprise-edition-changes">Enterprise Edition Changes</h3>

- When external storage is not accessible, [`RESTORE`](../v1.1/restore.html) jobs no longer loop indefinitely during failure or cancellation. [#21573][#21573]

<h3 id="v1.1.5-bug-fixes">Bug Fixes</h3>

- Errors from DDL statements sent by a client as part of a transaction, but in a different query string than the final commit, are no longer silently swallowed. [#21865][#21865]
- [`DROP INDEX`](../v1.1/drop-index.html) with an unqualified index name (without a specific table name) no longer fails if there are [views](../v1.1/views.html) in the database. [#21857][#21857]
- Fixed tuple equality to evaluate correctly in the presence of `NULL` elements. [#21237][#21237]
- Fixed an issue with the wire-formatting of [`BYTES`](../v1.1/bytes.html) arrays. [#21796][#21796]
- Fixed a stack overflow in the code for shutting down a server when out of disk space. [#21804][#21804]
- Fixed incorrect logic in lease rebalancing that prevented leases from being transferred. [#21442][#21442]

<h3 id="v1.1.5-doc-updates">Doc Updates</h3>

- Added [best practices for optimizing SQL performance](../v1.1/performance-best-practices-overview.html) in CockroachDB. [#2243](https://github.com/cockroachdb/docs/pull/2243)
- Added more detailed [clock synchronization guidance per cloud provider](../v1.1/recommended-production-settings.html#clock-synchronization). [#2295](https://github.com/cockroachdb/docs/pull/2295)
- Added a tutorial on using our Kubernetes-orchestrated AWS CloudFormation template for easy deployment and testing of CockroachDB. [#2356](https://github.com/cockroachdb/docs/pull/2356)
- Improved the styling of code samples and page tocs. [#2323](https://github.com/cockroachdb/docs/pull/2323) [#2371](https://github.com/cockroachdb/docs/pull/2371)

<h3 id="v1.1.5-contributors">Contributors</h3>

This release includes 8 merged PRs by 8 authors.

[#21237]: https://github.com/cockroachdb/cockroach/pull/21237
[#21442]: https://github.com/cockroachdb/cockroach/pull/21442
[#21573]: https://github.com/cockroachdb/cockroach/pull/21573
[#21796]: https://github.com/cockroachdb/cockroach/pull/21796
[#21804]: https://github.com/cockroachdb/cockroach/pull/21804
[#21827]: https://github.com/cockroachdb/cockroach/pull/21827
[#21865]: https://github.com/cockroachdb/cockroach/pull/21865
[#21857]: https://github.com/cockroachdb/cockroach/pull/21857
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This release includes several bug fixes and stability improvements.

<h3 id="v1.1.6-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.6.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.6.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.6.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1.6-general-changes">General Changes</h3>

- Disabling [diagnostics reporting](../v1.1/diagnostics-reporting.html) also disables new version notification checks. [#23008][#23008]

<h3 id="v1.1.6-bug-fixes">Bug Fixes</h3>

- Prevented disruptions in performance when gracefully shutting down a node. [#23302][#23302]
- Fixed a zero QPS scenario when gracefully shutting down a node. [#23306][#23306]
- Fixed a panic caused by empty `COCKROACH_UPDATE_CHECK_URL` or `COCKROACH_USAGE_REPORT_URL` environment variables. [#23008][#23008]
- The conversion from [`INTERVAL`](../v1.1/interval.html) to [`FLOAT`](../v1.1/float.html) now properly returns the number of seconds in the interval. [#22893][#22893]
- Fixed a bug that caused queries of virtual tables with an explicit database name prefix (e.g., `select * from mydb.crdb_internal.tables`) to not get scrubbed properly in [diagnostics reporting](../v1.1/diagnostics-reporting.html). [#22815][#22815]
- A `COMMIT` reporting an error generated by a previous parallel statement (i.e., `RETURNING NOTHING`) no longer leaves the connection in an aborted transaction state. Instead, the transaction is considered completed and a `ROLLBACK` is not necessary. [#22814][#22814]
- Fixed an issue with stale buffer data when using the binary format for [`ARRAY`](../v1.1/array.html) values. [#22262][#22262]
- Fixed a bug that caused SQL connection errors during node startup. [#22663][#22663]
- Fixed a bug that included [decommissioned nodes](../v1.1/remove-nodes.html) in cluster stats aggregates. [#22864][#22864]

<h3 id="v1.1.6-contributors">Contributors</h3>

This release includes 12 merged PRs by 11 authors. We would like to thank the following contributors from the CockroachDB community:

- Xudong Zheng

[#22262]: https://github.com/cockroachdb/cockroach/pull/22262
[#22663]: https://github.com/cockroachdb/cockroach/pull/22663
[#22814]: https://github.com/cockroachdb/cockroach/pull/22814
[#22815]: https://github.com/cockroachdb/cockroach/pull/22815
[#22826]: https://github.com/cockroachdb/cockroach/pull/22826
[#22864]: https://github.com/cockroachdb/cockroach/pull/22864
[#22893]: https://github.com/cockroachdb/cockroach/pull/22893
[#23008]: https://github.com/cockroachdb/cockroach/pull/23008
[#23302]: https://github.com/cockroachdb/cockroach/pull/23302
[#23306]: https://github.com/cockroachdb/cockroach/pull/23306
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This release includes several bug fixes and stability improvements.

<h3 id="v1.1.7-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.7.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.7.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.7.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1.7-build-changes">Build Changes</h3>

- CockroachDB now builds with go 1.9.4 and higher. [#23639][#23639]

<h3 id="v1.1.7-bug-fixes">Bug Fixes</h3>

- Fixed a deadlock when tables are rapidly [created](../v1.1/create-table.html) or [dropped](../v2.0/drop-table.html). [#23957][#23957]
- Fixed a rare deadlock for transactions performing schema changes and encountering [retryable errors](../v1.1/transactions.html#error-handling). [#23981][#23981]

<h3 id="v1.1.7-contributors">Contributors</h3>

This release includes 3 merged PRs by 2 authors.

[#23639]: https://github.com/cockroachdb/cockroach/pull/23639
[#23957]: https://github.com/cockroachdb/cockroach/pull/23957
[#23981]: https://github.com/cockroachdb/cockroach/pull/23981
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1.8-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.8.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.8.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.8.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1.8-bug-fixes">Bug Fixes</h3>

- Fixed potential cluster unavailability after Raft logs grow too large. [#24889][#24889]
- `ALTER INDEX ... RENAME` can now be used on the primary index. [#24779][#24779]
- Fixed "dangling rows" left over by transactions including both a schema change and `ROLLBACK TO SAVEPOINT`. [#24888][#24888]

<h3 id="v1.1.8-contributors">Contributors</h3>

This release includes 6 merged PRs by 4 authors.

[#24324]: https://github.com/cockroachdb/cockroach/pull/24324
[#24779]: https://github.com/cockroachdb/cockroach/pull/24779
[#24888]: https://github.com/cockroachdb/cockroach/pull/24888
[#24889]: https://github.com/cockroachdb/cockroach/pull/24889
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v1.1.9-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.9.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.9.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v1.1.9.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v1.1.9-security-bug-fix">Security bug fix</h3>

- Fixed a vulnerability in which TLS certificates were not validated correctly for internal RPC interfaces. This vulnerability could allow an unauthenticated user with network access to read and write to the cluster. [#30821](https://github.com/cockroachdb/cockroach/issues/30821)

<h3 id="v1.1.9-contributors">Contributors</h3>

This release includes 1 merged PR by 1 author.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.0-alpha.20171218-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-alpha.20171218.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-alpha.20171218.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-alpha.20171218.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0-alpha.20171218-sql-language-changes">SQL Language Changes</h3>

- Added support for read-only [transactions](../v2.0/transactions.html) via PostgreSQL-compatible syntax. [#20547](https://github.com/cockroachdb/cockroach/pull/20547)
    - `SET SESSION CHARACTERISTICS AS TRANSACTION READ ONLY/READ WRITE`
    - `SET TRANSACTION READ ONLY/READ WRITE`
    - `SET default_transaction_read_only`
    - `SET transaction_read_only`
- For compatibility with PostgreSQL, the return type of the `date_trunc(STRING,TIME)` [function](../v2.0/functions-and-operators.html) was changed from `TIME` to `INTERVAL`, and the return type of the `date_trunc(STRING,DATE)` function was changed from `DATE` to `TIMESTAMPTZ`. [#20467](https://github.com/cockroachdb/cockroach/pull/20467)

<h3 id="v2.0-alpha.20171218-bug-fixes">Bug Fixes</h3>

- Fixed a bug preventing CockroachDB from starting when the filesystem generates a `lost+found` directory in the Cockroach data directory. [#20565](https://github.com/cockroachdb/cockroach/pull/20565)
- Fixed the over-counting of memory usage by aggregations. [#20585](https://github.com/cockroachdb/cockroach/pull/20585)
- Fix a panic when using the `date_trunc(STRING,TIMESTAMP)` or `date_trunc(STRING,DATE)` function during queries that run with the distributed execution engine. [#20467](https://github.com/cockroachdb/cockroach/pull/20467)
- Fixed a bug where the `date_trunc(STRING,TIMESTAMP)` function would return a `TIMESTAMPTZ` value. [#20467](https://github.com/cockroachdb/cockroach/pull/20467)
- Fixed a race condition that would result in some queries hanging after cancellation. [#20088](https://github.com/cockroachdb/cockroach/pull/20088)
- Fixed a bug allowing [privileges](../v2.0/privileges.html) to be granted to non-existent users. [#20438](https://github.com/cockroachdb/cockroach/pull/20438)

<h3 id="v2.0-alpha.20171218-performance-improvements">Performance Improvements</h3>

- Queries that use inequalities using tuples (e.g., `(a,b,c) < (x,y,z)`) are now slightly better optimized. [#20484](https://github.com/cockroachdb/cockroach/pull/20484)
- `IS DISTINCT FROM` and `IS NOT DISTINCT FROM` clauses are now smarter about using available indexes. [#20346](https://github.com/cockroachdb/cockroach/pull/20346)
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}A bug that could trigger an assertion failure was discovered in this
release. Bringing up a node too soon after the assertion fired could introduce consistency problems, so this release has been withdrawn.{{site.data.alerts.end}}

<!--
<h3 id="v2.0-alpha.20180116-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- Removed the obsolete `kv.gc.batch_size` [cluster setting](../v2.0/cluster-settings.html). [#21070](https://github.com/cockroachdb/cockroach/pull/21070)
- Removed the `COCKROACH_METRICS_SAMPLE_INTERVAL` environment variable. Users that relied on it should reduce the value for the `timeseries.resolution_10s.storage_duration` [cluster setting](../v2.0/cluster-settings.html) instead. [#20810](https://github.com/cockroachdb/cockroach/pull/20810)

<h3 id="v2.0-alpha.20180116-general-changes">General Changes</h3>

- CockroachDB now proactively rebalances data when the diversity of the localities that a given range is located on can be improved. [#19489](https://github.com/cockroachdb/cockroach/pull/19489)
- Clusters are now initialized with default `.meta` and `.liveness` replication zones with lower GC TTL configurations. [#17628](https://github.com/cockroachdb/cockroach/pull/17628)

<h3 id="v2.0-alpha.20180116-sql-language-changes">SQL Language Changes</h3>

- The new `SHOW CREATE SEQUENCE` statement shows the [`CREATE SEQUENCE`](../v2.0/create-sequence.html) statement that would create a carbon copy of the specified sequence. [#21208](https://github.com/cockroachdb/cockroach/pull/21208)
- The [`DROP COLUMN`](../v2.0/drop-column.html) statement now drops [`CHECK`](../v2.0/check.html) constraints. [#21203](https://github.com/cockroachdb/cockroach/pull/21203)
- The `pg_sequence_parameters()` built-in function is now supported. [#21069](https://github.com/cockroachdb/cockroach/pull/21069)
- `ON DELETE CASCADE` foreign key constraints are now fully supported and memory bounded. [#20064](https://github.com/cockroachdb/cockroach/pull/20064) [#20706](https://github.com/cockroachdb/cockroach/pull/20706)
- For improved troubleshooting, more complete and useful details are now reported to clients when SQL errors are encountered. [#19793](https://github.com/cockroachdb/cockroach/pull/19793)
- The new `SHOW SYNTAX` statement allows clients to analyze arbitrary SQL syntax server-side and retrieve either the (pretty-printed) syntax decomposition of the string or the details of the syntax error, if any. This statement is intended for use in the CockroachDB interactive SQL shell. [#19793](https://github.com/cockroachdb/cockroach/pull/19793)
- Enhanced type checking of subqueries in order to generalize subquery support. As a side-effect, fixed a crash with subquery edge cases such as `SELECT (SELECT (1, 2)) IN (SELECT (1, 2))`. [#21076](https://github.com/cockroachdb/cockroach/pull/21076)
- Single-use common table expressions are now supported. [#20359](https://github.com/cockroachdb/cockroach/pull/20359)
- Statement sources with no output columns are now disallowed. [#20998](https://github.com/cockroachdb/cockroach/pull/20998)
- `WHERE` predicates that simplify to NULL no longer performs table scans. [#21067](https://github.com/cockroachdb/cockroach/pull/21067)
- The experimental `CREATE ROLE`, `DROP ROLE`, and `SHOW ROLES` statements are now supported. [#21020](https://github.com/cockroachdb/cockroach/pull/21020)  [#20980](https://github.com/cockroachdb/cockroach/pull/20980)
- Improved the output of `EXPLAIN` to show the plan tree structure. [#20697](https://github.com/cockroachdb/cockroach/pull/20697)
- `OUTER` interleaved joins are now supported. [#20963](https://github.com/cockroachdb/cockroach/pull/20963)
- Added the `rolreplication` and `rolbypassrls` columns to the `pg_catalog.pg_roles` table. [#20397](https://github.com/cockroachdb/cockroach/pull/20397)
- [`ARRAY`](../v2.0/array.html) values can now be cast to their own type. [#19816](https://github.com/cockroachdb/cockroach/pull/19816)
- The `||` operator is now supported for `JSONB`. [#20689](https://github.com/cockroachdb/cockroach/pull/20689)
- The `CASCADE` option is now required to drop an index that is used by Unique constraint. [#20837](https://github.com/cockroachdb/cockroach/pull/20837)
- The `BOOL` type now matches PostgreSQL's list of accepted formats. [#20833](https://github.com/cockroachdb/cockroach/pull/20833)
- The `sql_safe_updates` session variable now defaults to `false` unless the shell is truly interactive (using `cockroach sql`, `-e` not specified, standard input not redirected) and `--unsafe-updates` is not specified. Previously, `sql_safe_updates` would always default to `true` unless `--unsafe-updates` was specified. [#20805](https://github.com/cockroachdb/cockroach/pull/20805)
- The `errexit` client-side option now defaults to `false` only if the shell is truly interactive, not only when the input is not redirected as previously. [#20805](https://github.com/cockroachdb/cockroach/pull/20805)
- The `display_format` client-side option now defaults to `pretty` in every case where the output goes to a terminal, not only when the input is not redirected as previously. [#20805](https://github.com/cockroachdb/cockroach/pull/20805)
- The `check_syntax` and `smart_prompt` client-side options, together with the interactive line editor, are only enabled if the session is interactive and output goes to a terminal. [#20805](https://github.com/cockroachdb/cockroach/pull/20805)
- Table aliases are now permitted in `RETURNING` clauses. [#20808](https://github.com/cockroachdb/cockroach/pull/20808)
- Added the `SERIAL2`, `SERIAL4`, and `SERIAL8` aliases for the [`SERIAL`](../v2.0/serial.html) type. [#20776](https://github.com/cockroachdb/cockroach/pull/20776)
- NULL values are now supported in `COLLATE` expressions. [#20795](https://github.com/cockroachdb/cockroach/pull/20795)
- The new `crdb_internal.node_executable_version()` built-in function simplifies rolling upgrades. [#20292](https://github.com/cockroachdb/cockroach/pull/20292)
- The `json_pretty()`, `json_extract_path()`, `jsonb_extract_path()`, `json_object()`, and `asJSON()` built-in function are now supported. [#20702](https://github.com/cockroachdb/cockroach/pull/20702) [#20520](https://github.com/cockroachdb/cockroach/pull/20520) [#21015](https://github.com/cockroachdb/cockroach/pull/21015) [#20234](https://github.com/cockroachdb/cockroach/pull/20234)
- The `DISTINCT ON` clause is now supported for `SELECT` statements. [#20463](https://github.com/cockroachdb/cockroach/pull/20463)
- For compatibility with PostgreSQL and related tools:
    - Parsing of the `COMMENT ON` syntax is now allowed. [#21063](https://github.com/cockroachdb/cockroach/pull/21063)
    - The following built-in functions are now supported: `pg_catalog.pg_trigger()`, `pg_catalog.pg_rewrite()`, `pg_catalog.pg_operator()`, `pg_catalog.pg_user_mapping()`, `pg_catalog.foreign_data_wrapper()`, `pg_get_constraintdef()`, `inet_client_addr()`, `inet_client_port()`, `inet_server_addr()`, `inet_server_port()`. [#21065](https://github.com/cockroachdb/cockroach/pull/21065) [#20788](https://github.com/cockroachdb/cockroach/pull/20788)
    - Missing columns have been added to `information_schema.columns`, and the `pg_catalog.pg_user()` virtual table has been added. [#20788](https://github.com/cockroachdb/cockroach/pull/20788)
    - A string cast to `regclass` is interpreted as a possibly qualified name like `db.name`. [#20788](https://github.com/cockroachdb/cockroach/pull/20788)
    - Rendered columns for built-in functions are now titled by the name of the built-in function. [#20820](https://github.com/cockroachdb/cockroach/pull/20820)

<h3 id="v2.0-alpha.20180116-command-line-changes">Command-Line Changes</h3>

- Client `cockroach` commands that use SQL (`cockroach sql`, `cockroach node ls`, etc.) now print a warning if the server is running an older version of CockroachDB than the client. Also, this and other warning messages are now clearly indicated with the "warning:" prefix. [#20935](https://github.com/cockroachdb/cockroach/pull/20935)
- Client-side syntax checking performed by [`cockroach sql`](../v2.0/use-the-built-in-sql-client.html) when the `check_syntax` option is enabled has been enhanced for forward-compatibility with later CockroachDB versions. [#21119](https://github.com/cockroachdb/cockroach/pull/21119)
- The `?` [client-side command](../v2.0/use-the-built-in-sql-client.html#sql-shell-commands) of `cockroach sql` now prints out a description of each option. [#21119](https://github.com/cockroachdb/cockroach/pull/21119)
- The `--unsafe-updates` of `cockroach sql` was renamed to `--safe-updates`. The default behavior is unchanged: The previous flag defaulted to `false`; the new flag defaults to `true`. [#20935](https://github.com/cockroachdb/cockroach/pull/20935)
- The `cockroach sql` command no longer fails when the server is running a version of CockroachDB that does not support the sql_safe_updates session variable. [#20935](https://github.com/cockroachdb/cockroach/pull/20935)

<h3 id="v2.0-alpha.20180116-admin-ui-changes">Admin UI Changes</h3>

- Added graphs of node liveness heartbeat latency, an important internal signal of health, to the **Distributed** dashboard. [#21002](https://github.com/cockroachdb/cockroach/pull/21002)
- **Capacity Used** is now shown as "-" instead of 100% when the UI cannot load the real data from the server. [#20824](https://github.com/cockroachdb/cockroach/pull/20824)
- Removed a redundant rendering of the GC pause time from the **CPU Time** graph. [#20802](https://github.com/cockroachdb/cockroach/pull/20802)
- The **Databases** page now reports table sizes that are better approximations to actual disk space usage. [#20627](https://github.com/cockroachdb/cockroach/pull/20627)
- Added a system table to allow operators to designate geographic coordinates for any locality. This is for use with upcoming cluster visualization functionality in the Admin UI. [#19652](https://github.com/cockroachdb/cockroach/pull/19652)

<h3 id="v2.0-alpha.20180116-bug-fixes">Bug Fixes</h3>

- Fixed the `debug compact` command to compact all sstables. [#21293](https://github.com/cockroachdb/cockroach/pull/21293)
- Fixed tuple equality to evaluate correctly in the presence of NULL elements. [#21230](https://github.com/cockroachdb/cockroach/pull/21230)
- Fixed a bug where the temporary directory was being wiped on failed CockroachDB restart, causing importing and DistSQL queries to fail. [#20854](https://github.com/cockroachdb/cockroach/pull/20854)
- The "JSON" column in the output of `EXPLAIN(DISTSQL)` is now properly hidden by default. It can be shown using `SELECT *, JSON FROM [EXPLAIN(DISTSQL) ...]`. [#21154](https://github.com/cockroachdb/cockroach/pull/21154)
- `EXPLAIN` queries with placeholders no longer panic. [#21168](https://github.com/cockroachdb/cockroach/pull/21168)
- The `--safe-updates` flag of `cockroach sql` can now be used effectively in non-interactive sessions. [#20935](https://github.com/cockroachdb/cockroach/pull/20935)
- Fixed a bug where non-matching interleaved rows were being inner-joined with their parent rows. [#20938](https://github.com/cockroachdb/cockroach/pull/20938)
- Fixed an issue where seemingly irrelevant error messages were being returned for certain `INSERT` statements. [#20841](https://github.com/cockroachdb/cockroach/pull/20841)
- Crash details are now properly copied to the log file even when a node was started with `--logtostderr` as well as in other circumstances when crash details could be lost previously. [#20839](https://github.com/cockroachdb/cockroach/pull/20839)
- It is no longer possible to log in as a non-existent user in insecure mode. [#20800](https://github.com/cockroachdb/cockroach/pull/20800)
- The `BIGINT` type alias is now correctly shown when using `SHOW CREATE TABLE`. [#20798](https://github.com/cockroachdb/cockroach/pull/20798)
- Fixed a scenario where a range that is too big to snapshot can lose availability even with a majority of nodes alive. [#20589](https://github.com/cockroachdb/cockroach/pull/20589)
- Fixed `BETWEEN SYMMETRIC`, which was incorrectly considered an alias for `BETWEEN`. Per the SQL99 specification, `BETWEEN SYMMETRIC` is like `BETWEEN`, except that its arguments are automatically swapped if they would specify an empty range. [#20747](https://github.com/cockroachdb/cockroach/pull/20747)
- Fixed a replica corruption that could occur if a process crashed in the middle of a range split. [#20704](https://github.com/cockroachdb/cockroach/pull/20704)
- Fixed an issue with the formatting of unicode values in string arrays. [#20657](https://github.com/cockroachdb/cockroach/pull/20657)
- Fixed detection and proper handling of certain variations of network partitions using server-side RPC keepalive in addition to client-side RPC keepalive. [#20707](https://github.com/cockroachdb/cockroach/pull/20707)
- Prevented RPC connections between nodes with incompatible versions. [#20587](https://github.com/cockroachdb/cockroach/pull/20587)
- Dangling intents are now eagerly cleaned up when `AmbiguousResultErrors` are seen. [#20628](https://github.com/cockroachdb/cockroach/pull/20628)
- Fixed the return type signature of the JSON `#>>` operator and `array_positions()` built-in function. [#20524](https://github.com/cockroachdb/cockroach/pull/20524)
- Fixed an issue where escaped characters like `A` and `\` in `LIKE`/`ILIKE` patterns were not handled properly. [#20600](https://github.com/cockroachdb/cockroach/pull/20600)
- Fixed an issue with `(NOT) (I)LIKE` pattern matching on `_...%` and `%..._` returning incorrect results. [#20600](https://github.com/cockroachdb/cockroach/pull/20600)
- Fixed a small spelling bug that made it such that a `DOUBLE PRECISION` specified type would erroneously display as a float. [#20727](https://github.com/cockroachdb/cockroach/pull/20727)
- Fixed a crash caused by null collated strings. [#20637](https://github.com/cockroachdb/cockroach/pull/20637)

<h3 id="v2.0-alpha.20180116-performance-improvements">Performance Improvements</h3>

- Improved the efficiency of scans with joins and certain complex `WHERE` clauses containing tuple equality. [#21288](https://github.com/cockroachdb/cockroach/pull/21288)
- Improved the efficiency scans for certain `WHERE` clauses. [#21217](https://github.com/cockroachdb/cockroach/pull/21217)
- Reduced per-row overhead in distsql query execution. [#21251](https://github.com/cockroachdb/cockroach/pull/21251)
- Added support for distributed execution of [`UNION`](../v2.0/set-operations.html#union-combine-two-queries) queries. [#21175](https://github.com/cockroachdb/cockroach/pull/21175)
- Improved performance for aggregation and distinct operations by arena allocating "bucket" storage. [#21160](https://github.com/cockroachdb/cockroach/pull/21160)
- Distributed execution of `UNION ALL` queries is now supported. [#20742](https://github.com/cockroachdb/cockroach/pull/20742)
- Reduced the fixed overhead of commands sent through Raft by 40% by only sending lease sequence numbers instead of sending the entire lease structure. [#20953](https://github.com/cockroachdb/cockroach/pull/20953)
- When tables are dropped, the space is now reclaimed in a more timely fashion. [#20607](https://github.com/cockroachdb/cockroach/pull/20607)
- Increased speed of except and merge joins by avoiding an unnecessary allocation. [#20759](https://github.com/cockroachdb/cockroach/pull/20759)
- Improved rebalancing to make thrashing back and forth between nodes much less likely, including when localities have very different numbers of nodes. [#20709](https://github.com/cockroachdb/cockroach/pull/20709)
- Improved performance of `DISTINCT` queries by avoiding an unnecessary allocation. [#20755](https://github.com/cockroachdb/cockroach/pull/20755) [#20750](https://github.com/cockroachdb/cockroach/pull/20750)
- Significantly improved the efficiency of `DROP TABLE` and `TRUNCATE`. [#20601](https://github.com/cockroachdb/cockroach/pull/20601)
- Improved performance of low-level row manipulation routines. [#20688](https://github.com/cockroachdb/cockroach/pull/20688)
- Raft followers now write to their disks in parallel with the leader. [#19229](https://github.com/cockroachdb/cockroach/pull/19229)
- Significantly reduced the overhead of SQL memory accounting. [#20590](https://github.com/cockroachdb/cockroach/pull/20590)
- Equality joins on the entire interleave prefix between parent and (not necessarily direct) child interleaved tables are now faster. [#19853](https://github.com/cockroachdb/cockroach/pull/19853)

<h3 id="v2.0-alpha.20180116-doc-updates">Doc Updates</h3>

- Added a tutorial on using our Kubernetes-orchestrated AWS CloudFormation template for easy deployment and testing of CockroachDB. [#2356](https://github.com/cockroachdb/docs/pull/2356)
- Added docs on the [`TIME`](../v2.0/time.html) data type. [#2336](https://github.com/cockroachdb/docs/pull/2336)
- Added guidance on [reducing or disabling the storage of timeseries data](../v2.0/operational-faqs.html#can-i-reduce-or-disable-the-storage-of-timeseries-data-new-in-v2-0). [#2361](https://github.com/cockroachdb/docs/pull/2361)
- Added docs on the [`CREATE SEQUENCE`](../v2.0/create-sequence.html), [`ALTER SEQUENCE`](../v2.0/alter-sequence.html), and [`DROP SEQUENCE`](../v2.0/drop-sequence.html) statements. [#2292](https://github.com/cockroachdb/docs/pull/2292)
- Improved the font and coloring of code samples. [#2323](https://github.com/cockroachdb/docs/pull/2323)
-->
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}A bug that could trigger range splits in a tight loop was discovered in this release, so this release has been withdrawn.{{site.data.alerts.end}}

<h3 id="v2.0-alpha.20180122-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- Removed the obsolete `kv.gc.batch_size` [cluster setting](../v2.0/cluster-settings.html). [#21070](https://github.com/cockroachdb/cockroach/pull/21070)
- Removed the `COCKROACH_METRICS_SAMPLE_INTERVAL` environment variable. Users that relied on it should reduce the value for the `timeseries.resolution_10s.storage_duration` [cluster setting](../v2.0/cluster-settings.html) instead. [#20810](https://github.com/cockroachdb/cockroach/pull/20810)

<h3 id="v2.0-alpha.20180122-general-changes">General Changes</h3>

- CockroachDB now proactively rebalances data when the diversity of the localities that a given range is located on can be improved. [#19489](https://github.com/cockroachdb/cockroach/pull/19489)
- Clusters are now initialized with default `.meta` and `.liveness` replication zones with lower GC TTL configurations. [#17628](https://github.com/cockroachdb/cockroach/pull/17628)
- CockroachDB now uses gRPC version 1.9.1 [#21398]

<h3 id="v2.0-alpha.20180122-build-changes">Build Changes</h3>

- The build system now enforces a minimum version of Go, rather than enforcing a specific version of Go. Since the Go 1.x series has strict backward-compatibility guarantees, the old rule was unnecessarily restrictive. [#21426]

<h3 id="v2.0-alpha.20180122-sql-language-changes">SQL Language Changes</h3>

- The new `SHOW CREATE SEQUENCE` statement shows the [`CREATE SEQUENCE`](../v2.0/create-sequence.html) statement that would create a carbon copy of the specified sequence. [#21208](https://github.com/cockroachdb/cockroach/pull/21208)
- The [`DROP COLUMN`](../v2.0/drop-column.html) statement now drops [`CHECK`](../v2.0/check.html) constraints. [#21203](https://github.com/cockroachdb/cockroach/pull/21203)
- The `pg_sequence_parameters()` built-in function is now supported. [#21069](https://github.com/cockroachdb/cockroach/pull/21069)
- `ON DELETE CASCADE` foreign key constraints are now fully supported and memory bounded. [#20064](https://github.com/cockroachdb/cockroach/pull/20064) [#20706](https://github.com/cockroachdb/cockroach/pull/20706)
- `ON UPDATE CASCADE` foreign key constraints are now fully supported [#21329]
- For improved troubleshooting, more complete and useful details are now reported to clients when SQL errors are encountered. [#19793](https://github.com/cockroachdb/cockroach/pull/19793)
- The new `SHOW SYNTAX` statement allows clients to analyze arbitrary SQL syntax server-side and retrieve either the (pretty-printed) syntax decomposition of the string or the details of the syntax error, if any. This statement is intended for use in the CockroachDB interactive SQL shell. [#19793](https://github.com/cockroachdb/cockroach/pull/19793)
- Enhanced type checking of subqueries in order to generalize subquery support. As a side-effect, fixed a crash with subquery edge cases such as `SELECT (SELECT (1, 2)) IN (SELECT (1, 2))`. [#21076](https://github.com/cockroachdb/cockroach/pull/21076)
- Single-use common table expressions are now supported. [#20359](https://github.com/cockroachdb/cockroach/pull/20359)
- Statement sources with no output columns are now disallowed. [#20998](https://github.com/cockroachdb/cockroach/pull/20998)
- `WHERE` predicates that simplify to `NULL` no longer performs table scans. [#21067](https://github.com/cockroachdb/cockroach/pull/21067)
- The experimental `CREATE ROLE`, `DROP ROLE`, `SHOW ROLES`, `GRANT <role>`, and `REVOKE <role>` statements are now supported as part of [role-based access
control](https://github.com/cockroachdb/cockroach/blob/master/docs/RFCS/20171220_sql_role_based_access_control.md). [#21020](https://github.com/cockroachdb/cockroach/pull/21020)  [#20980](https://github.com/cockroachdb/cockroach/pull/20980) [#21341]
- Improved the output of `EXPLAIN` to show the plan tree structure. [#20697](https://github.com/cockroachdb/cockroach/pull/20697)
- `OUTER` interleaved joins are now supported. [#20963](https://github.com/cockroachdb/cockroach/pull/20963)
- Added the `rolreplication` and `rolbypassrls` columns to the `pg_catalog.pg_roles` table. [#20397](https://github.com/cockroachdb/cockroach/pull/20397)
- [`ARRAY`](../v2.0/array.html) values can now be cast to their own type. [#19816](https://github.com/cockroachdb/cockroach/pull/19816)
- The `||` operator is now supported for `JSONB`. [#20689](https://github.com/cockroachdb/cockroach/pull/20689)
- The `CASCADE` option is now required to drop an index that is used by Unique constraint. [#20837](https://github.com/cockroachdb/cockroach/pull/20837)
- The `BOOL` type now matches PostgreSQL's list of accepted formats. [#20833](https://github.com/cockroachdb/cockroach/pull/20833)
- The `sql_safe_updates` session variable now defaults to `false` unless the shell is truly interactive (using `cockroach sql`, `-e` not specified, standard input not redirected) and `--unsafe-updates` is not specified. Previously, `sql_safe_updates` would always default to `true` unless `--unsafe-updates` was specified. [#20805](https://github.com/cockroachdb/cockroach/pull/20805)
- The `errexit` client-side option now defaults to `false` only if the shell is truly interactive, not only when the input is not redirected as previously. [#20805](https://github.com/cockroachdb/cockroach/pull/20805)
- The `display_format` client-side option now defaults to `pretty` in every case where the output goes to a terminal, not only when the input is not redirected as previously. [#20805](https://github.com/cockroachdb/cockroach/pull/20805)
- The `check_syntax` and `smart_prompt` client-side options, together with the interactive line editor, are only enabled if the session is interactive and output goes to a terminal. [#20805](https://github.com/cockroachdb/cockroach/pull/20805)
- Table aliases are now permitted in `RETURNING` clauses. [#20808](https://github.com/cockroachdb/cockroach/pull/20808)
- Added the `SERIAL2`, `SERIAL4`, and `SERIAL8` aliases for the [`SERIAL`](../v2.0/serial.html) type. [#20776](https://github.com/cockroachdb/cockroach/pull/20776)
- `NULL` values are now supported in `COLLATE` expressions. [#20795](https://github.com/cockroachdb/cockroach/pull/20795)
- The new `crdb_internal.node_executable_version()` built-in function simplifies rolling upgrades. [#20292](https://github.com/cockroachdb/cockroach/pull/20292)
- The `json_pretty()`, `json_extract_path()`, `jsonb_extract_path()`, `json_object()`, `asJSON()`, `jsonb_set()`, `json_build_object()`, `json_strip_nulls()`, and `json_each{_text}()` built-in functions are now supported. [#20702](https://github.com/cockroachdb/cockroach/pull/20702) [#20520](https://github.com/cockroachdb/cockroach/pull/20520) [#21015](https://github.com/cockroachdb/cockroach/pull/21015) [#20234](https://github.com/cockroachdb/cockroach/pull/20234) [#21010] [#21019] [#21335] [#21044]
- The `DISTINCT ON` clause is now supported for `SELECT` statements. [#20463](https://github.com/cockroachdb/cockroach/pull/20463)
- The output of [`EXPLAIN`](../v2.0/explain.html) is now enhanced when applied to statements containing scalar sub-queries. [#21305]
- The `array_agg()` built-in function is now supported in distributed queries. [#21475]
- Removed the limit on transaction keys. There was formerly a limit of 100,000 keys. [#21078]
- Improved the error message when a column reference is ambiguous. [#21361]
- The new `SHOW EXPERIMENTAL_REPLICA TRACE` statement executes a query and returns which nodes served reads and writes. [#21349]
- Multiplication between [`INTERVAL`](../v2.0/interval.html) and [`FLOAT`](../v2.0/float.html) values, and between `INTERVAL` and [`DECIMAL`](../v2.0/decimal.html) values, is now fully supported. [#21292]
- Reduced the size of entries stored in the `system.rangelog` table by not storing empty JSON fields. [#21318]
- The `ALTER TABLE SCATTER` statement now randomizes the locations of the leases for all ranges in the referenced table or index. [#21431]
- When using HTTPS storage for [`IMPORT`](../v2.0/import.html), a custom CA for HTTPS storage providers can now be specified via the `cloudstorage.http.custom_ca` cluster setting. This is also used when accessing custom s3 export storage endpoints. [#21358] [#21404]
- Storage of timeseries data within the cluster can be disabled by setting the new `timeseries.storage.enabled` cluster setting to false. This is recommended only if you exclusively use a third-party tool such as Prometheus for timeseries monitoring. See this [FAQ](../v2.0/operational-faqs.html#can-i-reduce-or-disable-the-storage-of-timeseries-data-new-in-v2-0) for more details. [#21314]
- For compatibility with PostgreSQL and related tools:
    - Parsing of the `COMMENT ON` syntax is now allowed. [#21063](https://github.com/cockroachdb/cockroach/pull/21063)
    - The following built-in functions are now supported: `pg_catalog.pg_trigger()`, `pg_catalog.pg_rewrite()`, `pg_catalog.pg_operator()`, `pg_catalog.pg_user_mapping()`, `pg_catalog.foreign_data_wrapper()`, `pg_get_constraintdef()`, `inet_client_addr()`, `inet_client_port()`, `inet_server_addr()`, `inet_server_port()`. [#21065](https://github.com/cockroachdb/cockroach/pull/21065) [#20788](https://github.com/cockroachdb/cockroach/pull/20788)
    - Missing columns have been added to `information_schema.columns`, and the `pg_catalog.pg_user()` virtual table has been added. [#20788](https://github.com/cockroachdb/cockroach/pull/20788)
    - A string cast to `regclass` is interpreted as a possibly qualified name like `db.name`. [#20788](https://github.com/cockroachdb/cockroach/pull/20788)
    - Rendered columns for built-in functions are now titled by the name of the built-in function. [#20820](https://github.com/cockroachdb/cockroach/pull/20820)

<h3 id="v2.0-alpha.20180122-command-line-changes">Command-Line Changes</h3>

- Client `cockroach` commands that use SQL (`cockroach sql`, `cockroach node ls`, etc.) now print a warning if the server is running an older version of CockroachDB than the client. Also, this and other warning messages are now clearly indicated with the "warning:" prefix. [#20935](https://github.com/cockroachdb/cockroach/pull/20935)
- Client-side syntax checking performed by [`cockroach sql`](../v2.0/use-the-built-in-sql-client.html) when the `check_syntax` option is enabled has been enhanced for forward-compatibility with later CockroachDB versions. [#21119](https://github.com/cockroachdb/cockroach/pull/21119)
- The `?` [client-side command](../v2.0/use-the-built-in-sql-client.html#sql-shell-commands) of `cockroach sql` now prints out a description of each option. [#21119](https://github.com/cockroachdb/cockroach/pull/21119)
- The `--unsafe-updates` of `cockroach sql` was renamed to `--safe-updates`. The default behavior is unchanged: The previous flag defaulted to `false`; the new flag defaults to `true`. [#20935](https://github.com/cockroachdb/cockroach/pull/20935)
- The `cockroach sql` command no longer fails when the server is running a version of CockroachDB that does not support the sql_safe_updates session variable. [#20935](https://github.com/cockroachdb/cockroach/pull/20935)

<h3 id="v2.0-alpha.20180122-admin-ui-changes">Admin UI Changes</h3>

- Added graphs of node liveness heartbeat latency, an important internal signal of health, to the **Distributed** dashboard. [#21002](https://github.com/cockroachdb/cockroach/pull/21002)
- **Capacity Used** is now shown as "-" instead of 100% when the UI cannot load the real data from the server. [#20824](https://github.com/cockroachdb/cockroach/pull/20824)
- Removed a redundant rendering of the GC pause time from the **CPU Time** graph. [#20802](https://github.com/cockroachdb/cockroach/pull/20802)
- The **Databases** page now reports table sizes that are better approximations to actual disk space usage. [#20627](https://github.com/cockroachdb/cockroach/pull/20627)
- Added a system table to allow operators to designate geographic coordinates for any locality. This is for use with upcoming cluster visualization functionality in the Admin UI. [#19652](https://github.com/cockroachdb/cockroach/pull/19652)
- When a new version of CockroachDB is available, the Admin UI now links you to the documentation explaining how to upgrade your cluster. [#19718]
- Job descriptions are now expandable. [#21333]

<h3 id="v2.0-alpha.20180122-bug-fixes">Bug Fixes</h3>

- Fixed the `debug compact` command to compact all sstables. [#21293](https://github.com/cockroachdb/cockroach/pull/21293)
- Fixed tuple equality to evaluate correctly in the presence of `NULL` elements. [#21230](https://github.com/cockroachdb/cockroach/pull/21230)
- Fixed a bug where the temporary directory was being wiped on failed CockroachDB restart, causing importing and DistSQL queries to fail. [#20854](https://github.com/cockroachdb/cockroach/pull/20854)
- The "JSON" column in the output of `EXPLAIN(DISTSQL)` is now properly hidden by default. It can be shown using `SELECT *, JSON FROM [EXPLAIN(DISTSQL) ...]`. [#21154](https://github.com/cockroachdb/cockroach/pull/21154)
- `EXPLAIN` queries with placeholders no longer panic. [#21168](https://github.com/cockroachdb/cockroach/pull/21168)
- The `--safe-updates` flag of `cockroach sql` can now be used effectively in non-interactive sessions. [#20935](https://github.com/cockroachdb/cockroach/pull/20935)
- Fixed a bug where non-matching interleaved rows were being inner-joined with their parent rows. [#20938](https://github.com/cockroachdb/cockroach/pull/20938)
- Fixed an issue where seemingly irrelevant error messages were being returned for certain `INSERT` statements. [#20841](https://github.com/cockroachdb/cockroach/pull/20841)
- Crash details are now properly copied to the log file even when a node was started with `--logtostderr` as well as in other circumstances when crash details could be lost previously. [#20839](https://github.com/cockroachdb/cockroach/pull/20839)
- It is no longer possible to log in as a non-existent user in insecure mode. [#20800](https://github.com/cockroachdb/cockroach/pull/20800)
- The `BIGINT` type alias is now correctly shown when using `SHOW CREATE TABLE`. [#20798](https://github.com/cockroachdb/cockroach/pull/20798)
- Fixed a scenario where a range that is too big to snapshot can lose availability even with a majority of nodes alive. [#20589](https://github.com/cockroachdb/cockroach/pull/20589)
- Fixed `BETWEEN SYMMETRIC`, which was incorrectly considered an alias for `BETWEEN`. Per the SQL99 specification, `BETWEEN SYMMETRIC` is like `BETWEEN`, except that its arguments are automatically swapped if they would specify an empty range. [#20747](https://github.com/cockroachdb/cockroach/pull/20747)
- Fixed a replica corruption that could occur if a process crashed in the middle of a range split. [#20704](https://github.com/cockroachdb/cockroach/pull/20704)
- Fixed an issue with the formatting of unicode values in string arrays. [#20657](https://github.com/cockroachdb/cockroach/pull/20657)
- Fixed detection and proper handling of certain variations of network partitions using server-side RPC keepalive in addition to client-side RPC keepalive. [#20707](https://github.com/cockroachdb/cockroach/pull/20707)
- Prevented RPC connections between nodes with incompatible versions. [#20587](https://github.com/cockroachdb/cockroach/pull/20587)
- Dangling intents are now eagerly cleaned up when `AmbiguousResultErrors` are seen. [#20628](https://github.com/cockroachdb/cockroach/pull/20628)
- Fixed the return type signature of the JSON `#>>` operator and `array_positions()` built-in function. [#20524](https://github.com/cockroachdb/cockroach/pull/20524)
- Fixed an issue where escaped characters like `A` and `\` in `LIKE`/`ILIKE` patterns were not handled properly. [#20600](https://github.com/cockroachdb/cockroach/pull/20600)
- Fixed an issue with `(NOT) (I)LIKE` pattern matching on `_...%` and `%..._` returning incorrect results. [#20600](https://github.com/cockroachdb/cockroach/pull/20600)
- Fixed a small spelling bug that made it such that a `DOUBLE PRECISION` specified type would erroneously display as a float. [#20727](https://github.com/cockroachdb/cockroach/pull/20727)
- Fixed a crash caused by null collated strings. [#20637](https://github.com/cockroachdb/cockroach/pull/20637)
- Fixed a problem that could cause spurious garbage collection activity, in particular after dropping a table. [#21407]
- Fixed incorrect logic in lease rebalancing that prevented leases from being transferred [#21430]
- `INSERT`/`UPDATE`/`DELETE ... RETURNING` statements used with the "statement data source" syntax (e.g., `SELECT * FROM  [INSERT INTO ... RETURNING ...]`) no longer ever commit the transaction, causing errors for the higher-level query. [#20847]
- Fixed a crash caused by a column being backfilled in an index constraint. [#21308]
- Fixed a bug in which ranges could get stuck if the uncommitted raft log grew too large [#21356]
- The `setval()` built-in function no longer lets you set a value outside the `MAXVALUE`/`MINVALUE` of a [`SEQUENCE`](../v2.0/create-sequence.html). [#20973]

<h3 id="v2.0-alpha.20180122-performance-improvements">Performance Improvements</h3>

- Improved the efficiency of scans with joins and certain complex `WHERE` clauses containing tuple equality. [#21288](https://github.com/cockroachdb/cockroach/pull/21288)
- Improved the efficiency scans for certain `WHERE` clauses. [#21217](https://github.com/cockroachdb/cockroach/pull/21217)
- Reduced per-row overhead in distsql query execution. [#21251](https://github.com/cockroachdb/cockroach/pull/21251)
- Added support for distributed execution of [`UNION`](../v2.0/selection-queries.html#union-combine-two-queries) queries. [#21175](https://github.com/cockroachdb/cockroach/pull/21175)
- Improved performance for aggregation and distinct operations by arena allocating "bucket" storage. [#21160](https://github.com/cockroachdb/cockroach/pull/21160)
- Distributed execution of `UNION ALL` queries is now supported. [#20742](https://github.com/cockroachdb/cockroach/pull/20742)
- Reduced the fixed overhead of commands sent through Raft by 40% by only sending lease sequence numbers instead of sending the entire lease structure. [#20953](https://github.com/cockroachdb/cockroach/pull/20953)
- When tables are dropped, the space is now reclaimed in a more timely fashion. [#20607](https://github.com/cockroachdb/cockroach/pull/20607)
- Increased speed of except and merge joins by avoiding an unnecessary allocation. [#20759](https://github.com/cockroachdb/cockroach/pull/20759)
- Improved rebalancing to make thrashing back and forth between nodes much less likely, including when localities have very different numbers of nodes. [#20709](https://github.com/cockroachdb/cockroach/pull/20709)
- Improved performance of `DISTINCT` queries by avoiding an unnecessary allocation. [#20755](https://github.com/cockroachdb/cockroach/pull/20755) [#20750](https://github.com/cockroachdb/cockroach/pull/20750)
- Significantly improved the efficiency of `DROP TABLE` and `TRUNCATE`. [#20601](https://github.com/cockroachdb/cockroach/pull/20601)
- Improved performance of low-level row manipulation routines. [#20688](https://github.com/cockroachdb/cockroach/pull/20688)
- Raft followers now write to their disks in parallel with the leader. [#19229](https://github.com/cockroachdb/cockroach/pull/19229)
- Significantly reduced the overhead of SQL memory accounting. [#20590](https://github.com/cockroachdb/cockroach/pull/20590)
- Equality joins on the entire interleave prefix between parent and (not necessarily direct) child interleaved tables are now faster. [#19853](https://github.com/cockroachdb/cockroach/pull/19853)
- Improved the performance of scans that need to look at non-indexed columns. [#21459]
- Improved the performance of all scans that encounter a large number of versions per key, and the low-level reverse scan throughput by up almost 4x when there are a few versions per key.. [#21438]
- Queries on tables with many columns are now more efficient. [#21450]
- Queries that only need to read part of a table with many columns are now more efficient. [#21450]
- Improved low-level scan performance by 15-20% by disabling redundant checksums. [#21395]
- Re-implemented low-level scan operations in C++, doubling performance for scans of contiguous keys/rows. [#21395]
- Reduced the occurrence of ambiguous errors when a node is down. [#21376]
- Sped up distsql query execution by "fusing" processors executing on the same node together. [#21254]

<h3 id="v2.0-alpha.20180122-enterprise-edition-changes">Enterprise Edition Changes</h3>

- [Incremental backups](../v2.0/backup.html#incremental-backups) of a database after a table or index was added is now supported.[#21170]
- When using HTTPS storage for [`BACKUP`](../v2.0/backup.html) or [`RESTORE`](../v2.0/restore.html), a custom CA for HTTPS storage providers can now be specified via the `cloudstorage.http.custom_ca` cluster setting. This is also used when accessing custom s3 export storage endpoints. [#21358] [#21404]
- Bulk writes are now synced to disk periodically to ensure more predictable performance. [#20449]

<h3 id="v2.0-alpha.20180122-doc-updates">Doc Updates</h3>

- Added [best practices for optimizing SQL performance](../v2.0/performance-best-practices-overview.html) in CockroachDB. [#2243](https://github.com/cockroachdb/docs/pull/2243)
- Added more detailed [clock synchronization guidance per cloud provider](../v2.0/recommended-production-settings.html#clock-synchronization). [#2295](https://github.com/cockroachdb/docs/pull/2295)
- Added a tutorial on using our Kubernetes-orchestrated AWS CloudFormation template for easy deployment and testing of CockroachDB. [#2356](https://github.com/cockroachdb/docs/pull/2356)
- Added docs on the [`TIME`](../v2.0/time.html) data type. [#2336](https://github.com/cockroachdb/docs/pull/2336)
- Added guidance on [reducing or disabling the storage of timeseries data](../v2.0/operational-faqs.html#can-i-reduce-or-disable-the-storage-of-timeseries-data-new-in-v2-0). [#2361](https://github.com/cockroachdb/docs/pull/2361)
- Added docs on the [`CREATE SEQUENCE`](../v2.0/create-sequence.html), [`ALTER SEQUENCE`](../v2.0/alter-sequence.html), and [`DROP SEQUENCE`](../v2.0/drop-sequence.html) statements. [#2292](https://github.com/cockroachdb/docs/pull/2292)
- Various improvements to the docs on the [`IMPORT`](../v2.0/import.html), [`BACKUP`](../v2.0/backup.html), and [`RESTORE`](../v2.0/restore.html) statements. [#2340](https://github.com/cockroachdb/docs/pull/2340)
- Improved the styling of code samples and page tocs. [#2323](https://github.com/cockroachdb/docs/pull/2323) [#2371](https://github.com/cockroachdb/docs/pull/2371)

<h3 id="v2.0-alpha.20180122-contributors">Contributors</h3>

This release includes 111 merged PRs by 33 authors. We would like to thank the following contributors from the CockroachDB community:

- Yang Yuting
- Dmitry Saveliev
- Jincheng Li
- Mohamed Elqdusy
- 何羿宏
- louishust

[#19718]: https://github.com/cockroachdb/cockroach/pull/19718
[#20449]: https://github.com/cockroachdb/cockroach/pull/20449
[#20632]: https://github.com/cockroachdb/cockroach/pull/20632
[#20645]: https://github.com/cockroachdb/cockroach/pull/20645
[#20710]: https://github.com/cockroachdb/cockroach/pull/20710
[#20721]: https://github.com/cockroachdb/cockroach/pull/20721
[#20735]: https://github.com/cockroachdb/cockroach/pull/20735
[#20825]: https://github.com/cockroachdb/cockroach/pull/20825
[#20847]: https://github.com/cockroachdb/cockroach/pull/20847
[#20950]: https://github.com/cockroachdb/cockroach/pull/20950
[#20971]: https://github.com/cockroachdb/cockroach/pull/20971
[#20972]: https://github.com/cockroachdb/cockroach/pull/20972
[#20973]: https://github.com/cockroachdb/cockroach/pull/20973
[#20976]: https://github.com/cockroachdb/cockroach/pull/20976
[#21010]: https://github.com/cockroachdb/cockroach/pull/21010
[#21019]: https://github.com/cockroachdb/cockroach/pull/21019
[#21044]: https://github.com/cockroachdb/cockroach/pull/21044
[#21078]: https://github.com/cockroachdb/cockroach/pull/21078
[#21118]: https://github.com/cockroachdb/cockroach/pull/21118
[#21120]: https://github.com/cockroachdb/cockroach/pull/21120
[#21170]: https://github.com/cockroachdb/cockroach/pull/21170
[#21177]: https://github.com/cockroachdb/cockroach/pull/21177
[#21180]: https://github.com/cockroachdb/cockroach/pull/21180
[#21254]: https://github.com/cockroachdb/cockroach/pull/21254
[#21263]: https://github.com/cockroachdb/cockroach/pull/21263
[#21267]: https://github.com/cockroachdb/cockroach/pull/21267
[#21268]: https://github.com/cockroachdb/cockroach/pull/21268
[#21272]: https://github.com/cockroachdb/cockroach/pull/21272
[#21274]: https://github.com/cockroachdb/cockroach/pull/21274
[#21275]: https://github.com/cockroachdb/cockroach/pull/21275
[#21279]: https://github.com/cockroachdb/cockroach/pull/21279
[#21280]: https://github.com/cockroachdb/cockroach/pull/21280
[#21292]: https://github.com/cockroachdb/cockroach/pull/21292
[#21297]: https://github.com/cockroachdb/cockroach/pull/21297
[#21299]: https://github.com/cockroachdb/cockroach/pull/21299
[#21305]: https://github.com/cockroachdb/cockroach/pull/21305
[#21307]: https://github.com/cockroachdb/cockroach/pull/21307
[#21308]: https://github.com/cockroachdb/cockroach/pull/21308
[#21312]: https://github.com/cockroachdb/cockroach/pull/21312
[#21313]: https://github.com/cockroachdb/cockroach/pull/21313
[#21314]: https://github.com/cockroachdb/cockroach/pull/21314
[#21315]: https://github.com/cockroachdb/cockroach/pull/21315
[#21317]: https://github.com/cockroachdb/cockroach/pull/21317
[#21318]: https://github.com/cockroachdb/cockroach/pull/21318
[#21319]: https://github.com/cockroachdb/cockroach/pull/21319
[#21322]: https://github.com/cockroachdb/cockroach/pull/21322
[#21325]: https://github.com/cockroachdb/cockroach/pull/21325
[#21328]: https://github.com/cockroachdb/cockroach/pull/21328
[#21329]: https://github.com/cockroachdb/cockroach/pull/21329
[#21330]: https://github.com/cockroachdb/cockroach/pull/21330
[#21333]: https://github.com/cockroachdb/cockroach/pull/21333
[#21335]: https://github.com/cockroachdb/cockroach/pull/21335
[#21336]: https://github.com/cockroachdb/cockroach/pull/21336
[#21339]: https://github.com/cockroachdb/cockroach/pull/21339
[#21341]: https://github.com/cockroachdb/cockroach/pull/21341
[#21344]: https://github.com/cockroachdb/cockroach/pull/21344
[#21346]: https://github.com/cockroachdb/cockroach/pull/21346
[#21347]: https://github.com/cockroachdb/cockroach/pull/21347
[#21349]: https://github.com/cockroachdb/cockroach/pull/21349
[#21352]: https://github.com/cockroachdb/cockroach/pull/21352
[#21353]: https://github.com/cockroachdb/cockroach/pull/21353
[#21356]: https://github.com/cockroachdb/cockroach/pull/21356
[#21358]: https://github.com/cockroachdb/cockroach/pull/21358
[#21359]: https://github.com/cockroachdb/cockroach/pull/21359
[#21361]: https://github.com/cockroachdb/cockroach/pull/21361
[#21365]: https://github.com/cockroachdb/cockroach/pull/21365
[#21366]: https://github.com/cockroachdb/cockroach/pull/21366
[#21368]: https://github.com/cockroachdb/cockroach/pull/21368
[#21370]: https://github.com/cockroachdb/cockroach/pull/21370
[#21374]: https://github.com/cockroachdb/cockroach/pull/21374
[#21375]: https://github.com/cockroachdb/cockroach/pull/21375
[#21376]: https://github.com/cockroachdb/cockroach/pull/21376
[#21377]: https://github.com/cockroachdb/cockroach/pull/21377
[#21379]: https://github.com/cockroachdb/cockroach/pull/21379
[#21380]: https://github.com/cockroachdb/cockroach/pull/21380
[#21381]: https://github.com/cockroachdb/cockroach/pull/21381
[#21382]: https://github.com/cockroachdb/cockroach/pull/21382
[#21388]: https://github.com/cockroachdb/cockroach/pull/21388
[#21389]: https://github.com/cockroachdb/cockroach/pull/21389
[#21391]: https://github.com/cockroachdb/cockroach/pull/21391
[#21392]: https://github.com/cockroachdb/cockroach/pull/21392
[#21393]: https://github.com/cockroachdb/cockroach/pull/21393
[#21395]: https://github.com/cockroachdb/cockroach/pull/21395
[#21397]: https://github.com/cockroachdb/cockroach/pull/21397
[#21398]: https://github.com/cockroachdb/cockroach/pull/21398
[#21401]: https://github.com/cockroachdb/cockroach/pull/21401
[#21403]: https://github.com/cockroachdb/cockroach/pull/21403
[#21404]: https://github.com/cockroachdb/cockroach/pull/21404
[#21405]: https://github.com/cockroachdb/cockroach/pull/21405
[#21407]: https://github.com/cockroachdb/cockroach/pull/21407
[#21422]: https://github.com/cockroachdb/cockroach/pull/21422
[#21426]: https://github.com/cockroachdb/cockroach/pull/21426
[#21427]: https://github.com/cockroachdb/cockroach/pull/21427
[#21428]: https://github.com/cockroachdb/cockroach/pull/21428
[#21430]: https://github.com/cockroachdb/cockroach/pull/21430
[#21431]: https://github.com/cockroachdb/cockroach/pull/21431
[#21436]: https://github.com/cockroachdb/cockroach/pull/21436
[#21438]: https://github.com/cockroachdb/cockroach/pull/21438
[#21439]: https://github.com/cockroachdb/cockroach/pull/21439
[#21441]: https://github.com/cockroachdb/cockroach/pull/21441
[#21448]: https://github.com/cockroachdb/cockroach/pull/21448
[#21449]: https://github.com/cockroachdb/cockroach/pull/21449
[#21450]: https://github.com/cockroachdb/cockroach/pull/21450
[#21457]: https://github.com/cockroachdb/cockroach/pull/21457
[#21459]: https://github.com/cockroachdb/cockroach/pull/21459
[#21466]: https://github.com/cockroachdb/cockroach/pull/21466
[#21469]: https://github.com/cockroachdb/cockroach/pull/21469
[#21472]: https://github.com/cockroachdb/cockroach/pull/21472
[#21475]: https://github.com/cockroachdb/cockroach/pull/21475
[#21484]: https://github.com/cockroachdb/cockroach/pull/21484
[#21493]: https://github.com/cockroachdb/cockroach/pull/21493
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.0-alpha.20180129-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-alpha.20180129.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-alpha.20180129.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-alpha.20180129.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0-alpha.20180129-general-changes">General Changes</h3>

- CockroachDB now uses gRPC version 1.9.2 [#21600][#21600]

<h3 id="v2.0-alpha.20180129-enterprise-changes">Enterprise Changes</h3>

- Failed [`RESTORE`](../v2.0/restore.html) cleanup no longer causes the [`RESTORE`](../v2.0/restore.html) job to perpetually loop if external storage fails or is removed. [#21559][#21559]
- Non-transactional [`BACKUP`](../v2.0/backup.html) and [`RESTORE`](../v2.0/restore.html) statements are now disallowed inside transactions. [#21488][#21488]

<h3 id="v2.0-alpha.20180129-sql-language-changes">SQL Language Changes</h3>

- Reduced the size of `system.rangelog` entries to save disk space. [#21410][#21410]
- Prevented adding both a cascading referential constraint action and a check constraint to a column. [#21690][#21690]
- Added `json_array_length` function that returns the number of elements in the outermost `JSON` or `JSONB` array. [#21611][#21611]
- Added `referential_constraints` table to the [`information_schema`](../v2.0/information-schema.html). The `referential_constraints` table contains all foreign key constraints in the current database. [#21615][#21615]
- Replaced `BOOL` columns in the [`information_schema`](../v2.0/information-schema.html) with `STRING` columns to conform to the SQL specification. [#21612][#21612]
- Added support for inverted indexes for `JSON`. [#20941][#20941]
- [`DROP SEQUENCE`](../v2.0/drop-sequence.html) cannot drop a `SEQUENCE` that is currently in use. [#21364][#21364]
- The [`IMPORT`](../v2.0/import.html) function now does not require the `temp` directory and no longer creates a `RESTORE` job. Additionally, the `TRANSFORM_ONLY` option for [`IMPORT`](../v2.0/import.html) has been renamed to `TRANSFORM` and now takes an argument specifying the target directory. [#21490][#21490]

<h3 id="v2.0-alpha.20180129-command-line-changes">Command-Line Changes</h3>

- `cockroach start --background` now returns earlier for nodes awaiting the `cockroach init` command, facilitating use of automated scripts. [#21682][#21682]
- Command-line utilities that print results with the `pretty` format now use consistent horizontal alignment for every row of the result. [#18491][#18491]

<h3 id="v2.0-alpha.20180129-admin-ui-changes">Admin UI Changes</h3>

- The **Command Queue** debug page now displays errors correctly. [#21529][#21529]
- The **Problem Ranges** debug page now displays all problem ranges for the cluster. [#21522][#21522]

<h3 id="v2.0-alpha.20180129-bug-fixes">Bug Fixes</h3>

- Fixed a crash caused by `NULL` placeholder in comparison expressions. [#21705][#21705]
- The [`EXPLAIN (VERBOSE)`](../v2.0/explain.html#verbose-option) output now correctly shows the columns and properties of each query node (instead of incorrectly showing the columns and properties of the `root`). [#21527][#21527]
- Added a mechanism to recompute range stats automatically over time to reflect changes in the underlying logic. [#21345][#21345]

<h3 id="v2.0-alpha.20180129-performance-improvements">Performance Improvements</h3>

- Multiple ranges can now split at the same time, improving our ability to handle hotspot workloads. [#21673][#21673]
- Improved performance for queries that do not read any columns from the key component of the row. [#21571][#21571]
- Improved performance of scans by reducing efforts for non-required columns. [#21572][#21572]
- Improved efficiency of the key decoding operation. [#21498][#21498]
- Sped up the performance of low-level delete operations. [#21507][#21507]
- Prevented the jobs table from growing excessively large during jobs table updates. [#21575][#21575]

<h3 id="v2.0-alpha.20180129-contributors">Contributors</h3>

This release includes 110 merged PRs by 31 authors. We would like to thank the following contributors from the CockroachDB community:

- Constantine Peresypkin
- 何羿宏

Special thanks to first-time contributors Andrew Kimball, Nathaniel Stewart, Constantine Peresypkin and Paul Bardea.

[#18491]: https://github.com/cockroachdb/cockroach/pull/18491
[#19618]: https://github.com/cockroachdb/cockroach/pull/19618
[#20215]: https://github.com/cockroachdb/cockroach/pull/20215
[#20915]: https://github.com/cockroachdb/cockroach/pull/20915
[#20941]: https://github.com/cockroachdb/cockroach/pull/20941
[#21132]: https://github.com/cockroachdb/cockroach/pull/21132
[#21345]: https://github.com/cockroachdb/cockroach/pull/21345
[#21363]: https://github.com/cockroachdb/cockroach/pull/21363
[#21364]: https://github.com/cockroachdb/cockroach/pull/21364
[#21373]: https://github.com/cockroachdb/cockroach/pull/21373
[#21386]: https://github.com/cockroachdb/cockroach/pull/21386
[#21387]: https://github.com/cockroachdb/cockroach/pull/21387
[#21408]: https://github.com/cockroachdb/cockroach/pull/21408
[#21410]: https://github.com/cockroachdb/cockroach/pull/21410
[#21411]: https://github.com/cockroachdb/cockroach/pull/21411
[#21418]: https://github.com/cockroachdb/cockroach/pull/21418
[#21447]: https://github.com/cockroachdb/cockroach/pull/21447
[#21473]: https://github.com/cockroachdb/cockroach/pull/21473
[#21478]: https://github.com/cockroachdb/cockroach/pull/21478
[#21479]: https://github.com/cockroachdb/cockroach/pull/21479
[#21481]: https://github.com/cockroachdb/cockroach/pull/21481
[#21486]: https://github.com/cockroachdb/cockroach/pull/21486
[#21488]: https://github.com/cockroachdb/cockroach/pull/21488
[#21490]: https://github.com/cockroachdb/cockroach/pull/21490
[#21491]: https://github.com/cockroachdb/cockroach/pull/21491
[#21497]: https://github.com/cockroachdb/cockroach/pull/21497
[#21498]: https://github.com/cockroachdb/cockroach/pull/21498
[#21505]: https://github.com/cockroachdb/cockroach/pull/21505
[#21507]: https://github.com/cockroachdb/cockroach/pull/21507
[#21508]: https://github.com/cockroachdb/cockroach/pull/21508
[#21511]: https://github.com/cockroachdb/cockroach/pull/21511
[#21512]: https://github.com/cockroachdb/cockroach/pull/21512
[#21513]: https://github.com/cockroachdb/cockroach/pull/21513
[#21515]: https://github.com/cockroachdb/cockroach/pull/21515
[#21517]: https://github.com/cockroachdb/cockroach/pull/21517
[#21519]: https://github.com/cockroachdb/cockroach/pull/21519
[#21520]: https://github.com/cockroachdb/cockroach/pull/21520
[#21521]: https://github.com/cockroachdb/cockroach/pull/21521
[#21522]: https://github.com/cockroachdb/cockroach/pull/21522
[#21524]: https://github.com/cockroachdb/cockroach/pull/21524
[#21527]: https://github.com/cockroachdb/cockroach/pull/21527
[#21529]: https://github.com/cockroachdb/cockroach/pull/21529
[#21532]: https://github.com/cockroachdb/cockroach/pull/21532
[#21533]: https://github.com/cockroachdb/cockroach/pull/21533
[#21534]: https://github.com/cockroachdb/cockroach/pull/21534
[#21540]: https://github.com/cockroachdb/cockroach/pull/21540
[#21541]: https://github.com/cockroachdb/cockroach/pull/21541
[#21542]: https://github.com/cockroachdb/cockroach/pull/21542
[#21546]: https://github.com/cockroachdb/cockroach/pull/21546
[#21547]: https://github.com/cockroachdb/cockroach/pull/21547
[#21549]: https://github.com/cockroachdb/cockroach/pull/21549
[#21550]: https://github.com/cockroachdb/cockroach/pull/21550
[#21553]: https://github.com/cockroachdb/cockroach/pull/21553
[#21554]: https://github.com/cockroachdb/cockroach/pull/21554
[#21555]: https://github.com/cockroachdb/cockroach/pull/21555
[#21556]: https://github.com/cockroachdb/cockroach/pull/21556
[#21557]: https://github.com/cockroachdb/cockroach/pull/21557
[#21559]: https://github.com/cockroachdb/cockroach/pull/21559
[#21562]: https://github.com/cockroachdb/cockroach/pull/21562
[#21567]: https://github.com/cockroachdb/cockroach/pull/21567
[#21568]: https://github.com/cockroachdb/cockroach/pull/21568
[#21571]: https://github.com/cockroachdb/cockroach/pull/21571
[#21572]: https://github.com/cockroachdb/cockroach/pull/21572
[#21575]: https://github.com/cockroachdb/cockroach/pull/21575
[#21579]: https://github.com/cockroachdb/cockroach/pull/21579
[#21582]: https://github.com/cockroachdb/cockroach/pull/21582
[#21585]: https://github.com/cockroachdb/cockroach/pull/21585
[#21587]: https://github.com/cockroachdb/cockroach/pull/21587
[#21588]: https://github.com/cockroachdb/cockroach/pull/21588
[#21591]: https://github.com/cockroachdb/cockroach/pull/21591
[#21596]: https://github.com/cockroachdb/cockroach/pull/21596
[#21600]: https://github.com/cockroachdb/cockroach/pull/21600
[#21603]: https://github.com/cockroachdb/cockroach/pull/21603
[#21606]: https://github.com/cockroachdb/cockroach/pull/21606
[#21607]: https://github.com/cockroachdb/cockroach/pull/21607
[#21610]: https://github.com/cockroachdb/cockroach/pull/21610
[#21611]: https://github.com/cockroachdb/cockroach/pull/21611
[#21612]: https://github.com/cockroachdb/cockroach/pull/21612
[#21614]: https://github.com/cockroachdb/cockroach/pull/21614
[#21615]: https://github.com/cockroachdb/cockroach/pull/21615
[#21626]: https://github.com/cockroachdb/cockroach/pull/21626
[#21631]: https://github.com/cockroachdb/cockroach/pull/21631
[#21633]: https://github.com/cockroachdb/cockroach/pull/21633
[#21636]: https://github.com/cockroachdb/cockroach/pull/21636
[#21644]: https://github.com/cockroachdb/cockroach/pull/21644
[#21645]: https://github.com/cockroachdb/cockroach/pull/21645
[#21650]: https://github.com/cockroachdb/cockroach/pull/21650
[#21652]: https://github.com/cockroachdb/cockroach/pull/21652
[#21656]: https://github.com/cockroachdb/cockroach/pull/21656
[#21658]: https://github.com/cockroachdb/cockroach/pull/21658
[#21662]: https://github.com/cockroachdb/cockroach/pull/21662
[#21666]: https://github.com/cockroachdb/cockroach/pull/21666
[#21667]: https://github.com/cockroachdb/cockroach/pull/21667
[#21668]: https://github.com/cockroachdb/cockroach/pull/21668
[#21670]: https://github.com/cockroachdb/cockroach/pull/21670
[#21673]: https://github.com/cockroachdb/cockroach/pull/21673
[#21676]: https://github.com/cockroachdb/cockroach/pull/21676
[#21677]: https://github.com/cockroachdb/cockroach/pull/21677
[#21678]: https://github.com/cockroachdb/cockroach/pull/21678
[#21679]: https://github.com/cockroachdb/cockroach/pull/21679
[#21682]: https://github.com/cockroachdb/cockroach/pull/21682
[#21685]: https://github.com/cockroachdb/cockroach/pull/21685
[#21690]: https://github.com/cockroachdb/cockroach/pull/21690
[#21691]: https://github.com/cockroachdb/cockroach/pull/21691
[#21698]: https://github.com/cockroachdb/cockroach/pull/21698
[#21705]: https://github.com/cockroachdb/cockroach/pull/21705
[#21708]: https://github.com/cockroachdb/cockroach/pull/21708
[#21714]: https://github.com/cockroachdb/cockroach/pull/21714
[#21720]: https://github.com/cockroachdb/cockroach/pull/21720
[#21721]: https://github.com/cockroachdb/cockroach/pull/21721
[2f402e234]: https://github.com/cockroachdb/cockroach/commit/2f402e234
[d2e5fd351]: https://github.com/cockroachdb/cockroach/commit/d2e5fd351
[187f8e662]: https://github.com/cockroachdb/cockroach/commit/187f8e662
[559fcffe7]: https://github.com/cockroachdb/cockroach/commit/559fcffe7
[f8cb074e2]: https://github.com/cockroachdb/cockroach/commit/f8cb074e2
[0cde4dcdb]: https://github.com/cockroachdb/cockroach/commit/0cde4dcdb
[2d4883c12]: https://github.com/cockroachdb/cockroach/commit/2d4883c12
[7b6e775b9]: https://github.com/cockroachdb/cockroach/commit/7b6e775b9
[b74ce84bc]: https://github.com/cockroachdb/cockroach/commit/b74ce84bc
[7ee5c635b]: https://github.com/cockroachdb/cockroach/commit/7ee5c635b
[9e25aeb8a]: https://github.com/cockroachdb/cockroach/commit/9e25aeb8a
[900291e48]: https://github.com/cockroachdb/cockroach/commit/900291e48
[33d1f2749]: https://github.com/cockroachdb/cockroach/commit/33d1f2749
[4f33f0239]: https://github.com/cockroachdb/cockroach/commit/4f33f0239
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}A bug that could cause transactional anomalies was introduced in this release, so this release has been withdrawn.{{site.data.alerts.end}}

<h3 id="v2.0-alpha.20180212-enterprise-edition-changes">Enterprise Edition Changes</h3>

- [Sequences](../v2.0/create-sequence.html) are now supported in enterprise [`BACKUP`](../v2.0/backup.html)/[`RESTORE`](../v2.0/restore.html) jobs.

    This changes how sequences are stored in the key-value storage layer, so existing sequences must be dropped and recreated. Since a sequence cannot be dropped while it is being used in a column's `DEFAULT` expression, those expressions must be dropped before the sequence is dropped, and recreated after the sequence is recreated. The `setval` function can be used to set the value of a sequence to what it was previously. [#21684][#21684]

<h3 id="v2.0-alpha.20180212-sql-language-changes">SQL Language Changes</h3>

- Casts between [array types](../v2.0/array.html) are now allowed when a cast between the parameter types is allowed. [#22338][#22338]
- Scalar functions can now be used in `FROM` clauses. [#22314][#22314]
- Added privilege checks on [sequences](../v2.0/create-sequence.html). [#22284][#22284]
- The `ON DELETE SET DEFAULT`, `ON UPDATE SET DEFAULT`, `ON DELETE SET NULL`, and `ON UPDATE SET NULL` foreign key constraint actions are now fully supported. [#22220][#22220] [#21767][#21767] [#21716][#21716]
- JSON inverted indexes can now be specified in a [`CREATE TABLE`](../v2.0/create-table.html) statement. [#22217][#22217]
- When a node is gracefully shut down, planning queries are avoided and distributed queries are allowed the amount of time specified by the new `server.drain_max_wait` [cluster setting](../v2.0/cluster-settings.html) before the node is drained and stopped. [#20450][#20450]
- [Collated string](../v2.0/collate.html) are now supported in [IMPORT](../v2.0/import.html) jobs. [#21859][#21859]
- The new `SHOW GRANTS ON ROLE` statement and `pg_catalog.pg_auth_members` table lists role memberships. [#22205][#22205] [#21780][#21780]
- Role memberships are now considered in permission checks. [#21820][#21820]

<h3 id="v2.0-alpha.20180212-command-line-changes">Command-Line Changes</h3>

- [Debug commands](../v2.0/debug-zip.html) now open RocksDB in read-only mode. This makes them faster and able to run in parallel. [#21778][#21778]
- The [`cockroach dump`](../v2.0/sql-dump.html) command now outputs `CREATE SEQUENCE` statements before the `CREATE TABLE` statements that use them. [#21774][#21774]
- For better compatibility with `psql`'s extended format, the table formatter `records` now properly indicates line continuations in multi-line rows. [#22325][#22325]
- The [`cockroach sql`](../v2.0/use-the-built-in-sql-client.html) client-side option `show_times` is now always enabled when output goes to a terminal, not just when `display_format` is set to `pretty`. [#22326][#22326]
- When formatting `cockroach sql` results with `--format=sql`, the row count is now printed in a SQL comment at the end. [#22327][#22327]
- When formatting `cockroach sql` results with `--format=csv` or `--format=tsv`, result rows that contain special characters are now quoted properly. [#19306][#19306]

<h3 id="v2.0-alpha.20180212-admin-ui-changes">Admin UI Changes</h3>

- Added an icon to indicate when descriptions in the **Jobs** table are shortened and expandable. [#22221][#22221]
- Added "compaction queue" graphs to the **Queues** dashboard. [#22218][#22218]
- Added Raft snapshot queue metrics to the **Queue** dashboard. [#22210][#22210]
- When there are dead nodes, they are now show before live nodes on the **Nodes List** page. [#22222][#22222]
- Links to documentation in the Admin UI now point to the docs for v2.0. [#21894][#21894]

<h3 id="v2.0-alpha.20180212-bug-fixes">Bug Fixes</h3>

- Errors from DDL statements sent by a client as part of a transaction, but in a different query string than the final commit, are no longer silently swallowed. [#21829][#21829]
- Fixed a bug in cascading foreign key actions. [#21799][#21799]
- Tabular results where the column labels contain newline characters are now rendered properly. [#19306][#19306]
- Fixed a bug that prevented long descriptions in the Admin UI **Jobs** table from being collapsed after being expanding. [#22221][#22221]
- Fixed a bug that prevented using `SHOW GRANTS` with a grantee but no targets. [#21864][#21864]
- Fixed a panic with certain queries involving the `REGCLASS` type. [#22310][#22310]
- Fixed the behavior and types of the `encode()` and `decode()` functions. [#22230][#22230]
- Fixed a bug that prevented passing the same tuple for `FROM` and `TO` in `ALTER TABLE ... SCATTER`. [#21830][#21830]
- Fixed a regression that caused certain queries using `LIKE` or `SIMILAR TO` with an indexed column to be slow. [#21842][#21842]
- Fixed a stack overflow in the code for shutting down a server when out of disk space [#21768][#21768]
- Fixed Windows release builds. [#21793][#21793]
- Fixed an issue with the wire-formatting of `BYTES` arrays. [#21712][#21712]
- Fixed a bug that could lead to a node crashing and needing to be reinitialized. [#21771][#21771]
- When a database is created, dropped, or renamed, the SQL session is blocked until the effects of the operation are visible to future queries in that session. [#21900][#21900]
- Fixed a bug where healthy nodes could appear as "Suspect" in the Admin UI if the web browser's local clock was skewed. [#22237][#22237]

<h3 id="v2.0-alpha.20180212-performance-improvements">Performance Improvements</h3>

- Significantly reduced the likelihood of serializable restarts seen by clients due to concurrent workloads. [#21140][#21140]
- Reduced disruption from nodes recovering from network partitions. [#22316][#22316]
- Improved the performance of scans by copying less data in memory. [#22309][#22309]
- Slightly improved the performance of low-level scan operations. [#22244][#22244]
- When a range grows too large, writes are now be backpressured until the range is successfully able to split. This prevents unbounded range growth and improves a clusters ability to stay healthy under hotspot workloads. [#21777][#21777]
- The `information_schema` and `pg_catalog` databases are now faster to query. [#21609][#21609]
- Reduced the write amplification of Raft replication. [#20647][#20647]

<h3 id="v2.0-alpha.20180212-doc-updates">Doc Updates</h3>

- Added [cloud-specific hardware recommendations](../v2.0/recommended-production-settings.html#cloud-specific-recommendations). [#2312](https://github.com/cockroachdb/docs/pull/2312)
- Added a [detailed listing of SQL standard features with CockroachDB's level of support](../v2.0/sql-feature-support.html). [#2442](https://github.com/cockroachdb/docs/pull/2442)
- Added docs on the [`INET`](../v2.0/inet.html) data type. [#2439](https://github.com/cockroachdb/docs/pull/2439)
- Added docs on the [`SHOW CREATE SEQUENCE`](../v2.0/show-create-sequence.html) statement. [#2406](https://github.com/cockroachdb/docs/pull/2406)

<h3 id="v2.0-alpha.20180212-contributors">Contributors</h3>

This release includes 133 merged PRs by 28 authors. We would like to thank the contributors from the CockroachDB community, especially first-time contributor pocockn.

[#19306]: https://github.com/cockroachdb/cockroach/pull/19306
[#20290]: https://github.com/cockroachdb/cockroach/pull/20290
[#20450]: https://github.com/cockroachdb/cockroach/pull/20450
[#20647]: https://github.com/cockroachdb/cockroach/pull/20647
[#21140]: https://github.com/cockroachdb/cockroach/pull/21140
[#21609]: https://github.com/cockroachdb/cockroach/pull/21609
[#21684]: https://github.com/cockroachdb/cockroach/pull/21684
[#21712]: https://github.com/cockroachdb/cockroach/pull/21712
[#21716]: https://github.com/cockroachdb/cockroach/pull/21716
[#21754]: https://github.com/cockroachdb/cockroach/pull/21754
[#21767]: https://github.com/cockroachdb/cockroach/pull/21767
[#21768]: https://github.com/cockroachdb/cockroach/pull/21768
[#21771]: https://github.com/cockroachdb/cockroach/pull/21771
[#21774]: https://github.com/cockroachdb/cockroach/pull/21774
[#21777]: https://github.com/cockroachdb/cockroach/pull/21777
[#21778]: https://github.com/cockroachdb/cockroach/pull/21778
[#21780]: https://github.com/cockroachdb/cockroach/pull/21780
[#21793]: https://github.com/cockroachdb/cockroach/pull/21793
[#21799]: https://github.com/cockroachdb/cockroach/pull/21799
[#21816]: https://github.com/cockroachdb/cockroach/pull/21816
[#21820]: https://github.com/cockroachdb/cockroach/pull/21820
[#21829]: https://github.com/cockroachdb/cockroach/pull/21829
[#21830]: https://github.com/cockroachdb/cockroach/pull/21830
[#21842]: https://github.com/cockroachdb/cockroach/pull/21842
[#21847]: https://github.com/cockroachdb/cockroach/pull/21847
[#21859]: https://github.com/cockroachdb/cockroach/pull/21859
[#21864]: https://github.com/cockroachdb/cockroach/pull/21864
[#21894]: https://github.com/cockroachdb/cockroach/pull/21894
[#21900]: https://github.com/cockroachdb/cockroach/pull/21900
[#22205]: https://github.com/cockroachdb/cockroach/pull/22205
[#22210]: https://github.com/cockroachdb/cockroach/pull/22210
[#22217]: https://github.com/cockroachdb/cockroach/pull/22217
[#22218]: https://github.com/cockroachdb/cockroach/pull/22218
[#22220]: https://github.com/cockroachdb/cockroach/pull/22220
[#22221]: https://github.com/cockroachdb/cockroach/pull/22221
[#22222]: https://github.com/cockroachdb/cockroach/pull/22222
[#22230]: https://github.com/cockroachdb/cockroach/pull/22230
[#22237]: https://github.com/cockroachdb/cockroach/pull/22237
[#22244]: https://github.com/cockroachdb/cockroach/pull/22244
[#22245]: https://github.com/cockroachdb/cockroach/pull/22245
[#22278]: https://github.com/cockroachdb/cockroach/pull/22278
[#22284]: https://github.com/cockroachdb/cockroach/pull/22284
[#22309]: https://github.com/cockroachdb/cockroach/pull/22309
[#22310]: https://github.com/cockroachdb/cockroach/pull/22310
[#22314]: https://github.com/cockroachdb/cockroach/pull/22314
[#22316]: https://github.com/cockroachdb/cockroach/pull/22316
[#22319]: https://github.com/cockroachdb/cockroach/pull/22319
[#22325]: https://github.com/cockroachdb/cockroach/pull/22325
[#22326]: https://github.com/cockroachdb/cockroach/pull/22326
[#22327]: https://github.com/cockroachdb/cockroach/pull/22327
[#22338]: https://github.com/cockroachdb/cockroach/pull/22338
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This week's release includes:

 - Improved support for large delete statements.
 - Reduced disruption during upgrades and restarts.
 - Reduced occurrence of serializable transaction restarts.

{{site.data.alerts.callout_danger}}This release has a bug that may result in incorrect results for certain queries using <code>JOIN</code> and <code>ORDER BY</code>. This bug will be fixed in next week's beta.{{site.data.alerts.end}}

<h3 id="v2.0-beta.20180305-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180305.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180305.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180305.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0-beta.20180305-backwards-incompatible-changes">Backwards-Incompatible Changes</h3>

- [Sequences](../v2.0/create-sequence.html) are now supported in enterprise [`BACKUP`](../v2.0/backup.html)/[`RESTORE`](../v2.0/restore.html) jobs.

    This changes how sequences are stored in the key-value storage layer, so existing sequences must be dropped and recreated. Since a sequence cannot be dropped while it is being used in a column's [`DEFAULT`](../v2.0/default-value.html) expression, those expressions must be dropped before the sequence is dropped, and recreated after the sequence is recreated. The `setval()` function can be used to set the value of a sequence to what it was previously. [#21684][#21684]

- Positive [constraints in replication zone configs](../v2.0/configure-replication-zones.html#replication-constraints) no longer work. Any existing positive constraints will be ignored. This change should not impact existing deployments since positive constraints have not been documented or supported for some time. [#22906][#22906]

<h3 id="v2.0-beta.20180305-build-changes">Build Changes</h3>

- CockroachDB now builds with go 1.9.4 and higher. [#22608][#22608]

<h3 id="v2.0-beta.20180305-general-changes">General Changes</h3>

- [Diagnostics reports](../v2.0/diagnostics-reporting.html) now include information about changed settings and statistics on types of errors encountered during SQL execution. [#22705][#22705], [#22693][#22693], [#22948][#22948]

<h3 id="v2.0-beta.20180305-enterprise-edition-changes">Enterprise Edition Changes</h3>

- Revision history [`BACKUP`](../v2.0/backup.html)/[`RESTORE`](../v2.0/restore.html) is no longer considered experimental. [#22679][#22679]
- Revision history [`BACKUP`](../v2.0/backup.html)/[`RESTORE`](../v2.0/restore.html) now handles schema changes. [#21717][#21717]
- CockroachDB now checks that a backup actually contains the requested restore time. [#22659][#22659]
- Improved [`BACKUP`](../v2.0/backup.html)'s handling of tables after [`TRUNCATE`](../v2.0/truncate.html). [#21895][#21895]
- Ensured that only the backups created by the same cluster can be used in incremental backups. [#22474][#22474]
- Avoided extra internal copying of files during [`RESTORE`](../v2.0/restore.html). [#22281][#22281]
- Added a geographical map to the homepage of the Admin UI enterprise version, showing the location of nodes and localities in the cluster. The map is annotated with several top-level metrics: storage capacity used, queries per second, and current CPU usage, as well as the liveness status of nodes in the cluster. [#22763][#22763]

<h3 id="v2.0-beta.20180305-sql-language-changes">SQL Language Changes</h3>

- The type determined for constant `NULL` expressions is renamed to `unknown` for better compatibility with PostgreSQL. [#23150][#23150]
- Deleting multiple rows at once now consumes less memory. [#23013][#23013]
- Attempts to modify virtual schemas with DDL statements now fail with a clearer error message. [#23041][#23041]
- The new `SHOW SCHEMAS` statement reveals which are the valid virtual schemas next to the physical schema `public`. [#23041][#23041]
- CockroachDB now recognizes the special syntax `SET SCHEMA <name>` as an alias for `SET search_path = <name>` for better compatibility with PostgreSQL. [#23041][#23041]
- `current_role()` and `current_catalog()` are supported as aliases for the `current_user()` and `current_database()` [built-in functions](../v2.0/functions-and-operators.html) for better compatibility with PostgreSQL. [#23041][#23041]
- CockroachDB now returns the correct error code for division by zero. [#22948][#22948]
- The GC of table data after a [`DROP TABLE`](../v2.0/drop-table.html) statement now respects changes to the GC TTL interval specified in the zone config [#22903][#22903]
- The full names of tables/view/sequences are now properly logged in the system event log. [#22848][#22848]
- CockroachDB now recognizes the syntax `db.public.tbl` in addition to `db.tbl` for better compatibility with PostgreSQL. The handling of the session variable `search_path`, as well as that of the built-in functions `current_schemas()` and `current_schema()`, is now closer to that of PostgreSQL. Thus `SHOW TABLES FROM` can now inspect the tables of a specific schema (for example, `SHOW TABLES FROM db.public` or `SHOW TABLES FROM db.pg_catalog`). `SHOW GRANTS` also shows the schema of the databases and tables. [#22753][#22753]
- Users can now configure auditing per table and per access mode with `ALTER TABLE`. [#22534][#22534]
- SQL execution logs enabled by the [cluster setting](../v2.0/cluster-settings.html) `sql.trace.log_statement_execute` now go to a separate log file. This is an experimental feature meant to aid troubleshooting CockroachDB. [#22534][#22534]
- Added the `string_to_array()` [built-in function](../v2.0/functions-and-operators.html). [#22391][#22391]
- Added the `constraint_column_usage` table and roles-related tables to the [`information_schema`](../v2.0/information-schema.html) database. [#22323][#22323] [#22242][#22242]
- [`IMPORT`](../v2.0/import.html) no longer requires the experimental setting. [#22531][#22531]
- Computed columns and `CHECK` constraints now correctly report column names in the case of a type error. [#22500][#22500]
- The output of [`JSON`](../v2.0/jsonb.html) data now matches that of PostgreSQL. [#22393][#22393]
- Allowed [`IMPORT`](../v2.0/import.html) jobs to be paused. `IMPORT` jobs now correctly resume instead of being abandoned if the coordinator goes down. [#22291][#22291]
- Removed the `into_db` option in [`IMPORT`](../v2.0/import.html). The database is now specified as part of the table name. [#21813][#21813]
- Changed computed column syntax and improved related error messages. [#22429][#22429]
- Implemented additional [`INET`](../v2.0/inet.html) column type operators such as `contains` and `contained by`, binary operations, and addition/subtraction.
- Implemented the following operators for [`INET`](../v2.0/inet.html) column types: `<<`, `<<=`, `>>`, `>>=`, `&&`, `+`, `-`, `^`, `|`, `&`.  These operators are compatible with PostgreSQL 10 and are described in Table: 9.36 of the PostgreSQL documentation. [#21437][#21437]
- CockroachDB now properly rejects incorrectly-cased SQL function names with an error. [#22365][#22365]
- Allowed [`DEFAULT`](../v2.0/default-value.html) expressions in the `CREATE TABLE` of an [`IMPORT`](../v2.0/import.html) CSV. The expressions are not evaluated (data in the CSV is still required to be present). This change only allows them to be part of the table definition. [#22307][#22307]
- Added the `#-` [operator](../v2.0/functions-and-operators.html) for `JSON`. [#22375][#22375]
- The `SET transaction_isolation` statement is now supported for better PostgreSQL compatibility. [#22389][#22389]
- Allowed creation of computed columns. [#21823][#21823]
- Avoided extra internal copying of files during [`IMPORT`](../v2.0/import.html). [#22281][#22281]
- Casts between [array types](../v2.0/array.html) are now allowed when a cast between the parameter types is allowed. [#22338][#22338]
- Scalar functions can now be used in `FROM` clauses. [#22314][#22314]
- Added privilege checks on [sequences](../v2.0/create-sequence.html). [#22284][#22284]
- The `ON DELETE SET DEFAULT`, `ON UPDATE SET DEFAULT`, `ON DELETE SET NULL`, and `ON UPDATE SET NULL` [foreign key constraint actions](../v2.0/foreign-key.html#foreign-key-actions-new-in-v2-0) are now fully supported. [#22220][#22220] [#21767][#21767] [#21716][#21716]
- The `ON DELETE CASCADE` and `ON UPDATE CASCADE` [foreign key constraint actions](../v2.0/foreign-key.html#foreign-key-actions-new-in-v2-0) can now also contain `CHECK` constraints. [#22535][#22535]
- JSON inverted indexes can now be specified in a [`CREATE TABLE`](../v2.0/create-table.html) statement. [#22217][#22217]
- When a node is gracefully shut down, planning queries are avoided and distributed queries are allowed the amount of time specified by the new `server.drain_max_wait` [cluster setting](../v2.0/cluster-settings.html) before the node is drained and stopped. [#20450][#20450]
- [Collated string](../v2.0/collate.html) are now supported in [IMPORT](../v2.0/import.html) jobs. [#21859][#21859]
- The new `SHOW GRANTS ON ROLE` statement and `pg_catalog.pg_auth_members` table lists role memberships. [#22205][#22205] [#21780][#21780]
- Role memberships are now considered in permission checks. [#21820][#21820]

<h3 id="v2.0-beta.20180305-command-line-changes">Command-Line Changes</h3>

- [Replication zone constraints](../v2.0/configure-replication-zones.html#replication-constraints) can now be specified on a per-replica basis, meaning you can configure some replicas in a zone's ranges to follow one set of constraints and other replicas to follow other constraints. [#22906][#22906]
- Per-replica constraints no longer have to add up to the total number of replicas in a range. If you do not specify all the replicas, then the remaining replicas will be allowed on any store. [#23081][#23081]
- [`cockroach sql`](../v2.0/use-the-built-in-sql-client.html) now reminds the user about `SET database = ...` and `CREATE DATABASE` if started with no current database set. [#23089][#23089]
- Error messages displayed while connecting to a server with an incompatible version have been improved. [#22709][#22709]
- The `--cache` and `--max-sql-memory` flags of [`cockroach start`](../v2.0/start-a-node.html) now also support decimal notation to support a fraction of total available RAM size, e.g., `--cache=.25` is equivalent to `--cache=25%`. This simplifies integration with system management tools. [#22460][#22460]
- When printing tabular results as CSV or TSV, no final row count is emitted. This is intended to increase interoperability with external tools. [#20835][#20835]
- The `pretty` formatter does not introduce special unicode characters in multi-line table cells, for better compatibility with certain clients. To disambiguate multi-line cells from multiple single-line cells, a user can use `WITH ORDINALITY` to add a row numbering column. [#22324][#22324]
- Allowed specification of arbitrary RocksDB options. [#22401][#22401]
- [Debug commands](../v2.0/debug-zip.html) now open RocksDB in read-only mode. This makes them faster and able to run in parallel. [#21778][#21778]
- The [`cockroach dump`](../v2.0/sql-dump.html) command now outputs `CREATE SEQUENCE` statements before the `CREATE TABLE` statements that use them. [#21774][#21774]
- For better compatibility with `psql`'s extended format, the table formatter `records` now properly indicates line continuations in multi-line rows. [#22325][#22325]
- The [`cockroach sql`](../v2.0/use-the-built-in-sql-client.html) client-side option `show_times` is now always enabled when output goes to a terminal, not just when `display_format` is set to `pretty`. [#22326][#22326]
- When formatting [`cockroach sql`](../v2.0/use-the-built-in-sql-client.html) results with `--format=sql`, the row count is now printed in a SQL comment at the end. [#22327][#22327]
- When formatting [`cockroach sql`](../v2.0/use-the-built-in-sql-client.html) results with `--format=csv` or `--format=tsv`, result rows that contain special characters are now quoted properly. [#19306][#19306]

<h3 id="v2.0-beta.20180305-admin-ui-changes">Admin UI Changes</h3>

- [Decommissioned nodes](../v2.0/remove-nodes.html) are no longer included in cluster stats aggregates. [#22711][#22711]
- Time series metrics dashboards now show their own title rather than the generic "Cluster Overview". [#22746][#22746]
- The URLs for Admin UI pages have been reorganized to provide more consistent structure to the site. Old links will redirect to the new location of the page. [#22746][#22746]
- Nodes being decommissioned are now included in the total nodes count until they are completely decommissioned. [#22690][#22690]
- Added new graphs for monitoring activity of the time series system. [#22672][#22672]
- Disk usage for time series data is now visible on the **Databases** page. [#22398][#22398]
- Added a ui-clean task. [#22552][#22552]
- Added an icon to indicate when descriptions in the **Jobs** table are shortened and expandable. [#22221][#22221]
- Added "compaction queue" graphs to the **Queues** dashboard. [#22218][#22218]
- Added Raft snapshot queue metrics to the **Queue** dashboard. [#22210][#22210]
- Dead nodes are now displayed before live nodes on the **Nodes List** page. [#22222][#22222]
- Links to documentation in the Admin UI now point to the docs for v2.0. [#21894][#21894]

<h3 id="v2.0-beta.20180305-bug-fixes">Bug Fixes</h3>

- Fixed an issue where Admin UI graph tooltips would continue to display zero values for nodes which had long been decommissioned. [#22626][#22626]
- Fixed an issue where Admin UI graphs would occasionally have a persistent "dip" at the leading edge of data. [#22570][#22570]
- Fixed an issue where viewing Admin UI graphs for very long time spans (e.g., 1 month) could cause excessive memory usage. [#22392][#22392]
- Fixed padding on the **Node Diagnostics** page of the Admin UI. [#23019][#23019]
- Corrected the title of the decommissioned node list, which was mistakenly updated to say "Decommissioning". [#22703][#22703]
- Fixed a bug in [`cockroach dump`](../v2.0/sql-dump.html) output with `SEQUENCES`. [#22619][#22619]
- Fixed a bug that created uneven distribution of data (or failures in some cases) during [`IMPORT`](../v2.0/import.html) of tables without an explicit primary key. [#22542][#22542]
- Fixed a bug that could prevent disk space from being reclaimed. [#23153][#23153]
- [Replication zone configs](../v2.0/configure-replication-zones.html) no longer accept negative numbers as input. [#23081][#23081]
- Fixed the occasional selection of sub-optimal rebalance targets. [#23081][#23081]
- [`cockroach dump`](../v2.0/sql-dump.html) is now able to dump sequences with non-default parameters. [#23062][#23062]
- [Arrays](../v2.0/array.html) now support the `IS [NOT] DISTINCT FROM` operators. [#23090][#23090]
- [`SHOW TABLES`](../v2.0/show-tables.html) is now again able to inspect virtual schemas. [#23041][#23041]
- The special form of [`CREATE TABLE .. AS`](../v2.0/create-table-as.html) now properly supports placeholders in the subquery. [#23046][#23046]
- Fixed a bug where ranges could get stuck in an infinite "removal pending" state and would refuse to accept new writes. [#23024][#23024]
- Fixed incorrect index constraints on primary key columns on unique indexes. [#23003][#23003]
- Fixed a panic when upgrading quickly from v1.0.x to v2.0.x [#22971][#22971]
- Fixed a bug that prevented joins on interleaved tables with certain layouts from working. [#22935][#22935]
- The service latency tracked for SQL statement now includes the wait time of the execute message in the input queue. [#22881][#22881]
- The conversion from [`INTERVAL`](../v2.0/interval.html) to [`FLOAT`](../v2.0/float.html) now properly returns the number of seconds in the interval. [#22894][#22894]
- Fixed incorrect query results when the `WHERE` condition contains `IN` expressions where the right-hand side tuple contains `NULL`s. [#22735][#22735]
- Fixed incorrect handling for `IS (NOT) DISTINCT FROM` when either side is a tuple that contains `NULL`. [#22718][#22718]
- Fixed incorrect evaluation of `IN` expressions where the left-hand side is a tuple, and some of the tuples on either side contain `NULL`. [#22718][#22718]
- Expressions stored in check constraints and computed columns are now stored de-qualified so that they no longer refer to a specific database or table. [#22667][#22667]
- Fixed a bug where reusing addresses of decommissioned nodes could cause issues with Admin UI graphs. [#22614][#22614]
- [`IMPORT`](../v2.0/import.html) jobs can no longer be started if the target table already exists. [#22627][#22627]
- Computed columns can no longer be added to a table after table creation. [#22653][#22653]
- Allowed [`UPSERT`](../v2.0/upsert.html)ing into a table with computed columns. [#22517][#22517]
- Computed columns are now correctly disallowed from being foreign key references. [#22511][#22511]
- Various primitives that expect table names as argument now properly reject invalid table names. [#22577][#22577]
- `AddSSTable` no longer accidentally destroys files in the log on success. [#22551][#22551]
- `IsDistinctFrom` with `NULL` placeholder no longer returns incorrect results. [#22433][#22433]
- Fixed a bug that caused incorrect results for joins where columns that are constrained to be equal have different types. [#22549][#22549]
- Implemented additional safeguards against RPC connections between nodes that belong to different clusters. [#22518][#22518]
- The [`/health` endpoint](../v2.0/monitoring-and-alerting.html) now returns a node as unhealthy when draining or decommissioning. [#22502][#22502]
- Aggregates that take null arguments no return the correct results. [#22507][#22507]
- Fixed empty plan columns of `sequenceSelectNode`. [#22495][#22495]
- Disallowed any inserts into computed columns. [#22470][#22470]
- Tables with computed columns will produce a meaningful dump. [#22402][#22402]
- [`cockroach sql`](../v2.0/use-the-built-in-sql-client.html) no longer produces an error anymore when an empty statement is entered at the interactive prompt. [#22449][#22449]
- The `pg_typeof()` function now returns the correct type for the output of `UNION ALL` even when the left sub-select has a `NULL` column. [#22438][#22438]
- `<TYPE> <value>` literal casts now work correctly for all fixed-length types. [#22397][#22397]
- Errors from DDL statements sent by a client as part of a transaction, but in a different query string than the final commit, are no longer silently swallowed. [#21829][#21829]
- Fixed a bug in cascading foreign key actions. [#21799][#21799]
- Tabular results where the column labels contain newline characters are now rendered properly. [#19306][#19306]
- Fixed a bug that prevented long descriptions in the Admin UI **Jobs** table from being collapsed after being expanding. [#22221][#22221]
- Fixed a bug that prevented using [`SHOW GRANTS`](../v2.0/show-grants.html) with a grantee but no targets. [#21864][#21864]
- Fixed a panic with certain queries involving the `REGCLASS` type. [#22310][#22310]
- Fixed the behavior and types of the `encode()` and `decode()` functions. [#22230][#22230]
- Fixed a bug that prevented passing the same tuple for `FROM` and `TO` in `ALTER TABLE ... SCATTER`. [#21830][#21830]
- Fixed a regression that caused certain queries using `LIKE` or `SIMILAR TO` with an indexed column to be slow. [#21842][#21842]
- Fixed a stack overflow in the code for shutting down a server when out of disk space [#21768][#21768]
- Fixed Windows release builds. [#21793][#21793]
- Fixed an issue with the wire-formatting of [`BYTES`](../v2.0/bytes.html) arrays. [#21712][#21712]
- Fixed a bug that could lead to a node crashing and needing to be reinitialized. [#21771][#21771]
- When a database is created, dropped, or renamed, the SQL session is blocked until the effects of the operation are visible to future queries in that session. [#21900][#21900]
- Fixed a bug where healthy nodes could appear as "Suspect" in the Admin UI if the web browser's local clock was skewed. [#22237][#22237]
- Fixed bugs when running DistSQL queries across mixed-version (1.1.x and 2.0-alpha) clusters. [#22897][#22897]

<h3 id="v2.0-beta.20180305-performance-improvements">Performance Improvements</h3>

- Improved a cluster's ability to continue operating when nearly out of disk space on most nodes. [#21866][#21866]
- Disk space is more aggressively freed up when the disk is almost full. [#22235][#22235]
- Experimentally enabled some joins to perform a lookup join and increase join speed for cases where the right side of the join is much larger than the left. [#22674][#22674]
- Supported distributed execution of `INTERSECT` and `EXCEPT` queries. [#22442][#22442]
- Reduced cancellation time of DistSQL aggregation queries. [#22684][#22684]
- Unnecessary value checksums are no longer computed, speeding up database writes. [#22487][#22487]
- Reduced unnecessary logging in the storage layer. [#22516][#22516]
- Improved the performance of distributed sql queries. [#22471][#22471]
- Distributed execution of `INTERSECT ALL` and `EXCEPT ALL` queries is now supported. [#21896][#21896]
- Allowed `-` in usernames, but not as the first character. [#22728][#22728]
- A `COMMIT` reporting an error generated by a previous parallel statement (i.e., `RETURNING NOTHING`) no longer leaves the connection in an aborted transaction state. Instead, the transaction is considered completed and a `ROLLBACK` is not necessary. [#22683][#22683]
- Significantly reduced the likelihood of serializable restarts seen by clients due to concurrent workloads. [#21140][#21140]
- Reduced disruption from nodes recovering from network partitions. [#22316][#22316]
- Improved the performance of scans by copying less data in memory. [#22309][#22309]
- Slightly improved the performance of low-level scan operations. [#22244][#22244]
- When a range grows too large, writes are now be backpressured until the range is successfully able to split. This prevents unbounded range growth and improves a clusters ability to stay healthy under hotspot workloads. [#21777][#21777]
- The `information_schema` and `pg_catalog` databases are now faster to query. [#21609][#21609]
- Reduced the write amplification of Raft replication. [#20647][#20647]

<h3 id="v2.0-beta.20180305-doc-updates">Doc Updates</h3>

- Added [cloud-specific hardware recommendations](../v2.0/recommended-production-settings.html#cloud-specific-recommendations). [#2312](https://github.com/cockroachdb/docs/pull/2312)
- Added a [detailed listing of SQL standard features with CockroachDB's level of support](../v2.0/sql-feature-support.html). [#2442](https://github.com/cockroachdb/docs/pull/2442)
- Added docs on the [`INET`](../v2.0/inet.html) data type. [#2439](https://github.com/cockroachdb/docs/pull/2439)
- Added docs on the [`SHOW CREATE SEQUENCE`](../v2.0/show-create-sequence.html) statement. [#2406](https://github.com/cockroachdb/docs/pull/2406)
- Clarified that [password creation](../v2.0/create-and-manage-users.html#user-authentication) is only supported in secure clusters. [#2567](https://github.com/cockroachdb/docs/pull/2567)
- Added docs on [production monitoring tools](../v2.0/monitoring-and-alerting.html) and the critical events and metrics to alert on. [#2564](https://github.com/cockroachdb/docs/pull/2564)
- Added docs on the [`JSONB`](../v2.0/jsonb.html) data type. [#2561](https://github.com/cockroachdb/docs/pull/2561)
- Added docs on the `BETWEEN SYMMETRIC` [operator](../v2.0/functions-and-operators.html#operators). [#2551](https://github.com/cockroachdb/docs/pull/2551)
- Updated docs on [supporting castings for `ARRAY` values](../v2.0/array.html#supported-casting-conversionnew-in-v2-0). [#2549](https://github.com/cockroachdb/docs/pull/2549)
- Various improvements to docs on the [built-in SQL client](../v2.0/use-the-built-in-sql-client.html). [#2544](https://github.com/cockroachdb/docs/pull/2544)

<h3 id="v2.0-beta.20180305-contributors">Contributors</h3>

This release includes 430 merged PRs by 37 authors. We would like to thank all contributors from the CockroachDB community, with special thanks to first-time contributors noonan, Mark Wistrom, pocockn, and 何羿宏.

[#19306]: https://github.com/cockroachdb/cockroach/pull/19306
[#20290]: https://github.com/cockroachdb/cockroach/pull/20290
[#20450]: https://github.com/cockroachdb/cockroach/pull/20450
[#20647]: https://github.com/cockroachdb/cockroach/pull/20647
[#20790]: https://github.com/cockroachdb/cockroach/pull/20790
[#20835]: https://github.com/cockroachdb/cockroach/pull/20835
[#21140]: https://github.com/cockroachdb/cockroach/pull/21140
[#21437]: https://github.com/cockroachdb/cockroach/pull/21437
[#21477]: https://github.com/cockroachdb/cockroach/pull/21477
[#21609]: https://github.com/cockroachdb/cockroach/pull/21609
[#21684]: https://github.com/cockroachdb/cockroach/pull/21684
[#21712]: https://github.com/cockroachdb/cockroach/pull/21712
[#21716]: https://github.com/cockroachdb/cockroach/pull/21716
[#21717]: https://github.com/cockroachdb/cockroach/pull/21717
[#21754]: https://github.com/cockroachdb/cockroach/pull/21754
[#21767]: https://github.com/cockroachdb/cockroach/pull/21767
[#21768]: https://github.com/cockroachdb/cockroach/pull/21768
[#21771]: https://github.com/cockroachdb/cockroach/pull/21771
[#21774]: https://github.com/cockroachdb/cockroach/pull/21774
[#21777]: https://github.com/cockroachdb/cockroach/pull/21777
[#21778]: https://github.com/cockroachdb/cockroach/pull/21778
[#21780]: https://github.com/cockroachdb/cockroach/pull/21780
[#21793]: https://github.com/cockroachdb/cockroach/pull/21793
[#21799]: https://github.com/cockroachdb/cockroach/pull/21799
[#21813]: https://github.com/cockroachdb/cockroach/pull/21813
[#21816]: https://github.com/cockroachdb/cockroach/pull/21816
[#21820]: https://github.com/cockroachdb/cockroach/pull/21820
[#21823]: https://github.com/cockroachdb/cockroach/pull/21823
[#21829]: https://github.com/cockroachdb/cockroach/pull/21829
[#21830]: https://github.com/cockroachdb/cockroach/pull/21830
[#21842]: https://github.com/cockroachdb/cockroach/pull/21842
[#21847]: https://github.com/cockroachdb/cockroach/pull/21847
[#21859]: https://github.com/cockroachdb/cockroach/pull/21859
[#21864]: https://github.com/cockroachdb/cockroach/pull/21864
[#21866]: https://github.com/cockroachdb/cockroach/pull/21866
[#21894]: https://github.com/cockroachdb/cockroach/pull/21894
[#21895]: https://github.com/cockroachdb/cockroach/pull/21895
[#21896]: https://github.com/cockroachdb/cockroach/pull/21896
[#21900]: https://github.com/cockroachdb/cockroach/pull/21900
[#22205]: https://github.com/cockroachdb/cockroach/pull/22205
[#22210]: https://github.com/cockroachdb/cockroach/pull/22210
[#22217]: https://github.com/cockroachdb/cockroach/pull/22217
[#22218]: https://github.com/cockroachdb/cockroach/pull/22218
[#22220]: https://github.com/cockroachdb/cockroach/pull/22220
[#22221]: https://github.com/cockroachdb/cockroach/pull/22221
[#22222]: https://github.com/cockroachdb/cockroach/pull/22222
[#22230]: https://github.com/cockroachdb/cockroach/pull/22230
[#22235]: https://github.com/cockroachdb/cockroach/pull/22235
[#22237]: https://github.com/cockroachdb/cockroach/pull/22237
[#22242]: https://github.com/cockroachdb/cockroach/pull/22242
[#22244]: https://github.com/cockroachdb/cockroach/pull/22244
[#22245]: https://github.com/cockroachdb/cockroach/pull/22245
[#22278]: https://github.com/cockroachdb/cockroach/pull/22278
[#22281]: https://github.com/cockroachdb/cockroach/pull/22281
[#22284]: https://github.com/cockroachdb/cockroach/pull/22284
[#22291]: https://github.com/cockroachdb/cockroach/pull/22291
[#22307]: https://github.com/cockroachdb/cockroach/pull/22307
[#22309]: https://github.com/cockroachdb/cockroach/pull/22309
[#22310]: https://github.com/cockroachdb/cockroach/pull/22310
[#22314]: https://github.com/cockroachdb/cockroach/pull/22314
[#22316]: https://github.com/cockroachdb/cockroach/pull/22316
[#22319]: https://github.com/cockroachdb/cockroach/pull/22319
[#22323]: https://github.com/cockroachdb/cockroach/pull/22323
[#22324]: https://github.com/cockroachdb/cockroach/pull/22324
[#22325]: https://github.com/cockroachdb/cockroach/pull/22325
[#22326]: https://github.com/cockroachdb/cockroach/pull/22326
[#22327]: https://github.com/cockroachdb/cockroach/pull/22327
[#22338]: https://github.com/cockroachdb/cockroach/pull/22338
[#22365]: https://github.com/cockroachdb/cockroach/pull/22365
[#22375]: https://github.com/cockroachdb/cockroach/pull/22375
[#22389]: https://github.com/cockroachdb/cockroach/pull/22389
[#22391]: https://github.com/cockroachdb/cockroach/pull/22391
[#22392]: https://github.com/cockroachdb/cockroach/pull/22392
[#22393]: https://github.com/cockroachdb/cockroach/pull/22393
[#22397]: https://github.com/cockroachdb/cockroach/pull/22397
[#22398]: https://github.com/cockroachdb/cockroach/pull/22398
[#22401]: https://github.com/cockroachdb/cockroach/pull/22401
[#22402]: https://github.com/cockroachdb/cockroach/pull/22402
[#22404]: https://github.com/cockroachdb/cockroach/pull/22404
[#22416]: https://github.com/cockroachdb/cockroach/pull/22416
[#22429]: https://github.com/cockroachdb/cockroach/pull/22429
[#22433]: https://github.com/cockroachdb/cockroach/pull/22433
[#22438]: https://github.com/cockroachdb/cockroach/pull/22438
[#22442]: https://github.com/cockroachdb/cockroach/pull/22442
[#22449]: https://github.com/cockroachdb/cockroach/pull/22449
[#22455]: https://github.com/cockroachdb/cockroach/pull/22455
[#22460]: https://github.com/cockroachdb/cockroach/pull/22460
[#22470]: https://github.com/cockroachdb/cockroach/pull/22470
[#22471]: https://github.com/cockroachdb/cockroach/pull/22471
[#22474]: https://github.com/cockroachdb/cockroach/pull/22474
[#22487]: https://github.com/cockroachdb/cockroach/pull/22487
[#22495]: https://github.com/cockroachdb/cockroach/pull/22495
[#22500]: https://github.com/cockroachdb/cockroach/pull/22500
[#22502]: https://github.com/cockroachdb/cockroach/pull/22502
[#22507]: https://github.com/cockroachdb/cockroach/pull/22507
[#22511]: https://github.com/cockroachdb/cockroach/pull/22511
[#22514]: https://github.com/cockroachdb/cockroach/pull/22514
[#22516]: https://github.com/cockroachdb/cockroach/pull/22516
[#22517]: https://github.com/cockroachdb/cockroach/pull/22517
[#22518]: https://github.com/cockroachdb/cockroach/pull/22518
[#22531]: https://github.com/cockroachdb/cockroach/pull/22531
[#22534]: https://github.com/cockroachdb/cockroach/pull/22534
[#22535]: https://github.com/cockroachdb/cockroach/pull/22535
[#22542]: https://github.com/cockroachdb/cockroach/pull/22542
[#22549]: https://github.com/cockroachdb/cockroach/pull/22549
[#22551]: https://github.com/cockroachdb/cockroach/pull/22551
[#22552]: https://github.com/cockroachdb/cockroach/pull/22552
[#22570]: https://github.com/cockroachdb/cockroach/pull/22570
[#22577]: https://github.com/cockroachdb/cockroach/pull/22577
[#22601]: https://github.com/cockroachdb/cockroach/pull/22601
[#22608]: https://github.com/cockroachdb/cockroach/pull/22608
[#22614]: https://github.com/cockroachdb/cockroach/pull/22614
[#22619]: https://github.com/cockroachdb/cockroach/pull/22619
[#22620]: https://github.com/cockroachdb/cockroach/pull/22620
[#22626]: https://github.com/cockroachdb/cockroach/pull/22626
[#22627]: https://github.com/cockroachdb/cockroach/pull/22627
[#22637]: https://github.com/cockroachdb/cockroach/pull/22637
[#22648]: https://github.com/cockroachdb/cockroach/pull/22648
[#22653]: https://github.com/cockroachdb/cockroach/pull/22653
[#22658]: https://github.com/cockroachdb/cockroach/pull/22658
[#22659]: https://github.com/cockroachdb/cockroach/pull/22659
[#22667]: https://github.com/cockroachdb/cockroach/pull/22667
[#22672]: https://github.com/cockroachdb/cockroach/pull/22672
[#22674]: https://github.com/cockroachdb/cockroach/pull/22674
[#22679]: https://github.com/cockroachdb/cockroach/pull/22679
[#22683]: https://github.com/cockroachdb/cockroach/pull/22683
[#22684]: https://github.com/cockroachdb/cockroach/pull/22684
[#22690]: https://github.com/cockroachdb/cockroach/pull/22690
[#22693]: https://github.com/cockroachdb/cockroach/pull/22693
[#22703]: https://github.com/cockroachdb/cockroach/pull/22703
[#22705]: https://github.com/cockroachdb/cockroach/pull/22705
[#22709]: https://github.com/cockroachdb/cockroach/pull/22709
[#22711]: https://github.com/cockroachdb/cockroach/pull/22711
[#22718]: https://github.com/cockroachdb/cockroach/pull/22718
[#22728]: https://github.com/cockroachdb/cockroach/pull/22728
[#22729]: https://github.com/cockroachdb/cockroach/pull/22729
[#22735]: https://github.com/cockroachdb/cockroach/pull/22735
[#22746]: https://github.com/cockroachdb/cockroach/pull/22746
[#22753]: https://github.com/cockroachdb/cockroach/pull/22753
[#22848]: https://github.com/cockroachdb/cockroach/pull/22848
[#22881]: https://github.com/cockroachdb/cockroach/pull/22881
[#22894]: https://github.com/cockroachdb/cockroach/pull/22894
[#22897]: https://github.com/cockroachdb/cockroach/pull/22897
[#22903]: https://github.com/cockroachdb/cockroach/pull/22903
[#22906]: https://github.com/cockroachdb/cockroach/pull/22906
[#22935]: https://github.com/cockroachdb/cockroach/pull/22935
[#22948]: https://github.com/cockroachdb/cockroach/pull/22948
[#22971]: https://github.com/cockroachdb/cockroach/pull/22971
[#22983]: https://github.com/cockroachdb/cockroach/pull/22983
[#23003]: https://github.com/cockroachdb/cockroach/pull/23003
[#23013]: https://github.com/cockroachdb/cockroach/pull/23013
[#23019]: https://github.com/cockroachdb/cockroach/pull/23019
[#23024]: https://github.com/cockroachdb/cockroach/pull/23024
[#23041]: https://github.com/cockroachdb/cockroach/pull/23041
[#23046]: https://github.com/cockroachdb/cockroach/pull/23046
[#23062]: https://github.com/cockroachdb/cockroach/pull/23062
[#23081]: https://github.com/cockroachdb/cockroach/pull/23081
[#23089]: https://github.com/cockroachdb/cockroach/pull/23089
[#23090]: https://github.com/cockroachdb/cockroach/pull/23090
[#23150]: https://github.com/cockroachdb/cockroach/pull/23150
[#23153]: https://github.com/cockroachdb/cockroach/pull/23153
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

In this release, we’ve enhanced our debug pages to support graphing custom metrics, improved handling of large deletes, and fixed several bugs.

- Custom graph debug page [#23227](https://github.com/cockroachdb/cockroach/pull/23227)
- Improve handling of large deletes [#23289](https://github.com/cockroachdb/cockroach/pull/23289)

<h3 id="v2.0-beta.20180312-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180312.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180312.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180312.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0-beta.20180312-build-changes">Build Changes</h3>

- Binaries are now built with Go 1.10 by default. [#23311][#23311]

<h3 id="v2.0-beta.20180312-general-changes">General Changes</h3>

- [Logging data](../v2.0/debug-and-error-logs.html) is now flushed to files every second to aid troubleshooting and monitoring. Synchronization to disk is performed separately every 30 seconds. [#23231][#23231]
- Disabling [diagnostics reporting](../v1.1/diagnostics-reporting.html) also disables new version notification checks. [#23007][#23007]
- Removed the `diagnostics.reporting.report_metrics` [cluster setting](../v2.0/cluster-settings.html), which is duplicative with the `COCKROACH_SKIP_ENABLING_DIAGNOSTIC_REPORTING` environment variable. [#23007][#23007]
- All internal error messages are now logged when logging is set to a high enough verbosity. [#23127][#23127]

<h3 id="v2.0-beta.20180312-sql-language-changes">SQL Language Changes</h3>

- Improved handling of large [`DELETE`](../v2.0/delete.html) statements. They are now either allowed to complete or exited with an error message indicating that the transaction is too large to complete. [#23289][#23289]
- The `pg_catalog` virtual tables, as well as the special casts `::regproc` and `::regclass`, can now only be queried by clients that [set a current database](../v2.0/set-vars.html). [#23148][#23148]

<h3 id="v2.0-beta.20180312-command-line-changes">Command-Line Changes</h3>

- When a node spends more than 30 seconds waiting for an `init` command or to join a cluster, a help message now gets prints to `stdout`. [#23181][#23181]

<h3 id="v2.0-beta.20180312-admin-ui-changes">Admin UI Changes</h3>

- Added a new debug page that allows users to create a "custom" graph displaying any combination of metrics. [#23227][#23227]
- In the geographical map on the homepage of the Admin UI enterprise version, node components now link to **Note Details** page. [#23283][#23283]
- Removed the **Keys Written per Second per Store** graph. [#23303][#23303]
- Added the **Lead Transferee** field to the **Range Debug** page. [#23241][#23241]

<h3 id="v2.0-beta.20180312-bug-fixes">Bug Fixes</h3>

- Fixed a correctness bug where some `ORDER BY` queries would not return the correct results. [#23541][#23541]
- The Admin UI no longer hangs after a node's network configuration has changed. [#23348][#23348]
- The binary format for [`JSONB`](../v2.0/jsonb.html) values is now supported. [#23215][#23215]
- A node now waits in an unready state for the length of time specified by the `server.shutdown.drain_wait` cluster setting before draining. This helps ensure that load balancers will not send client traffic to a node about to be drained. [#23319][#23319]
- Fixed a panic when using `UPSERT ... RETURNING` with `UNION`. [#23317][#23317]
- Prevented disruptions in performance when gracefully shutting down a node. [#23300][#23300]
- Hardened the [cluster version upgrade](../v2.0/upgrade-cockroach-version.html) mechanism. Rapid upgrades through more than two versions could sometimes fail recoverably. [#23287][#23287]
- Fixed a deadlock when tables are rapidly created or dropped. [#23288][#23288]
- Fixed a small memory leak in [`IMPORT`](../v2.0/import.html) CSV. [#23259][#23259]
- Prevented a panic in DistSQL under certain error conditions. [#23201][#23201]
- Added a [readiness endpoint](../v2.0/monitoring-and-alerting.html#health-ready-1) (`/health?ready=1`) for better integration with load balancers. [#23247][#23247]
- Fixed a zero QPS scenario when gracefully shutting down a node. [#23246][#23246]
- Secondary log files (e.g., the SQL execution log) are now periodically flushed to disk, in addition to the flush
  that occurs naturally when single log files are full (`--log-file-max-size`) and when the process terminates gracefully. Log file rotation is also now properly active for these files. [#23231][#23231]
- Previously, the `ranges` column in the `node status` command output only included ranges whose raft leader was on the node in question. It now includes the count of all ranges on the node, regardless of where the raft leader is. [#23180][#23180]
- Fixed a panic caused by empty `COCKROACH_UPDATE_CHECK_URL` or `COCKROACH_USAGE_REPORT_URL` environment variables. [#23008][#23008]
- Prevented stale reads caused by the system clock moving backwards while the `cockroach` process is not running. [#23122][#23122]
- Corrected the handling of cases where a replica fails to retrieve the last processed timestamp of a queue. [#23127][#23127]
- Fixed a bug where the liveness status would not always display correctly on the single-node page in the Admin UI. [#23193][#23193]
- Fixed a bug that showed incorrect descriptions on the **Jobs** page in the Admin UI. [#23256][#23256]

<h3 id="v2.0-beta.20180312-doc-updates">Doc Updates</h3>

- Updated the [GCE deployment tutorial](../v2.0/deploy-cockroachdb-on-google-cloud-platform.html) with guidance on increasing the backend timeout setting for TCP Proxy load balancers. [#2687](https://github.com/cockroachdb/docs/pull/2687)
- Documented [read refreshing](../v2.0/architecture/transaction-layer.html#read-refreshing) in the CockroachDB architecture documentation. [#2684](https://github.com/cockroachdb/docs/pull/2684)
- Updated the explanation of [automatic retries](../v2.0/transactions.html#automatic-retries). [#2680](https://github.com/cockroachdb/docs/pull/2680)
- Documented changes to the [built-in replication zone](../v2.0/configure-replication-zones.html#list-the-pre-configured-replication-zones). [#2677](https://github.com/cockroachdb/docs/pull/2677)
- Updated the [`information_schema`](../v2.0/information-schema.html) documentation to cover new views. [#2675](https://github.com/cockroachdb/docs/pull/2675) [#2673](https://github.com/cockroachdb/docs/pull/2673) [#2672](https://github.com/cockroachdb/docs/pull/2672) [#2668](https://github.com/cockroachdb/docs/pull/2668) [#2662](https://github.com/cockroachdb/docs/pull/2662) [#2654](https://github.com/cockroachdb/docs/pull/2654) [#2637](https://github.com/cockroachdb/docs/pull/2637)
- Clarified the target of the [`cockroach init`](../v2.0/initialize-a-cluster.html) command. [#2670](https://github.com/cockroachdb/docs/pull/2670)
- Added details about [how to monitor clock offsets](../v2.0/operational-faqs.html#how-can-i-tell-how-well-node-clocks-are-synchronized). [#2663](https://github.com/cockroachdb/docs/pull/2663)
- Documented how to [perform a rolling upgrade on a Kubernetes-orchestrated cluster](../v2.0/orchestrate-cockroachdb-with-kubernetes.html). [#2661](https://github.com/cockroachdb/docs/pull/2661)
- Updated the [Azure deployment tutorial](../v2.0/deploy-cockroachdb-on-microsoft-azure.html) with correct network security rule guidance. [#2653](https://github.com/cockroachdb/docs/pull/2653)  
- Improved the documentation of the [`cockroach node status`](../v2.0/view-node-details.html) command. [#2639](https://github.com/cockroachdb/docs/pull/2639)
- Clarified that the [`DROP COLUMN`](../v2.0/drop-column.html) statement now drops `CHECK` constraints. [#2638](https://github.com/cockroachdb/docs/pull/2638)
- Added details about [disk space usage after deletes and select performance on deleted rows](../v2.0/delete.html#disk-space-usage-after-deletes). [#2635](https://github.com/cockroachdb/docs/pull/2635)
- Clarified that [`DROP INDEX .. CASCADE`](../v2.0/drop-index.html) is required to drop a `UNIQUE` index. [#2633](https://github.com/cockroachdb/docs/pull/2633)
- Updated the [`EXPLAIN`](../v2.0/explain.html) documentation to identify all explainable statements, cover the new output structure, and better explain the contents of the `Ordering` column. [#2632](https://github.com/cockroachdb/docs/pull/2632) [#2682](https://github.com/cockroachdb/docs/pull/2682)
- Defined "range lease" in the [CockroachDB architecture overview](../v2.0/architecture/overview.html#terms). [#2625](https://github.com/cockroachdb/docs/pull/2625)
- Added an FAQ on [preparing for planned node maintenance](../v2.0/operational-faqs.html#how-do-i-prepare-for-planned-node-maintenance). [#2600](https://github.com/cockroachdb/docs/pull/2600)

<h3 id="v2.0-beta.20180312-contributors">Contributors</h3>

This release includes 44 merged PRs by 21 authors.

[#23007]: https://github.com/cockroachdb/cockroach/pull/23007
[#23122]: https://github.com/cockroachdb/cockroach/pull/23122
[#23127]: https://github.com/cockroachdb/cockroach/pull/23127
[#23148]: https://github.com/cockroachdb/cockroach/pull/23148
[#23180]: https://github.com/cockroachdb/cockroach/pull/23180
[#23181]: https://github.com/cockroachdb/cockroach/pull/23181
[#23193]: https://github.com/cockroachdb/cockroach/pull/23193
[#23201]: https://github.com/cockroachdb/cockroach/pull/23201
[#23215]: https://github.com/cockroachdb/cockroach/pull/23215
[#23227]: https://github.com/cockroachdb/cockroach/pull/23227
[#23231]: https://github.com/cockroachdb/cockroach/pull/23231
[#23241]: https://github.com/cockroachdb/cockroach/pull/23241
[#23246]: https://github.com/cockroachdb/cockroach/pull/23246
[#23247]: https://github.com/cockroachdb/cockroach/pull/23247
[#23256]: https://github.com/cockroachdb/cockroach/pull/23256
[#23259]: https://github.com/cockroachdb/cockroach/pull/23259
[#23283]: https://github.com/cockroachdb/cockroach/pull/23283
[#23287]: https://github.com/cockroachdb/cockroach/pull/23287
[#23288]: https://github.com/cockroachdb/cockroach/pull/23288
[#23289]: https://github.com/cockroachdb/cockroach/pull/23289
[#23300]: https://github.com/cockroachdb/cockroach/pull/23300
[#23303]: https://github.com/cockroachdb/cockroach/pull/23303
[#23311]: https://github.com/cockroachdb/cockroach/pull/23311
[#23317]: https://github.com/cockroachdb/cockroach/pull/23317
[#23319]: https://github.com/cockroachdb/cockroach/pull/23319
[#23348]: https://github.com/cockroachdb/cockroach/pull/23348
[#23372]: https://github.com/cockroachdb/cockroach/pull/23372
[#23541]: https://github.com/cockroachdb/cockroach/pull/23541
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

In this release, we’ve improved CockroachDB’s ability to run in orchestrated environments and closed several Postgres capability gaps.

- Better [`/health`](../v2.0/monitoring-and-alerting.html) behavior to support orchestrated deployments. [#23551][#23551]

<h3 id="v2.0-beta.20180319-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180319.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180319.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180319.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0-beta.20180319-sql-language-changes">SQL Language Changes</h3>

- `NO CYCLE` and `CACHE 1` are now supported options during [sequence creation](../v2.0/create-sequence.html). [#23518][#23518]
- `ISNULL` and `NOTNULL` are now accepted as alternatives to `IS NULL` and `IS NOT NULL`. [#23518][#23518]

<h3 id="v2.0-beta.20180319-command-line-changes">Command-Line Changes</h3>

- Changed the `server.drain_max_wait` [cluster setting](../v2.0/cluster-settings.html) to `server.shutdown.query_wait` [#23629][#23629]
- The generated HAProxy config generated by [`cockroach gen haproxy`](../v2.0/generate-cockroachdb-resources.html) has been extended with readiness checks. [#23590][#23590]

<h3 id="v2.0-beta.20180319-admin-ui-changes">Admin UI Changes</h3>

- Implemented a spinner on the **Logs** page instead of saying "No Data" while loading. [#23556][#23556]
- Now using monospace font and rendering new lines on the **Logs** page. Also, packed lines together more tightly. [#23556][#23556]
- Moved the **Clock Offset** graph from the **Distributed** dashboard to the [Runtime dashboard](../v2.0/admin-ui-runtime-dashboard.html). Now displaying each node's clock offset independently rather than aggregating them together. [#23627][#23627]
- When [reporting anonymous usage details](../v2.0/diagnostics-reporting.html), locality tier names are now redacted. [#23588][#23588]
- Clicking on the entire node component is now allowed in the Node Map, not just the visible elements. [#23536][#23536]
- The Node Map now shows how long a node has been dead. [#23404][#23404]
- Correct liveness status text now displays on nodes in the Node Map. [#23404][#23404]

<h3 id="v2.0-beta.20180319-bug-fixes">Bug Fixes</h3>

- Fixed a bug in which the usable capacity of nodes was not added up correctly in the Admin UI. [#23695][#23695]
- An [`ARRAY`](../v2.0/array.html) can now be used with the PostgreSQL binary format. [#23467][#23467]
- Fixed a panic when a query would incorrectly attempt to use an aggregation or window function in [`ON CONFLICT DO UPDATE`](../v2.0/insert.html#update-values-on-conflict). [#23658][#23658]
- [`CREATE TABLE AS`](../v2.0/create-table-as.html) can now be used with [scalar subqueries](../v2.0/scalar-expressions.html#scalar-subqueries). [#23470][#23470]
- Connection attempts to former members of the cluster and the associated spurious log messages are now prevented. [#23605][#23605]
- Fixed a panic when executing `INSERT INTO ... SELECT` queries where the number of columns targeted for insertion does not match the number of columns returned by the [`SELECT`](../v2.0/select-clause.html). [#23642][#23642]
- Reduced the risk that a node in the process of crashing could serve inconsistent data. [#23616][#23616]
- Fixed a correctness bug where some `ORDER BY` queries would not return the correct results under concurrent transactional load. [#23602][#23602]
- `RETURNING NOTHING` now properly detects [parallel statement execution](../v2.0/parallel-statement-execution.html) opportunities against statements that contain data-modifying statements in subqueries. [#23524][#23524]
- The [`/health` HTTP endpoint](../v2.0/monitoring-and-alerting.html#health-endpoints) is now accessible before a node has successfully become part of an initialized cluster, meaning that it now accurately reflects the health of the process rather than the ability of the process to serve queries. This has been the intention all along, but it didn't work until the node had joined a cluster or had `cockroach init` run on it. [#23551][#23551]
- Fixed a panic that could occur with certain types of casts. [#23535][#23535]
- Prevented a hang while crashing when `stderr` is blocked. [#23484][#23484]
- Fixed panics related to distributed execution of queries with `REGCLASS` casts. [#23482][#23482]
- Fixed a panic with computed columns. [#23435][#23435]
- Added prevention against potential consistency issues when a node is stopped and restarted in rapid succession. [#23339][#23339]
- [Decommissioning a node](../v2.0/remove-nodes.html) that has already been terminated now works in all cases. Success previously depended on whether the gateway node "remembered" the absent decommissioned node. [#23378][#23378]

<h3 id="v2.0-beta.20180319-build-changes">Build Changes</h3>

- [Go 1.10](https://golang.org/dl/) is now the minimum required version necessary to build CockroachDB. [#23494][#23494]

<h3 id="v2.0-beta.20180319-doc-updates">Doc Updates</h3>

- Documented the [`SPLIT AT`](../v2.0/split-at.html) statement, which forces a key-value layer range split at a specified row in a table or index. [#2704](https://github.com/cockroachdb/docs/pull/2704)
- Various updates to the [`IMPORT`](../v2.0/import.html) documentation. [#2676](https://github.com/cockroachdb/docs/pull/2676)
- Various updates to the [`SHOW TRACE`](../v2.0/show-trace.html) documentation. [#2674](https://github.com/cockroachdb/docs/pull/2674)
- Clarified the upgrade path for [rolling upgrades](../v2.0/upgrade-cockroach-version.html). [#2627](https://github.com/cockroachdb/docs/pull/2627)
- Added more detailed documentation on [ordering query results](../v2.0/query-order.html) with `ORDER BY`. [#2658](https://github.com/cockroachdb/docs/pull/2658)
- Documented [inverted indexes](../v2.0/inverted-indexes.html) for [`JSONB`](../v2.0/jsonb.html) data. [#2608](https://github.com/cockroachdb/docs/pull/2608)

<h3 id="v2.0-beta.20180319-contributors">Contributors</h3>

This release includes 48 merged PRs by 21 authors.

[#23339]: https://github.com/cockroachdb/cockroach/pull/23339
[#23378]: https://github.com/cockroachdb/cockroach/pull/23378
[#23404]: https://github.com/cockroachdb/cockroach/pull/23404
[#23435]: https://github.com/cockroachdb/cockroach/pull/23435
[#23467]: https://github.com/cockroachdb/cockroach/pull/23467
[#23470]: https://github.com/cockroachdb/cockroach/pull/23470
[#23482]: https://github.com/cockroachdb/cockroach/pull/23482
[#23484]: https://github.com/cockroachdb/cockroach/pull/23484
[#23494]: https://github.com/cockroachdb/cockroach/pull/23494
[#23518]: https://github.com/cockroachdb/cockroach/pull/23518
[#23524]: https://github.com/cockroachdb/cockroach/pull/23524
[#23535]: https://github.com/cockroachdb/cockroach/pull/23535
[#23536]: https://github.com/cockroachdb/cockroach/pull/23536
[#23551]: https://github.com/cockroachdb/cockroach/pull/23551
[#23556]: https://github.com/cockroachdb/cockroach/pull/23556
[#23588]: https://github.com/cockroachdb/cockroach/pull/23588
[#23590]: https://github.com/cockroachdb/cockroach/pull/23590
[#23602]: https://github.com/cockroachdb/cockroach/pull/23602
[#23605]: https://github.com/cockroachdb/cockroach/pull/23605
[#23616]: https://github.com/cockroachdb/cockroach/pull/23616
[#23627]: https://github.com/cockroachdb/cockroach/pull/23627
[#23629]: https://github.com/cockroachdb/cockroach/pull/23629
[#23642]: https://github.com/cockroachdb/cockroach/pull/23642
[#23658]: https://github.com/cockroachdb/cockroach/pull/23658
[#23695]: https://github.com/cockroachdb/cockroach/pull/23695
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.0-beta.20180326-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180326.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180326.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180326.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0-beta.20180326-general-changes">General Changes</h3>

- A CockroachDB process now flushes its logs upon receiving `SIGHUP` instead of `SIGUSR1` as it did earlier. This is aimed to simplify the automation of process monitoring, test, and backup tools. [#23783][#23783]
- Information about [zone config](../v2.0/configure-replication-zones.html) usage is now included in [diagnostic reports](../v2.0/diagnostics-reporting.html). [#23750][#23750]

<h3 id="v2.0-beta.20180326-enterprise-edition-changes">Enterprise Edition Changes</h3>

- Added the `cloudstorage.timeout` [cluster setting](../v2.0/cluster-settings.html) for import/export operations. [#23776][#23776]

<h3 id="v2.0-beta.20180326-sql-language-changes">SQL Language Changes</h3>

- SQL features introduced in CockroachDB v2.0 cannot be used in clusters that are not [upgraded fully to v2.0](../v2.0/upgrade-cockroach-version.html). [#24013][#24013]
- Added an `escape` option to the `encode()` and `decode()` [built-in functions](../v2.0/functions-and-operators.html). [#23781][#23781]
- Introduced a series of PostgreSQL-compatible, privilege-related [built-in functions](../v2.0/functions-and-operators.html). [#23839][#23839]
- Added the `pg_language` table to the `pg_catalog` virtual schema. [#23839][#23839]
- Added the `anyarray` type to the `pg_type` virtual schema. [#23836][#23836]
- [Retryable errors](../v2.0/transactions.html#error-handling) on schema change operations are now less likely to be returned to clients; more operations are retried internally. [#24050][#24050]

<h3 id="v2.0-beta.20180326-command-line-changes">Command-Line Changes</h3>

- Client commands now report a warning if the connection URL is specified by the `--url` as well as some other command-line flag. If you use the `--url` flag, other flags can fill in pieces missing from the URL.
- Added per-node heap profiles to the [`debug zip`](../v2.0/debug-zip.html) command output. [#23858][#23858]

<h3 id="v2.0-beta.20180326-admin-ui-changes">Admin UI Changes</h3>

- More debug pages are now locked down by the `server.remote_debugging.mode` [cluster setting](../v2.0/cluster-settings.html). [#24022][#24022]
- The **Network Diagnostics** report no longer crashes when the latencies are very small or on a single node cluster. [#23868][#23868]
- Fixed the flicker in the **Node Map** as data is being reloaded. [#23757][#23757]
- Fixed the text overflowing past the table cell boundaries on the **Jobs** page. [#23748][#23748]
- Updated the labels for the **Snapshots** graph on the **Replication** dashboard to be more specific. [#23742][#23742]
- Fixed a bug where graphs would not display on clusters with large numbers of nodes. [#24045][#24045]
- [Decommissioned nodes](../v2.0/remove-nodes.html) no longer appear in the node selection dropdown on the **Metrics** page. [#23800][#23800]
- Fixed a condition where a persistent trailing dip could appear in graphs for longer time periods. [#23874][#23874]

<h3 id="v2.0-beta.20180326-bug-fixes">Bug Fixes</h3>

- Redacted string values in debug API responses. [#24070][#24070]
- Old replicas are now garbage collected in a more timely fashion after a node has been offline for a long time (this bug only exists in recent v2.0 alpha/beta releases, not in v1.1). [#24066][#24066]
- Fixed a bug where some [inverted index](../v2.0/inverted-indexes.html) queries could return incorrect results. [#23968][#23968]
- Fixed the behavior of the `@>` operator with arrays and scalars. [#23969][#23969]
- [Inverted indexes](../v2.0/inverted-indexes.html) can no longer be hinted for inappropriate queries. [#23989][#23989]
- Enforced minimum privileges for the `admin` role. [#23935][#23935]
- A panic is now avoided if the SQL audit log directory does not exist when the node is started. [#23928][#23928]
- Supported Postgres syntax for `USING GIN`. [#23910][#23910]
- Fixed a bug where [`INSERT`](../v2.0/insert.html)/[`DELETE`](../v2.0/delete.html)/[`UPDATE`](../v2.0/update.html)/[`UPSERT`](../v2.0/upsert.html) may lose updates if run using `WITH` or the `[ ... ]` syntax. [#23895][#23895]
- Made sure that all built-in functions have a unique Postgres OID for compatibility. [#23880][#23880]
- Fixed an error message generated by the experimental SCRUB feature. [#23845][#23845]
- Fixed a bug where [`CREATE VIEW`](../v2.0/create-view.html) after [`ALTER TABLE ADD COLUMN`](../v2.0/add-column.html) would fail to register the dependency on the newly added column. [#23845][#23845]
- Fixed crashes or incorrect results when combining an `OUTER JOIN` with a `VALUES` clause that contains only `NULL` values on a column (or other subqueries which result in a `NULL` column). [#23838][#23838]
- Fixed rare nil pointer exception in rebalance target selection. [#23807][#23807]
- The [`cockroach zone set`](../v2.0/configure-replication-zones.html) command will now automatically retry if it encounters an error while setting zone configurations. [#23782][#23782]
- Fixed a bug where closing a connection in the middle of executing a query sometimes crashed the server. [#23761][#23761]
- Fixed a bug where expressions could be mistakenly considered equal, despite their types being different. [#23722][#23722]
- Fixed a bug where the `RANGE COUNT` metric on the Cluster Overview page of the Admin UI could significantly undercount the number of ranges. [#23746][#23746]
- The client URL reported upon [`cockroach start`](../v2.0/start-a-node.html) now does not include the option `application_name`. [#23894][#23894]

<h3 id="v2.0-beta.20180326-performance-improvements">Performance Improvements</h3>

- Improved cluster performance during overload scenarios. [#23884][#23884]

<h3 id="v2.0-beta.20180326-doc-updates">Doc Updates</h3>

- Added a local cluster tutorial demonstrating [JSON Support](../v2.0/demo-json-support.html). [#2716](https://github.com/cockroachdb/docs/pull/2716)
- Added full documentation for the [`VALIDATE CONSTRAINT`](../v2.0/validate-constraint.html) statement. [#2730](https://github.com/cockroachdb/docs/pull/2730)

<h3 id="v2.0-beta.20180326-contributors">Contributors</h3>

This release includes 64 merged PRs by 23 authors. We would like to thank the following contributors from the CockroachDB community, with special thanks to first-time contributors Bob Vawter.

[#23577]: https://github.com/cockroachdb/cockroach/pull/23577
[#23722]: https://github.com/cockroachdb/cockroach/pull/23722
[#23742]: https://github.com/cockroachdb/cockroach/pull/23742
[#23746]: https://github.com/cockroachdb/cockroach/pull/23746
[#23748]: https://github.com/cockroachdb/cockroach/pull/23748
[#23750]: https://github.com/cockroachdb/cockroach/pull/23750
[#23757]: https://github.com/cockroachdb/cockroach/pull/23757
[#23761]: https://github.com/cockroachdb/cockroach/pull/23761
[#23776]: https://github.com/cockroachdb/cockroach/pull/23776
[#23781]: https://github.com/cockroachdb/cockroach/pull/23781
[#23782]: https://github.com/cockroachdb/cockroach/pull/23782
[#23783]: https://github.com/cockroachdb/cockroach/pull/23783
[#23800]: https://github.com/cockroachdb/cockroach/pull/23800
[#23807]: https://github.com/cockroachdb/cockroach/pull/23807
[#23836]: https://github.com/cockroachdb/cockroach/pull/23836
[#23838]: https://github.com/cockroachdb/cockroach/pull/23838
[#23839]: https://github.com/cockroachdb/cockroach/pull/23839
[#23845]: https://github.com/cockroachdb/cockroach/pull/23845
[#23858]: https://github.com/cockroachdb/cockroach/pull/23858
[#23868]: https://github.com/cockroachdb/cockroach/pull/23868
[#23874]: https://github.com/cockroachdb/cockroach/pull/23874
[#23880]: https://github.com/cockroachdb/cockroach/pull/23880
[#23884]: https://github.com/cockroachdb/cockroach/pull/23884
[#23894]: https://github.com/cockroachdb/cockroach/pull/23894
[#23895]: https://github.com/cockroachdb/cockroach/pull/23895
[#23910]: https://github.com/cockroachdb/cockroach/pull/23910
[#23928]: https://github.com/cockroachdb/cockroach/pull/23928
[#23935]: https://github.com/cockroachdb/cockroach/pull/23935
[#23968]: https://github.com/cockroachdb/cockroach/pull/23968
[#23969]: https://github.com/cockroachdb/cockroach/pull/23969
[#23989]: https://github.com/cockroachdb/cockroach/pull/23989
[#24013]: https://github.com/cockroachdb/cockroach/pull/24013
[#24022]: https://github.com/cockroachdb/cockroach/pull/24022
[#24045]: https://github.com/cockroachdb/cockroach/pull/24045
[#24050]: https://github.com/cockroachdb/cockroach/pull/24050
[#24066]: https://github.com/cockroachdb/cockroach/pull/24066
[#24070]: https://github.com/cockroachdb/cockroach/pull/24070
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This is the first release candidate for CockroachDB v2.0. All known bugs have either been fixed or pushed to a future release, with large bugs documented as [known limitations](../v2.0/known-limitations.html).  

- Improved the **Node Map** to provide guidance when an enterprise license or additional configuration is required. [#24271][#24271]
- Bug fixes and stability improvements.

<h3 id="v2.0-rc.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-rc.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-rc.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-rc.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0-rc.1-admin-ui-changes">Admin UI Changes</h3>

- Improved the **Node Map** to provide guidance when an enterprise license or additional configuration is required. [#24271][#24271]
- Added the available storage capacity to the **Cluster Overview** metrics. [#24254][#24254]

<h3 id="v2.0-rc.1-bug-fixes">Bug Fixes</h3>

- Fixed a bug in [`RESTORE`](../v2.0/restore.html) that could lead to missing rows if the `RESTORE` was interrupted. [#24089][#24089]
- New nodes running CockroachDB v2.0 can now join clusters that contain nodes running v1.1. [#24257][#24257]
- Fixed a crash in [`cockroach zone ls`](../v2.0/configure-replication-zones.html) that would happen if a table with a zone config on it had been deleted but not yet garbage collected. (This was broken in v2.0 alphas, not in v1.1.) [#24180][#24180]
- Fixed a bug where zooming on the **Node Map** could break after zooming out to the maximum extent. [#24183][#24183]
- Fixed a crash while performing rolling restarts. [#24260][#24260]
- Fixed a bug where [privileges](../v2.0/privileges.html) were sometimes set incorrectly after upgrading from an older release. [#24393][#24393]

<h3 id="v2.0-rc.1-contributors">Contributors</h3>

This release includes 11 merged PRs by 10 authors. We would like to thank all contributors from the CockroachDB community, with special thanks to first-time contributor Vijay Karthik.

[#24089]: https://github.com/cockroachdb/cockroach/pull/24089
[#24180]: https://github.com/cockroachdb/cockroach/pull/24180
[#24183]: https://github.com/cockroachdb/cockroach/pull/24183
[#24254]: https://github.com/cockroachdb/cockroach/pull/24254
[#24257]: https://github.com/cockroachdb/cockroach/pull/24257
[#24260]: https://github.com/cockroachdb/cockroach/pull/24260
[#24271]: https://github.com/cockroachdb/cockroach/pull/24271
[#24393]: https://github.com/cockroachdb/cockroach/pull/24393
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

With the release of CockroachDB v2.0, we’ve made significant performance improvements, expanded our PostgreSQL compatibility by adding support for JSON (among other types), and provided functionality for managing multi-regional clusters in production.  

- Read more about these changes in the [v2.0 blog post](https://www.cockroachlabs.com/blog/cockroachdb-2-0-release/).
- Check out a [summary of the most significant user-facing changes](#summary).
- Then [upgrade to CockroachDB v2.0](../v2.0/upgrade-cockroach-version.html).

<h3 id="v2.0.0-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.0.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.0.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.0.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0.0-summary">Summary</h3>

This section summarizes the most significant user-facing changes in v2.0.0. For a complete list of features and changes, including bug fixes and performance improvements, see the [release notes](index.html#testing-releases) for previous testing releases.

- [Enterprise Features](#enterprise-features)
- [Core Features](#core-features)
- [Backward-Incompatible Changes](#backward-incompatible-changes)
- [Known Limitations](#known-limitations)
- [Documentation Updates](#documentation-updates)

<style>
    table td:first-child {
        min-width: 225px;
    }
</style>

<h3 id="v2.0.0-enterprise-features">Enterprise Features</h3>

These new features require an [enterprise license](../v2.0/enterprise-licensing.html). Register for a 30-day trial license [here](https://www.cockroachlabs.com/pricing/start-trial/).

Feature | Description
--------|------------
[Table Partitioning](../v2.0/partitioning.html) | Table partitioning gives you row-level control of how and where your data is stored. This feature can be used to keep data close to users, thereby reducing latency, or to store infrequently-accessed data on slower and cheaper storage, thereby reducing costs.
[Node Map](../v2.0/enable-node-map.html) | The **Node Map** in the Admin UI visualizes the geographical configuration of a multi-region cluster by plotting the node localities on a world map. This feature provides real-time cluster metrics, with the ability to drill down to individual nodes to monitor and troubleshoot cluster health and performance.
[Role-Based Access Control](../v2.0/roles.html) | Roles simplify access control by letting you assign SQL privileges to groups of users rather than to individuals.  
[Point-in-time Backup/Restore](../v2.0/restore.html#point-in-time-restore-new-in-v2-0) (Beta) | Data can now be restored as it existed at a specific point-in-time within the [revision history of a backup](../v2.0/backup.html#backups-with-revision-history-new-in-v2-0).<br><br>This is a **beta** feature. It is currently undergoing continued testing. Please [file a Github issue](../v2.0/file-an-issue.html) with us if you identify a bug.

<h3 id="v2.0.0-core-features">Core Features</h3>

These new features are freely available in the core version and do not require an enterprise license.

<h3 id="v2.0.0-sql">SQL</h3>

Feature | Description
--------|------------
[JSON Support](../v2.0/demo-json-support.html) | The [`JSONB`](../v2.0/jsonb.html) data type and [inverted indexes](../v2.0/inverted-indexes.html) give you the flexibility to store and efficiently query  semi-structured data.
[Sequences](../v2.0/create-sequence.html) | Sequences generate sequential integers according to defined rules. They are generally used for creating numeric primary keys.   
[SQL Audit Logging](../v2.0/sql-audit-logging.html) (Experimental)| SQL audit logging gives you detailed information about queries being executed against your system. This feature is especially useful when you want to log all queries that are run against a table containing personally identifiable information (PII).<br><br>This is an **experimental** feature. Its interface and output are subject to change.
[Common Table Expressions](../v2.0/common-table-expressions.html) | Common Table Expressions (CTEs) simplify the definition and use of subqueries. They can be used in combination with [`SELECT` clauses](../v2.0/select-clause.html) and [`INSERT`](../v2.0/insert.html), [`DELETE`](../v2.0/delete.html), [`UPDATE`](../v2.0/update.html) and [`UPSERT`](../v2.0/upsert.html) statements.
[Computed Columns](../v2.0/computed-columns.html) | Computed columns store data generated from other columns by an expression that's included in the column definition. They are especially useful in combination with [table partitioning](../v2.0/partitioning.html), [`JSONB`](../v2.0/jsonb.html) columns, and [secondary indexes](../v2.0/indexes.html).
[Foreign Key Actions](../v2.0/foreign-key.html#foreign-key-actions-new-in-v2-0) | The `ON UPDATE` and `ON DELETE` foreign key actions control what happens to a constrained column when the column it's referencing (the foreign key) is deleted or updated.
[Virtual Schemas](../v2.0/sql-name-resolution.html#logical-schemas-and-namespaces) | For PostgreSQL compatibility, CockroachDB now supports a three-level structure for names: database name > virtual schema name > object name. The new [`SHOW SCHEMAS`](../v2.0/show-schemas.html) statement can be used to list all virtual schemas for a given database.
[`IMPORT`](../v2.0/import.html) | The `IMPORT` statement now imports tabular data in a fully distributed fashion, and import jobs can now be [paused](../v2.0/pause-job.html), [resumed](../v2.0/resume-job.html), and [cancelled](../v2.0/cancel-job.html).
[`INET`](../v2.0/inet.html) | The `INET` data type stores an IPv4 or IPv6 address.
[`TIME`](../v2.0/time.html) | The `TIME` data type stores the time of day without a time zone.

<h3 id="v2.0.0-operations">Operations</h3>

Feature | Description
--------|------------
[Node Readiness Endpoint](../v2.0/monitoring-and-alerting.html#health-ready-1) | The new `/health?ready=1` endpoint returns an `HTTP 503 Service Unavailable` status response code with an error when a node is being decommissioned or is in the process of shutting down and is therefore not able to accept SQL connections and execute queries. This is especially useful for making sure [load balancers](../v2.0/recommended-production-settings.html#load-balancing) do not direct traffic to nodes that are live but not "ready", which is a necessary check during [rolling upgrades](../v2.0/upgrade-cockroach-version.html).
[Node Decommissioning](../v2.0/remove-nodes.html) | Nodes that have been decommissioned and stopped no longer appear in Admin UI and command-line interface metrics.
[Per-Replica Constraints in Replication Zones](../v2.0/configure-replication-zones.html#scope-of-constraints) | When defining a replication zone, unique constraints can be defined for each affected replica, meaning you can effectively pick the exact location of each replica.
[Replication Zone for "Liveness" Range](../v2.0/configure-replication-zones.html#create-a-replication-zone-for-a-system-range) | Clusters now come with a pre-defined replication zone for the "liveness" range, which contains the authoritative information about which nodes are live at any given time.
[Timeseries Data Controls](../v2.0/operational-faqs.html#can-i-reduce-or-disable-the-storage-of-timeseries-data-new-in-v2-0) | It is now possible to reduce the amount of timeseries data stored by a CockroachDB cluster or to disable the storage of timeseries data entirely. The latter is recommended only when using a third-party tool such as Prometheus for timeseries monitoring.

<h3 id="v2.0.0-backward-incompatible-changes">Backward-Incompatible Changes</h3>

Change | Description
-------|------------
Replication Zones | [Positive replication zone constraints](../v2.0/configure-replication-zones.html#replication-constraints) no longer work. Any existing positive constraints will be ignored. This change should not impact existing deployments since positive constraints have not been documented or supported for some time.
Casts from `BYTES` to `STRING` | Casting between these types now works the same way as in PostgreSQL. New functions `encode()` and `decode()` are available to replace the former functionality.
`NaN` Comparisons | `NaN` comparisons have been redefined to be compatible with PostgreSQL. `NaN` is now equal to itself and sorts before all other non-NULL values.
[`DROP USER`](../v2.0/drop-user.html) | It is no longer possible to drop a user with grants; the user's grants must first be [revoked](../v2.0/revoke.html).
[Cluster Settings](../v2.0/cluster-settings.html) | The obsolete `kv.gc.batch_size` cluster setting has been removed.
Environment Variables | The `COCKROACH_METRICS_SAMPLE_INTERVAL` environment variable has been removed. Users that relied on it should reduce the value for the `timeseries.resolution_10s.storage_duration` [cluster setting](../v2.0/cluster-settings.html) instead.
[Sequences](../v2.0/create-sequence.html) | As of the [v1.2-alpha.20171113](../releases/v1.2-alpha.20171113.html) release, how sequences are stored in the key-value layer changed. Sequences created prior to that release must therefore be dropped and recreated. Since a sequence cannot be dropped while it is being used in a column's [`DEFAULT`](../v2.0/default-value.html) expression, those expressions must be dropped before the sequence is dropped, and recreated after the sequence is recreated. The `setval()` function can be used to set the value of a sequence to what it was previously.
[Reserved Keywords](../v2.0/sql-grammar.html#reserved_keyword) | `ROLE`, `VIRTUAL`, and `WORK` have been added as reserved keywords and are no longer allowed as [identifiers](../v2.0/keywords-and-identifiers.html).

<h3 id="v2.0.0-known-limitations">Known Limitations</h3>

For information about limitations we've identified in CockroachDB v2.0, with suggested workarounds where applicable, see [Known Limitations](../v2.0/known-limitations.html).

<h3 id="v2.0.0-documentation-updates">Documentation Updates</h3>

Topic | Description
------|------------
[Production Checklist](../v2.0/recommended-production-settings.html) | This topic now provides cloud-specific hardware, security, load balancing, monitoring and alerting, and clock synchronization recommendations as well as expanded cluster topology guidance. Related [deployment tutorials](../v2.0/manual-deployment.html) have been enhanced with much of this information as well.
[Monitoring and Alerting](../v2.0/monitoring-and-alerting.html) | This new topic explains available tools for monitoring the overall health and performance of a cluster and critical events and metrics to alert on.
[Common Errors](../v2.0/common-errors.html) | This new topic helps you understand and resolve errors you might encounter, including retryable and ambiguous errors for transactions.
[SQL Performance](../v2.0/performance-best-practices-overview.html) | This new topic provides best practices for optimizing SQL performance in CockroachDB.
[SQL Standard Comparison](../v2.0/sql-feature-support.html) | This new topic lists which SQL standard features are supported, partially-supported, and unsupported by CockroachDB.
[Selection Queries](../v2.0/selection-queries.html) | This new topic explains the function and syntax of queries and operations involved in reading and processing data in CockroachDB, alongside more detailed information about [ordering query results](../v2.0/query-order.html), [limiting query results](../v2.0/limit-offset.html), [subqueries](../v2.0/subqueries.html), and [join expressions](../v2.0/joins.html).
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.0.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0.1-general-changes">General Changes</h3>

- The new `server.clock.persist_upper_bound_interval` [cluster setting](../v2.0/cluster-settings.html) can be used to guarantees monotonic wall time across server restarts. [#24624][#24624]
- The new `server.clock.forward_jump_check_enabled` [cluster setting](../v2.0/cluster-settings.html) can be used to cause nodes to panic on clock jumps. [#24606][#24606]
- Prevented execution errors reporting a missing `libtinfo.so.5` on Linux systems. [#24531][#24531]

<h3 id="v2.0.1-enterprise-edition-changes">Enterprise Edition Changes</h3>

- It is now possible to [`RESTORE`](../v2.0/restore.html) views when using the `into_db` option. [#24590][#24590] {% comment %}doc{% endcomment %}
- The new `jobs.registry.leniency` [cluster setting](../v2.0/cluster-settings.html) can be used to allow long-running [`IMPORT`](../v2.0/import.html) jobs to survive temporary node saturation. [#24505][#24505]
- Relaxed the limitation on using [`BACKUP`](../v2.0/backup.html) in a mixed version cluster. [#24515][#24515]

<h3 id="v2.0.1-sql-language-changes">SQL Language Changes</h3>

- Improved the error message returned on object creation when no current database is set or only invalid schemas are in the `search_path`. [#24812][#24812]
- The `current_schema()` and `current_schemas()` [built-in functions](../v2.0/functions-and-operators.html) now only consider valid schemas, like PostgreSQL does. [#24758][#24758]
- The experimental SQL features `SHOW TESTING_RANGES` and `ALTER ... TESTING_RELOCATE` have been renamed [`SHOW EXPERIMENTAL_RANGES`](../v2.0/show-experimental-ranges.html) and `ALTER ... EXPERIMENTAL_RELOCATE`. [#24699][#24699]
- `ROLE`, `VIRTUAL`, and `WORK` are no longer reserved keywords and can again be used as unrestricted names. [#24665][#24665] [#24549][#24549]

<h3 id="v2.0.1-command-line-changes">Command-Line Changes</h3>

- When [`cockroach gen haproxy`](../v2.0/generate-cockroachdb-resources.html) is run, if an `haproxy.cfg` file already exists in the current directory, it now gets fully overwritten instead of potentially resulting in an unusable config. [#24336][#24336] {% comment %}doc{% endcomment %}

<h3 id="v2.0.1-bug-fixes">Bug Fixes</h3>

- Fixed a bug when using fractional units (e.g., `0.5GiB`) for the `--cache` and `--sql-max-memory` flags of [`cockroach start`](../v2.0/start-a-node.html). [#24388][#24388]
- Fixed the handling of role membership lookups within transactions. [#24334][#24334]
- Fixed a bug causing some lookup join queries to report incorrect type errors. [#24825][#24825]
- `ALTER INDEX ... RENAME` can now be used on the primary index. [#24777][#24777]
- Fixed a panic involving [inverted index](../v2.0/inverted-indexes.html) queries using the `->` operator. [#24596][#24596]
- Fix a panic involving [inverted index](../v2.0/inverted-indexes.html) queries over `NULL`. [#24566][#24566]
- Fixed a bug preventing [inverted index](../v2.0/inverted-indexes.html) queries that have a root with a single entry or element but multiple children overall. [#24376][#24376]
- [`JSONB`](../v2.0/jsonb.html) values can now be cast to [`STRING`](../v2.0/string.html) values. [#24553][#24553]
- Prevented executing distributed SQL operations on draining nodes. [#23916][#23916]
- Fixed a panic caused by a `WHERE` condition that requires a column to equal a specific value and at the same time equal another column. [#24517][#24517]
- Fixed a panic caused by passing a `Name` type to `has_database_privilege()`. [#24270][#24270]
- Fixed a bug causing index backfills to fail in a loop after exceeding the GC TTL of their source table. [#24427][#24427]
- Fixed a panic caused by null config zones in diagnostics reporting. [#24526][#24526]

<h3 id="v2.0.1-performance-improvements">Performance Improvements</h3>

- Some [`SELECT`s](../v2.0/select-clause.html) with limits no longer require a second low-level scan, resulting in much faster execution. [#24796][#24796]

<h3 id="v2.0.1-contributors">Contributors</h3>

This release includes 39 merged PRs by 16 authors. Special thanks to Vijay Karthik from the CockroachDB community.

[#23916]: https://github.com/cockroachdb/cockroach/pull/23916
[#24221]: https://github.com/cockroachdb/cockroach/pull/24221
[#24270]: https://github.com/cockroachdb/cockroach/pull/24270
[#24334]: https://github.com/cockroachdb/cockroach/pull/24334
[#24336]: https://github.com/cockroachdb/cockroach/pull/24336
[#24376]: https://github.com/cockroachdb/cockroach/pull/24376
[#24388]: https://github.com/cockroachdb/cockroach/pull/24388
[#24427]: https://github.com/cockroachdb/cockroach/pull/24427
[#24505]: https://github.com/cockroachdb/cockroach/pull/24505
[#24515]: https://github.com/cockroachdb/cockroach/pull/24515
[#24517]: https://github.com/cockroachdb/cockroach/pull/24517
[#24526]: https://github.com/cockroachdb/cockroach/pull/24526
[#24531]: https://github.com/cockroachdb/cockroach/pull/24531
[#24549]: https://github.com/cockroachdb/cockroach/pull/24549
[#24553]: https://github.com/cockroachdb/cockroach/pull/24553
[#24566]: https://github.com/cockroachdb/cockroach/pull/24566
[#24590]: https://github.com/cockroachdb/cockroach/pull/24590
[#24596]: https://github.com/cockroachdb/cockroach/pull/24596
[#24606]: https://github.com/cockroachdb/cockroach/pull/24606
[#24624]: https://github.com/cockroachdb/cockroach/pull/24624
[#24665]: https://github.com/cockroachdb/cockroach/pull/24665
[#24699]: https://github.com/cockroachdb/cockroach/pull/24699
[#24758]: https://github.com/cockroachdb/cockroach/pull/24758
[#24777]: https://github.com/cockroachdb/cockroach/pull/24777
[#24796]: https://github.com/cockroachdb/cockroach/pull/24796
[#24812]: https://github.com/cockroachdb/cockroach/pull/24812
[#24825]: https://github.com/cockroachdb/cockroach/pull/24825
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.0.2-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0.2-general-changes">General Changes</h3>

- The header of new log files generated by [`cockroach start`](../v2.0/start-a-node.html) will now include the cluster ID once it has been determined. [#24982][#24982]
- The cluster ID is now reported with tag `[config]` in the first log file, not only when log files are rotated. [#24982][#24982]
- Stopped spamming the server logs with "error closing gzip response writer" messages. [#25108][#25108]

<h3 id="v2.0.2-sql-language-changes">SQL Language Changes</h3>

- Added more ways to specify an index name for statements that require one (e.g., `DROP INDEX`, `ALTER INDEX ... RENAME`, etc.), improving PostgreSQL compatibility. [#24817][#24817] {% comment %}doc{% endcomment %}
- Clarified the error message produced upon accessing a virtual schema with no database prefix (e.g., when `database` is not set). [#24809][#24809]
- `STORED` is no longer a reserved keyword and can again be used as an unrestricted name for databases, tables and columns. [#24864][#24864] {% comment %}doc{% endcomment %}
- Errors detected by `SHOW SYNTAX` are now tracked internally like other SQL errors. [#24900][#24900]
- [`IMPORT`](../v2.0/import.html) now supports hex-encoded byte literals for [`BYTES`](../v2.0/bytes.html) columns. [#25063][#25063] {% comment %}doc{% endcomment %}
- [Collated strings](../v2.0/collate.html) can now be used in `WHERE` clauses on indexed columns. [#25175][#25175] {% comment %}doc{% endcomment %}
- The Level and Type columns of [`EXPLAIN (VERBOSE)`](../v2.0/explain.html) results are now hidden; if they are needed, they can be `SELECT`ed explicitly. [#25206][#25206] {% comment %}doc{% endcomment %}

<h3 id="v2.0.2-admin-ui-changes">Admin UI Changes</h3>

- Added RocksDB compactions/flushes to storage graphs. [#25457][#25457]

<h3 id="v2.0.2-bug-fixes">Bug Fixes</h3>

- It is once again possible to use a simply qualified table name in qualified stars (e.g., `SELECT mydb.kv.* FROM kv`) for compatibility with CockroachDB v1.x. [#24842][#24842]
- Fixed a scenario in which a node could deadlock while starting up. [#24831][#24831]
- Ranges in partitioned tables now properly split to respect their configured maximum size. [#24912][#24912]
- Some kinds of schema change errors that were stuck in a permanent loop now correctly fail. [#25015][#25015]
- When [adding a column](../v2.0/add-column.html), CockroachDB now verifies that the column is referenced by no more than one foreign key. Existing tables with a column that is used by multiple foreign key constraints should be manually changed to have at most one foreign key per column. [#25079][#25079]
- CockroachDB now properly reports an error when using the internal-only functions `final_variance()` and `final_stddev()` instead of causing a crash. [#25218][#25218]
- The `constraint_schema` column in `information_schema.constraint_column_usage` now displays the constraint's schema instead of its catalog. [#25220][#25220]
- Fix a panic caused by certain queries containing `OFFSET` and `ORDER BY`. [#25238][#25238]
- `BEGIN; RELEASE SAVEPOINT` now returns an error instead of causing a crash. [#25251][#25251]
- Fixed a rare `segfault` that occurred when reading from an invalid memory location returned from C++. [#25361][#25361]
- Fixed a bug with `IS DISTINCT FROM` not returning `NULL` values that pass the condition in some cases. [#25339][#25339]
- Restarting a CockroachDB server on Windows no longer fails due to file system locks in the store directory. [#25439][#25439]
- Prevented the consistency checker from deadlocking. This would previously manifest itself as a steady number of replicas queued for consistency checking on one or more nodes and would resolve by restarting the affected nodes. [#25474][#25474]
- Fixed problems with [`IMPORT`](../v2.0/import.html) sometimes failing after node decommissioning. [#25307][#25307]
- Fixed a bug causing `PREPARE` to hang when run in the same transaction as a `CREATE TABLE` statement. [#24874][#24874]

<h3 id="v2.0.2-build-changes">Build Changes</h3>

- Build metadata, like the commit SHA and build time, is properly injected into the binary when using Go 1.10 and building from a symlink. [#25062][#25062]

<h3 id="v2.0.2-doc-updates">Doc Updates</h3>

- Improved the documentation of the `now()`, `current_time()`, `current_date()`, `current_timestamp()`, `clock_timestamp()`, `statement_timestamp()`, `cluster_logical_timestamp()`, and `age()` [built-in functions](../v2.0/functions-and-operators.html). [#25383][#25383] [#25145][#25145]

<h3 id="v2.0.2-contributors">Contributors</h3>

This release includes 42 merged PRs by 16 authors. We would like to thank the following contributors from the CockroachDB community:

- Garvit Juniwal
- Jingguo Yao

[#24809]: https://github.com/cockroachdb/cockroach/pull/24809
[#24817]: https://github.com/cockroachdb/cockroach/pull/24817
[#24831]: https://github.com/cockroachdb/cockroach/pull/24831
[#24842]: https://github.com/cockroachdb/cockroach/pull/24842
[#24864]: https://github.com/cockroachdb/cockroach/pull/24864
[#24874]: https://github.com/cockroachdb/cockroach/pull/24874
[#24900]: https://github.com/cockroachdb/cockroach/pull/24900
[#24912]: https://github.com/cockroachdb/cockroach/pull/24912
[#24982]: https://github.com/cockroachdb/cockroach/pull/24982
[#25015]: https://github.com/cockroachdb/cockroach/pull/25015
[#25062]: https://github.com/cockroachdb/cockroach/pull/25062
[#25063]: https://github.com/cockroachdb/cockroach/pull/25063
[#25079]: https://github.com/cockroachdb/cockroach/pull/25079
[#25108]: https://github.com/cockroachdb/cockroach/pull/25108
[#25145]: https://github.com/cockroachdb/cockroach/pull/25145
[#25175]: https://github.com/cockroachdb/cockroach/pull/25175
[#25206]: https://github.com/cockroachdb/cockroach/pull/25206
[#25218]: https://github.com/cockroachdb/cockroach/pull/25218
[#25220]: https://github.com/cockroachdb/cockroach/pull/25220
[#25238]: https://github.com/cockroachdb/cockroach/pull/25238
[#25251]: https://github.com/cockroachdb/cockroach/pull/25251
[#25307]: https://github.com/cockroachdb/cockroach/pull/25307
[#25339]: https://github.com/cockroachdb/cockroach/pull/25339
[#25361]: https://github.com/cockroachdb/cockroach/pull/25361
[#25383]: https://github.com/cockroachdb/cockroach/pull/25383
[#25439]: https://github.com/cockroachdb/cockroach/pull/25439
[#25457]: https://github.com/cockroachdb/cockroach/pull/25457
[#25474]: https://github.com/cockroachdb/cockroach/pull/25474
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.0.3-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.3.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.3.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.3.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0.3-general-changes">General Changes</h3>

- The new `compactor.threshold_bytes` and `max_record_age` [cluster settings](../v2.0/cluster-settings.html) can be used to configure the compactor. [#25458][#25458]
- The new `cluster.preserve_downgrade_option` [cluster setting](../v2.0/cluster-settings.html) makes it possible to preserve the option to downgrade after [performing a rolling upgrade to v2.1](../v2.1/upgrade-cockroach-version.html). [#25811][#25811]

<h3 id="v2.0.3-sql-language-changes">SQL Language Changes</h3>

- Prevented [`DROP TABLE`](../v2.0/drop-table.html) from using too much CPU. [#25852][#25852]

<h3 id="v2.0.3-command-line-changes">Command-Line Changes</h3>

- The [`cockroach sql`](../v2.0/use-the-built-in-sql-client.html) command no longer prompts for a password when a certificate is provided. [#26232][#26232]
- The [`cockroach quit`](../v2.0/stop-a-node.html) command now prints warning messages to the standard error stream, not to standard output. [#26163][#26163]

<h3 id="v2.0.3-bug-fixes">Bug Fixes</h3>

- Prevented the internal gossip network from being partitioned by making it much less likely that nodes in the network could forget about each other. [#25521][#25521]
- Prevented spurious `BudgetExceededErrors` for some queries that read a lot of JSON data from disk. [#25719][#25719]
- Fixed a crash in some cases when using a `GROUP BY` with `HAVING`. [#25654][#25654]
- Fixed a crash caused by inserting data into a table with [computed columns](../v2.0/computed-columns.html) that reference other columns that weren't present in the `INSERT` statement. [#25807][#25807]
- [`UPSERT`](../v2.0/upsert.html) is now properly able to write `NULL` values to every column in tables containing more than one [column family](../v2.0/column-families.html). [#26181][#26181]
- Fixed a bug where a long-running query running from one day to the next would not always produce the right value for `current_date()`. [#26413][#26413]
- Fixed a bug where [`cockroach quit`](../v2.0/stop-a-node.html) would erroneously fail even though the node already successfully shut down. [#26163][#26163]
- Rows larger than 8192 bytes are now supported by the "copy from" protocol. [#26641][#26641]
- Trying to "copy from stdin" into a table that doesn't exist no longer drops the connection. [#26641][#26641]
- Previously, expired compactions could stay in the queue forever. Now, they are removed when they expire. [#26659][#26659]

<h3 id="v2.0.3-performance-improvements">Performance Improvements</h3>

- The performance impact of dropping a large table has been substantially reduced. [#26615][#26615]

<h3 id="v2.0.3-doc-updates">Doc Updates</h3>

- Documented [special syntax forms](../v2.0/functions-and-operators.html#special-syntax-forms) of built-in SQL functions and [conditional and function-like operators](../v2.0/functions-and-operators.html#conditional-and-function-like-operators), and updated the [SQL operator order of precedence](../v2.0/functions-and-operators.html#operators). [#3192][#3192]
- Added best practices on [understanding and avoiding transaction contention](../v2.0/performance-best-practices-overview.html#understanding-and-avoiding-transaction-contention) and a related [FAQ](../v2.0/operational-faqs.html#why-would-increasing-the-number-of-nodes-not-result-in-more-operations-per-second). [#3156][#3156]
- Improved the documentation of [`AS OF SYSTEM TIME`](../v2.0/as-of-system-time.html). [#3155][#3155]
- Expanded the [manual deployment](../v2.0/manual-deployment.html) guides to cover running a sample workload against a cluster. [#3149][#3149]
- Added FAQs on [generating unique, slowly increasing sequential numbers](../v2.0/sql-faqs.html#how-do-i-generate-unique-slowly-increasing-sequential-numbers-in-cockroachdb) and [the differences between `UUID`, sequences, and `unique_rowid()`](../v2.0/sql-faqs.html#what-are-the-differences-between-uuid-sequences-and-unique_rowid). [#3104][#3104]

<h3 id="v2.0.3-contributors">Contributors</h3>

This release includes 19 merged PRs by 14 authors.

[#25458]: https://github.com/cockroachdb/cockroach/pull/25458
[#25521]: https://github.com/cockroachdb/cockroach/pull/25521
[#25654]: https://github.com/cockroachdb/cockroach/pull/25654
[#25719]: https://github.com/cockroachdb/cockroach/pull/25719
[#25807]: https://github.com/cockroachdb/cockroach/pull/25807
[#25811]: https://github.com/cockroachdb/cockroach/pull/25811
[#25852]: https://github.com/cockroachdb/cockroach/pull/25852
[#26163]: https://github.com/cockroachdb/cockroach/pull/26163
[#26181]: https://github.com/cockroachdb/cockroach/pull/26181
[#26232]: https://github.com/cockroachdb/cockroach/pull/26232
[#26403]: https://github.com/cockroachdb/cockroach/pull/26403
[#26413]: https://github.com/cockroachdb/cockroach/pull/26413
[#26615]: https://github.com/cockroachdb/cockroach/pull/26615
[#26641]: https://github.com/cockroachdb/cockroach/pull/26641
[#26659]: https://github.com/cockroachdb/cockroach/pull/26659
[#3104]: https://github.com/cockroachdb/docs/pull/3104
[#3149]: https://github.com/cockroachdb/docs/pull/3149
[#3155]: https://github.com/cockroachdb/docs/pull/3155
[#3156]: https://github.com/cockroachdb/docs/pull/3156
[#3192]: https://github.com/cockroachdb/docs/pull/3192
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.0.4-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.4.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.4.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.4.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0.4-sql-language-changes">SQL Language Changes</h3>

- [`CHECK`](../v2.0/check.html) constraints are now checked when updating a conflicting row in [`INSERT ... ON CONFLICT DO UPDATE`](../v2.0/insert.html#update-values-on-conflict) statements. [#26699][#26699] {% comment %}doc{% endcomment %}
- An error is now returned to the user instead of panicking when trying to add a column with a [`UNIQUE`](../v2.0/unique.html) constraint when that column's type is not indexable. [#26728][#26728] {% comment %}doc{% endcomment %}

<h3 id="v2.0.4-command-line-changes">Command-Line Changes</h3>

- CockroachDB now computes the correct number of replicas on down nodes. Therefore, when [decommissioning nodes](../v2.0/remove-nodes.html) via the [`cockroach node decommission`](../v2.0/view-node-details.html) command, the `--wait=all` option no longer hangs indefinitely when there are down nodes. As a result, the `--wait=live` option is no longer necessary and has been deprecated. [#27158][#27158]

<h3 id="v2.0.4-bug-fixes">Bug Fixes</h3>

- Fixed a typo on **Node Map** screen of the Admin UI. [#27129][#27129]
- Fixed a rare crash on node [decommissioning](../v2.0/remove-nodes.html). [#26717][#26717]
- Joins across two [interleaved tables](../v2.0/interleave-in-parent.html) no longer return incorrect results under certain circumstances when the equality columns aren't all part of the interleaved columns. [#26832][#26832]
- Successes of time series maintenance queue operations are no longer counted as errors in the **Metrics** dashboard of the Admin UI. [#26820][#26820]
- Prevented a situation in which ranges repeatedly fail to perform a split. [#26944][#26944]
- Fixed a crash that could occur when distributed `LIMIT` queries were run on a cluster with at least one unhealthy node. [#26953][#26953]
- Failed [`IMPORT`](../v2.0/import.html)s now begin to clean up partially imported data immediately and in a faster manner. [#26986][#26986]
- Alleviated a scenario in which a large number of uncommitted Raft commands could cause memory pressure at startup time. [#27024][#27024]
- The pg-specific syntax `SET transaction_isolation` now supports settings other than `SNAPSHOT`. This bug did not affect the standard SQL `SET TRANSACTION
  ISOLATION LEVEL`. [#27047][#27047]
- The `DISTINCT ON` clause is now reported properly in statement statistics. [#27222][#27222]
- Fixed a crash when trying to plan certain `UNION ALL` queries. [#27233][#27233]
- Commands are now abandoned earlier once a deadline has been reached. [#27215][#27215]
- Fixed a panic in [`IMPORT`](../v2.0/import.html) when creating a table using a sequence operation (e.g., `nextval()`) in a column's [DEFAULT](../v2.0/default-value.html) expression. [#27294][#27294]

<h3 id="v2.0.4-doc-updates">Doc Updates</h3>

- Added a tutorial on [benchmarking CockroachDB with TPC-C](../v2.0/performance-benchmarking-with-tpc-c.html). [#3281][#3281]
- Added `systemd` configs and instructions to [deployment tutorials](../v2.0/manual-deployment.html). [#3268][#3268]
- Updated the [Kubernetes tutorials](../v2.0/orchestrate-cockroachdb-with-kubernetes.html) to reflect that pods aren't "Ready" before init. [#3291][#3291]

<h3 id="v2.0.4-contributors">Contributors</h3>

This release includes 22 merged PRs by 17 authors. We would like to thank the following contributors from the CockroachDB community, with special thanks to first-time contributors Emmanuel.

- Emmanuel
- neeral

[#26699]: https://github.com/cockroachdb/cockroach/pull/26699
[#26717]: https://github.com/cockroachdb/cockroach/pull/26717
[#26728]: https://github.com/cockroachdb/cockroach/pull/26728
[#26820]: https://github.com/cockroachdb/cockroach/pull/26820
[#26832]: https://github.com/cockroachdb/cockroach/pull/26832
[#26944]: https://github.com/cockroachdb/cockroach/pull/26944
[#26953]: https://github.com/cockroachdb/cockroach/pull/26953
[#26986]: https://github.com/cockroachdb/cockroach/pull/26986
[#27024]: https://github.com/cockroachdb/cockroach/pull/27024
[#27047]: https://github.com/cockroachdb/cockroach/pull/27047
[#27129]: https://github.com/cockroachdb/cockroach/pull/27129
[#27158]: https://github.com/cockroachdb/cockroach/pull/27158
[#27215]: https://github.com/cockroachdb/cockroach/pull/27215
[#27222]: https://github.com/cockroachdb/cockroach/pull/27222
[#27233]: https://github.com/cockroachdb/cockroach/pull/27233
[#27294]: https://github.com/cockroachdb/cockroach/pull/27294
[#3268]: https://github.com/cockroachdb/docs/pull/3268
[#3281]: https://github.com/cockroachdb/docs/pull/3281
[#3291]: https://github.com/cockroachdb/docs/pull/3291
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.0.5-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.5.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.5.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.5.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0.5-sql-language-changes">SQL language changes</h3>

- The binary Postgres wire format is now supported for [`INTERVAL`](../v2.0/interval.html) values. [#28135][#28135] {% comment %}doc{% endcomment %}

<h3 id="v2.0.5-bug-fixes">Bug fixes</h3>

- [`IMPORT`](../v2.0/import.html) no longer silently converts `rn` characters in CSV files into `n`. [#28225][#28225]
- Fixed a bug that could cause the row following a deleted row to be skipped during [`BACKUP`](../v2.0/backup.html). [#28196][#28196]
- Limited the size of "batch groups" when committing a batch to RocksDB to avoid rare scenarios in which multi-gigabyte batch groups are created, which can cause a server to run out of memory when replaying the RocksDB log at startup. [#28009][#28009]
- Prevented unbounded growth of the Raft log caused by a loss of quorum. [#27868][#27868]
- CockroachDB now properly reports an error when a query attempts to use `ORDER BY` within a function argument list,
  which is an unsupported feature. [#25147][#25147]

<h3 id="v2.0.5-doc-updates">Doc updates</h3>

- Added a [Performance Tuning tutorial](../v2.0/performance-tuning.html) that demonstrates essential techniques for getting fast reads and writes in CockroachDB, starting with a single-region deployment and expanding into multiple regions. [#3378][#3378]
- Expanded the [Production Checklist](../v2.0/recommended-production-settings.html#networking) to cover a detailed explanation of network flags and scenarios and updated [production deployment tutorials](../v2.0/manual-deployment.html) to encourage the use of `--advertise-host` on node start. [#3352][#3352]
- Expanded the [Kubernetes tutorials](../v2.0/orchestrate-cockroachdb-with-kubernetes.html) to include setting up monitoring and alerting with Prometheus and Alertmanager. [#3370][#3370]
- Updated the [OpenSSL certificate tutorial](../v2.0/create-security-certificates-openssl.html) to allow multiple node certificates with the same subject. [#3423][#3423]

<h3 id="v2.0.5-contributors">Contributors</h3>

This release includes 9 merged PRs by 7 authors. We would like to thank the following contributor from the CockroachDB community:

- neeral

[#25147]: https://github.com/cockroachdb/cockroach/pull/25147
[#27868]: https://github.com/cockroachdb/cockroach/pull/27868
[#28009]: https://github.com/cockroachdb/cockroach/pull/28009
[#28135]: https://github.com/cockroachdb/cockroach/pull/28135
[#28196]: https://github.com/cockroachdb/cockroach/pull/28196
[#28225]: https://github.com/cockroachdb/cockroach/pull/28225
[#3378]: https://github.com/cockroachdb/docs/pull/3378
[#3352]: https://github.com/cockroachdb/docs/pull/3352
[#3370]: https://github.com/cockroachdb/docs/pull/3370
[#3385]: https://github.com/cockroachdb/docs/pull/3385
[#3423]: https://github.com/cockroachdb/docs/pull/3423
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.0.6-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.6.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.6.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.6.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0.6-security-bug-fix">Security bug fix</h3>

- Fixed a vulnerability in which TLS certificates were not validated correctly for internal RPC interfaces. This vulnerability could allow an unauthenticated user with network access to read and write to the cluster. [#30821](https://github.com/cockroachdb/cockroach/issues/30821)

<h3 id="v2.0.6-command-line-changes">Command-line changes</h3>

- The [`cockroach zone`](../v2.0/configure-replication-zones.html) command is now compatible with CockroachDB v2.1. However, note that `cockroach zone` is also *deprecated* in CockroachDB v2.1 in favor of `ALTER ... CONFIGURE ZONE` and `SHOW ZONE CONFIGURATION` statements to update and view replication zones. [#29632][#29632]

<h3 id="v2.0.6-bug-fixes">Bug fixes</h3>

- The [**Jobs** page](../v2.0/admin-ui-jobs-page.html) now sorts by **Creation Time** by default instead of by **User**. [#30429][#30429]
- Fixed out-of-memory errors caused by very large raft logs. [#28398][#28398] [#28526][#28526]
- Fixed a rare scenario where the value written for one system key was seen when another system key was read, leading to the violation of internal invariants. [#28798][#28798]
- Fixed a memory leak when contended queries time out. [#29100][#29100]
- Fixed a bug causing index creation to fail under rare circumstances. [#29203][#29203]
- Fixed a panic that occurred when not all values were present in a composite foreign key. [#30154][#30154]
- The `ON DELETE CASCADE` and `ON UPDATE CASCADE` [foreign key actions](../v2.0/foreign-key.html#foreign-key-actions-new-in-v2-0) no longer cascade through `NULL`s. [#30129][#30129]
- Fixed the occasional improper processing of the `WITH` operand with `IMPORT`/`BACKUP`/`RESTORE` and [common table expressions](../v2.0/common-table-expressions.html). [#30199][#30199]
- Transaction size limit errors are no longer returned for transactions that have already committed. [#30309][#30309]
- Fixed a potential infinite loop when the merge joiner encountered an error or cancellation. [#30380][#30380]
- This release includes the following fixes to the [`cockroach sql`](../v2.0/use-the-built-in-sql-client.html) command:
    - The command now properly prints a warning when a `?` character is mistakenly used to receive contextual help in a non-interactive session, instead of crashing. [#28325][#28325]
    - The command now works properly even when the `TERM` environment variable is not set. [#28614][#28614]
    - The commands are now properly able to customize the prompt with `~/.editrc` on Linux. [#28614][#28614]
    - The commands once again support copy-pasting special unicode character from other documents. [#28614][#28614]

<h3 id="v2.0.6-performance-improvements">Performance improvements</h3>

- Greatly improved the performance of catching up followers that are behind when Raft logs are large. [#28526][#28526]

<h3 id="v2.0.6-contributors">Contributors</h3>

This release includes 26 merged PRs by 12 authors.

[#28325]: https://github.com/cockroachdb/cockroach/pull/28325
[#28398]: https://github.com/cockroachdb/cockroach/pull/28398
[#28526]: https://github.com/cockroachdb/cockroach/pull/28526
[#28614]: https://github.com/cockroachdb/cockroach/pull/28614
[#28798]: https://github.com/cockroachdb/cockroach/pull/28798
[#29100]: https://github.com/cockroachdb/cockroach/pull/29100
[#29203]: https://github.com/cockroachdb/cockroach/pull/29203
[#29632]: https://github.com/cockroachdb/cockroach/pull/29632
[#30129]: https://github.com/cockroachdb/cockroach/pull/30129
[#30154]: https://github.com/cockroachdb/cockroach/pull/30154
[#30199]: https://github.com/cockroachdb/cockroach/pull/30199
[#30309]: https://github.com/cockroachdb/cockroach/pull/30309
[#30380]: https://github.com/cockroachdb/cockroach/pull/30380
[#30429]: https://github.com/cockroachdb/cockroach/pull/30429
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.0.7-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.7.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.7.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0.7.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.0.7-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.0.7
~~~

<h3 id="v2.0.7-bug-fixes">Bug fixes</h3>

- Fixed a security vulnerability in which data could be leaked from a cluster, or tampered with in a cluster, in secure mode. [#30823][#30823]
- Fixed a bug where queries could get stuck for seconds or minutes, usually following node restarts. [#31350][#31350]
- CockroachDB no longer crashes due to a `SIGTRAP` error soon after startup on macOS Mojave. [#31522][#31522]
- Fixed bug causing transactions to unnecessarily hit a "too large" error. [#31827][#31827]
- Fixed a bug causing transactions to appear partially committed. Occasionally, CockroachDB claimed to have failed to commit a transaction when some (or all) of its writes were actually persisted. [#32223][#32223]
- Fixed a bug where entry application on Raft followers could fall behind entry application on the leader, causing stalls during splits. [#32601][#32601]
- CockroachDB now properly rejects queries that use an invalid function (e.g., an aggregation) in the `SET` clause of an [`UPDATE`](../v2.0/update.html) statement. [#32507][#32507]

<h3 id="v2.0.7-build-changes">Build changes</h3>

- CockroachDB can now be built from source on macOS 10.14 (Mojave). [#31310][#31310]

<h3 id="v2.0.7-contributors">Contributors</h3>

This release includes 11 merged PRs by 6 authors.

[#30823]: https://github.com/cockroachdb/cockroach/pull/30823
[#31310]: https://github.com/cockroachdb/cockroach/pull/31310
[#31350]: https://github.com/cockroachdb/cockroach/pull/31350
[#31522]: https://github.com/cockroachdb/cockroach/pull/31522
[#31827]: https://github.com/cockroachdb/cockroach/pull/31827
[#32223]: https://github.com/cockroachdb/cockroach/pull/32223
[#32507]: https://github.com/cockroachdb/cockroach/pull/32507
[#32601]: https://github.com/cockroachdb/cockroach/pull/32601
[#32636]: https://github.com/cockroachdb/cockroach/pull/32636
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.0-alpha.20180416-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180416.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180416.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180416.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-alpha.20180416-general-changes">General Changes</h3>

- Prevent execution errors reporting a missing `libtinfo.so.5` on Linux systems. [#24513][#24513]
- A CockroachDB process will now flush its logs upon receiving `SIGHUP`.
- Added a [cluster setting](../v2.1/cluster-settings.html) for HLC to be monotonic across restarts [#23744][#23744] {% comment %}doc{% endcomment %}
- Added a [cluster setting](../v2.1/cluster-settings.html) for HLC to panic on clock jumps. [#23717][#23717] {% comment %}doc{% endcomment %}
- Statistics on the types of errors encountered are now included in [diagnostics reporting](../v2.1/diagnostics-reporting.html). [#22912][#22912] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180416-enterprise-edition-changes">Enterprise Edition Changes</h3>

- It is now possible to [`RESTORE`](../v2.1/restore.html) views when using the `into_db` option. [#24555][#24555] {% comment %}doc{% endcomment %}
- Relaxed the limitation on using [`BACKUP`](../v2.1/backup.html) in a mixed version cluster. [#24493][#24493]
- `BACKUP` and `RESTORE` are more resilient to non-URL-safe characters in query string authentication parameters. [#24300][#24300]
- The new `jobs.registry.leniency` [cluster setting](../v2.1/cluster-settings.html) can be used to allow long-running import jobs to survive temporary node saturation. [#23913][#23913] {% comment %}doc{% endcomment %}
- Added configurable limits on the number of `BACKUP`/`RESTORE` requests each store will process. [#23517][#23517] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180416-sql-language-changes">SQL Language Changes</h3>

- Added configurable limits on the number of [`IMPORT`](../v2.1/import.html) requests each store will process. [#23517][#23517] {% comment %}doc{% endcomment %}
- The new `ALTER TABLE ... INJECT STATS` command injects table statistics from a JSON object (which can be obtained via `SHOW HISTOGRAM USING JSON`). [#24488][#24488] {% comment %}doc{% endcomment %}
- The new `SHOW STATISTICS USING JSON` variant of `SHOW STATISTICS` outputs table statistics as a JSON object; it can be used to extract statistics from clusters to reproduce issues. [#24488][#24488] {% comment %}doc{% endcomment %}
- `VIRTUAL` and `WORK` are no longer reserved keywords and can again be used as unrestricted names. [#24491][#24491] {% comment %}doc{% endcomment %}
- Added the `CANCEL SESSION` statement as well as an `IF EXISTS` variant to `CANCEL QUERY`. [#23861][#23861] {% comment %}doc{% endcomment %}
- Added a new `session_id` column to the result of `SHOW SESSIONS`. [#23861][#23861] {% comment %}doc{% endcomment %}
- Added support for the `information_schema.pg_expandarray()` function. [#24422][#24422]
- `DROP DATABASE` and `ALTER DATABASE ... RENAME` now prevent the removal of a database name if that database is set as the current database (`SET database` / `USE`) and the session setting `sql_safe_updates` is also set. [#24246][#24246] {% comment %}doc{% endcomment %}
- Added support for naming array types via the `_type` form and quoted type names. [#24190][#24190]
- Added the `quote_ident()` built-in function for increased PostgreSQL compatibility. [#24190][#24190]
- The behavior of `UPSERT` and `INSERT ... ON CONFLICT` when a `RETURNING` clause is present is now more consistent when an update touches the same row twice or more. This is a CockroachDB-specific extension. [#23698][#23698]
- Added the `statement_timeout` session variable. [#23399][#23399] {% comment %}doc{% endcomment %}
- The type determined for constant `NULL` expressions has been renamed to "unknown" for better compatibility with PostgreSQL. [#23142][#23142]
- Attempts to modify virtual schemas with DDL statements now fail with a clearer error message. [#23044][#23044]
- CockroachDB now recognizes the special syntax `SET SCHEMA <name>` as an alias for `SET search_path = <name>` for better compatibility with PostgreSQL. [#22997][#22997] {% comment %}doc{% endcomment %}
- Added support for `pg_sleep()` function. [#22804][#22804]
- Division by zero now returns the correct error code. [#22912][#22912]
- The GC of table data after a `DROP TABLE` now respects changes to the GC TTL interval specified in the relevant [replication zone](../v2.1/configure-replication-zones.html). [#22774][#22774]
- The full names of tables/views/sequences are now properly logged in the system event log. [#22842][#22842]
- `current_role` is now recognized as an alias for `current_user` for better compatibility with PostgreSQL. [#22828][#22828]
- The special identifier `current_catalog` is now supported as an alias for `current_database()` for better compatibility with PostgreSQL. [#22828][#22828]
- Added the `skip` option to the `IMPORT` command. [#23466][#23466] {% comment %}doc{% endcomment %}
- The service latency tracked for SQL statements now includes the wait time of the execute message in the input queue. [#22880][#22880]

<h3 id="v2.1.0-alpha.20180416-command-line-changes">Command-Line Changes</h3>

- The `cockroach gen autocomplete` command can now generate zsh-compatible completion files by passing `zsh` as an argument. [#24400][#24400] {% comment %}doc{% endcomment %}
- Removed the `cockroach load csv` subcommand. [#24319][#24319]
- When `cockroach gen haproxy` is run, if an `haproxy.cfg` file already exists in the current directory, it now gets fully overwritten instead of potentially resulting in an unusable config. [#24332][#24332] {% comment %}doc{% endcomment %}
- The new `cockroach demo` command opens a SQL shell connected to a fully in-memory store, and an empty database named `demo`. It's useful for users or developers who wish to test out Cockroach's SQL dialect. [#24259][#24259] {% comment %}doc{% endcomment %}
- Replication zones now allow for specifying an ordered list of lease placement preferences. Whenever possible, CockroachDB will attempt to put the lease for a range on a store that satisfies the first set of constraints. If that's not possible, it'll attempt to put the lease on a store that satisfies the second set of constraints, and so on. If none of the preferences can be  met, the lease will be placed as it is today. [#23202][#23202]
- Bracketed pastes are requested from the terminal emulator when possible. Pasting text into the interactive SQL shell is more reliable as a result. [#23116][#23116]
- The `cockroach sql` command now reminds you about `SET database = ...` and `CREATE DATABASE` if started with no current database. [#23077][#23077]
- Per-replica constraints in replication zones no longer have to add up to the total number of replicas in a range. If all replicas aren't specified, then the remaining replicas will be allowed on any store. [#23057][#23057] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180416-admin-ui-changes">Admin UI Changes</h3>

- Removed explicit back links on **Events** and **Nodes** pages. [#23904][#23904]
- Added a new debug page to display all [cluster settings](../v2.1/cluster-settings.html). [#24064][#24064]
- While the **Logs** page loads, a spinner is now shown instead of a "no data" message. [#23496][#23496]
- The **Logs** page now uses a monospaced font, properly renders newlines, and packs lines together more tightly. [#23496][#23496]
- The **Node Map** now shows how long a node has been dead. [#23255][#23255] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180416-bug-fixes">Bug Fixes</h3>

- Fixed a bug when using fractional units (e.g., `0.5GiB`) for the `--cache` and `--sql-max-memory` flags of `cockroach start`. [#24381][#24381]
- Fixed the handling of role membership lookups within transactions. [#24284][#24284]
- Fixed a panic around inverted index queries using the `->` operator. [#24576][#24576]
- `JSONB` values can now be cast to `STRING` values. [#24518][#24518]
- Fixed a panic caused by a `WHERE` condition that requires a column to equal a specific value and at the same time equal another column. [#24506][#24506]
- Fixed panics resulting from distributed execution of queries with OID types. [#24431][#24431]
- Fixed a bug where an expected transaction heartbeat failure aborted the transaction. [#24134][#24134]
- Fixed a bug causing index backfills to fail in a loop after exceeding the GC TTL of their source table. [#24293][#24293]
- Inverted index queries involving `NULL` are now properly handled. [#24251][#24251]
- Fixed a bug involving Npgsql and array values. [#24227][#24227]
- Fixed a panic caused by passing a `Name` type to `has_database_privilege()`. [#24252][#24252]
- On-disk checksums are now correctly generated during `IMPORT`. If there is existing data created by `IMPORT` that cannot be recreated, use `cockroach dump` to rewrite any affected tables. [#24128][#24128]
- Attempts to `RESTORE` to a time later than that covered by the latest `BACKUP` are now rejected. [#23727][#23727]
- Fixed a bug that could prevent disk space from being reclaimed. [#23136][#23136]
- Replication zone configs no longer accept negative numbers as input. [#22870][#22870]
- Fixed the occasional selection of sub-optimal rebalance targets. [#23036][#23036]
- The `cockroach dump` command is now able to dump sequences with non-default parameters. [#23051][#23051] {% comment %}doc{% endcomment %}
- `SHOW TABLES` is once again able to inspect virtual schemas. [#22994][#22994] {% comment %}doc{% endcomment %}
- The `CREATE TABLE .. AS` statement now properly supports placeholders in the subquery. [#23006][#23006]
- Fixed a bug where ranges could get stuck in an infinite "removal pending" state and would refuse to accept new writes. [#22916][#22916]
- Arrays now support `IS [NOT] DISTINCT FROM` operators. [#23005][#23005]
- Fixed incorrect index constraints on primary key columns on unique indexes. [#22977][#22977]
- Fixed a bug that prevented joins on interleaved tables with certain layouts from working. [#22920][#22920]
- The conversion from `INTERVAL` to `FLOAT` now properly returns the number of seconds in the interval. [#22892][#22892]
- Fix a panic cause sometimes by Flush protocol messages. [#24119][#24119]

<h3 id="v2.1.0-alpha.20180416-performance-improvements">Performance Improvements</h3>

- Deleting many rows at once now consumes less memory. [#22991][#22991]
- Fewer disk writes are required for each database write, increasing write throughput and reducing
  write latency. [#22317][#22317]
- Reduced the amount of memory used during garbage collection of old versions. [#24209][#24209]
- Greatly improved the performance of the `DISTINCT` operator when its inputs are known to be sorted. [#24438][#24438] [#24148][#24148]
- Write requests that result in no-ops are no longer proposed through Raft. [#24345][#24345]

<h3 id="v2.1.0-alpha.20180416-build-changes">Build Changes</h3>

- Release binaries are now built with enough debug information to produce useful CPU profiles and backtraces. [#24296][#24296]

<h3 id="v2.1.0-alpha.20180416-contributors">Contributors</h3>

This release includes 732 merged PRs by 38 authors. We would like to thank the following contributors from the CockroachDB community:

- Mahmoud Al-Qudsi
- Vijay Karthik (first-time contributor)

[#21095]: https://github.com/cockroachdb/cockroach/pull/21095
[#22317]: https://github.com/cockroachdb/cockroach/pull/22317
[#22766]: https://github.com/cockroachdb/cockroach/pull/22766
[#22767]: https://github.com/cockroachdb/cockroach/pull/22767
[#22774]: https://github.com/cockroachdb/cockroach/pull/22774
[#22804]: https://github.com/cockroachdb/cockroach/pull/22804
[#22819]: https://github.com/cockroachdb/cockroach/pull/22819
[#22828]: https://github.com/cockroachdb/cockroach/pull/22828
[#22842]: https://github.com/cockroachdb/cockroach/pull/22842
[#22849]: https://github.com/cockroachdb/cockroach/pull/22849
[#22870]: https://github.com/cockroachdb/cockroach/pull/22870
[#22880]: https://github.com/cockroachdb/cockroach/pull/22880
[#22886]: https://github.com/cockroachdb/cockroach/pull/22886
[#22892]: https://github.com/cockroachdb/cockroach/pull/22892
[#22911]: https://github.com/cockroachdb/cockroach/pull/22911
[#22912]: https://github.com/cockroachdb/cockroach/pull/22912
[#22916]: https://github.com/cockroachdb/cockroach/pull/22916
[#22919]: https://github.com/cockroachdb/cockroach/pull/22919
[#22920]: https://github.com/cockroachdb/cockroach/pull/22920
[#22953]: https://github.com/cockroachdb/cockroach/pull/22953
[#22962]: https://github.com/cockroachdb/cockroach/pull/22962
[#22968]: https://github.com/cockroachdb/cockroach/pull/22968
[#22977]: https://github.com/cockroachdb/cockroach/pull/22977
[#22979]: https://github.com/cockroachdb/cockroach/pull/22979
[#22982]: https://github.com/cockroachdb/cockroach/pull/22982
[#22991]: https://github.com/cockroachdb/cockroach/pull/22991
[#22994]: https://github.com/cockroachdb/cockroach/pull/22994
[#22997]: https://github.com/cockroachdb/cockroach/pull/22997
[#22998]: https://github.com/cockroachdb/cockroach/pull/22998
[#23005]: https://github.com/cockroachdb/cockroach/pull/23005
[#23006]: https://github.com/cockroachdb/cockroach/pull/23006
[#23017]: https://github.com/cockroachdb/cockroach/pull/23017
[#23036]: https://github.com/cockroachdb/cockroach/pull/23036
[#23044]: https://github.com/cockroachdb/cockroach/pull/23044
[#23045]: https://github.com/cockroachdb/cockroach/pull/23045
[#23051]: https://github.com/cockroachdb/cockroach/pull/23051
[#23057]: https://github.com/cockroachdb/cockroach/pull/23057
[#23070]: https://github.com/cockroachdb/cockroach/pull/23070
[#23077]: https://github.com/cockroachdb/cockroach/pull/23077
[#23082]: https://github.com/cockroachdb/cockroach/pull/23082
[#23104]: https://github.com/cockroachdb/cockroach/pull/23104
[#23114]: https://github.com/cockroachdb/cockroach/pull/23114
[#23116]: https://github.com/cockroachdb/cockroach/pull/23116
[#23126]: https://github.com/cockroachdb/cockroach/pull/23126
[#23136]: https://github.com/cockroachdb/cockroach/pull/23136
[#23142]: https://github.com/cockroachdb/cockroach/pull/23142
[#23162]: https://github.com/cockroachdb/cockroach/pull/23162
[#23169]: https://github.com/cockroachdb/cockroach/pull/23169
[#23175]: https://github.com/cockroachdb/cockroach/pull/23175
[#23178]: https://github.com/cockroachdb/cockroach/pull/23178
[#23183]: https://github.com/cockroachdb/cockroach/pull/23183
[#23197]: https://github.com/cockroachdb/cockroach/pull/23197
[#23202]: https://github.com/cockroachdb/cockroach/pull/23202
[#23204]: https://github.com/cockroachdb/cockroach/pull/23204
[#23211]: https://github.com/cockroachdb/cockroach/pull/23211
[#23221]: https://github.com/cockroachdb/cockroach/pull/23221
[#23230]: https://github.com/cockroachdb/cockroach/pull/23230
[#23233]: https://github.com/cockroachdb/cockroach/pull/23233
[#23235]: https://github.com/cockroachdb/cockroach/pull/23235
[#23252]: https://github.com/cockroachdb/cockroach/pull/23252
[#23255]: https://github.com/cockroachdb/cockroach/pull/23255
[#23258]: https://github.com/cockroachdb/cockroach/pull/23258
[#23260]: https://github.com/cockroachdb/cockroach/pull/23260
[#23261]: https://github.com/cockroachdb/cockroach/pull/23261
[#23265]: https://github.com/cockroachdb/cockroach/pull/23265
[#23282]: https://github.com/cockroachdb/cockroach/pull/23282
[#23292]: https://github.com/cockroachdb/cockroach/pull/23292
[#23298]: https://github.com/cockroachdb/cockroach/pull/23298
[#23301]: https://github.com/cockroachdb/cockroach/pull/23301
[#23334]: https://github.com/cockroachdb/cockroach/pull/23334
[#23363]: https://github.com/cockroachdb/cockroach/pull/23363
[#23370]: https://github.com/cockroachdb/cockroach/pull/23370
[#23399]: https://github.com/cockroachdb/cockroach/pull/23399
[#23409]: https://github.com/cockroachdb/cockroach/pull/23409
[#23412]: https://github.com/cockroachdb/cockroach/pull/23412
[#23418]: https://github.com/cockroachdb/cockroach/pull/23418
[#23441]: https://github.com/cockroachdb/cockroach/pull/23441
[#23463]: https://github.com/cockroachdb/cockroach/pull/23463
[#23465]: https://github.com/cockroachdb/cockroach/pull/23465
[#23466]: https://github.com/cockroachdb/cockroach/pull/23466
[#23479]: https://github.com/cockroachdb/cockroach/pull/23479
[#23496]: https://github.com/cockroachdb/cockroach/pull/23496
[#23512]: https://github.com/cockroachdb/cockroach/pull/23512
[#23516]: https://github.com/cockroachdb/cockroach/pull/23516
[#23517]: https://github.com/cockroachdb/cockroach/pull/23517
[#23521]: https://github.com/cockroachdb/cockroach/pull/23521
[#23530]: https://github.com/cockroachdb/cockroach/pull/23530
[#23533]: https://github.com/cockroachdb/cockroach/pull/23533
[#23541]: https://github.com/cockroachdb/cockroach/pull/23541
[#23546]: https://github.com/cockroachdb/cockroach/pull/23546
[#23550]: https://github.com/cockroachdb/cockroach/pull/23550
[#23560]: https://github.com/cockroachdb/cockroach/pull/23560
[#23572]: https://github.com/cockroachdb/cockroach/pull/23572
[#23573]: https://github.com/cockroachdb/cockroach/pull/23573
[#23617]: https://github.com/cockroachdb/cockroach/pull/23617
[#23618]: https://github.com/cockroachdb/cockroach/pull/23618
[#23637]: https://github.com/cockroachdb/cockroach/pull/23637
[#23657]: https://github.com/cockroachdb/cockroach/pull/23657
[#23678]: https://github.com/cockroachdb/cockroach/pull/23678
[#23687]: https://github.com/cockroachdb/cockroach/pull/23687
[#23698]: https://github.com/cockroachdb/cockroach/pull/23698
[#23717]: https://github.com/cockroachdb/cockroach/pull/23717
[#23720]: https://github.com/cockroachdb/cockroach/pull/23720
[#23725]: https://github.com/cockroachdb/cockroach/pull/23725
[#23727]: https://github.com/cockroachdb/cockroach/pull/23727
[#23729]: https://github.com/cockroachdb/cockroach/pull/23729
[#23744]: https://github.com/cockroachdb/cockroach/pull/23744
[#23753]: https://github.com/cockroachdb/cockroach/pull/23753
[#23760]: https://github.com/cockroachdb/cockroach/pull/23760
[#23768]: https://github.com/cockroachdb/cockroach/pull/23768
[#23787]: https://github.com/cockroachdb/cockroach/pull/23787
[#23797]: https://github.com/cockroachdb/cockroach/pull/23797
[#23803]: https://github.com/cockroachdb/cockroach/pull/23803
[#23804]: https://github.com/cockroachdb/cockroach/pull/23804
[#23810]: https://github.com/cockroachdb/cockroach/pull/23810
[#23813]: https://github.com/cockroachdb/cockroach/pull/23813
[#23814]: https://github.com/cockroachdb/cockroach/pull/23814
[#23824]: https://github.com/cockroachdb/cockroach/pull/23824
[#23825]: https://github.com/cockroachdb/cockroach/pull/23825
[#23834]: https://github.com/cockroachdb/cockroach/pull/23834
[#23841]: https://github.com/cockroachdb/cockroach/pull/23841
[#23843]: https://github.com/cockroachdb/cockroach/pull/23843
[#23844]: https://github.com/cockroachdb/cockroach/pull/23844
[#23851]: https://github.com/cockroachdb/cockroach/pull/23851
[#23852]: https://github.com/cockroachdb/cockroach/pull/23852
[#23861]: https://github.com/cockroachdb/cockroach/pull/23861
[#23869]: https://github.com/cockroachdb/cockroach/pull/23869
[#23876]: https://github.com/cockroachdb/cockroach/pull/23876
[#23904]: https://github.com/cockroachdb/cockroach/pull/23904
[#23913]: https://github.com/cockroachdb/cockroach/pull/23913
[#23926]: https://github.com/cockroachdb/cockroach/pull/23926
[#23930]: https://github.com/cockroachdb/cockroach/pull/23930
[#23934]: https://github.com/cockroachdb/cockroach/pull/23934
[#23973]: https://github.com/cockroachdb/cockroach/pull/23973
[#23995]: https://github.com/cockroachdb/cockroach/pull/23995
[#24017]: https://github.com/cockroachdb/cockroach/pull/24017
[#24031]: https://github.com/cockroachdb/cockroach/pull/24031
[#24039]: https://github.com/cockroachdb/cockroach/pull/24039
[#24044]: https://github.com/cockroachdb/cockroach/pull/24044
[#24049]: https://github.com/cockroachdb/cockroach/pull/24049
[#24064]: https://github.com/cockroachdb/cockroach/pull/24064
[#24074]: https://github.com/cockroachdb/cockroach/pull/24074
[#24083]: https://github.com/cockroachdb/cockroach/pull/24083
[#24100]: https://github.com/cockroachdb/cockroach/pull/24100
[#24119]: https://github.com/cockroachdb/cockroach/pull/24119
[#24128]: https://github.com/cockroachdb/cockroach/pull/24128
[#24134]: https://github.com/cockroachdb/cockroach/pull/24134
[#24148]: https://github.com/cockroachdb/cockroach/pull/24148
[#24161]: https://github.com/cockroachdb/cockroach/pull/24161
[#24164]: https://github.com/cockroachdb/cockroach/pull/24164
[#24178]: https://github.com/cockroachdb/cockroach/pull/24178
[#24190]: https://github.com/cockroachdb/cockroach/pull/24190
[#24192]: https://github.com/cockroachdb/cockroach/pull/24192
[#24196]: https://github.com/cockroachdb/cockroach/pull/24196
[#24209]: https://github.com/cockroachdb/cockroach/pull/24209
[#24227]: https://github.com/cockroachdb/cockroach/pull/24227
[#24239]: https://github.com/cockroachdb/cockroach/pull/24239
[#24241]: https://github.com/cockroachdb/cockroach/pull/24241
[#24246]: https://github.com/cockroachdb/cockroach/pull/24246
[#24251]: https://github.com/cockroachdb/cockroach/pull/24251
[#24252]: https://github.com/cockroachdb/cockroach/pull/24252
[#24253]: https://github.com/cockroachdb/cockroach/pull/24253
[#24259]: https://github.com/cockroachdb/cockroach/pull/24259
[#24284]: https://github.com/cockroachdb/cockroach/pull/24284
[#24293]: https://github.com/cockroachdb/cockroach/pull/24293
[#24296]: https://github.com/cockroachdb/cockroach/pull/24296
[#24300]: https://github.com/cockroachdb/cockroach/pull/24300
[#24319]: https://github.com/cockroachdb/cockroach/pull/24319
[#24332]: https://github.com/cockroachdb/cockroach/pull/24332
[#24345]: https://github.com/cockroachdb/cockroach/pull/24345
[#24354]: https://github.com/cockroachdb/cockroach/pull/24354
[#24373]: https://github.com/cockroachdb/cockroach/pull/24373
[#24381]: https://github.com/cockroachdb/cockroach/pull/24381
[#24390]: https://github.com/cockroachdb/cockroach/pull/24390
[#24400]: https://github.com/cockroachdb/cockroach/pull/24400
[#24422]: https://github.com/cockroachdb/cockroach/pull/24422
[#24431]: https://github.com/cockroachdb/cockroach/pull/24431
[#24438]: https://github.com/cockroachdb/cockroach/pull/24438
[#24488]: https://github.com/cockroachdb/cockroach/pull/24488
[#24491]: https://github.com/cockroachdb/cockroach/pull/24491
[#24493]: https://github.com/cockroachdb/cockroach/pull/24493
[#24506]: https://github.com/cockroachdb/cockroach/pull/24506
[#24510]: https://github.com/cockroachdb/cockroach/pull/24510
[#24513]: https://github.com/cockroachdb/cockroach/pull/24513
[#24518]: https://github.com/cockroachdb/cockroach/pull/24518
[#24555]: https://github.com/cockroachdb/cockroach/pull/24555
[#24576]: https://github.com/cockroachdb/cockroach/pull/24576
[#24594]: https://github.com/cockroachdb/cockroach/pull/24594
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This release includes usability enhancements, PostgreSQL compatibility improvements, and general bug fixes.

{{site.data.alerts.callout_success}}The <a href="../v2.1/export.html"><code>EXPORT CSV</code></a> feature in this release allows you to quickly get data out of CockroachDB and into a format that can be ingested by downstream systems. Unlike the existing ability to export data via a <code>SELECT</code> that outputs to a CSV file, <code>EXPORT</code> uses all nodes in the cluster to parallelize CSV creation for significantly faster processing. Note that this is a prototype feature, so we’d love for you to try it out and create issues if you’d like any enhancements or find any bugs.{{site.data.alerts.end}}

<h3 id="v2.1.0-alpha.20180507-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180507.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180507.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180507.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-alpha.20180507-general-changes">General Changes</h3>

- Added a `/_status/diagnostics/{node_id}` debug endpoint, which returns an [anonymized diagnostics report](../v2.1/diagnostics-reporting.html). [#24813][#24813] [#24997][#24997]{% comment %}doc{% endcomment %}
- The header of new log files generated by [`cockroach start`](../v2.1/start-a-node.html) now includes the cluster ID once it has been determined. [#24926][#24926]
- The cluster ID is now reported with tag `[config]` in the first log file, not only when log files are rotated. [#24993][#24993]
- Stopped spamming the server logs with "error closing gzip response writer" messages. [#25106][#25106]
- Enforced stricter validation of [security certificates](../v2.1/create-security-certificates.html). [#24687][#24687]

<h3 id="v2.1.0-alpha.20180507-enterprise-edition-changes">Enterprise Edition Changes</h3>

- Added alpha support for [`EXPORT CSV`](../v2.1/export.html). [#25075][#25075]

<h3 id="v2.1.0-alpha.20180507-sql-language-changes">SQL Language Changes</h3>

- `ROLE` and `STORED` are no longer reserved keywords and can again be used as unrestricted names for databases, tables and columns. [#24629][#24629] [#24554][#24554] {% comment %}doc{% endcomment %}
- The experimental SQL features `SHOW TESTING_RANGES` and `ALTER ... TESTING_RELOCATE` have been renamed `SHOW EXPERIMENTAL_RANGES` and `ALTER ... EXPERIMENTAL_RELOCATE`. [#24696][#24696] {% comment %}doc{% endcomment %}
- The `current_schema()` and `current_schemas()` built-in functions now only consider valid schemas, like PostgreSQL does. [#24718][#24718]
- Clarified the error message produced upon accessing a virtual schema with no database prefix (e.g., when `database` is not set). [#24772][#24772]
- Improved the error message returned on object creation when no current database is set or only invalid schemas are in the `search_path`. [#24770][#24770]
- Added more ways to specify an index name for statements that require one (e.g., [`DROP INDEX`](../v2.1/drop-index.html), [`ALTER INDEX ... RENAME`](../v2.1/rename-index.html), etc.), improving PostgreSQL compatibility. [#24778][#24778] {% comment %}doc{% endcomment %}
- Errors detected by `SHOW SYNTAX` are now tracked internally like other SQL errors. [#24819][#24819]
- Added support for `lpad()` and `rpad()` string functions. [#24891][#24891] {% comment %}doc{% endcomment %}
- [Computed columns](../v2.1/computed-columns.html) can now be added with [`ALTER TABLE ... ADD COLUMN`](../v2.1/add-column.html). [#24464][#24464] {% comment %}doc{% endcomment %}
- Added the `TIMETZ` column type and datum. [#24343][#24343]
- The [`EXPLAIN`](../v2.1/explain.html) output for [`UPDATE`](../v2.1/update.html) statements now also report [`CHECK`](../v2.1/check.html) expressions, for consistency with `INSERT`. [#23373][#23373] {% comment %}doc{% endcomment %}
- Reduced the amount of RAM used when a query performs further computations on the result of a mutation statement (`INSERT`/`DELETE`/`UPSERT`/`UPSERT`) combined with `RETURNING`. [#23373][#23373]
- Added the 'base64' option to the `encode()` and `decode()` built-in functions. [#25002][#25002] {% comment %}doc{% endcomment %}
- [`IMPORT`](../v2.1/import.html) now supports hex-encoded byte literals for [`BYTES`](../v2.1/bytes.html) columns. [#24859][#24859]
- Set Returning Functions (SRF) can now be accessed using `(SRF).x`, where `x` is the name of a column returned from the SRF or a `*`. For example, `SELECT (information_schema._pg_expandarray(ARRAY['c', 'b', 'a'])).x` and `SELECT (information_schema._pg_expandarray(ARRAY['c', 'b', 'a'])).*` are now both valid. Also, the naming of the resulting columns from SRFs now provide more information about the resulting tuple. [#24832][#24832] {% comment %}doc{% endcomment %}
- Removed the `METADATA`, `QUALIFY`, and `EXPRS` options for [`EXPLAIN`](../v2.1/explain.html). [#25101][#25101] {% comment %}doc{% endcomment %}
- CockroachDB now properly reports an error when a query attempts to use `ORDER BY` within a function argument list, which is an unsupported feature. [#25146][#25146]
- `AS OF SYSTEM TIME` queries now accept a negative interval to produce a relative time from the statement's `statement_timestamp()` time. [#24768][#24768]

<h3 id="v2.1.0-alpha.20180507-command-line-changes">Command-Line Changes</h3>

- The `cockroach demo` command now shows the Admin UI URL on startup. [#24738][#24738]
- [`cockroach dump`](../v2.1/sql-dump.html) now supports self and cyclic foreign key references. [#24716][#24716] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180507-admin-ui-changes">Admin UI Changes</h3>

- Updated the window title for each page to make browser history more useful. [#24634][#24634]
- Changed the label "bytes" to "used capacity" in the **Nodes** table. [#24843][#24843]
- The names of dropped schema objects on `DROP DATABASE ... CASCADE` are now displayed. [#24852][#24852]
- The **Cluster Overview** now adjusts to take the advantage of the size of the screen. [#24849][#24849]
- Fixed a bug where the **Node List** could get cut off. [#24849][#24849]
- Improve responsiveness of the Prometheus metrics endpoint on very overloaded nodes. [#25083][#25083]
- Time series charts now display data points at more consistent timestamps. [#24856][#24856]

<h3 id="v2.1.0-alpha.20180507-bug-fixes">Bug Fixes</h3>

- Converted a panic related to an unsupported type to an error. [#24688][#24688]
- [`ALTER INDEX ... RENAME`](../v2.1/rename-index.html) can now be used on the primary index. [#24776][#24776] {% comment %}doc{% endcomment %}
- Fixed a scenario in which a node could deadlock while starting up. [#24808][#24808]
- It is once again possible to use a simply qualified table name in qualified stars (e.g., `SELECT mydb.kv.* FROM kv`) for compatibility with CockroachDB v1.x. [#24811][#24811] {% comment %}doc{% endcomment %}
- Ranges in [partitioned tables](../v2.1/partitioning.html) now properly split to respect their configured maximum size. [#24896][#24896]
- Fixed a bug where `SELECT * FROM [DELETE FROM ... RETURNING ...] LIMIT 1` or `WITH d AS (DELETE FROM ... RETURNING ...) SELECT * FROM d LIMIT 1` would fail to properly delete some rows. The is fixed for `SELECT * FROM [INSERT ... RETURNING ...] LIMIT 1` or `WITH d AS (INSERT ... RETURNING ...) SELECT * FROM d LIMIT 1` as well. [#23373][#23373]
- Removed a limitation where `UPDATE`, `INSERT`, or `UPSERT` would fail if the number of modified rows was too large. [#23373][#23373] {% comment %}doc{% endcomment %}
- [`UPSERT`](../v2.1/upsert.html) now properly reports the count of modified rows when `RETURNING` is not specified. [#23373][#23373]
- When [adding a column](../v2.1/add-column.html), CockroachDB now verifies that the column is reference by no more than one foreign key. Existing tables with a column that is used by multiple foreign key constraints should be manually changed to have at most one foreign key per column. [#25060][#25060] {% comment %}doc{% endcomment %}
- Corrected the documentation for the `age()` [built-in function](../v2.1/functions-and-operators.html). [#25132][#25132] {% comment %}doc{% endcomment %}
- Fixed a bug cuasing `PREPARE` to hang when run in the same transaction as a `CREATE TABLE` statement. [#23816][#23816]

<h3 id="v2.1.0-alpha.20180507-performance-improvements">Performance Improvements</h3>

- Improved the performance of hash joins. [#24577][#24577]
- Aggregations are now streamed based on the ordering on the `GROUP BY` columns. [#24113][#24113]
- Some `SELECT`s with limits no longer require a second low-level scan, resulting in much faster execution. [#24790][#24790]

<h3 id="v2.1.0-alpha.20180507-build-changes">Build Changes</h3>

- Build metadata, like the commit SHA and build time, is now properly injected into the binary when using Go 1.10 and building from a symlink. [#25008][#25008]

<h3 id="v2.1.0-alpha.20180507-doc-updates">Doc Updates</h3>

- Added a [performance tuning guide](../v2.1/kubernetes-performance.html) for running CockroachDB in Kubernetes. [#2896][#2896]
- Clarified [replication zone levels](../v2.1/configure-replication-zones.html#replication-zone-levels) and added a warning about increasing the default replication factor without increasing the replication factor of system ranges. [#2901][#2901]
- Updated the [`cockroach start`](../v2.1/start-a-node.html) documentation to recommend decimal notation for flags that accept percentages. [#3056][#3056]
- Documented how to use the [`server.shutdown.drain_wait`](../v2.1/operational-faqs.html#how-do-i-prepare-for-planned-node-maintenance) cluster setting to prevent a load balancer from sending client traffic to a node about to be shut down. [#2903][#2903]
- Documented the [`intervalstyle`](../v2.1/set-vars.html) session variable. [#2904][#2904]
- Added documentation on the [`SHOW EXPERIMENTAL_RANGES`](../v2.1/show-experimental-ranges.html) statement. [#2930][#2930]
- Update the [Node Map](../v2.1/enable-node-map.html#location-coordinates-for-reference) documentation to provide location coordinates for AWS, Azure, and Google Cloud. [#2942][#2942]
- Updated the `SPLIT AT` documentation to show how to [split a table with a composite primary key](../v2.1/split-at.html#split-a-table-with-a-composite-primary-key). [#2950][#2950]
- Documented the `--temp-dir` flag for [`cockroach start`](../v2.1/start-a-node.html). [#2955][#2955]
- Expanded the [Production Checklist](../v2.1/recommended-production-settings.html) to recommend a higher replication factor when using local disks rather than a cloud providers' network-attached disks that are often replicated underneath the covers. [#3001][#3001]

<h3 id="v2.1.0-alpha.20180507-contributors">Contributors</h3>

This release includes 224 merged PRs by 37 authors. We would like to thank the following contributors from the CockroachDB community, with special thanks to first-time contributors Bob Potter, Karan Vaidya, dchenk, and phelanm.

- Bob Potter
- Brett Snyder
- Jingguo Yao
- Karan Vaidya
- Vijay Karthik
- dchenk
- phelanm

[#2896]: https://github.com/cockroachdb/docs/pull/2896
[#2901]: https://github.com/cockroachdb/docs/pull/2901
[#2903]: https://github.com/cockroachdb/docs/pull/2903
[#2904]: https://github.com/cockroachdb/docs/pull/2904
[#2930]: https://github.com/cockroachdb/docs/pull/2930
[#2942]: https://github.com/cockroachdb/docs/pull/2942
[#2950]: https://github.com/cockroachdb/docs/pull/2950
[#2955]: https://github.com/cockroachdb/docs/pull/2955
[#3001]: https://github.com/cockroachdb/docs/pull/3001
[#3056]: https://github.com/cockroachdb/docs/pull/3056
[#19693]: https://github.com/cockroachdb/cockroach/pull/19693
[#23373]: https://github.com/cockroachdb/cockroach/pull/23373
[#23816]: https://github.com/cockroachdb/cockroach/pull/23816
[#24113]: https://github.com/cockroachdb/cockroach/pull/24113
[#24343]: https://github.com/cockroachdb/cockroach/pull/24343
[#24464]: https://github.com/cockroachdb/cockroach/pull/24464
[#24554]: https://github.com/cockroachdb/cockroach/pull/24554
[#24577]: https://github.com/cockroachdb/cockroach/pull/24577
[#24629]: https://github.com/cockroachdb/cockroach/pull/24629
[#24634]: https://github.com/cockroachdb/cockroach/pull/24634
[#24687]: https://github.com/cockroachdb/cockroach/pull/24687
[#24688]: https://github.com/cockroachdb/cockroach/pull/24688
[#24696]: https://github.com/cockroachdb/cockroach/pull/24696
[#24716]: https://github.com/cockroachdb/cockroach/pull/24716
[#24718]: https://github.com/cockroachdb/cockroach/pull/24718
[#24738]: https://github.com/cockroachdb/cockroach/pull/24738
[#24768]: https://github.com/cockroachdb/cockroach/pull/24768
[#24770]: https://github.com/cockroachdb/cockroach/pull/24770
[#24772]: https://github.com/cockroachdb/cockroach/pull/24772
[#24776]: https://github.com/cockroachdb/cockroach/pull/24776
[#24778]: https://github.com/cockroachdb/cockroach/pull/24778
[#24790]: https://github.com/cockroachdb/cockroach/pull/24790
[#24799]: https://github.com/cockroachdb/cockroach/pull/24799
[#24808]: https://github.com/cockroachdb/cockroach/pull/24808
[#24811]: https://github.com/cockroachdb/cockroach/pull/24811
[#24813]: https://github.com/cockroachdb/cockroach/pull/24813
[#24819]: https://github.com/cockroachdb/cockroach/pull/24819
[#24832]: https://github.com/cockroachdb/cockroach/pull/24832
[#24843]: https://github.com/cockroachdb/cockroach/pull/24843
[#24849]: https://github.com/cockroachdb/cockroach/pull/24849
[#24852]: https://github.com/cockroachdb/cockroach/pull/24852
[#24856]: https://github.com/cockroachdb/cockroach/pull/24856
[#24859]: https://github.com/cockroachdb/cockroach/pull/24859
[#24891]: https://github.com/cockroachdb/cockroach/pull/24891
[#24896]: https://github.com/cockroachdb/cockroach/pull/24896
[#24926]: https://github.com/cockroachdb/cockroach/pull/24926
[#24993]: https://github.com/cockroachdb/cockroach/pull/24993
[#24997]: https://github.com/cockroachdb/cockroach/pull/24997
[#25002]: https://github.com/cockroachdb/cockroach/pull/25002
[#25008]: https://github.com/cockroachdb/cockroach/pull/25008
[#25057]: https://github.com/cockroachdb/cockroach/pull/25057
[#25060]: https://github.com/cockroachdb/cockroach/pull/25060
[#25075]: https://github.com/cockroachdb/cockroach/pull/25075
[#25082]: https://github.com/cockroachdb/cockroach/pull/25082
[#25083]: https://github.com/cockroachdb/cockroach/pull/25083
[#25101]: https://github.com/cockroachdb/cockroach/pull/25101
[#25106]: https://github.com/cockroachdb/cockroach/pull/25106
[#25132]: https://github.com/cockroachdb/cockroach/pull/25132
[#25146]: https://github.com/cockroachdb/cockroach/pull/25146
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This release includes general usability enhancements and bug fixes as well as:

- [**Easier data migrations from MySQL**](../v2.1/import-data.html): The `IMPORT` feature now supports a subset of MySQL export formats. We will continue to make migrations easier in the alphas leading up to 2.1.

Please give this feature and the ones below a try. If you see something that can be improved, we’d love to hear from you on [GitHub](https://github.com/cockroachdb/cockroach/issues) or the [Forum](https://forum.cockroachlabs.com/).

<h3 id="v2.1.0-alpha.20180604-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180604.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180604.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180604.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-alpha.20180604-general-changes">General Changes</h3>

- New clusters and existing clusters [upgraded](../v2.1/upgrade-cockroach-version.html) to this version of CockroachDB will include two new empty databases, `defaultdb` and `postgres`. The `defaultdb` database is automatically used for clients that connect without a current database set (e.g., without a database component in the connection URL). The `postgres` database is provided for compatibility with PostgreSQL client frameworks that require it to exist when the database server has been freshly installed. Both new databases behave like any other regular database and, if deemed unnecessary, can be [manually deleted](../v2.1/drop-database.html). [#24735][#24735] {% comment %}doc{% endcomment %}
- The new `compactor.threshold_bytes` and `max_record_age` [cluster settings](../v2.1/cluster-settings.html) can be used to configure the compactor. [#25397][#25397] {% comment %}doc{% endcomment %}
- After [upgrading a cluster](../v2.1/upgrade-cockroach-version.html) from v2.0 to v2.1, it is no longer necessary to manually finalize the upgrade. [#24987][#24987]

<h3 id="v2.1.0-alpha.20180604-sql-language-changes">SQL Language Changes</h3>

- [Collated strings](../v2.1/collate.html) can now be used in `WHERE` clauses on indexed columns. [#25169][#25169]
- The new `CANCEL QUERIES` and `CANCEL SESSIONS` variants of the [`CANCEL QUERY`](../v2.1/cancel-query.html) and [`CANCEL SESSION`](../v2.1/cancel-session.html) statements cancel multiple queries or sessions at once. Likewise, the new `CANCEL/PAUSE/RESUME JOBS` variants of the [`CANCEL JOB`](../v2.1/cancel-job.html), [`PAUSE JOB`](../v2.1/pause-job.html), and [`RESUME JOB`](../v2.1/resume-job.html) statements operate on multiple jobs at once. [#25157][#25157] {% comment %}doc{% endcomment %}
- The `Level` and `Type` columns of [`EXPLAIN (VERBOSE)`](../v2.1/explain.html) results are now hidden; if they are needed, they can be `SELECT`ed explicitly. [#25172][#25172] {% comment %}doc{% endcomment %}
- All users now automatically belong to the new `public` role. This role makes it possible to grant privileges on an object for all users at once, e.g., `GRANT SELECT ON mytable TO public;`. [#25099][#25099]
- The binary Postgres wire format is now supported for [`INTERVAL`](../v2.1/interval.html) values. [#25242][#25242] {% comment %}doc{% endcomment %}
- Prevented [`DROP TABLE`](../v2.1/drop-table.html) from using too much CPU. [#24983][#24983]
- Improved [`SET TRACING`](../v2.1/set-vars.html#set-tracing) so that a client can more easily trace around a statement that produce errors. [#25262][#25262]
- Added the `generate_subscripts()` [built-in function](../v2.1/functions-and-operators.html). [#25295][#25295] {% comment %}doc{% endcomment %}
- Improved the documentation of the `now()`, `current_time()`, `current_date()`, `current_timestamp()`,
`clock_timestamp()`, `statement_timestamp()`, and `cluster_logical_timestamp()` [built-in functions](../v2.1/functions-and-operators.html). [#25327][#25327] {% comment %}doc{% endcomment %}
- Running [`TRUNCATE`](../v2.1/truncate.html) without `CASCADE` on a table that has interleaved table children now returns an error instead of proceeding to delete both tables. [#25265][#25265] {% comment %}doc{% endcomment %}
- Tuples can now be labeled using the new grammar `((1,2,3) AS a,b,c)`. [#25283][#25283] {% comment %}doc{% endcomment %}
- Labeled tuples can now be accessed using their labels, but doing so requires an extra level of parentheses, e.g., `SELECT (((1,'2',true) AS a, b, c)).a`. [#25810][#25810]
- [`SHOW TRACE FOR <stmt>`](../v2.1/) now runs `<stmt>` through the [DistSQL](../v2.1/architecture/sql-layer.html#distsql) execution engine, if supported. `SHOW KV TRACE FOR <stmt>` still runs `<stmt>` through local SQL. [#24709][#24709] {% comment %}doc{% endcomment %}
- Introduced two experimental scalar operators, `IFERROR()` and `ISERROR()`. They may be documented for public use in the future. [#25304][#25304]
- The `server.time_until_store_dead` [cluster setting](../v2.1/cluster-settings.html) can no longer be set to less than `1m15s`. Setting it to lower values was previously allowed but not safe, since it can cause bad rebalancing behavior. [#25598][#25598] {% comment %}doc{% endcomment %}
- [`CANCEL JOB`](../v2.1/cancel-job.html) can now be executed on long-running schema change jobs, causing them to terminate early and roll back. [#25571][#25571] {% comment %}doc{% endcomment %}
- Added the `array_to_string()` [built-in function](../v2.1/functions-and-operators.html). [#25681][#25681] {% comment %}doc{% endcomment %}
- [`IMPORT`](../v2.1/import.html) now supports MySQL's tabbed `OUTFILE` format. [#25615][#25615] {% comment %}doc{% endcomment %}
- [`IMPORT`](../v2.1/import.html) now supports `mysqldump` SQL as a data format. [#25783][#25783] {% comment %}doc{% endcomment %}
- The experimental lookup join feature now supports secondary indexes. [#25628][#25628] {% comment %}doc{% endcomment %}
- Stored, computed columns can now be converted to regular columns by running `ALTER TABLE t ALTER COLUMN c DROP STORED`. [#25819][#25819] {% comment %}doc{% endcomment %}
- The experimental lookup join feature now supports left outer joins. [#25644][#25644] {% comment %}doc{% endcomment %}
- [`TRUNCATE`](../v2.1/truncate.html) commands are now logged in the event log. [#25868][#25868]
- Improved [`IMPORT`](../v2.1/import.html) error messages. [#26032][#26032]

<h3 id="v2.1.0-alpha.20180604-command-line-changes">Command-Line Changes</h3>

- Changing or removing a [replication zone](../v2.1/configure-replication-zones.html) config now causes events to be written to the system event log. [#25250][#25250]
- Messages that refer to an invoked command (e.g., "Failed running start") are no longer confused by the presence of flags before the first argument (e.g., `cockroach --no-color start`). [#25246][#25246]
- Typos in [replication zone constraints](../v2.1/configure-replication-zones.html#replication-constraints) are now validated. When they are set, required attributes and localities must match at least one node in the cluster. [#25421][#25421] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180604-admin-ui-changes">Admin UI Changes</h3>

- Running unit tests for the Admin UI now depends on the installation of Google Chrome. [#25140][#25140]
- Added RocksDB compactions/flushes to Storage graphs. [#25428][#25428]
- Added a Stores report page, including encryption status. [#26040][#26040]
- Removed time selectors and tier labels during [Node Map](../v2.1/enable-node-map.html) setup. [#25280][#25280]

<h3 id="v2.1.0-alpha.20180604-bug-fixes">Bug Fixes</h3>

- The [`cockroach sql`](../v2.1/use-the-built-in-sql-client.html) command once again does not prompt for a password when a certificate is provided. [#25252][#25252]
- Corrected the behavior of `GREATEST` and `LEAST` built-ins when they have a leading `NULL` argument. [#25882][#25882]
- CockroachDB now properly reports an error when using the internal-only functions `final_variance()` and `final_stddev()` instead of causing a crash. [#25158][#25158]
- The `constraint_schema` column in `information_schema.constraint_column_usage` now displays the constraint's schema instead of its catalog. [#25190][#25190] {% comment %}doc{% endcomment %}
- `BEGIN; RELEASE SAVEPOINT;` now returns and error instead of causing a crash. [#25247][#25247]
- Fix a bug where the sessions endpoint on the Admin UI would return an error when there was an active transaction. [#25249][#25249]
- Corrected the CockroachDB-specific, currently undocumented conversion from [`INTERVAL`](../v2.1/interval.html) to/from numeric types. [#25257][#25257]
- Fixed problems with [`IMPORT`](../v2.1/import.html) sometimes failing after node decommissioning. [#25162][#25162]
- Prevented queries that use placeholders for tuple types from causing a crash. [#25269][#25269]
- Fixed a rare `segfault` that occurred when reading from an invalid memory location returned from C++. [#25347][#25347]
- Fixed a bug with `IS DISTINCT FROM` not returning `NULL` values that pass the condition in some cases. [#25336][#25336]
- Restarting a CockroachDB server on Windows no longer fails due to file system locks in the store directory. [#25267][#25267]
- Prevented the consistency checker from deadlocking. This would previously manifest itself as a steady number of replicas queued for consistency checking on one or more nodes and would resolve by restarting the affected nodes. [#25456][#25456]
- Fixed a crash in some cases when using a `GROUP BY` with `HAVING`. [#25574][#25574]
- Fixed a nil pointer dereference when importing data containing date values. [#25661][#25661]
- Numeric literal values no longer silently lose information after a certain precision. [#25597][#25597]
- Prevented spurious `BudgetExceededErrors` for some queries that read a lot of [`JSON`](../v2.1/jsonb.html) data from disk. [#25679][#25679]
- Fixed query errors in some cases involving a `NULL` constant that is cast to a specific type. [#25735][#25735]
- Fixed a crash when trying to plan certain `UNION ALL` queries. [#25747][#25747]
- Fixed a crash caused by inserting data into a table with [computed columns](../v2.1/computed-columns.html) that reference other columns not present in the `INSERT` statement. [#25682][#25682]
- `EXPLAIN (DISTSQL)` now properly reports that plans containing subqueries cannot be run through the [DistSQL execution engine](../v2.1/architecture/sql-layer.html#distsql). [#25618][#25618]
- CockroachDB no longer crashes if the control statements `CANCEL`/`PAUSE`/`RESUME` are given values using special PostgreSQL types (e.g., `NAME`). [#25844][#25844]
- Fixed a panic when using unordered aggregations. [#26042][#26042]
- Fixed an error caused by [`INET`](../v2.1/inet.html) constants in some rare cases. [#26086][#26086]
- Fixed an error caused by empty arrays in some cases. [#26090][#26090]
- Previously, expired compactions could stay in the queue forever. Now, they are removed when they expire. [#26039][#26039]
- Fixed problems using tables with [foreign key](../v2.1/foreign-key.html) or [interleaved](../v2.1/interleave-in-parent.html) references to other tables when the tables were created in the same transaction. [#25786][#25786]

<h3 id="v2.1.0-alpha.20180604-doc-updates">Doc Updates</h3>

- Documented [special syntax forms](../v2.1/functions-and-operators.html#special-syntax-forms) of built-in SQL functions and [conditional and function-like operators](../v2.1/functions-and-operators.html#conditional-and-function-like-operators), and updated the [SQL operator order of precedence](../v2.1/functions-and-operators.html#operators). [#3192][#3192]
- Added best practices on [understanding and avoiding transaction contention](../v2.1/performance-best-practices-overview.html#understanding-and-avoiding-transaction-contention) and a related [FAQ](../v2.1/operational-faqs.html#why-would-increasing-the-number-of-nodes-not-result-in-more-operations-per-second). [#3156][#3156]
- Improved the documentation of [`AS OF SYSTEM TIME`](../v2.1/as-of-system-time.html). [#3155][#3155]
- Expanded the [manual deployment](../v2.1/manual-deployment.html) guides to cover running a sample workload against a cluster. [#3149][#3149]
- Documented the [`TIMETZ`](../v2.1/time.html) data type. [#3102][#3102]
- Added FAQs on [generating unique, slowly increasing sequential numbers](../v2.1/sql-faqs.html#how-do-i-generate-unique-slowly-increasing-sequential-numbers-in-cockroachdb) and [the differences between `UUID`, sequences, and `unique_rowid()`](../v2.1/sql-faqs.html#what-are-the-differences-between-uuid-sequences-and-unique_rowid). [#3104][#3104]

<h3 id="v2.1.0-alpha.20180604-contributors">Contributors</h3>

This release includes 304 merged PRs by 38 authors. We would like to thank the following contributors from the CockroachDB community, with special thanks to first-time contributors Nishant Gupta, wabada, and yuzefovich.

- Garvit Juniwal
- Gustav Paul
- Karan Vaidya
- Nishant Gupta
- Vijay Karthik
- wabada
- Yahor Yuzefovich

[#24709]: https://github.com/cockroachdb/cockroach/pull/24709
[#24735]: https://github.com/cockroachdb/cockroach/pull/24735
[#24956]: https://github.com/cockroachdb/cockroach/pull/24956
[#24983]: https://github.com/cockroachdb/cockroach/pull/24983
[#24987]: https://github.com/cockroachdb/cockroach/pull/24987
[#25099]: https://github.com/cockroachdb/cockroach/pull/25099
[#25140]: https://github.com/cockroachdb/cockroach/pull/25140
[#25157]: https://github.com/cockroachdb/cockroach/pull/25157
[#25158]: https://github.com/cockroachdb/cockroach/pull/25158
[#25162]: https://github.com/cockroachdb/cockroach/pull/25162
[#25169]: https://github.com/cockroachdb/cockroach/pull/25169
[#25172]: https://github.com/cockroachdb/cockroach/pull/25172
[#25190]: https://github.com/cockroachdb/cockroach/pull/25190
[#25211]: https://github.com/cockroachdb/cockroach/pull/25211
[#25242]: https://github.com/cockroachdb/cockroach/pull/25242
[#25246]: https://github.com/cockroachdb/cockroach/pull/25246
[#25247]: https://github.com/cockroachdb/cockroach/pull/25247
[#25249]: https://github.com/cockroachdb/cockroach/pull/25249
[#25250]: https://github.com/cockroachdb/cockroach/pull/25250
[#25252]: https://github.com/cockroachdb/cockroach/pull/25252
[#25257]: https://github.com/cockroachdb/cockroach/pull/25257
[#25262]: https://github.com/cockroachdb/cockroach/pull/25262
[#25265]: https://github.com/cockroachdb/cockroach/pull/25265
[#25267]: https://github.com/cockroachdb/cockroach/pull/25267
[#25269]: https://github.com/cockroachdb/cockroach/pull/25269
[#25280]: https://github.com/cockroachdb/cockroach/pull/25280
[#25283]: https://github.com/cockroachdb/cockroach/pull/25283
[#25295]: https://github.com/cockroachdb/cockroach/pull/25295
[#25304]: https://github.com/cockroachdb/cockroach/pull/25304
[#25327]: https://github.com/cockroachdb/cockroach/pull/25327
[#25336]: https://github.com/cockroachdb/cockroach/pull/25336
[#25347]: https://github.com/cockroachdb/cockroach/pull/25347
[#25397]: https://github.com/cockroachdb/cockroach/pull/25397
[#25421]: https://github.com/cockroachdb/cockroach/pull/25421
[#25428]: https://github.com/cockroachdb/cockroach/pull/25428
[#25456]: https://github.com/cockroachdb/cockroach/pull/25456
[#25539]: https://github.com/cockroachdb/cockroach/pull/25539
[#25571]: https://github.com/cockroachdb/cockroach/pull/25571
[#25574]: https://github.com/cockroachdb/cockroach/pull/25574
[#25597]: https://github.com/cockroachdb/cockroach/pull/25597
[#25598]: https://github.com/cockroachdb/cockroach/pull/25598
[#25615]: https://github.com/cockroachdb/cockroach/pull/25615
[#25618]: https://github.com/cockroachdb/cockroach/pull/25618
[#25628]: https://github.com/cockroachdb/cockroach/pull/25628
[#25644]: https://github.com/cockroachdb/cockroach/pull/25644
[#25661]: https://github.com/cockroachdb/cockroach/pull/25661
[#25679]: https://github.com/cockroachdb/cockroach/pull/25679
[#25681]: https://github.com/cockroachdb/cockroach/pull/25681
[#25682]: https://github.com/cockroachdb/cockroach/pull/25682
[#25735]: https://github.com/cockroachdb/cockroach/pull/25735
[#25747]: https://github.com/cockroachdb/cockroach/pull/25747
[#25768]: https://github.com/cockroachdb/cockroach/pull/25768
[#25769]: https://github.com/cockroachdb/cockroach/pull/25769
[#25783]: https://github.com/cockroachdb/cockroach/pull/25783
[#25786]: https://github.com/cockroachdb/cockroach/pull/25786
[#25810]: https://github.com/cockroachdb/cockroach/pull/25810
[#25819]: https://github.com/cockroachdb/cockroach/pull/25819
[#25844]: https://github.com/cockroachdb/cockroach/pull/25844
[#25868]: https://github.com/cockroachdb/cockroach/pull/25868
[#25882]: https://github.com/cockroachdb/cockroach/pull/25882
[#26032]: https://github.com/cockroachdb/cockroach/pull/26032
[#26039]: https://github.com/cockroachdb/cockroach/pull/26039
[#26040]: https://github.com/cockroachdb/cockroach/pull/26040
[#26042]: https://github.com/cockroachdb/cockroach/pull/26042
[#26061]: https://github.com/cockroachdb/cockroach/pull/26061
[#26086]: https://github.com/cockroachdb/cockroach/pull/26086
[#26090]: https://github.com/cockroachdb/cockroach/pull/26090
[#3102]: https://github.com/cockroachdb/docs/pull/3102
[#3104]: https://github.com/cockroachdb/docs/pull/3104
[#3149]: https://github.com/cockroachdb/docs/pull/3149
[#3155]: https://github.com/cockroachdb/docs/pull/3155
[#3156]: https://github.com/cockroachdb/docs/pull/3156
[#3192]: https://github.com/cockroachdb/docs/pull/3192
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

For our July 2nd alpha release, in addition to PostgreSQL compatibility enhancements, general usability improvements, and bug fixes, we want to highlight a few major benefits:

- [**Get visibility into query performance with the Statements pages**](../v2.1/admin-ui-statements-page.html) - The Web UI can now surface statistics about queries along with visualizations to help identify application problems quickly.
- [**Get up and running faster with `IMPORT MYSQLDUMP/PGDUMP`**](../v2.1/import-data.html) - It is now much easier to transfer existing databases to CockroachDB.
- [**Improved data security with Encryption at Rest (enterprise)**](../v2.1/encryption.html) - With this enhancement, you can now encrypt your CockroachDB files on disk, rotate keys, and monitor encryption status without having to make changes to your application code.
- [**Stream changes to Kafka with CDC (enterprise)**](../v2.1/change-data-capture.html) - CockroachDB can now stream changes into Apache Kafka to support downstream processing such as reporting, caching, or full-text indexing.
- **Secure your Web UI with User Authentication** - A login page can now be enabled to control who can access the Web UI in secure clusters.

Please give these features and the ones below a try. If you see something that can be improved, we’d love to hear from you on [GitHub](https://github.com/cockroachdb/cockroach/issues) or the [Forum](https://forum.cockroachlabs.com/).

<h3 id="v2.1.0-alpha.20180702-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180702.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180702.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180702.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-alpha.20180702-backward-incompatible-changes">Backward-incompatible changes</h3>

- CockroachDB now uses a different algorithm to generate column names for complex expressions in [`SELECT`](../v2.1/select-clause.html) clauses when `AS` is not used. The results are more compatible with PostgreSQL but may appear different to client applications. This does not impact most uses of SQL, where the rendered expressions are sufficiently simple (simple function applications, reuses of existing columns) or when `AS` is used explicitly. [#26550][#26550]
- The output columns for the statement [`SHOW CONSTRAINTS`](../v2.1/show-constraints.html) were changed. The previous interface was experimental; the new interface will now be considered stable. [#26478][#26478] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180702-general-changes">General changes</h3>

- Metrics can now be sent to a Graphite endpoint specified using the `external.graphite.endpoint` [cluster setting](../v2.1/cluster-settings.html). The `external.graphite.interval` setting controls the interval at which this happens. [#25227][#25227]
- Added a [config file and instructions](https://github.com/cockroachdb/cockroach/blob/master/cloud/kubernetes/performance/cockroachdb-daemonset-secure.yaml) for running CockroachDB in secure mode in a Kubernetes DaemonSet. [#26816][#26816] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180702-enterprise-edition-changes">Enterprise edition changes</h3>

- The new `SHOW BACKUP RANGES` and `SHOW BACKUP FILES` statements show details about the ranges and files, respectively, that comprise a backup. [#26450][#26450] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180702-sql-language-changes">SQL language changes</h3>

- If a computed column's expression results in an error, the name of the computed column is now added to the error returned to the user. This makes it easier for users to understand why an otherwise valid operation might fail. [#26054][#26054]
- Implemented the minus operation between a JSON Object and a text array. [#26183][#26183] {% comment %}doc{% endcomment %}
- Fixed some error messages to more closely match PostgreSQL error messages, including the corresponding PostgreSQL
  error codes. [#26290][#26290]
- Added an empty `pg_stat_activity` virtual table for compatibility with DBeaver and other SQL clients that require it. [#26249][#26249]
- The new `EXPLAIN (DISTSQL, ANALYZE)` statement annotates DistSQL execution plans with collected execution statistics. [#25849][#25849] {% comment %}doc{% endcomment %}
- [`IMPORT`](../v2.1/import.html) now supports the PostgreSQL `COPY` format. [#26334][#26334] {% comment %}doc{% endcomment %}
- The output of [`SHOW SESSIONS`](../v2.1/show-sessions.html) now includes the number of currently allocated bytes by the session, and the maximum number of allocated bytes that the session ever owned at once. Note that these numbers do not include the bytes allocated for the session by remote nodes. [#25395][#25395] {% comment %}doc{% endcomment %}
- The `bytea_output` [session variable](../v2.1/set-vars.html) now controls how byte arrays are converted to strings and reported back to clients, for compatibility with PostgreSQL. [#25835][#25835] {% comment %}doc{% endcomment %}
- Added placeholder `information_schema.routines` and `information_schema.parameters` for compatibility with Navicat, PGAdmin, and other clients that require them. [#26327][#26327] {% comment %}doc{% endcomment %}
- CockroachDB now recognizes aggregates in `ORDER BY` clauses even when there is no `GROUP BY` clause nor aggregation performed, for compatibility with PostgreSQL. [#26425][#26425] {% comment %}doc{% endcomment %}
- Added the `pg_is_in_recovery()` [function](../v2.1/functions-and-operators.html) for compatibility with PostgreSQL tools. [#26445][#26445] {% comment %}doc{% endcomment %}
- CockroachDB now supports simple forms of PostgreSQL's `ROWS FROM(...)` syntax. [#26223][#26223] {% comment %}doc{% endcomment %}
- CockroachDB now generates a simple column name when using an SRF that produces multiple columns. [#26223][#26223]
- CockroachDB now properly handles some uses of multiple SRFs in the same `SELECT` clause in a way compatible with
  PostgreSQL. [#26223][#26223]
- Added the `pg_is_xlog_replay_paused()` [function](../v2.1/functions-and-operators.html) for compatibility with PostgreSQL tools. [#26462][#26462] {% comment %}doc{% endcomment %}
- Added the `pg_catalog.pg_seclabel` and `pg_catalog.pg_shseclabel` tables for compatibility with Postgres tools. Note that we do not support adding security labels. [#26515][#26515]
- CockroachDB now supports [`INSERT ... ON CONFLICT DO NOTHING`](../v2.1/insert.html) without any specified columns; on a conflict with any [`UNIQUE`](../v2.1/unique.html) column, the insert will not continue. [#26465][#26465] {% comment %}doc{% endcomment %}
- CockroachDB now supports the `bit_length()`, `quote_ident()`, `quote_literal()`, and `quote_nullable()` [built-in functions](../v2.1/functions-and-operators.html), and the aliases `char_length()` and `character_length()` for `length()`, for compatibility with PostgreSQL. [#26586][#26586] {% comment %}doc{% endcomment %}
- If a function name is typed in with an invalid schema or invalid case, the error message now tries to provides a suggestion for alternate spelling. [#26588][#26588]
- CockroachDB now can evaluate set-generating functions with arguments that refer to the `FROM` clause. In particular, this makes it possible to use functions like `json_each()` and `json_object_keys()` over [`JSONB`](../v2.1/jsonb.html) columns. [#26503][#26503] {% comment %}doc{% endcomment %}
- Added prototype support for [`IMPORT ... MYSQLDUMP`](../v2.1/import.html), including the ability to import entire (multi-table) mysqldump files. [#26164][#26164] {% comment %}doc{% endcomment %}
- [`CHECK`](../v2.1/check.html) constraints are now checked when updating a conflicting row in [`INSERT ... ON CONFLICT DO UPDATE`](../v2.1/insert.html) statements. [#26642][#26642] {% comment %}doc{% endcomment %}
- Labeled tuples can now be accessed using their labels (e.g., `SELECT (x).word FROM (SELECT pg_expand_keywords() AS x)` or a star (e.g., `SELECT (x).* FROM (SELECT pg_expand_keywords() AS x)`). [#26628][#26628] {% comment %}doc{% endcomment %}
- An error is now returned to the user instead of panicking when trying to add a column with a [`UNIQUE`](../v2.1/unique.html) constraint when that column's type is not indexable. [#26684][#26684] {% comment %}doc{% endcomment %}
- Introduced the `sql.failure.count` metric, which counts the number of queries that result in an error. [#26731][#26731]
- Added support for de-compressing [`IMPORT`](../v2.1/import.html) files with gzip or bzip. [#26796][#26796] {% comment %}doc{% endcomment %}
- Added initial support for `IMPORT` with pg_dump files. [#26740][#26740] {% comment %}doc{% endcomment %}
- Added the `like_escape()`, `ilike_escape()`, `not_like_escape()`, `not_ilike_escape()`, `similar_escape()`, and `not_similar_escape()` [built-in functions](../v2.1/functions-and-operators.html) for use when an optional `ESCAPE` clause is present. [#26176][#26176] {% comment %}doc{% endcomment %}
- Added support for set-returning functions in distributed SQL execution. [#26739][#26739]
- Added a cluster setting to enable the experimental cost-based optimizer. [#26299][#26299]
- Added the `pg_catalog.pg_shdescription` table for compatibility with PostgreSQL tools. Note that CockroachDB does not support adding descriptions to shared database objects. [#26474][#26474]

<h3 id="v2.1.0-alpha.20180702-command-line-changes">Command-line changes</h3>

- [`cockroach quit`](../v2.1/stop-a-node.html) now emits warning messages on its standard error stream, not standard output. [#26158][#26158] {% comment %}doc{% endcomment %}
- [`cockroach sql`](../v2.1/use-the-built-in-sql-client.html) now recognizes the values `on`, `off`, `0`, `1`, `true` and `false` to set client-side boolean parameters with `set`. [#26287][#26287] {% comment %}doc{% endcomment %}
- [`cockroach sql`](../v2.1/use-the-built-in-sql-client.html) now recognizes `set option=value` as an alias to `set option value`. [#26287][#26287] {% comment %}doc{% endcomment %}
- `cockroach demo` now supports more options also supported by `cockroach sql`, including `--execute`, `--format`,
  `--echo-sql` and `--safe-updates`. [#26287][#26287] {% comment %}doc{% endcomment %}
- `cockroach demo` includes the welcome messages also printed by `cockroach sql`. [#26287][#26287]
- `cockroach demo` now uses the standard `defaultdb` database instead of creating its own `demo` database. [#26287][#26287] {% comment %}doc{% endcomment %}
- [`cockroach sql`](../v2.1/use-the-built-in-sql-client.html) and `cockroach demo` now accept `--set` to run `set` commands prior to starting the shell
  or running commands via `-e`. [#26287][#26287] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180702-admin-ui-changes">Admin UI changes</h3>

- Authentication in the Admin UI can now be enabled for secure clusters by setting the environment variable `COCKROACH_EXPERIMENTAL_REQUIRE_WEB_LOGIN=TRUE`. [#25005][#25005]
- System databases are now listed after all user databases on the [**Databases** page](../v2.1/admin-ui-databases-page.html). [#25817][#25817] {% comment %}doc{% endcomment %}
- Added **Statements** and **Statement Details** pages showing fingerprints of incoming statements and basic statistics about them. [#24485][#24485]
- Lease transfers are now shown in the **Range Operations** graph on the [**Replication** dashboard](../v2.1/admin-ui-replication-dashboard.html). [#26653][#26653] {% comment %}doc{% endcomment %}
- Add a debug page showing how table data is distributed across nodes, as well as the zone configs which are affecting that distribution. [#24855][#24855] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180702-bug-fixes">Bug fixes</h3>

- Fixed an issue where the Table details page in the Admin UI would become unresponsive after some time. [#26636][#26636]
- Fix a bug where [`cockroach quit`](../v2.1/stop-a-node.html) would erroneously fail even though the node already successfully shut down. [#26158][#26158]
- [`UPSERT`](../v2.1/upsert.html) is now properly able to write `NULL` values to every column in tables containing more than one column family. [#26169][#26169]
- Fixed a bug causing index creation to fail under rare circumstances. [#26265][#26265]
- Corrected `NULL` handling during [`IMPORT`](../v2.1/import.html) of `MYSQLOUTFILE`. [#26275][#26275]
- Fixed concurrent access to the same file when using encryption. [#26377][#26377]
- Fixed a bug where a prepared query would not produce the right value for `current_date()` if prepared on one day and executed on the next. [#26370][#26370]
- Rows larger than 8192 bytes are now supported by the "copy from" protocol. [#26345][#26345]
- Trying to "copy from stdin" into a table that doesn't exist no longer drops the connection. [#26345][#26345]
- CockroachDB now produces a clearer message when special functions (e.g., `generate_series()`) are used in an invalid context (e.g., `LIMIT`). [#26425][#26425]
- Fixed a rare crash on node [decommissioning](../v2.1/remove-nodes.html). [#26706][#26706]
- Commands are now abandoned earlier once a deadline has been reached. [#26643][#26643]
- Using [`SHOW TRACE FOR SESSION`](../v2.1/show-trace.html) multiple times without an intervening `SET tracing` statement now properly outputs the trace without introducing extraneous duplicate rows. [#26746][#26746]
- The output of debug and tracing commands is no longer corrupted when byte array values contain invalid UTF-8 sequences. [#26769][#26769]
- Joins across two [interleaved tables](../v2.1/interleave-in-parent.html) no longer return incorrect results under certain circumstances when the equality columns aren't all part of the interleaved columns. [#26756][#26756]
- Prepared statements using [`RETURNING NOTHING`](../v2.1/parallel-statement-execution.html) that are executed using the `EXECUTE` statement are now properly parallelized. [#26668][#26668]
- The pretty-print code for `SHOW` now properly quotes the variable name, and the pretty-printing code for an index definition inside `CREATE TABLE` now properly indicates whether the index was inverted. [#26923][#26923]
- Within a [transaction](../v2.1/transactions.html), DML statements are now allowed after a [`TRUNCATE`](../v2.1/truncate.html). [#26051][#26051]

<h3 id="v2.1.0-alpha.20180702-performance-improvements">Performance improvements</h3>

- Improved the throughput of highly contended writes with the new `contentionQueue`. [#25014][#25014]
- The performance impact of dropping a large table has been substantially reduced. [#26449][#26449]
- Using tuples in a query no longer reverts you to single node local SQL execution. [#25860][#25860]
- CockroachDB's internal monitoring time series are now encoded using a more efficient on-disk format to provide considerable space savings. Monitoring data written in the old format will not be converted but will still be queryable. [#26614][#26614]
- Improved the performance of the `sortChunks` processor. [#26874][#26874]

<h3 id="v2.1.0-alpha.20180702-build-changes">Build Changes</h3>

- Release binaries are now built with runtime AES detection. [#26649][#26649]

<h3 id="v2.1.0-alpha.20180702-doc-updates">Doc updates</h3>

- Added `systemd` configs and instructions to [deployment tutorials](../v2.1/manual-deployment.html). [#3268][#3268]
- Added instructions for [importing data from Postgres dump files](../v2.1/import-data.html). [#3306][#3306]
- Expanded the first level of the 2.1 docs sidenav by default. [#3270][#3270]
- Updated the [Kubernetes tutorials](../v2.1/orchestrate-cockroachdb-with-kubernetes.html) to reflect that pods aren't "Ready" before init. [#3291][#3291]

<h3 id="v2.1.0-alpha.20180702-contributors">Contributors</h3>

This release includes 328 merged PRs by 35 authors. We would like to thank the following contributors from the CockroachDB community, with special thanks to first-time contributors Chris Seto and Emmanuel.

- Chris Seto
- Emmanuel
- neeral

[#24485]: https://github.com/cockroachdb/cockroach/pull/24485
[#24855]: https://github.com/cockroachdb/cockroach/pull/24855
[#25005]: https://github.com/cockroachdb/cockroach/pull/25005
[#25014]: https://github.com/cockroachdb/cockroach/pull/25014
[#25227]: https://github.com/cockroachdb/cockroach/pull/25227
[#25395]: https://github.com/cockroachdb/cockroach/pull/25395
[#25817]: https://github.com/cockroachdb/cockroach/pull/25817
[#25835]: https://github.com/cockroachdb/cockroach/pull/25835
[#25849]: https://github.com/cockroachdb/cockroach/pull/25849
[#25860]: https://github.com/cockroachdb/cockroach/pull/25860
[#26051]: https://github.com/cockroachdb/cockroach/pull/26051
[#26054]: https://github.com/cockroachdb/cockroach/pull/26054
[#26158]: https://github.com/cockroachdb/cockroach/pull/26158
[#26164]: https://github.com/cockroachdb/cockroach/pull/26164
[#26169]: https://github.com/cockroachdb/cockroach/pull/26169
[#26176]: https://github.com/cockroachdb/cockroach/pull/26176
[#26183]: https://github.com/cockroachdb/cockroach/pull/26183
[#26223]: https://github.com/cockroachdb/cockroach/pull/26223
[#26249]: https://github.com/cockroachdb/cockroach/pull/26249
[#26260]: https://github.com/cockroachdb/cockroach/pull/26260
[#26265]: https://github.com/cockroachdb/cockroach/pull/26265
[#26275]: https://github.com/cockroachdb/cockroach/pull/26275
[#26287]: https://github.com/cockroachdb/cockroach/pull/26287
[#26290]: https://github.com/cockroachdb/cockroach/pull/26290
[#26299]: https://github.com/cockroachdb/cockroach/pull/26299
[#26327]: https://github.com/cockroachdb/cockroach/pull/26327
[#26334]: https://github.com/cockroachdb/cockroach/pull/26334
[#26345]: https://github.com/cockroachdb/cockroach/pull/26345
[#26355]: https://github.com/cockroachdb/cockroach/pull/26355
[#26370]: https://github.com/cockroachdb/cockroach/pull/26370
[#26377]: https://github.com/cockroachdb/cockroach/pull/26377
[#26425]: https://github.com/cockroachdb/cockroach/pull/26425
[#26445]: https://github.com/cockroachdb/cockroach/pull/26445
[#26447]: https://github.com/cockroachdb/cockroach/pull/26447
[#26449]: https://github.com/cockroachdb/cockroach/pull/26449
[#26450]: https://github.com/cockroachdb/cockroach/pull/26450
[#26462]: https://github.com/cockroachdb/cockroach/pull/26462
[#26465]: https://github.com/cockroachdb/cockroach/pull/26465
[#26468]: https://github.com/cockroachdb/cockroach/pull/26468
[#26474]: https://github.com/cockroachdb/cockroach/pull/26474
[#26478]: https://github.com/cockroachdb/cockroach/pull/26478
[#26503]: https://github.com/cockroachdb/cockroach/pull/26503
[#26515]: https://github.com/cockroachdb/cockroach/pull/26515
[#26550]: https://github.com/cockroachdb/cockroach/pull/26550
[#26586]: https://github.com/cockroachdb/cockroach/pull/26586
[#26588]: https://github.com/cockroachdb/cockroach/pull/26588
[#26614]: https://github.com/cockroachdb/cockroach/pull/26614
[#26628]: https://github.com/cockroachdb/cockroach/pull/26628
[#26636]: https://github.com/cockroachdb/cockroach/pull/26636
[#26642]: https://github.com/cockroachdb/cockroach/pull/26642
[#26643]: https://github.com/cockroachdb/cockroach/pull/26643
[#26649]: https://github.com/cockroachdb/cockroach/pull/26649
[#26653]: https://github.com/cockroachdb/cockroach/pull/26653
[#26668]: https://github.com/cockroachdb/cockroach/pull/26668
[#26684]: https://github.com/cockroachdb/cockroach/pull/26684
[#26706]: https://github.com/cockroachdb/cockroach/pull/26706
[#26711]: https://github.com/cockroachdb/cockroach/pull/26711
[#26731]: https://github.com/cockroachdb/cockroach/pull/26731
[#26739]: https://github.com/cockroachdb/cockroach/pull/26739
[#26740]: https://github.com/cockroachdb/cockroach/pull/26740
[#26746]: https://github.com/cockroachdb/cockroach/pull/26746
[#26756]: https://github.com/cockroachdb/cockroach/pull/26756
[#26769]: https://github.com/cockroachdb/cockroach/pull/26769
[#26776]: https://github.com/cockroachdb/cockroach/pull/26776
[#26796]: https://github.com/cockroachdb/cockroach/pull/26796
[#26816]: https://github.com/cockroachdb/cockroach/pull/26816
[#26874]: https://github.com/cockroachdb/cockroach/pull/26874
[#26923]: https://github.com/cockroachdb/cockroach/pull/26923
[#3268]: https://github.com/cockroachdb/docs/pull/3268
[#3270]: https://github.com/cockroachdb/docs/pull/3270
[#3291]: https://github.com/cockroachdb/docs/pull/3291
[#3306]: https://github.com/cockroachdb/docs/pull/3306
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

For our July 30th alpha release, in addition to PostgreSQL compatibility enhancements, general usability improvements, and bug fixes, we want to highlight some major benefits:

- [**Troubleshoot performance problems with hardware metrics**](../v2.1/admin-ui-hardware-dashboard.html) - The new Web UI **Hardware** dashboard provides more visibility into how cluster CPU, networking, disk, and memory resources are being utilized so you can quickly identify and remove performance bottlenecks.
- [**Easier PostgreSQL migration**](../v2.1/import-data.html) - We’ve made further enhancements to reduce PostgreSQL migration friction. Notable improvements include support for foreign keys, sequences, and `COPY` in `IMPORT ... PGDUMP`.
- [**Monitor Kubernetes-orchestrated clusters with Prometheus**](../v2.1/orchestrate-cockroachdb-with-kubernetes.html) - We expanded our guides for running CockroachDB on Kubernetes in production to include setting up monitoring and alerting with Prometheus and Alertmanager.

Please give these features and the ones below a try. If you see something that can be improved, we’d love to hear from you on [GitHub](https://github.com/cockroachdb/cockroach/issues) or the [Forum](https://forum.cockroachlabs.com/).

<h3 id="v2.1.0-alpha.20180730-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180730.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180730.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-alpha.20180730.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-alpha.20180730-general-changes">General changes</h3>

- The [cost-based optimizer](../v2.1/cost-based-optimizer.html) is now on by default. [#26893][#26893]
- The time series system used by CockroachDB to store internal monitoring data now utilizes pre-computed rollups to significantly increase the duration for which monitoring data is available while using less storage. Monitoring data will be available for up to a year by default; however, data older than seven days will be stored at a reduced resolution, and thus will only be able to give details about 30 minute intervals. [#27121][#27121]
- Building CockroachDB from source now requires yarn at version 1.7.0 or above. [#27262][#27262]
- Added support for signing server and client certificates by different CAs. [#27636][#27636]

<h3 id="v2.1.0-alpha.20180730-enterprise-edition-changes">Enterprise edition changes</h3>

- Core dumps are now disabled when [encryption](../v2.1/encryption.html) is enabled. [#27426][#27426]
- [`CHANGEFEED`s](../v2.1/change-data-capture.html) now use an asynchronous Kafka producer, increasing throughput. [#27421][#27421]

<h3 id="v2.1.0-alpha.20180730-sql-language-changes">SQL language changes</h3>

- CockroachDB now supports custom frame specification for [window functions](../v2.1/window-functions.html) using `ROWS` (fully-supported) and `RANGE` modes. For `RANGE`, `<value> PRECEDING` and `<value> FOLLOWING` are not supported. [#26666][#26666]
- The `SNAPSHOT` [isolation level](../v2.1/transactions.html#isolation-levels) has been removed. Transactions that request to use it are now mapped to `SERIALIZABLE`. [#27040][#27040].
- When the cost-based optimizer is enabled, it will also affect prepared queries. [#27034][#27034]
- Upon failing to gather data from other nodes, the [`SHOW CLUSTER QUERIES`](../v2.1/show-queries.html) and [`SHOW CLUSTER SESSIONS`](../v2.1/show-sessions.html) statements now report the details of the error. [#26821][#26821]
- Improved the description for the `age()` [built-in function](../v2.1/functions-and-operators.html). [#27082][#27082]
- The `pg_get_indexdef()` built-in function now supports 3 arguments. [#27161][#27161]
- Added `COPY` support to `IMPORT .. . PGDUMP`. [#27062][#27062]
- The new `max_row_size` option overrides default limits on line size for `IMPORT ... PGDUMP` and `PGCOPY`. [#27062][#27062]
- The `SHOW TRACE FOR <stmt>` statement was incomplete and incorrect and has thus been removed. To turn on tracing, use `SET tracing = ...` and `SHOW SESSION TRACE`, or enable the new `auto_trace` client-side option for `cockroach sql`. [#26729][#26729] [#27805][#27805]
- `SET tracing` accepts a new option `results`, which causes result rows and row counts to be copied to the session trace. This was previously implicit with option `kv` but must now be specified explicitly when desired. [#26729][#26729]
- The word `view` is now supported as an identifier like in PostgreSQL. [#27204][#27204]
- `IMPORT ... PGDUMP` no longer requires the `--no-owner` flag. [#27268][#27268]
- `AS OF SYSTEM TIME` can now use some more complex expressions to compute the desired timestamp. [#27206][#27206]
- Added support for the `convert_from()` and `convert_to()` built-in functions, for compatibility with PostgreSQL.  For `convert_from()`, however, in contrast with PostgreSQL, the function in CockroachDB accepts NUL in the input, because null characters are valid in CockroachDB strings. [#27328][#27328]
- The `ALTER ... EXPERIMENTAL CONFIGURE ZONE` statement now accepts arbitrary scalar expressions (including possibly containing sub-queries) to compute the YAML operand. [#27213][#27213]
- CockroachDB now recognizes PostgreSQL's abbreviated time units when converting strings to intervals. [#27393][#27393]
- Sorting with a limit and/or input ordering now falls back to disk. [#27083][#27083]
- CockroachDB now reports a hint in the error message if it encounters a correlated query that it does not
  support yet. [#27396][#27396]
- The new `EXPERIMENTAL_RELOCATE LEASE` command for `ALTER TABLE` and `ALTER INDEX` allows manually transferring the leases for specific ranges to specific stores. [#26436][#26436]
- Added the `sql.distsql.flow_stream_timeout` and `sql.distsql.max_running_flows` [cluster settings](../v2.1/cluster-settings.html) to fine-tune flow setup [#27404][#27404]
- `IMPORT` now supports a `WITH oversample = ...` option to decrease variance in data distribution during processing. [#27341][#27341]
- `IMPORT ... PGDUMP` now supports foreign keys. [#27425][#27425]
- `IMPORT ... PGDUMP` now supports sequences. [#27739][#27739]
- `IMPORT ... PGDUMP` now supports empty and public schemas. [#27782][#27782]
- `SHOW JOBS` now reports results even when a job entry is incomplete or incorrect. [#27430][#27430]
- The column labels in the output of `EXPLAIN` and all `SHOW` statements have been renamed for consistency. [#27098][#27098]
- The column labels in the output of `SHOW COLUMNS` have been renamed for consistency with `information_schema`. The new `generation_expression` column reports the expression used for computed columns. [#27098][#27098]
- The `SHOW CREATE` statement has been simplified and can be used equivalently on tables, views, and sequences without having to specify the type of object to inspect. [#27098][#27098]
- Added the `chr()` built-in function (the inverse of `ascii()`). [#27278][#27278]
- Added support for skipping foreign keys in `IMPORT`s that support them. [#27606][#27606]
- The new `sql.optimizer.count` metric has been added to track the number of queries with the experimental
  cost-based optimizer. [#26981][#26981]
- More statement types are now reported in the collected statement statistics in the web UI and diagnostics reporting. [#27646][#27646]
- Added support for KV traces (`SHOW KV TRACE FOR SESSION`) on DistSQL-executed queries. [#27802][#27802]
- The return type of single-column generator functions has been changed from `tuple{columnType}` to `columnType`. This is a compatibility change to match the behavior of PostgreSQL. [#27773][#27773]

<h3 id="v2.1.0-alpha.20180730-command-line-changes">Command-line changes</h3>

- CockroachDB now computes the correct number of replicas on down nodes. Therefore, when [decommissioning nodes](../v2.1/remove-nodes.html) via the [`cockroach node decommission`](../v2.0/view-node-details.html) command, the `--wait=all` option no longer hangs indefinitely when there are down nodes. As a result, the `--wait=live` option is no longer necessary and has been deprecated. The `--wait=all` option is now the default. [#27027][#27027]
- Added the `cockroach sqlfmt` command for formatting SQL statements. [#27240][#27240]
- The output labels of `cockroach user ls` and `cockroach user get` have been renamed for consistency with the SQL `SHOW USERS` statement. Also, to reduce inadvertent data leaks, the output of `cockroach user get` no longer includes hashed passwords. [#27098][#27098]
- The new client-side option `prompt1` can be used to customize the `cockroach sql` interactive prompt. [#27803][#27803]
- The new `auto_trace` client-side option can be use to turn on tracing for a `cockroach sql` session. [#27805][#27805]

<h3 id="v2.1.0-alpha.20180730-web-ui-changes">Web UI changes</h3>

- The new **Hardware** dashboard displays time series data about CPU, memory, and disk and network IO. [#27626][#27626]
- Time series metric metadata is now available at `<Web UI>/_admin/metricmetada`. [#25359][#25359]
- Encryption progress is now reported on `<Web UI>/#/reports/stores/local` debug page. [#26802][#26802]
- Statement statistics can now be filtered by app on the **Statements** page. [#26949][#26949] {% comment %}doc{% endcomment %}
- Improved the readability of the mean and standard deviation bar chart on the **Statement Details** page. [#26949][#26949] {% comment %}doc{% endcomment %}
- Added a visualization of the standard deviation of the latency of statements to the **Statements** page. [#26949][#26949] {% comment %}doc{% endcomment %}
- The **Statements** page now shows statements that executed on all nodes in the cluster, not just the gateway node. [#26605][#26605] {% comment %}doc{% endcomment %}
- The **Statement Details** page now includes a table showing statistics broken down by which node was the gateway node. [#26605][#26605] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180730-bug-fixes">Bug fixes</h3>

- Fixed the ordering of columns in the [`cockroach node status`](../v2.1/view-node-details.html) output. [#27042][#27042]
- Fixed a bug that would make the **Statement Details** page in the Web UI break if a statement wasn't found. [#27105][#27105]
- Fixed some incorrectly typed columns in the `pg_index` virtual table. [#27723][#27723]
- Fixed permissions and audit logging issues with the optimizer. [#27108][#27108]
- Prevented a situation in which ranges repeatedly fail to perform a split. [#26934][#26934]
- Fixed a crash that could occur when distributed `LIMIT` queries were run on a cluster with at least one unhealthy node. [#26950][#26950]
- Failed [`IMPORT`s](../v2.1/import.html) now begin to clean up partially imported data immediately and in a faster manner. [#26959][#26959]
- `IMPORT` now detects node failure and will restart instead of fail. [#26881][#26881]
- Fixed a panic in the optimizer with `IN` filters. [#27053][#27053]
- Fixed a panic that could occur when renaming a scalar function used as a data source. [#27039][#27039]
- The server will not finalize a version upgrade automatically and erroneously if there are nodes temporarily inactive in the cluster. [#26821][#26821] {% comment %}doc{% endcomment %}
- The `DISTINCT ON` clause is now reported properly in statement statistics. [#27221][#27221]
- Fixed a panic in [`IMPORT`](../v2.0/import.html) when creating a table using a sequence operation (e.g., `nextval()`) in a column's [DEFAULT](../v2.0/default-value.html) expression.  [#27122][#27122]
- `SET` now properly rejects attempts to use
  invalid variable names starting with `tracing.`. [#27216][#27216]
- Fixed `NULL` equality handling in the experimental lookup join feature. [#27336][#27336]
- `ALTER ... EXPERIMENTAL CONFIGURE ZONE` is now properly tracked in statement statistics. [#27213][#27213]
- Invalid uses of set-generating functions in `FROM` clauses are now reported with the same error code as PostgreSQL. [#27390][#27390]
- The number of `COPY` columns is now correctly verified during `IMPORT ... PGDUMP`. [#27345][#27345]
- `CHANGFEED`s now correctly emit all versions of quickly changing rows. [#27612][#27612]
- Alleviated a scenario in which a large number of uncommitted Raft commands could cause memory pressure at startup time. [#27009][#27009]
- Prevented the unbounded growth of the Raft log caused by a loss of quorum. [#27774][#27774]
- Foreign key references in `IMPORT ... PGDUMP` are now processed in the correct order. [#27782][#27782]

<h3 id="v2.1.0-alpha.20180730-performance-improvements">Performance improvements</h3>

- Transactional writes are now pipelined when being replicated and when being written to disk, dramatically reducing the latency of transactions that perform multiple writes. This can be disabled using the new `kv.transaction.write_pipelining_enabled` [cluster setting](../v2.1/cluster-settings.html). [#26599][#26599] {% comment %}doc{% endcomment %}
- Reduced CPU utilization in clusters with many ranges, also during periods of lease rebalancing. [#26910][#26910] [#26907][#26907]
- Reduced the memory size of commonly used Request and Response objects. [#27112][#27112]
- Improved low-level iteration performance. [#27299][#27299]
- Prevented a scenario when dropping a table could cause excessive compaction activity that would degrade performance significantly. [#27353][#27353]
- Limited the scanner from running incessantly on stores with 100s of thousands of replicas. [#27441][#27441]
- Prevented dead nodes in clusters with many ranges from causing unnecessarily high CPU usage. [#26911][#26911]
- Significantly reduce CPU usage when a large number of ranges are deleted from a node. [#27520][#27520]
- Min, max, sum, and avg now take linear time when used for aggregation as window functions for all supported window frame options. [#26988][#26988]
- `CHANGEFEED`s no longer hold all data for each poll in memory at once, increasing scalability. [#27612][#27612] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-alpha.20180730-build-changes">Build changes</h3>

- Upgraded protobuf to 3.6.0 [#26935][#26935]

<h3 id="v2.1.0-alpha.20180730-doc-updates">Doc updates</h3>

- Added a tutorial on [benchmarking CockroachDB with TPC-C](../v2.1/performance-benchmarking-with-tpc-c.html). [#3281][#3281]
- Expanded the [Production Checklist](../v2.1/recommended-production-settings.html#networking) to cover a detailed explanation of network flags and scenarios and updated [production deployment tutorials](../v2.1/manual-deployment.html) to encourage the use of `--advertise-host` on node start. [#3352][#3352]
- Expanded the [Kubernetes tutorials](../v2.1/orchestrate-cockroachdb-with-kubernetes.html) to include setting up monitoring and alerting with Prometheus and Alertmanager. [#3370][#3370]
- Updated the [rolling upgrade tutorial](../v2.1/upgrade-cockroach-version.html) with explicit `systemd` commands. [#3396][#3396]
- Updated the [OpenSSL certificate tutorial](../v2.1/create-security-certificates-openssl.html) to allow multiple node certificates with the same subject. [#3423][#3423]
- Added an example on [editing SQL statements in an external editor from within the built-in SQL shell](../v2.1/use-the-built-in-sql-client.html#edit-sql-statements-in-an-external-editor). [#3425][#3425]

<h3 id="v2.1.0-alpha.20180730-contributors">Contributors</h3>

This release includes 328 merged PRs by 42 authors. We would like to thank the following contributors from the CockroachDB community, with special thanks to first-time contributors Art Nikpal, Ivan Kozik, Tarek Badr, and nexdrew.

- Art Nikpal
- Brett Snyder
- Ivan Kozik
- Nishant Gupta
- Tarek Badr
- neeral
- nexdrew

[#25112]: https://github.com/cockroachdb/cockroach/pull/25112
[#25359]: https://github.com/cockroachdb/cockroach/pull/25359
[#25412]: https://github.com/cockroachdb/cockroach/pull/25412
[#26436]: https://github.com/cockroachdb/cockroach/pull/26436
[#26599]: https://github.com/cockroachdb/cockroach/pull/26599
[#26605]: https://github.com/cockroachdb/cockroach/pull/26605
[#26666]: https://github.com/cockroachdb/cockroach/pull/26666
[#26729]: https://github.com/cockroachdb/cockroach/pull/26729
[#26802]: https://github.com/cockroachdb/cockroach/pull/26802
[#26821]: https://github.com/cockroachdb/cockroach/pull/26821
[#26881]: https://github.com/cockroachdb/cockroach/pull/26881
[#26893]: https://github.com/cockroachdb/cockroach/pull/26893
[#26905]: https://github.com/cockroachdb/cockroach/pull/26905
[#26907]: https://github.com/cockroachdb/cockroach/pull/26907
[#26910]: https://github.com/cockroachdb/cockroach/pull/26910
[#26911]: https://github.com/cockroachdb/cockroach/pull/26911
[#26934]: https://github.com/cockroachdb/cockroach/pull/26934
[#26935]: https://github.com/cockroachdb/cockroach/pull/26935
[#26939]: https://github.com/cockroachdb/cockroach/pull/26939
[#26949]: https://github.com/cockroachdb/cockroach/pull/26949
[#26950]: https://github.com/cockroachdb/cockroach/pull/26950
[#26959]: https://github.com/cockroachdb/cockroach/pull/26959
[#26981]: https://github.com/cockroachdb/cockroach/pull/26981
[#26988]: https://github.com/cockroachdb/cockroach/pull/26988
[#27009]: https://github.com/cockroachdb/cockroach/pull/27009
[#27027]: https://github.com/cockroachdb/cockroach/pull/27027
[#27034]: https://github.com/cockroachdb/cockroach/pull/27034
[#27039]: https://github.com/cockroachdb/cockroach/pull/27039
[#27040]: https://github.com/cockroachdb/cockroach/pull/27040
[#27042]: https://github.com/cockroachdb/cockroach/pull/27042
[#27053]: https://github.com/cockroachdb/cockroach/pull/27053
[#27062]: https://github.com/cockroachdb/cockroach/pull/27062
[#27082]: https://github.com/cockroachdb/cockroach/pull/27082
[#27083]: https://github.com/cockroachdb/cockroach/pull/27083
[#27098]: https://github.com/cockroachdb/cockroach/pull/27098
[#27105]: https://github.com/cockroachdb/cockroach/pull/27105
[#27108]: https://github.com/cockroachdb/cockroach/pull/27108
[#27112]: https://github.com/cockroachdb/cockroach/pull/27112
[#27121]: https://github.com/cockroachdb/cockroach/pull/27121
[#27122]: https://github.com/cockroachdb/cockroach/pull/27122
[#27128]: https://github.com/cockroachdb/cockroach/pull/27128
[#27137]: https://github.com/cockroachdb/cockroach/pull/27137
[#27149]: https://github.com/cockroachdb/cockroach/pull/27149
[#27161]: https://github.com/cockroachdb/cockroach/pull/27161
[#27204]: https://github.com/cockroachdb/cockroach/pull/27204
[#27206]: https://github.com/cockroachdb/cockroach/pull/27206
[#27213]: https://github.com/cockroachdb/cockroach/pull/27213
[#27216]: https://github.com/cockroachdb/cockroach/pull/27216
[#27221]: https://github.com/cockroachdb/cockroach/pull/27221
[#27240]: https://github.com/cockroachdb/cockroach/pull/27240
[#27262]: https://github.com/cockroachdb/cockroach/pull/27262
[#27268]: https://github.com/cockroachdb/cockroach/pull/27268
[#27278]: https://github.com/cockroachdb/cockroach/pull/27278
[#27286]: https://github.com/cockroachdb/cockroach/pull/27286
[#27299]: https://github.com/cockroachdb/cockroach/pull/27299
[#27328]: https://github.com/cockroachdb/cockroach/pull/27328
[#27336]: https://github.com/cockroachdb/cockroach/pull/27336
[#27341]: https://github.com/cockroachdb/cockroach/pull/27341
[#27345]: https://github.com/cockroachdb/cockroach/pull/27345
[#27353]: https://github.com/cockroachdb/cockroach/pull/27353
[#27390]: https://github.com/cockroachdb/cockroach/pull/27390
[#27393]: https://github.com/cockroachdb/cockroach/pull/27393
[#27396]: https://github.com/cockroachdb/cockroach/pull/27396
[#27404]: https://github.com/cockroachdb/cockroach/pull/27404
[#27421]: https://github.com/cockroachdb/cockroach/pull/27421
[#27425]: https://github.com/cockroachdb/cockroach/pull/27425
[#27426]: https://github.com/cockroachdb/cockroach/pull/27426
[#27430]: https://github.com/cockroachdb/cockroach/pull/27430
[#27441]: https://github.com/cockroachdb/cockroach/pull/27441
[#27520]: https://github.com/cockroachdb/cockroach/pull/27520
[#27606]: https://github.com/cockroachdb/cockroach/pull/27606
[#27612]: https://github.com/cockroachdb/cockroach/pull/27612
[#27626]: https://github.com/cockroachdb/cockroach/pull/27626
[#27636]: https://github.com/cockroachdb/cockroach/pull/27636
[#27646]: https://github.com/cockroachdb/cockroach/pull/27646
[#27719]: https://github.com/cockroachdb/cockroach/pull/27719
[#27723]: https://github.com/cockroachdb/cockroach/pull/27723
[#27733]: https://github.com/cockroachdb/cockroach/pull/27733
[#27739]: https://github.com/cockroachdb/cockroach/pull/27739
[#27773]: https://github.com/cockroachdb/cockroach/pull/27773
[#27774]: https://github.com/cockroachdb/cockroach/pull/27774
[#27782]: https://github.com/cockroachdb/cockroach/pull/27782
[#27802]: https://github.com/cockroachdb/cockroach/pull/27802
[#27803]: https://github.com/cockroachdb/cockroach/pull/27803
[#27805]: https://github.com/cockroachdb/cockroach/pull/27805
[#3370]: https://github.com/cockroachdb/docs/pull/3370
[#3385]: https://github.com/cockroachdb/docs/pull/3385
[#3396]: https://github.com/cockroachdb/docs/pull/3396
[#3423]: https://github.com/cockroachdb/docs/pull/3423
[#3352]: https://github.com/cockroachdb/docs/pull/3352
[#3425]: https://github.com/cockroachdb/docs/pull/3425
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

We have now transitioned into the CockroachDB 2.1 Beta phase and will be releasing weekly until the GA release. This week's release includes PostgreSQL compatibility enhancements, general usability improvements, performance improvements, and bug fixes. In addition, we want to highlight a few major benefits:

- **Automatic performance optimizations** - Range leases are now automatically rebalanced throughout the cluster to even out the amount of QPS being handled by each server.
- **Better controls for geo-distributed clusters** - We’ve added more sophisticated support for controlling the network interfaces to use in certain situations, so nodes can prefer local, private IPs for inter-DC communication, and only use public IPs when making hops that must go over the open internet. See the `--locality-advertise-addr` flag of the [`cockroach start`](../v2.1/start-a-node.html) command for more details.

<h3 id="v2.1.0-beta.20180827-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180827.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180827.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180827.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-beta.20180827-backward-incompatible-changes">Backward-incompatible changes</h3>

- Support for PostgreSQL's `TIMETZ` data type has been removed due to incomplete/incorrect implementation. This
feature was available only in previous 2.1 alpha releases. Before upgrading to this release, tables with the `TIMETZ` type must be dropped entirely; it is not possible to convert the data or drop a single `TIMETZ` column. [#28095][#28095] {% comment %}doc{% endcomment %}
- Support for the `BIT` data type has been removed due to incorrect implementation and incompatibility with some client apps. Tables with the `BIT` type will continue to work but will see their type automatically changed to `INT` in the output of `SHOW TABLES`, `information_schema`, etc. This is backward-compatible insofar that the previous `BIT` type in CockroachDB was actually a simple integer. A PostgreSQL-compatible replacement will likely be added at a later time. [#28814][#28814] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-beta.20180827-general-changes">General changes</h3>

- CockroachDB now supports a separate CA (`ca-ui.crt`) and certificate (`ui.crt`) for the Web UI. [#27916][#27916] {% comment %}doc{% endcomment %}
- The ability to set lease placement preferences in [replication zones](../v2.1/configure-replication-zones.html) is now fully supported. Existing lease placement preferences will continue to function as in v2.0. [#28261][#28261] {% comment %}doc{% endcomment %}
- The new `/_admin/v1/enqueue_range` admin server endpoint runs a specified range through a specified internal queue on one or all nodes. The `skip_should_queue` parameter can also be specified to tell the system to blindly run without first checking whether it needs to be run. This endpoint is intended primarily for debugging purposes. [#26554][#26554] {% comment %}doc{% endcomment %}
- If enabled, anonymous [diagnostics reporting](../v2.1/diagnostics-reporting.html) now includes hardware and OS information as well as basic stats about the size of `IMPORT` jobs. [#28676][#28676] [#28726][#28726] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-beta.20180827-enterprise-edition-changes">Enterprise edition changes</h3>

- This release includes several changes to the [Change Data Capture](../v2.1/change-data-capture.html) feature:
    - `CHANGEFEED`s now support interleaved tables [#27991][#27991] {% comment %}doc{% endcomment %}
    - `CREATE CHANGEFEED` now requires an enterprise license when used with Kafka. [#27962][#27962] {% comment %}doc{% endcomment %}
    - `CHANGEFEED`s now produce an error when column families are added (instead of returning incorrect results) and when targeting `system` tables (instead of operating with undefined behavior). [#27962][#27962] {% comment %}doc{% endcomment %}
    - `CREATE CHANGEFEED` is now restricted to superusers. [#27962][#27962] {% comment %}doc{% endcomment %}
    - `CHANGEFEED` job descriptions now substitute values for SQL placeholders. [#28220][#28220] {% comment %}doc{% endcomment %}
    - `CHANGEFEED`s can now only target lists of physical tables. [#27996][#27996] {% comment %}doc{% endcomment %}
    - `CHANGEFEED`s now produce an error when a watched table is truncated, dropped, or renamed. [#28204][#28204] {% comment %}doc{% endcomment %}
    - `CHANGEFEED` Kafka tunings have been adjusted for faster flushes, improving throughput. [#28586][#28586]
    - `CHANGEFEED`s now checkpoint progress more granularly. [#28319][#28319]
    - `CHANGEFEED`s now export metrics for production monitoring. [#28162][#28162] {% comment %}doc{% endcomment %}
    - The `CHANGEFEED` `timestamp` option has been split into `updated` and `resolved`. [#28733][#28733] {% comment %}doc{% endcomment %}
    - `CHANGEFEED`s are now executed using our distributed SQL framework. [#28555][#28555] {% comment %}doc{% endcomment %}
- This release includes the following changes to the [Encryption At Rest](../v2.1/encryption.html) feature:
    - The status of encryption is now written to [debug logs](../v2.1/debug-and-error-logs.html). [#27880][#27880] {% comment %}doc{% endcomment %}
    - Data keys are now rotated while nodes are running. [#28148][#28148] {% comment %}doc{% endcomment %}
    - The new `cockroach debug encryption-status` command displays encryption key information. [#28582][#28582] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-beta.20180827-sql-language-changes">SQL language changes</h3>

- Added foreign key support to [`IMPORT ... MYSQLDUMP`](../v2.1/import.html). [#27861][#27861] {% comment %}doc{% endcomment %}
- The output of [`SHOW GRANTS`](../v2.1/show-grants.html) is now fully sorted. [#27884][#27884] {% comment %}doc{% endcomment %}
- Reads from Google Cloud Storage for [`IMPORT`](../v2.1/import.html) or [`BACKUP`](../v2.1/backup.html) jobs are now more resilient to quota limits. [#27862][#27862]
- The [`ORDER BY INDEX`](../v2.1/query-order.html#sorting-in-index-order) notation now implies an ordering by the implicit primary key columns appended to an index. [#27812][#27812] {% comment %}doc{% endcomment %}
- Added the `server_encoding` [session variable](../v2.1/show-vars.html) and protocol status parameter, for compatibility with PostgreSQL. It is set to `UTF8` and cannot be changed. [#27943][#27943] {% comment %}doc{% endcomment %}
- Extended support of the `extra_float_digits` [session variable](../v2.1/show-vars.html), for compatibility with PostgreSQL. [#27952][#27952] {% comment %}doc{% endcomment %}
- Improved the handling of [`SET`](../v2.1/set-vars.html), [`RESET`](../v2.1/reset-vars.html) and [`SHOW`](../v2.1/show-vars.html), for better compatibility with PostgreSQL. [#27947][#27947] {% comment %}doc{% endcomment %}
- Exposed the `integer_datetimes` session variable in `SHOW` and `pg_settings`, for compatibility with PostgreSQL. [#27947][#27947] {% comment %}doc{% endcomment %}
- The default values of the `client_min_messages` and `extra_float_digits` [session variables](../v2.1/show-vars.html) now match PostgreSQL. [#27947][#27947] {% comment %}doc{% endcomment %}
- Corrected the `oids` and formatting of some columns in the `pg_catalog.pg_index` table. [#27961][#27961]
- The distribution of queries that use the `repeat()` [built-in function](../v2.1/functions-and-operators.html) are now permitted. [#28039][#28039]
- Statement statistics are now grouped separately for queries using the [cost-based optimizer](../v2.1/cost-based-optimizer.html) and heuristic planner. [#27806][#27806]
- CockroachDB now supports empty tuples with the syntax `()`, 1-valued tuples with the syntax `(x,)` in addition to `row(x)`, and the ability to use `IN` with an empty tuple as right operand. This is a CockroachDB extension. [#28143][#28143] {% comment %}doc{% endcomment %}
- CockroachDB now supports constructing array values using parentheses, for example `ARRAY(1,2,3,4)`. This is a CockroachDB extension; the standard PostgreSQL syntax `ARRAY[1,2,3,4]` remains supported. [#28238][#28238] {% comment %}doc{% endcomment %}
- CockroachDB now supports converting arrays and tuples to strings, for compatibility with PostgreSQL. [#28183][#28183] {% comment %}doc{% endcomment %}
- `ANY`/`ALL`/`SOME` comparisons are now more permissive about the types of their input expressions, and comparisons with empty tuples are now allowed. [#28226][#28226]
- Improved the handling of decimal 0s. Specifically, -0 is coerced to 0 and values like 0.00 retain the digits after the decimal point. [#27978][#27978]
- Arrays of arrays are no longer allowed, even as intermediate results. [#28116][#28116]
- [`IMPORT ... PGDUMP`](../v2.1/import.html) now supports CockroachDB dump files. [#28359][#28359] {% comment %}doc{% endcomment %}
- The decimal variants of the `ceil()` and `ceiling()` functions now return 0 where they would have returned -0 previously. [#28366][#28366]
- Improved support for S3-compatible endpoints in [`BACKUP`](../v2.1/backup.html), [`RESTORE`](../v2.1/restore.html), and [`IMPORT`](../v2.1/import.html). The `AWS_REGION` parameter is no longer required. Services like Digital Ocean Spaces and Minio now work correctly. [#28394][#28394] {% comment %}doc{% endcomment %}
- CockroachDB now supports an optional `FILTER` clause with aggregates when used as [window functions](../v2.1/window-functions.html). [#28357][#28357]
- Normalized the case of table names imported via [`IMPORT ... MYSQLDUMP`](../v2.1/import.html). [#28397][#28397] {% comment %}doc{% endcomment %}
- All queries now run through the DistSQL execution engine. [#27863][#27863]
- It is now an error to specify both `FORCE_INDEX` and `NO_INDEX_JOIN` hints at the same time. [#28411][#28411]
- Added `numeric_precision_radix` to the `information_schema.columns` table. [#28467][#28467] {% comment %}doc{% endcomment %}
- Added the `schemachanger.lease.duration` and `schemachanger.lease.renew_fraction` [cluster settings](../v2.1/cluster-settings.html) to control the schema change lease. [#28342][#28342] {% comment %}doc{% endcomment %}
- Added the `string_agg()` aggregation function, which concats a collection of strings into a single string and separates them with a specified delimiter. [#28392][#28392] {% comment %}doc{% endcomment %}
- CockroachDB now fully supports the `RANGE` mode for specification of [window function frames](../v2.1/window-functions.html). [#27022][#27022] {% comment %}doc{% endcomment %}
- CockroachDB now supports the `GROUPS` mode for specification of [window function frames](../v2.1/window-functions.html). [#28244][#28244] {% comment %}doc{% endcomment %}
- CockroachDB now supports the `ARRAY()` operator and comparisons with sub-queries on the right side of the comparison, when they appear themselves in sub-queries. [#28618][#28618]
- CockroachDB now supports two experimental compatibility modes with how PostgreSQL handles [`SERIAL`](../v2.1/serial.html) and [sequences](../v2.1/create-sequence.html), to ease reuse of 3rd party frameworks or apps developed for PostgreSQL. These modes can be enabled with the `experimental_serial_normalization` session variable (per client) and `sql.defaults.serial_normalization` cluster setting (cluster-wide). The first mode, `virtual_sequence`, enables compatibility with many applications using `SERIAL` with maximum performance and scalability. The second mode, `sql_sequence`, enables maximum PostgreSQL compatibility but uses regular SQL sequences and is thus subject to performance constraints. [#28575][#28575] {% comment %}doc{% endcomment %}
- The output of [`SHOW COLUMNS`](../v2.1/show-columns.html) now indicates which columns are hidden. [#28750][#28750] {% comment %}doc{% endcomment %}
- [`SHOW CREATE`](../v2.1/show-create.html) now reports the `FLOAT` column types as `FLOAT4` and `FLOAT8` (the default) instead of `REAL` and `FLOAT`. [#28776][#28776]

<h3 id="v2.1.0-beta.20180827-command-line-changes">Command-line changes</h3>

- This release includes the following changes to the [`cockroach start`](../v2.1/start-a-node.html) command:
    - The new `--listen-addr` flag recognizes both a hostname/address and port and replaces the `--host` and `--port` flags, which are now deprecated for `cockroach start` but remain valid for other *client* commands. The port portion of `--listen-addr` can be either a service name or numeric value; when specified as `0`, a port number is automatically allocated. [#27800][#27800] [#28373][#28373] [#28502][#28502] {% comment %}doc{% endcomment %}
    - The new `--advertise-addr` flag recognizes both a hostname/address and port and replaces the `--advertise-host` and `--advertise-port` flags, which are now deprecated.  The port portion of `--advertise-addr` can be either a service name or numeric value; when specified as `0`, a port number is automatically allocated. [#27800][#27800] [#28373][#28373] [#28502][#28502] {% comment %}doc{% endcomment %}
    - The new `--http-addr` flag recognizes both a hostname/address and port and replaces the `--http-host` flag, which is now deprecated. The port portion of `--http-addr` can be either a service name or numeric value; when specified as `0`, a port number is automatically allocated. [#28373][#28373] [#28502][#28502] {% comment %}doc{% endcomment %}
    - The new `--locality-advertise-addr` flag can be used advertise a hostname/address and port to other CockroachDB nodes for specific [localities](../v2.1/start-a-node.html#locality). This is useful in deployments with "local" or "private" interfaces that are only accessible by a subset of the nodes and "global" or "public" interfaces that are slower or more expensive but accessible by any node. In such cases, `--locality-advertise-addr` can be used to route traffic over the local interface whenever possible. [#28531][#28531]
    - The command now reports the URL of the web UI with the prefix "`webui:`", not `admin:`. [#28038][#28038] {% comment %}doc{% endcomment %}
    - The command now reports a warning if more than 75% of available RAM is reserved by `--cache` and `--max-sql-memory`. [#28199][#28199] {% comment %}doc{% endcomment %}
    - The command now suggests which command-line flags to use to access the newly started node in client commands (e.g., `cockroach quit`, etc.). [#28198][#28198] [`cockroach start`](../v2.1/start-a-node.html) {% comment %}doc{% endcomment %}
- This release includes the following changes to `cockroach` client commands:
    - Client commands now better attempt to inform the user about why a connection is failing. [#28200][#28200] {% comment %}doc{% endcomment %}
    - Client commands that print out SQL results now issue a warning if more than 10000 result rows are buffered in the `table` formatter. [#28490][#28490]
    - Client commands that use a SQL connection (e.g., `cockroach sql`, `cockroach node`, `cockroach user`) now produce an error if a connection could not be established within 5 seconds instead of waiting forever.  [#28326][#28326] {% comment %}doc{% endcomment %}
    - The [`cockroach sql`](../v2.1/use-the-built-in-sql-client.html) command and other client commands that display SQL results now use the new `table` result formatter by default, replacing the previous formatter called `pretty`. This provides more compact and more reusable results. [#28465][#28465] {% comment %}doc{% endcomment %}
    - The [`cockroach sql`](../v2.1/use-the-built-in-sql-client.html) command and other client commands that display SQL results containing byte arrays now print them as if they were converted by a SQL cast to the `STRING` type. [#28494][#28494] {% comment %}doc{% endcomment %}
    - The `--host` flag and `COCKROACH_HOST` environment variable for client commands now recognize both a hostname/address and port number. The `--port` flag is still recognized but no longer documented; `--host` is now preferred. The `COCKROACH_PORT` environment variable is now deprecated in favor of `COCKROACH_HOST`. Also, the syntax to specify IPv6 addresses has been changed to use square brackets, for example, `--host=[::1]` instead of just `--host=::1`; the previous syntax is still recognized for backward compatibility but is deprecated. [#28373][#28373] {% comment %}doc{% endcomment %}
- The new `timeseries.storage.10s_resolution_ttl` and `timeseries.storage.30m_resolution_ttl` [cluster settings](../v2.1/cluster-settings.html) control how long time series data is retained on the cluster. They work with the recently added "roll-ups" to allow longer retention of time series data while consuming considerably less disk space. [#28169][#28169] {% comment %}doc{% endcomment %}    
- The [`cockroach demo`](../v2.1/cockroach-demo.html) command now supports starting with one of various datasets loaded. [#28383][#28383] {% comment %}doc{% endcomment %}
- The file generated by running `cockroach debug zip` now contains the contents of the `system.rangelog` table, which is a record of range splits and rebalances in the cluster. The problem ranges report is now included as well. [#28396][#28396] [#28253][#28253] {% comment %}doc{% endcomment %}
- The `cockroach node status` command now works on unavailable/broken clusters. [#28249][#28249] {% comment %}doc{% endcomment %}
- CockroachDB now reports a non-zero exit status if an attempt is made to use a non-existent command. [#28492][#28492]
- CockroachDB now attempts to inform the operator if the names and IP addresses listed in the configured certificates do not match the server configuration. [#28502][#28502] {% comment %}doc{% endcomment %}
- Added a locality filter for the `cockroach gen haproxy` command [#28649][#28649] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-beta.20180827-web-ui-changes">Web UI changes</h3>

- Added disk read and write time charts to the [**Hardware** dashboard](../v2.1/admin-ui-hardware-dashboard.html). [#27977][#27977] [#28594][#28594] {% comment %}doc{% endcomment %}
- The [**Hardware** dashboard](../v2.1/admin-ui-hardware-dashboard.html) now shows system and user CPU summed instead of separately, and normalized by number of CPUs. [#28596][#28596] {% comment %}doc{% endcomment %}
- Added a link to the [**Statements** page](../v2.1/admin-ui-statements-page.html) from the sidebar. [#27928][#27928] {% comment %}doc{% endcomment %}
- The [**Statements** page](../v2.1/admin-ui-statements-page.html) now reveals whether a SQL query used the new cost-based optimizer. [#28094][#28094] {% comment %}doc{% endcomment %}
- Added the number of CPUs and percentages of memory and disk usage to the [**Node List**](../v2.1/admin-ui-overview-dashboard.html). [#28189][#28189] {% comment %}doc{% endcomment %}
- Removed "distsql reads" time series from the [**SQL** dashboard](../v2.1/admin-ui-sql-dashboard.html), since execution engines are being merged. [#28350][#28350] {% comment %}doc{% endcomment %}
- The **Problem Ranges** report now shows the number of replicas that have an excessively large log. [#28034][#28034] {% comment %}doc{% endcomment %}
- The **Stores** report now shows encryption statistics. [#26890][#26890] {% comment %}doc{% endcomment %}
- Login is now required by default on secure clusters. [#28416][#28416] {% comment %}doc{% endcomment %}
- Enlarged the clickable area on dropdown components to include entirety of the surrounding container. [#28331][#28331]
- The [**Jobs** page](../v2.1/admin-ui-jobs-page.html) now supports indefinitely-running job types that have a "highwater timestamp", instead of the "fraction completed" used by jobs with a finite task. [#28535][#28535] {% comment %}doc{% endcomment %}
- Improved the alert text that is displayed when the Web UI connection is lost. [#28838][#28838]

<h3 id="v2.1.0-beta.20180827-bug-fixes">Bug fixes</h3>

- Fixed a bug where the [**Statements** page](../v2.1/admin-ui-statements-page.html) in the Web UI blanked out after reloading itself. [#28108][#28108]
- CockroachDB no longer erroneously allows generator functions, aggregates, and window functions in the `ON` clause of joins. [#28839][#28839]
- Fixed an `index-id does not exist` error that could happen on [`ADD COLUMN`](../v2.1/add-column.html) or [`DROP COLUMN`](../v2.1/drop-column.html). [#28803][#28803]
- Fixed row counts in the output of [`IMPORT`](../v2.1/import.html). [#28469][#28469] {% comment %}doc{% endcomment %}
- Fixed various problems related to the rollback of [schema changes](../v2.1/online-schema-changes.html).[#28014][#28014] [#28050][#28050]
- Prevented a node from freezing after `DROP DATABASE` when the command aborts, and fixed the rare use of an older descriptor after [`DROP INDEX`](../v2.1/drop-index.html). [#28381][#28381]
- Fixed the handling of regular aggregations combined with window functions and columns "as-is". [#27897][#27897]
- Fixed a panic caused by key-value tracing a plan that uses an index joiner. [#27942][#27942]
- The `bytea_output` [session variable](../v2.1/set-vars.html) is now properly effective for distributed queries. [#27951][#27951]
- Limited the size of "batch groups" when committing a batch to RocksDB to avoid rare scenarios in which multi-gigabyte batch groups are created, which can cause a server to run out of memory when replaying the RocksDB log at startup. [#27895][#27895]
- Fixed the round-tripping of cast expression formatting in the presence of [collated strings](../v2.1/collate.html). [#27941][#27941]
- Prevented spurious query errors when planning some complex correlated SRFs through the distributed execution engine. [#27995][#27995]
- Fixed the handling of frame boundary offsets in `WINDOW` clauses. [#27933][#27933]
- Fixed the formatting of time datatypes in some circumstances. [#28040][#28040]
- Fixed the behavior of `crdb_internal.cluster_id()` in distributed queries. [#28042][#28042]
- Fixed incorrect `NULL` handling in the distributed implementations of `INTERSECT` and `EXCEPT`. [#28097][#28097]
- Corrected erroneous failures of privileged built-ins in queries run through the distributed execution engine. [#28107][#28107]
- Ensured that the [`TIMESTAMP`](../v2.1/timestamp.html) data type never retains a timezone and renders consistently across a distributed computation flow. [#28112][#28112]
- Corrected casts and binary operators between `TIMESTAMPTZ` and `TIMESTAMP` in some cases. [#28128][#28128]
- Prevented some [sequence built-ins](../v2.1/functions-and-operators.html#sequence-functions) from incorrectly running in distributed flows. [#28114][#28114]
- Corrected the round-trip formatting of negative floats and decimals in the context of other expressions when executing in a distributed flow. [#28129][#28129]
- Fixed bug that could skip the row following a deleted row during [`BACKUP`](../v2.1/backup.html). [#28172][#28172]
- The [`cockroach user set --password`](../v2.1/create-and-manage-users.html) command can now change the password of existing users. [#28197][#28197] {% comment %}doc{% endcomment %}
- CockroachDB now supports a wider range of tuple and array values in query results. [#28151][#28151]
- This release includes the following fixes to the [`cockroach sql`](../v2.1/use-the-built-in-sql-client.html) and [`cockroach demo`](../v2.1/cockroach-demo.html) command:
    - The commands are now properly able to customize the prompt with `~/.editrc` on Linux. [#28233][#28233] {% comment %}doc{% endcomment %}
    - The commands once again support copy-pasting special unicode character from other documents. [#28233][#28233] {% comment %}doc{% endcomment %}
    - The commands once again properly handle copy-pasting a mixture of client-side commands (e.g., `set`) and SQL statements. [#28235][#28235]
    - The commands now properly print a warning when a `?` character is mistakenly used to receive contextual help in a non-interactive session, instead of crashing. [#28324][#28324]
    - The commands now work properly even when the `TERM` environment variable is not set. [#28613][#28613]
- Generator built-ins now correctly return no rows instead of `NULL` when given `NULL` arguments. [#28252][#28252]
- Fixed out-of-memory errors caused by very large raft logs. [#28293][#28293] [#28511][#28511]
- Certain queries that use empty arrays constructed from subqueries no longer spuriously fail when executed via the distributed execution engine. [#28391][#28391]
- `SHOW JOBS` now uses placeholder values for `BACKUP` and `RESTORE` job descriptions. [#28321][#28321]
- CockroachDB now handles negative `FLOAT` zeros properly in more cases. [#28569][#28569]
- CockroachDB now correctly handles computation of `array_agg()` when used as a [window function](../v2.1/window-functions.html). [#28291][#28291]
- [Decommissioning multiple nodes](../v2.1/remove-nodes.html) is now possible without posing a risk to cluster health. Recommissioning a node no longer requires a restart of the target node to take effect. [#28707][#28707] {% comment %}doc{% endcomment %}
- Fixed a rare scenario where the value written for one system key was seen when another system key was read, leading to the violation of internal invariants. [#28794][#28794]
- Hidden columns are now listed in `information_schema` and `pg_catalog` tables, for better compatibility with PostgreSQL. [#28750][#28750] {% comment %}doc{% endcomment %}
- Casting arrays now correctly preserves `NULL` values. [#28860][#28860]
- `IMPORT` no longer silently converts `rn` characters in CSV files into `n`. [#28181][#28181]
- Fixed initial poor latencies introduced in a recent release. [#28599][#28599]

<h3 id="v2.1.0-beta.20180827-performance-improvements">Performance improvements</h3>

- CockroachDB now periodically refreshes table leases to avoid initial latency on tables that have not been accessed recently. [#28725][#28725] {% comment %}doc{% endcomment %}
- Improved the fixed cost of running distributed sql queries. [#27899][#27899]
- Prevent large buffer allocation for DML statements with `RETURNING` clauses. [#27944][#27944]
- Improved low-level iteration performance in the presence of range tombstones. [#27904][#27904]
- Data ingested with `RESTORE` and `IMPORT` is now eligible for a performance optimization used in incremental `BACKUP` and `CHANGEFEED`s. [#27966][#27966]
- Reduced lock contention in `RemoteClockMonitor`. [#28000][#28000]
- Reduced lock contention in the Replica write path. [#24990][#24990]
- Reduced lock contention in the Gossip server. [#28001][#28001] [#28127][#28127]
- Reduced lock contention and avoided allocations in `raftEntryCache`. [#27997][#27997]
- Fixed a batch commit performance regression that reduced write performance by 20%. [#28163][#28163]
- Greatly improved the performance of catching up followers that are behind when Raft logs are large. [#28511][#28511]
- Slightly improved the performance of the `nextval()` [sequence function](../v2.1/functions-and-operators.html#sequence-functions). [#28576][#28576]
- Reduced the cost of Raft log truncations and increased single-range throughput. [#28126][#28126]
- Subqueries are now run through the distributed execution engine. [#28580][#28580]
- Range leases are now automatically rebalanced throughout the cluster to even out the amount of QPS being handled by each node. [#28340][#28340] {% comment %}doc{% endcomment %}
- Greatly improved the performance of deleting from interleaved tables that have `ON DELETE CASCADE` clauses. [#28330][#28330]

<h3 id="v2.1.0-beta.20180827-doc-updates">Doc updates</h3>

- Added a tutorial on [orchestrating CockroachDB across multiple Kubernetes clusters in different regions](../v2.1/orchestrate-cockroachdb-with-kubernetes-multi-cluster.html). [#3558](https://github.com/cockroachdb/docs/pull/3558)
- Expanded the [Build an App](../v2.1/build-an-app-with-cockroachdb.html) tutorials for most languages to offer instructions and code samples for secure clusters. [#3557](https://github.com/cockroachdb/docs/pull/3557)
- Significantly expanded the documentation on [Window Functions](../v2.1/window-functions.html). [#3426](https://github.com/cockroachdb/docs/pull/3426)
- Added a conceptual explanation of [Online Schema Changes](../v2.1/online-schema-changes.html), with examples and current limitations. [#3492](https://github.com/cockroachdb/docs/pull/3492)
- Streamlined instructions for essential [enterprise and core backup and restore tasks](../v2.1/backup-and-restore.html), including a bash script for automated backups. [#3489](https://github.com/cockroachdb/docs/pull/3489)
- Expanded the [TPC-C Performance Benchmarking](../v2.1/performance-benchmarking-with-tpc-c.html) tutorial to cover benchmarking large clusters. [#3281][#3281]
- Documented the `skip` option for [`IMPORT`](../v2.1/import.html) as well as support for decompressing input files. [#3510](https://github.com/cockroachdb/docs/pull/3510)
- Documented the `ANALYZE`, `OPT`, and `DISTSQL` option for [`EXPLAIN`](../v2.1/explain.html). [#3427](https://github.com/cockroachdb/docs/pull/3427)
- Documented how to [add a computed column to an existing table](../v2.1/computed-columns.html#add-a-computed-column-to-an-existing-table) and [convert a computed column into a regular column](../v2.1/computed-columns.html#convert-a-computed-column-into-a-regular-column). [#3501](https://github.com/cockroachdb/docs/pull/3501) [#3538](https://github.com/cockroachdb/docs/pull/3538)
- Documented the abbreviated PostgreSQL [`INTERVAL`](../v2.1/interval.html) format. [#3503](https://github.com/cockroachdb/docs/pull/3503)
- Documented the `auto_trace` [session variable](../v2.1/set-vars.html), which replaces the `SHOW TRACE` statement. [#3508](https://github.com/cockroachdb/docs/pull/3508)
- Various updates to the [Information Schema](../v2.1/information-schema.html) documentation. [#3531](https://github.com/cockroachdb/docs/pull/3531)
- Documented the new [default databases](../v2.1/show-databases.html#default-databases). [#3506](https://github.com/cockroachdb/docs/pull/3506)
- Cleaned up the output of all `SHOW` statements; combined the `SHOW CREATE TABLE`, `SHOW CREATE VIEW`, and `SHOW CREATE SEQUENCE` pages into a single [`SHOW
CREATE`](../v2.1/show-create.html) page; and removed the experimental status from [`SHOW CONSTRAINTS`](../v2.1/show-constraints.html). [#3523](https://github.com/cockroachdb/docs/pull/3523)
- Documented the [`cockroach demo`](../v2.1/cockroach-demo.html) command. [#3509](https://github.com/cockroachdb/docs/pull/3509)
- Various updates to the [`cockroach sql`](../v2.1/use-the-built-in-sql-client.html) documentation. [#3499](https://github.com/cockroachdb/docs/pull/3499)

<h3 id="v2.1.0-beta.20180827-contributors">Contributors</h3>

This release includes 493 merged PRs by 39 authors.
We would like to thank the following contributors from the CockroachDB community:

- Constantine Peresypkin
- Garvit Juniwal
- Joseph Lowinske (first-time contributor, CockroachDB team member)
- Song Hao
- Takuya Kuwahara
- Tim O'Brien (first-time contributor, CockroachDB team member)
- neeral

[#24990]: https://github.com/cockroachdb/cockroach/pull/24990
[#26554]: https://github.com/cockroachdb/cockroach/pull/26554
[#26806]: https://github.com/cockroachdb/cockroach/pull/26806
[#26890]: https://github.com/cockroachdb/cockroach/pull/26890
[#27022]: https://github.com/cockroachdb/cockroach/pull/27022
[#27752]: https://github.com/cockroachdb/cockroach/pull/27752
[#27800]: https://github.com/cockroachdb/cockroach/pull/27800
[#27806]: https://github.com/cockroachdb/cockroach/pull/27806
[#27812]: https://github.com/cockroachdb/cockroach/pull/27812
[#27829]: https://github.com/cockroachdb/cockroach/pull/27829
[#27861]: https://github.com/cockroachdb/cockroach/pull/27861
[#27862]: https://github.com/cockroachdb/cockroach/pull/27862
[#27863]: https://github.com/cockroachdb/cockroach/pull/27863
[#27880]: https://github.com/cockroachdb/cockroach/pull/27880
[#27884]: https://github.com/cockroachdb/cockroach/pull/27884
[#27895]: https://github.com/cockroachdb/cockroach/pull/27895
[#27897]: https://github.com/cockroachdb/cockroach/pull/27897
[#27899]: https://github.com/cockroachdb/cockroach/pull/27899
[#27904]: https://github.com/cockroachdb/cockroach/pull/27904
[#27916]: https://github.com/cockroachdb/cockroach/pull/27916
[#27928]: https://github.com/cockroachdb/cockroach/pull/27928
[#27933]: https://github.com/cockroachdb/cockroach/pull/27933
[#27941]: https://github.com/cockroachdb/cockroach/pull/27941
[#27942]: https://github.com/cockroachdb/cockroach/pull/27942
[#27943]: https://github.com/cockroachdb/cockroach/pull/27943
[#27944]: https://github.com/cockroachdb/cockroach/pull/27944
[#27947]: https://github.com/cockroachdb/cockroach/pull/27947
[#27951]: https://github.com/cockroachdb/cockroach/pull/27951
[#27952]: https://github.com/cockroachdb/cockroach/pull/27952
[#27959]: https://github.com/cockroachdb/cockroach/pull/27959
[#27961]: https://github.com/cockroachdb/cockroach/pull/27961
[#27962]: https://github.com/cockroachdb/cockroach/pull/27962
[#27966]: https://github.com/cockroachdb/cockroach/pull/27966
[#27977]: https://github.com/cockroachdb/cockroach/pull/27977
[#27978]: https://github.com/cockroachdb/cockroach/pull/27978
[#27991]: https://github.com/cockroachdb/cockroach/pull/27991
[#27995]: https://github.com/cockroachdb/cockroach/pull/27995
[#27996]: https://github.com/cockroachdb/cockroach/pull/27996
[#27997]: https://github.com/cockroachdb/cockroach/pull/27997
[#28000]: https://github.com/cockroachdb/cockroach/pull/28000
[#28001]: https://github.com/cockroachdb/cockroach/pull/28001
[#28007]: https://github.com/cockroachdb/cockroach/pull/28007
[#28014]: https://github.com/cockroachdb/cockroach/pull/28014
[#28034]: https://github.com/cockroachdb/cockroach/pull/28034
[#28038]: https://github.com/cockroachdb/cockroach/pull/28038
[#28039]: https://github.com/cockroachdb/cockroach/pull/28039
[#28040]: https://github.com/cockroachdb/cockroach/pull/28040
[#28042]: https://github.com/cockroachdb/cockroach/pull/28042
[#28050]: https://github.com/cockroachdb/cockroach/pull/28050
[#28085]: https://github.com/cockroachdb/cockroach/pull/28085
[#28094]: https://github.com/cockroachdb/cockroach/pull/28094
[#28095]: https://github.com/cockroachdb/cockroach/pull/28095
[#28097]: https://github.com/cockroachdb/cockroach/pull/28097
[#28107]: https://github.com/cockroachdb/cockroach/pull/28107
[#28108]: https://github.com/cockroachdb/cockroach/pull/28108
[#28112]: https://github.com/cockroachdb/cockroach/pull/28112
[#28114]: https://github.com/cockroachdb/cockroach/pull/28114
[#28116]: https://github.com/cockroachdb/cockroach/pull/28116
[#28126]: https://github.com/cockroachdb/cockroach/pull/28126
[#28127]: https://github.com/cockroachdb/cockroach/pull/28127
[#28128]: https://github.com/cockroachdb/cockroach/pull/28128
[#28129]: https://github.com/cockroachdb/cockroach/pull/28129
[#28143]: https://github.com/cockroachdb/cockroach/pull/28143
[#28148]: https://github.com/cockroachdb/cockroach/pull/28148
[#28151]: https://github.com/cockroachdb/cockroach/pull/28151
[#28159]: https://github.com/cockroachdb/cockroach/pull/28159
[#28162]: https://github.com/cockroachdb/cockroach/pull/28162
[#28163]: https://github.com/cockroachdb/cockroach/pull/28163
[#28169]: https://github.com/cockroachdb/cockroach/pull/28169
[#28172]: https://github.com/cockroachdb/cockroach/pull/28172
[#28181]: https://github.com/cockroachdb/cockroach/pull/28181
[#28183]: https://github.com/cockroachdb/cockroach/pull/28183
[#28189]: https://github.com/cockroachdb/cockroach/pull/28189
[#28197]: https://github.com/cockroachdb/cockroach/pull/28197
[#28198]: https://github.com/cockroachdb/cockroach/pull/28198
[#28199]: https://github.com/cockroachdb/cockroach/pull/28199
[#28200]: https://github.com/cockroachdb/cockroach/pull/28200
[#28204]: https://github.com/cockroachdb/cockroach/pull/28204
[#28220]: https://github.com/cockroachdb/cockroach/pull/28220
[#28226]: https://github.com/cockroachdb/cockroach/pull/28226
[#28233]: https://github.com/cockroachdb/cockroach/pull/28233
[#28235]: https://github.com/cockroachdb/cockroach/pull/28235
[#28238]: https://github.com/cockroachdb/cockroach/pull/28238
[#28244]: https://github.com/cockroachdb/cockroach/pull/28244
[#28249]: https://github.com/cockroachdb/cockroach/pull/28249
[#28252]: https://github.com/cockroachdb/cockroach/pull/28252
[#28253]: https://github.com/cockroachdb/cockroach/pull/28253
[#28261]: https://github.com/cockroachdb/cockroach/pull/28261
[#28291]: https://github.com/cockroachdb/cockroach/pull/28291
[#28293]: https://github.com/cockroachdb/cockroach/pull/28293
[#28319]: https://github.com/cockroachdb/cockroach/pull/28319
[#28321]: https://github.com/cockroachdb/cockroach/pull/28321
[#28324]: https://github.com/cockroachdb/cockroach/pull/28324
[#28326]: https://github.com/cockroachdb/cockroach/pull/28326
[#28330]: https://github.com/cockroachdb/cockroach/pull/28330
[#28331]: https://github.com/cockroachdb/cockroach/pull/28331
[#28340]: https://github.com/cockroachdb/cockroach/pull/28340
[#28342]: https://github.com/cockroachdb/cockroach/pull/28342
[#28350]: https://github.com/cockroachdb/cockroach/pull/28350
[#28357]: https://github.com/cockroachdb/cockroach/pull/28357
[#28359]: https://github.com/cockroachdb/cockroach/pull/28359
[#28366]: https://github.com/cockroachdb/cockroach/pull/28366
[#28373]: https://github.com/cockroachdb/cockroach/pull/28373
[#28381]: https://github.com/cockroachdb/cockroach/pull/28381
[#28383]: https://github.com/cockroachdb/cockroach/pull/28383
[#28391]: https://github.com/cockroachdb/cockroach/pull/28391
[#28392]: https://github.com/cockroachdb/cockroach/pull/28392
[#28394]: https://github.com/cockroachdb/cockroach/pull/28394
[#28396]: https://github.com/cockroachdb/cockroach/pull/28396
[#28397]: https://github.com/cockroachdb/cockroach/pull/28397
[#28411]: https://github.com/cockroachdb/cockroach/pull/28411
[#28416]: https://github.com/cockroachdb/cockroach/pull/28416
[#28465]: https://github.com/cockroachdb/cockroach/pull/28465
[#28467]: https://github.com/cockroachdb/cockroach/pull/28467
[#28469]: https://github.com/cockroachdb/cockroach/pull/28469
[#28490]: https://github.com/cockroachdb/cockroach/pull/28490
[#28492]: https://github.com/cockroachdb/cockroach/pull/28492
[#28494]: https://github.com/cockroachdb/cockroach/pull/28494
[#28502]: https://github.com/cockroachdb/cockroach/pull/28502
[#28511]: https://github.com/cockroachdb/cockroach/pull/28511
[#28514]: https://github.com/cockroachdb/cockroach/pull/28514
[#28531]: https://github.com/cockroachdb/cockroach/pull/28531
[#28533]: https://github.com/cockroachdb/cockroach/pull/28533
[#28535]: https://github.com/cockroachdb/cockroach/pull/28535
[#28555]: https://github.com/cockroachdb/cockroach/pull/28555
[#28569]: https://github.com/cockroachdb/cockroach/pull/28569
[#28575]: https://github.com/cockroachdb/cockroach/pull/28575
[#28576]: https://github.com/cockroachdb/cockroach/pull/28576
[#28580]: https://github.com/cockroachdb/cockroach/pull/28580
[#28582]: https://github.com/cockroachdb/cockroach/pull/28582
[#28586]: https://github.com/cockroachdb/cockroach/pull/28586
[#28594]: https://github.com/cockroachdb/cockroach/pull/28594
[#28596]: https://github.com/cockroachdb/cockroach/pull/28596
[#28599]: https://github.com/cockroachdb/cockroach/pull/28599
[#28613]: https://github.com/cockroachdb/cockroach/pull/28613
[#28618]: https://github.com/cockroachdb/cockroach/pull/28618
[#28632]: https://github.com/cockroachdb/cockroach/pull/28632
[#28649]: https://github.com/cockroachdb/cockroach/pull/28649
[#28676]: https://github.com/cockroachdb/cockroach/pull/28676
[#28707]: https://github.com/cockroachdb/cockroach/pull/28707
[#28725]: https://github.com/cockroachdb/cockroach/pull/28725
[#28726]: https://github.com/cockroachdb/cockroach/pull/28726
[#28733]: https://github.com/cockroachdb/cockroach/pull/28733
[#28750]: https://github.com/cockroachdb/cockroach/pull/28750
[#28776]: https://github.com/cockroachdb/cockroach/pull/28776
[#28794]: https://github.com/cockroachdb/cockroach/pull/28794
[#28803]: https://github.com/cockroachdb/cockroach/pull/28803
[#28814]: https://github.com/cockroachdb/cockroach/pull/28814
[#28838]: https://github.com/cockroachdb/cockroach/pull/28838
[#28839]: https://github.com/cockroachdb/cockroach/pull/28839
[#28856]: https://github.com/cockroachdb/cockroach/pull/28856
[#28860]: https://github.com/cockroachdb/cockroach/pull/28860
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.0-beta.20180904-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180904.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180904.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180904.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-beta.20180904-enterprise-edition-changes">Enterprise edition changes</h3>

- Added additional monitoring metrics for [`CHANGEFEED`s](../v2.1/create-changefeed.html). [#28923][#28923]

<h3 id="v2.1.0-beta.20180904-sql-language-changes">SQL language changes</h3>

- CockroachDB now hides more information from the statement statistics in [diagnostics reporting](../v2.1/diagnostics-reporting.html). [#28906][#28906] {% comment %}doc{% endcomment %}
- CockroachDB now preserves the distinction between different column types for string values like in PostgreSQL, for compatibility with 3rd party tools and ORMs. [#29006][#29006] {% comment %}doc{% endcomment %}
- The [`SET CLUSTER SETTING`](../v2.1/set-cluster-setting.html) statement can no longer be used inside a [transaction](../v2.1/transactions.html). It also now attempts to wait until the change has been gossiped before allowing subsequent statements. [#29082][#29082] {% comment %}doc{% endcomment %}
- The [`ALTER TABLE ... SPLIT AT`](../v2.1/split-at.html) statement now produces an error if executed while the merge queue is enabled, as the merge queue is likely to immediately discard any splits created by the statement. [#29082][#29082] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-beta.20180904-command-line-changes">Command-line changes</h3>

- Improved the error message printed when [`cockroach quit`](../v2.1/stop-a-node.html) is run on a node that has not yet been initialized. [#29152][#29152]
- The [`cockroach start`](../v2.1/start-a-node.html) command now emits the PID of the server process to the file specified by the `--pid-file` flag as soon as it is ready to accept network connections but possibly before it is done bootstrapping (i.e., before [`cockroach init`](../v2.1/initialize-a-cluster.html) completes). To wait for SQL readiness, use the `--listen-url-file` flag instead. [#29160][#29160] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-beta.20180904-bug-fixes">Bug fixes</h3>

- CockroachDB now populates the `data_type` column of `information_schema.columns` like PostgreSQL, for compatibility with 3rd party tools and ORMs. [#29006][#29006] {% comment %}doc{% endcomment %}
- The [`cockroach dump`](../v2.1/sql-dump.html) command can once again operate across multiple CockroachDB versions. [#29006][#29006]
- CockroachDB now distinguishes `CHAR` and `VARCHAR`, as mandated by the SQL standard and PostgreSQL compatibility. When a width is not specified (e.g., `CHAR(3)`), the maximum width of `VARCHAR` remains unconstrained whereas the maximum width of `CHAR` is 1 character. [#29006][#29006] {% comment %}doc{% endcomment %}
- CockroachDB now properly checks the width of strings inserted in a [collated string](../v2.1/collate.html) column with a specified width. [#29006][#29006]
- Improve the handling of jobs run prior to a [cluster upgrade](../v2.1/upgrade-cockroach-version.html). [#29019][#29019]
- CockroachDB once again prefers using an IPv4 listen address if a hostname with both IPv4 and IPv6 addresses is provided to `--host`/`--listen-addr`/`--advertise-addr`. [#29158][#29158]
- Fixed a memory leak when contended queries time out. [#29099][#29099]
- When the `--background` flag is specified, the [`cockroach start`](../v2.1/start-a-node.html) command now avoids printing messages to standard output after it has detached to the background. [#29160][#29160]

<h3 id="v2.1.0-beta.20180904-contributors">Contributors</h3>

This release includes 41 merged PRs by 16 authors.

[#28906]: https://github.com/cockroachdb/cockroach/pull/28906
[#28923]: https://github.com/cockroachdb/cockroach/pull/28923
[#28978]: https://github.com/cockroachdb/cockroach/pull/28978
[#29006]: https://github.com/cockroachdb/cockroach/pull/29006
[#29019]: https://github.com/cockroachdb/cockroach/pull/29019
[#29082]: https://github.com/cockroachdb/cockroach/pull/29082
[#29099]: https://github.com/cockroachdb/cockroach/pull/29099
[#29152]: https://github.com/cockroachdb/cockroach/pull/29152
[#29158]: https://github.com/cockroachdb/cockroach/pull/29158
[#29160]: https://github.com/cockroachdb/cockroach/pull/29160
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.0-beta.20180910-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180910.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180910.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180910.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-beta.20180910-general-changes">General changes</h3>

- CockroachDB no longer checks key usage attributes in [security certificates](../v2.1/create-security-certificates.html). [#29223][#29223]

<h3 id="v2.1.0-beta.20180910-sql-language-changes">SQL language changes</h3>

- In a mixed-version cluster, nodes running v2.0 no longer schedule distributed SQL work on nodes running v2.1. [#29168][#29168]
- When [`TRUNCATE`](../v2.1/truncate.html) or [`DROP TABLE`](../v2.1/drop-table.html) is run while a [schema change](../v2.1/online-schema-changes.html) like `CREATE INDEX` is being processed, the schema change job no longer runs indefinitely. [#29262][#29262]
- [View](../v2.1/create-view.html) and [table](../v2.1/create-table.html) names are now recycled quickly after [`DROP VIEW`](../v2.1/drop-view.html) and [`DROP TABLE`](../v2.1/drop-table.html).

<h3 id="v2.1.0-beta.20180910-command-line-changes">Command-line changes</h3>

- The new `cockroach workload` command provides various generators for data and query loads. [#28978][#28978]
- The `csv` and `tsv` formats for `cockroach` commands that output result rows now buffer data for a maximum of 5 seconds. This makes it possible to, for example, view SQL [`CHANGEFEED`s](../v2.1/create-changefeed.html) interactively with [`cockroach sql`](../v2.1/use-the-built-in-sql-client.html) and [`cockroach demo`](../v2.1/cockroach-demo.html). [#29445][#29445]

<h3 id="v2.1.0-beta.20180910-bug-fixes">Bug fixes</h3>

- Fixed support for the `--http-host` flag, which was broken in previous 2.1 beta releases. [#29220][#29220]
- Reduced the duration of partitions in the gossip network when a node crashes to eliminate a cause of temporary data unavailability. [#29317][#29317]
- The `unnest` and `_pg_expandarray` [functions](../v2.1/functions-and-operators.html) now return an error when called with NULL as the first argument. [#29385][#29385]
- Fixed a crash caused by JSON values and operations that use [arrays](../v2.1/array.html). [#29432][#29432]
- Fixed a rare crash with the message `no err but aborted txn proto`. [#29456][#29456]
- Fixed a crash caused by SQL statements containing `->(NULL::STRING)`. [#29414][#29414]
- Fixed table descriptor corruption when [`TRUNCATE`](../v2.1/truncate.html) is run while [`DROP COLUMN`](../v2.1/drop-column.html) is being processed. [#29262][#29262]

<h3 id="v2.1.0-beta.20180910-doc-updates">Doc updates</h3>

- Updated the [Data Replication](../v2.1/demo-data-replication.html) tutorial and the [Production Checklist](../v2.1/recommended-production-settings.html) to emphasize the importance of manually increasing the replication factor for important internal data when doing so for the `.default` replication zone. [#3702](https://github.com/cockroachdb/docs/pull/3702)

<h3 id="v2.1.0-beta.20180910-contributors">Contributors</h3>

This release includes 65 merged PRs by 20 authors.

[#28978]: https://github.com/cockroachdb/cockroach/pull/28978
[#29168]: https://github.com/cockroachdb/cockroach/pull/29168
[#29220]: https://github.com/cockroachdb/cockroach/pull/29220
[#29223]: https://github.com/cockroachdb/cockroach/pull/29223
[#29262]: https://github.com/cockroachdb/cockroach/pull/29262
[#29294]: https://github.com/cockroachdb/cockroach/pull/29294
[#29317]: https://github.com/cockroachdb/cockroach/pull/29317
[#29352]: https://github.com/cockroachdb/cockroach/pull/29352
[#29385]: https://github.com/cockroachdb/cockroach/pull/29385
[#29414]: https://github.com/cockroachdb/cockroach/pull/29414
[#29432]: https://github.com/cockroachdb/cockroach/pull/29432
[#29445]: https://github.com/cockroachdb/cockroach/pull/29445
[#29456]: https://github.com/cockroachdb/cockroach/pull/29456
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.0-beta.20180917-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180917.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180917.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180917.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-beta.20180917-backward-incompatible-changes">Backward-incompatible changes</h3>

- [`CHANGEFEED`s](../v2.1/change-data-capture.html) created with previous betas and alphas will not work with this version. [#29559][#29559]
- The experimental, non-recommended `kv.allocator.stat_based_rebalancing.enabled` and `kv.allocator.stat_rebalance_threshold` [cluster settings](../v2.1/cluster-settings.html) have been replaced by an improved approach to load-based rebalancing that can be controlled via the new `kv.allocator.load_based_rebalancing` [cluster setting](../v2.1/cluster-settings.html). By default, leases will be rebalanced within a cluster to achieve better QPS balance. [#29663][#29663]

<h3 id="v2.1.0-beta.20180917-sql-language-changes">SQL language changes</h3>

- Renamed the `EXPERIMENTAL_OPT` [session setting](../v2.1/set-vars.html) to `OPTIMIZER`. The default value is `ON`, as before. [#29530][#29530]
- Special characters, such as newlines, are now formatted using `octal`, instead of `hex`, for compatibility with PostgreSQL. [#29593][#29593]

<h3 id="v2.1.0-beta.20180917-command-line-changes">Command-line changes</h3>

- All `cockroach` client sub-commands (except for `cockroach workload`) now support the `--url` flag. [#29621][#29621]
- Removed `--log-backtrace-at` and `--verbosity` flags, which were documented as being only useful by CockroachDB developers yet never actually used by CockroachDB developers. [#30092][#30092]

<h3 id="v2.1.0-beta.20180917-admin-ui-changes">Admin UI changes</h3>

- Long table rows now wrap, when necessary. [#29551][#29551]
- [Diagnostics](../v2.1/diagnostics-reporting.html) requests are now proxied through Cockroach Labs to prevent exposing user IP addresses. [#29194][#29194]
- Added attributes to the login form to allow LastPass to properly recognize it. [#29561][#29561]
- Custom and regular charts now have the same width. [#30083][#30083]
- Improved the UX of the [**Custom Chart**](../v2.1/admin-ui-custom-chart-debug-page.html) page, and added the ability to configure multiple independent charts. [#30118][#30118]
- Improved the design and accessibility of tooltips. [#30115][#30115]
- Various improvements to the [**Statements**](../v2.1/admin-ui-statements-page.html) pages. [#30115][#30115]
    - Simplified and cleaned-up the appearance.
    - Added statement retries.
    - Right-aligned all numeric stats.
    - Added more tooltips, including for the **By Gateway Node** table on the **Statement Details** page.
    - Improved tooltips by adding a legend detailing the parts of the bar chart.
    - Highlighted summary rows.
    - Improved table headers.
    - Reordered tables to highlight the most useful data.
    - Widened bar charts.
    - Summarized [`SET`](../v2.1/set-vars.html) statements.
    - When a statement fingerprint has sometimes failed, used the optimizer, or been distributed, the number of matching executions is now shown.

<h3 id="v2.1.0-beta.20180917-bug-fixes">Bug fixes</h3>

- Fixed a bug that would allow the cluster summary text in the Admin UI to overflow its space. [#29548][#29548]
- Corrected the behavior of `INSERT INTO t DEFAULT VALUES` when there are active schema changes. [#29496][#29496]
- Fixed a race condition in [`IMPORT`](../v2.1/import.html) with a column that was a [collated string](../v2.1/collate.html). [#29386][#29386]
- Fixed crash caused by certain kinds of [`UPSERT ... RETURNING`](../v2.1/upsert.html) statements on tables with active schema changes. [#29543][#29543]
- [`CHANGEFEED`s](../v2.1/change-data-capture.html) now error when a watched table backfills (instead of undefined behavior). [#29559][#29559]
- Fixed a panic that occurs when verbose logging is enabled. [#29534][#29534]
- Fixed a panic caused by inserting values of the wrong type into columns depended on by [computed columns](../v2.1/computed-columns.html). [#29598][#29598]
- Fixed an issue where, under severe load, clients were sometimes receiving [retryable errors](../v2.1/transactions.html#error-handling) with a non-retryable error code. [#29614][#29614]
- The [`cockroach gen haproxy`](../v2.1/generate-cockroachdb-resources.html) command now recognizes nodes that specify the HTTP port number using `--http-addr` instead of `--http-port`. [#29536][#29536]
- Fixed a panic in SQL execution. [#29669][#29669]
- Fixed a panic caused by malformed UTF-8 SQL strings. [#29668][#29668]
- Corrected the Postgres `oid` type returned for collated string columns. [#29674][#29674]
- Enterprise [`CHANGEFEED`s](../v2.1/change-data-capture.html) now correctly skip the initial scan when started with the `cursor=` option. [#29613][#29613]
- Hash functions with `NULL` input now return `NULL`. [#29974][#29974]
- Prevented a very rare premature failure in [`CHANGEFEED`s](../v2.1/change-data-capture.html) caused by a race condition with range splits. [#30009][#30009]
- Fixed a crash when `SELECT MIN(NULL)` was run with the [SQL optimizer](../v2.1/cost-based-optimizer.html) enabled. [#30014][#30014]
- Fixed a rare crash with the message `retryable error for the wrong txn`. [#30046][#30046]
- Fixed a bug where certain queries, like merge joins, would appear to run out of memory due to incorrect memory accounting and fail. [#30087][#30087]
- The `string_agg()` [function](../v2.1/functions-and-operators.html) can now accept a `NULL` as a delimiter. [#30076][#30076]

<h3 id="v2.1.0-beta.20180917-performance-improvements">Performance improvements</h3>

- Range replicas are now automatically rebalanced throughout the cluster to even out the amount of QPS being handled by each node. [#29663][#29663]
- Prevented allocation when checking RPC connection health. [#30055][#30055]

<h3 id="v2.1.0-beta.20180917-doc-updates">Doc updates</h3>

- Updated the description of [correlated subqueries](../v2.1/subqueries.html#correlated-subqueries). More updates coming soon. [#3714](https://github.com/cockroachdb/docs/pull/3714)
- Update the description of [`cockroach` client connection parameters](../v2.1/connection-parameters.html). [#3715](https://github.com/cockroachdb/docs/pull/3715)
- Added documentation of the `public` role, which all users belong to. [#3722](https://github.com/cockroachdb/docs/pull/3722)
- Update the [Diagnostics Reporting](../v2.1/diagnostics-reporting.html) page with a summary of details reported and how to view the details yourself. [#3737](https://github.com/cockroachdb/docs/pull/3737)

<h3 id="v2.1.0-beta.20180917-contributors">Contributors</h3>

This release includes 87 merged PRs by 23 authors. We would like to thank the following contributors from the CockroachDB community:

- Sankt Petersbug (first-time contributor)

[#29194]: https://github.com/cockroachdb/cockroach/pull/29194
[#29386]: https://github.com/cockroachdb/cockroach/pull/29386
[#29496]: https://github.com/cockroachdb/cockroach/pull/29496
[#29530]: https://github.com/cockroachdb/cockroach/pull/29530
[#29534]: https://github.com/cockroachdb/cockroach/pull/29534
[#29536]: https://github.com/cockroachdb/cockroach/pull/29536
[#29543]: https://github.com/cockroachdb/cockroach/pull/29543
[#29548]: https://github.com/cockroachdb/cockroach/pull/29548
[#29551]: https://github.com/cockroachdb/cockroach/pull/29551
[#29559]: https://github.com/cockroachdb/cockroach/pull/29559
[#29561]: https://github.com/cockroachdb/cockroach/pull/29561
[#29593]: https://github.com/cockroachdb/cockroach/pull/29593
[#29598]: https://github.com/cockroachdb/cockroach/pull/29598
[#29613]: https://github.com/cockroachdb/cockroach/pull/29613
[#29614]: https://github.com/cockroachdb/cockroach/pull/29614
[#29621]: https://github.com/cockroachdb/cockroach/pull/29621
[#29663]: https://github.com/cockroachdb/cockroach/pull/29663
[#29668]: https://github.com/cockroachdb/cockroach/pull/29668
[#29669]: https://github.com/cockroachdb/cockroach/pull/29669
[#29674]: https://github.com/cockroachdb/cockroach/pull/29674
[#29974]: https://github.com/cockroachdb/cockroach/pull/29974
[#30009]: https://github.com/cockroachdb/cockroach/pull/30009
[#30014]: https://github.com/cockroachdb/cockroach/pull/30014
[#30046]: https://github.com/cockroachdb/cockroach/pull/30046
[#30055]: https://github.com/cockroachdb/cockroach/pull/30055
[#30076]: https://github.com/cockroachdb/cockroach/pull/30076
[#30083]: https://github.com/cockroachdb/cockroach/pull/30083
[#30087]: https://github.com/cockroachdb/cockroach/pull/30087
[#30092]: https://github.com/cockroachdb/cockroach/pull/30092
[#30115]: https://github.com/cockroachdb/cockroach/pull/30115
[#30118]: https://github.com/cockroachdb/cockroach/pull/30118
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.0-beta.20180924-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180924.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180924.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20180924.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-beta.20180924-sql-language-changes">SQL language changes</h3>

- [`CHANGEFEED`s](../v2.1/change-data-capture.html) will retry, rather than abort, in certain cases when failing to emit to a sink. [#30157][#30157]
- The new `ALTER ... CONFIGURE ZONE` statement can be used to add, modify, reset, and remove [replication zones](../v2.1/configure-replication-zones.html), with support for placeholders (`$1`, etc.) and for multiple executions. The new `SHOW ZONE CONFIGURATION` statement can be used to view existing replication zones. Clients should use these SQL statements instead of the `cockroach zone` sub-commands, which are now deprecated and will be removed in a future version of CockroachDB. [#30173][#30173]
- Added the `2.0` value for both the `distsql` [session setting](../v2.1/set-vars.html) and the `sql.defaults.distsql` [cluster setting](../v2.1/cluster-settings.html), which instructs the database to use the 2.0 `auto` behavior for determining whether queries are distributed or run through the gateway node. [#30209][#30209]

<h3 id="v2.1.0-beta.20180924-command-line-changes">Command-line changes</h3>

- The various `cockroach zone` sub-commands are now deprecated and will be removed in a future version of CockroachDB. Clients should use the SQL interface instead via `SHOW ZONE CONFIGURATION` and `ALTER ... CONFIGURE ZONE`. [#30173][#30173]
- Improved the output of [`cockroach node status`](../v2.1/view-node-details.html) to include separate `is_available` and `is_live` columns. [#30268][#30268]
- The [`cockroach debug zip`](../v2.1/debug-zip.html) command now also collects heap profiles that were generated and stored when there was high memory usage [#30281][#30281]

<h3 id="v2.1.0-beta.20180924-bug-fixes">Bug fixes</h3>

- The `ON DELETE CASCADE` and `ON UPDATE CASCADE` [foreign key actions](../v2.1/foreign-key.html#foreign-key-actions) no longer cascade through `NULL`s. [#30122][#30122]
- Fixed the evaluation of `<tuple> IS NOT NULL` and `<tuple> IS NULL` comparison operations involving a non-null constant tuple to return `true` or `false` rather than `NULL`. [#30184][#30184]
- Fixed the occasional improper processing of the `WITH` operand with `IMPORT`/`EXPORT`/`BACKUP`/`RESTORE` and [common table expressions](../v2.1/common-table-expressions.html). [#30198][#30198]
- Fixed the return type of an array built from the results of a subquery to be `elementType[]` rather than `tuple{elementType}[]`. [#30237][#30237]
- Fixed a panic that was occurring when the cost-based optimizer was disabled and an array built from the results of a subquery was used in the `WHERE` clause of an outer query. [#30237][#30237]
- Fixed a panic that occurred when not all values were present in a composite foreign key. [#30153][#30153]
- Transaction size limit errors are no longer returned for transactions that have already committed. [#30304][#30304]

<h3 id="v2.1.0-beta.20180924-performance-improvements">Performance improvements</h3>

- Avoided unnecessary allocations when parsing prepared statement placeholders. [#30299][#30299]
- 1PC transactions now avoid writing transaction record and intents when pushed due to reads at a higher timestamp. [#30298][#30298]

<h3 id="v2.1.0-beta.20180924-contributors">Contributors</h3>

This release includes 46 merged PRs by 20 authors.

[#30122]: https://github.com/cockroachdb/cockroach/pull/30122
[#30153]: https://github.com/cockroachdb/cockroach/pull/30153
[#30157]: https://github.com/cockroachdb/cockroach/pull/30157
[#30173]: https://github.com/cockroachdb/cockroach/pull/30173
[#30184]: https://github.com/cockroachdb/cockroach/pull/30184
[#30198]: https://github.com/cockroachdb/cockroach/pull/30198
[#30209]: https://github.com/cockroachdb/cockroach/pull/30209
[#30237]: https://github.com/cockroachdb/cockroach/pull/30237
[#30268]: https://github.com/cockroachdb/cockroach/pull/30268
[#30281]: https://github.com/cockroachdb/cockroach/pull/30281
[#30298]: https://github.com/cockroachdb/cockroach/pull/30298
[#30299]: https://github.com/cockroachdb/cockroach/pull/30299
[#30304]: https://github.com/cockroachdb/cockroach/pull/30304
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.0-beta.20181001-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20181001.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20181001.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20181001.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-beta.20181001-security-bug-fix">Security bug fix</h3>

- Fixed a vulnerability in which TLS certificates were not validated correctly for internal RPC interfaces. This vulnerability could allow an unauthenticated user with network access to read and write to the cluster. [#30821](https://github.com/cockroachdb/cockroach/issues/30821)

<h3 id="v2.1.0-beta.20181001-sql-language-changes">SQL language changes</h3>

- The entries in the `replicas` column of the `crdb_internal.ranges` virtual table are now always sorted by store
ID.
- The `EXPERIMENTAL_RELOCATE` statement no longer temporarily increases the number of replicas in a range more than one above the range's replication factor, preventing rare edge cases of unavailability.

<h3 id="v2.1.0-beta.20181001-command-line-changes">Command-line changes</h3>

- The `--log-dir`, `--log-dir-max-size`, `--log-file-max-size`, and `--log-file-verbosity` flags are now only available for the [`cockroach start`](../v2.1/start-a-node.html) and [`cockroach demo`](../v2.1/cockroach-demo.html) commands. Previously, these flags were available for other commands but rarely used or functional. [#30341][#30341] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-beta.20181001-admin-ui-changes">Admin UI changes</h3>

- The new **SQL Query Errors** graph on the [**SQL** dashboard](../v2.1/admin-ui-sql-dashboard.html) shows the number of queries that returned a runtime or execution error. [#30371][#30371] {% comment %}doc{% endcomment %}
- Hovering over a truncated entry in the [**Events** panel](../v2.1/admin-ui-access-and-navigate.html#events-panel) now shows the full description of the event. [#30391][#30391]

<h3 id="v2.1.0-beta.20181001-bug-fixes">Bug fixes</h3>

- The [`cockroach demo`](../v2.1/cockroach-demo.html) command now runs with replication disabled. [#30517][#30517]
- The [**Jobs** page](../v2.1/admin-ui-jobs-page.html) now sorts by **Creation Time** by default instead of by **User**. [#30428][#30428]
- Fixed a panic in the [optimizer](../v2.1/cost-based-optimizer.html) code when generator functions such as `generate_series()` are used as the argument to an aggregate function. [#30362][#30362]
- Corrected the help text for [`EXPORT`](../v2.1/export.html). [#30425][#30425]
- Ignored more unsupported clauses in [`IMPORT ... PGDUMP`](../v2.1/import.html). [#30425][#30425]
- Fixed [`IMPORT`](../v2.1/import.html) of empty or small tables under rare conditions. [#30425][#30425]
- Fixed a panic when generator functions such as `unnest()` are used in the [`SELECT`](../v2.1/select-clause.html) list
  with `GROUP BY`. [#30462][#30462]
- Fixed a panic caused by columns being reordered when using [`UPSERT`](../v2.1/upsert.html) with a `RETURNING` clause. [#30467][#30467]
- Fixed a panic when a [correlated subquery](../v2.1/subqueries.html#correlated-subqueries) in the `WHERE` clause contains an aggregate function referencing the outer query. This now causes an error since aggregates are not allowed in `WHERE`. [#30522][#30522]
- Corrected the list of permitted values printed when a non-permitted value is set for the `distsql` [session variable](../v2.1/set-vars.html). [#30631][#30631]

<h3 id="v2.1.0-beta.20181001-performance-improvements">Performance improvements</h3>

- Removed unnecessary synchronous disk writes caused by erroneous logic in the Raft implementation. [#30459][#30459]
- Range replicas are now automatically rebalanced throughout the cluster to even out the amount of QPS being handled by each node by default. Previously, this was available as a cluster setting but was not the default behavior. [#30649][#30649] {% comment %}doc{% endcomment %}

<h3 id="v2.1.0-beta.20181001-contributors">Contributors</h3>

This release includes 56 merged PRs by 19 authors.

[#30341]: https://github.com/cockroachdb/cockroach/pull/30341
[#30362]: https://github.com/cockroachdb/cockroach/pull/30362
[#30371]: https://github.com/cockroachdb/cockroach/pull/30371
[#30391]: https://github.com/cockroachdb/cockroach/pull/30391
[#30425]: https://github.com/cockroachdb/cockroach/pull/30425
[#30428]: https://github.com/cockroachdb/cockroach/pull/30428
[#30459]: https://github.com/cockroachdb/cockroach/pull/30459
[#30461]: https://github.com/cockroachdb/cockroach/pull/30461
[#30462]: https://github.com/cockroachdb/cockroach/pull/30462
[#30467]: https://github.com/cockroachdb/cockroach/pull/30467
[#30517]: https://github.com/cockroachdb/cockroach/pull/30517
[#30522]: https://github.com/cockroachdb/cockroach/pull/30522
[#30631]: https://github.com/cockroachdb/cockroach/pull/30631
[#30649]: https://github.com/cockroachdb/cockroach/pull/30649
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.0-beta.20181008-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20181008.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20181008.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20181008.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-beta.20181008-sql-language-changes">SQL language changes</h3>

- `EXECUTE` is no longer an [explainable statement](../v2.1/explain.html). As an alternative, it is possible to `PREPARE ... AS EXPLAIN ...` and then execute the prepared statement to see the plan for a prepared query. [#30725][#30725]

<h3 id="v2.1.0-beta.20181008-admin-ui-changes">Admin UI changes</h3>

- Removed read and write graphs from the [Hardware Dashboard](../v2.1/admin-ui-hardware-dashboard.html). [#30655][#30655]

<h3 id="v2.1.0-beta.20181008-bug-fixes">Bug fixes</h3>

- `EXPLAIN ALTER DATABASE ... RENAME` no longer renames the target database. [#30661][#30661]
- `EXPLAIN ALTER TABLE ... RENAME` no longer renames the target table. [#30661][#30661]
- `EXPLAIN ALTER TABLE ... RENAME COLUMN` no longer renames the target column. [#30661][#30661]
- `EXPLAIN ALTER INDEX ... RENAME` no longer renames the target index. [#30661][#30661]
- It is once again possible to use [`EXPLAIN`](../v2.1/explain.html) for all preparable statements, and prepare all explainable statements. [#30661][#30661]
- [`TRUNCATE`](../v2.1/truncate.html) is now properly restricted in SQL transactions like other DDL statements. [#30661][#30661]
- [`TRUNCATE`](../v2.1/truncate.html) can now be used with [`EXPLAIN`](../v2.1/explain.html) and as a prepared statement. [#30661][#30661]
- The default unit for converting a string value when setting the `statement_timeout` [session variable](../v2.1/set-vars.html) is now milliseconds for compatibility with PostgreSQL. [#30654][#30654]

<h3 id="v2.1.0-beta.20181008-doc-updates">Doc updates</h3>

- Added a [Migration Overview](../v2.1/migration-overview.html) and specific guides for [Migrating from Postgres](../v2.1/migrate-from-postgres.html), [Migrating from MySQL](../v2.1/migrate-from-mysql.html), and [Migrating from CSV](../v2.1/migrate-from-csv.html). [#3766](https://github.com/cockroachdb/docs/pull/3766)
- Called out performance-optimized configuration files for [Kubernetes single-cluster deployments](../v2.1/orchestrate-cockroachdb-with-kubernetes.html). [#3827](https://github.com/cockroachdb/docs/pull/3827) [#3838](https://github.com/cockroachdb/docs/pull/3838)
- Documented [how replication zones affect secondary indexes](../v2.1/configure-replication-zones.html#replication-zone-levels). [#3818](https://github.com/cockroachdb/docs/pull/3818)
- Clarified that [per-replica constraints in replication zones](../v2.1/configure-replication-zones.html#scope-of-constraints) do not need to add up to total replicas. [#3812](https://github.com/cockroachdb/docs/pull/3812)
- Clarified a [known limitation about schema changes inside transactions](../v2.1/known-limitations.html#schema-changes-within-transactions). [#3814](https://github.com/cockroachdb/docs/pull/3814)
- Updated the [`ARRAY`](../v2.1/array.html) documentation to cover casting from array to `STRING` values. [#3813](https://github.com/cockroachdb/docs/pull/3813)
- Documented the use of `--locality` when using [`cockroach gen haproxy`](../v2.1/generate-cockroachdb-resources.html#haproxy) to generate an HAProxy config file. [#3809](https://github.com/cockroachdb/docs/pull/3809)
- Updated the [session variables](../v2.1/set-vars.html) documentation. [#3799](https://github.com/cockroachdb/docs/pull/3799)
- Updated the list of information included in a [`debug zip`](../v2.1/debug-zip.html). [#3796](https://github.com/cockroachdb/docs/pull/3796)

<h3 id="v2.1.0-beta.20181008-contributors">Contributors</h3>

This release includes 31 merged PRs by 15 authors.

[#30531]: https://github.com/cockroachdb/cockroach/pull/30531
[#30603]: https://github.com/cockroachdb/cockroach/pull/30603
[#30650]: https://github.com/cockroachdb/cockroach/pull/30650
[#30654]: https://github.com/cockroachdb/cockroach/pull/30654
[#30655]: https://github.com/cockroachdb/cockroach/pull/30655
[#30661]: https://github.com/cockroachdb/cockroach/pull/30661
[#30668]: https://github.com/cockroachdb/cockroach/pull/30668
[#30674]: https://github.com/cockroachdb/cockroach/pull/30674
[#30680]: https://github.com/cockroachdb/cockroach/pull/30680
[#30681]: https://github.com/cockroachdb/cockroach/pull/30681
[#30684]: https://github.com/cockroachdb/cockroach/pull/30684
[#30694]: https://github.com/cockroachdb/cockroach/pull/30694
[#30704]: https://github.com/cockroachdb/cockroach/pull/30704
[#30714]: https://github.com/cockroachdb/cockroach/pull/30714
[#30715]: https://github.com/cockroachdb/cockroach/pull/30715
[#30724]: https://github.com/cockroachdb/cockroach/pull/30724
[#30725]: https://github.com/cockroachdb/cockroach/pull/30725
[#30733]: https://github.com/cockroachdb/cockroach/pull/30733
[#30737]: https://github.com/cockroachdb/cockroach/pull/30737
[#30738]: https://github.com/cockroachdb/cockroach/pull/30738
[#30739]: https://github.com/cockroachdb/cockroach/pull/30739
[#30763]: https://github.com/cockroachdb/cockroach/pull/30763
[#30764]: https://github.com/cockroachdb/cockroach/pull/30764
[#30779]: https://github.com/cockroachdb/cockroach/pull/30779
[#30782]: https://github.com/cockroachdb/cockroach/pull/30782
[#30788]: https://github.com/cockroachdb/cockroach/pull/30788
[#30789]: https://github.com/cockroachdb/cockroach/pull/30789
[#30794]: https://github.com/cockroachdb/cockroach/pull/30794
[#30799]: https://github.com/cockroachdb/cockroach/pull/30799
[#30808]: https://github.com/cockroachdb/cockroach/pull/30808
[#30829]: https://github.com/cockroachdb/cockroach/pull/30829
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.0-beta.20181015-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20181015.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20181015.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-beta.20181015.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-beta.20181015-sql-language-changes">SQL language changes</h3>

- The output of [`SHOW JOBS`](../v2.1/show-jobs.html) now reports ongoing jobs first in start time order, followed by completed jobs in finished time order. [#31005][#31005] 
- CockroachDB now supports more customizations from PostgreSQL client drivers when initially setting up the client connection. [#31021][#31021]
- Columns that are part of a table's [`PRIMARY KEY`](../v2.1/primary-key.html) can no longer be specified as [`STORING` columns](../v2.1/create-index.html#store-columns) in secondary indexes on the table. [#31032][#31032]
- The output of `SHOW ZONE CONFIGURATIONS` and `SHOW ZONE CONFIGURATION FOR` now only shows the zone name and the SQL representation of the config. [#31089][#31089]

<h3 id="v2.1.0-beta.20181015-command-line-changes">Command-line changes</h3>

- It is now possible to provide initial/default values for any customizable [session variable](../v2.1/set-vars.html) in the client connection URL. [#31021][#31021]

<h3 id="v2.1.0-beta.20181015-admin-ui-changes">Admin UI changes</h3>

- Leveraged PopperJS positioning engine to automate the positioning of tooltips. [#30476][#30476]
- Added a graph of the average QPS per store to the [**Replication** dashboard](../v2.1/admin-ui-replication-dashboard.html). Note that this uses an exponentially weighted moving average, not an instantaneous measurement. It is primarily of interest because it's the data that's used when making load-based rebalancing decisions. [#30889][#30889]
- Added a bar chart to the memory and capacity usage columns on the [**Node List**](../v2.1/admin-ui-cluster-overview-page.html#node-list). These columns sort by percentage used. [#31070][#31070]
- Added a debug page with a form that lets users manually enqueue a range in one of the various store-level replica queues on a specified store. This feature is intended for advanced users only. [#31092][#31092]

<h3 id="v2.1.0-beta.20181015-bug-fixes">Bug fixes</h3>

- Lookup joins no longer omit rows in certain circumstances during limit queries. [#30836][#30836]
- Fixed a panic due to malformed placeholder values. [#30860][#30860]
- The [`cockroach start`](../v2.1/start-a-node.html) command now prints a hint about waiting for a join or [`cockroach init`](../v2.1/initialize-a-cluster.html) only when starting nodes for a new cluster, not when adding nodes to an existing cluster. [#30953][#30953]
- Fixed a possible crash when using filters with `<tuple> IN <tuples>` expressions. [#30968][#30968]
- Prevented an edge case in load-based rebalancing where the cluster could transfer the lease for a range to a replica that isn't keeping up with the other replicas, causing brief periods where no replicas think they're leaseholder for the range and thus no requests can be processed for the range. [#30972][#30972]
- CockroachDB now properly ignores non-alphanumeric characters in encoding names passed to [functions](../v2.1/functions-and-operators.html) like `convert_from()` and `client_encoding()`, for compatibility with PostgreSQL. [#31021][#31021]
- CockroachDB now properly recognizes the value of `extra_float_digits` provided by clients as a [connection parameter](../v2.1/connection-parameters.html). [#31021][#31021]
- CockroachDB now properly recognizes two-part values for the `DateStyle` [session variable](../v2.1/set-vars.html) and [connection parameter](../v2.1/connection-parameters.html), for compatibility with PostgreSQL. [#31021][#31021]
- CockroachDB now reports all server status parameters supported by PostgreSQL when setting up a session. This is expected to improve compatibility with some drivers. [#31021][#31021]
- CockroachDB now properly uses the client-provided default values when using the [`RESET`](../v2.1/reset-vars.html) statement (or `SET ... = DEFAULT`). [#31021][#31021]
- CockroachDB now properly fills the columns `boot_val` and `reset_val` in `pg_catalog.pg_settings`, for better compatibility with PostgreSQL. [#31021][#31021]
- CockroachDB now properly supports renaming a column that's also stored in an index. [#31074][#31074]
- During password login, "user does not exist" and "invalid password" cases now produce the same error message. [#30935][#30935]

<h3 id="v2.1.0-beta.20181015-performance-improvements">Performance improvements</h3>

- CockroachDB now avoids acquiring an exclusive lock when checking replica status in the write proposal path. [#30920][#30920]

<h3 id="v2.1.0-beta.20181015-doc-updates">Doc updates</h3>

- Added a tutorial demonstrating essential [performance tuning tutorial](../v2.1/performance-tuning.html) techniques for getting fast reads and writes in CockroachDB, starting with a single-region deployment and expanding into multiple regions. [#3854](https://github.com/cockroachdb/docs/pull/3854)
- Added a tutorial demonstrating the importances of [serializable transactions](../v2.1/demo-serializable.html). [#3844](https://github.com/cockroachdb/docs/pull/3844)
- Added documentation on [index name resolution](../v2.1/sql-name-resolution.html#index-name-resolution). [#3830](https://github.com/cockroachdb/docs/pull/3830).
- Updated the documentation on [set-returning functions (SRFs)](../v2.1/table-expressions.html#table-generator-functions). [#3810](https://github.com/cockroachdb/docs/pull/3810)
- Update the example on how [auto-incrementing is not always sequential](../v2.1/serial.html#auto-incrementing-is-not-always-sequential). [#3832](https://github.com/cockroachdb/docs/pull/3832)

<h3 id="v2.1.0-beta.20181015-contributors">Contributors</h3>

This release includes 40 merged PRs by 19 authors.

[#30476]: https://github.com/cockroachdb/cockroach/pull/30476
[#30836]: https://github.com/cockroachdb/cockroach/pull/30836
[#30860]: https://github.com/cockroachdb/cockroach/pull/30860
[#30889]: https://github.com/cockroachdb/cockroach/pull/30889
[#30920]: https://github.com/cockroachdb/cockroach/pull/30920
[#30935]: https://github.com/cockroachdb/cockroach/pull/30935
[#30953]: https://github.com/cockroachdb/cockroach/pull/30953
[#30968]: https://github.com/cockroachdb/cockroach/pull/30968
[#30972]: https://github.com/cockroachdb/cockroach/pull/30972
[#31005]: https://github.com/cockroachdb/cockroach/pull/31005
[#31021]: https://github.com/cockroachdb/cockroach/pull/31021
[#31032]: https://github.com/cockroachdb/cockroach/pull/31032
[#31070]: https://github.com/cockroachdb/cockroach/pull/31070
[#31074]: https://github.com/cockroachdb/cockroach/pull/31074
[#31089]: https://github.com/cockroachdb/cockroach/pull/31089
[#31092]: https://github.com/cockroachdb/cockroach/pull/31092
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.0-rc.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-rc.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-rc.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-rc.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-rc.1-docker-image">Docker Image</h3>

{% include copy-clipboard.html %}
~~~ shell
$ docker pull cockroachdb/cockroach-unstable:v2.1.0-rc.1
~~~

<h3 id="v2.1.0-rc.1-enterprise-edition-changes">Enterprise edition changes</h3>

- [`CHANGEFEED`s](../v2.1/change-data-capture.html) can now be configured with a minimum duration between emitted resolved timestamps. [#31008][#31008]
- [`CHANGEFEED`s](../v2.1/change-data-capture.html) now have limited and experimental support for the `AVRO` format. [#31143][#31143]
- [`CHANGEFEED`s](../v2.1/change-data-capture.html) now continue running when watched tables are [`ALTER`ed](../v2.1/alter-table.html) in ways that require a backfill. [#31165][#31165]

<h3 id="v2.1.0-rc.1-sql-language-changes">SQL language changes</h3>

- [`EXPLAIN`](../v2.1/explain.html) now always shows filter and join conditions. [#31186][#31186]
- CockroachDB now supports CTEs inside [views](../v2.1/views.html). [#31051][#31051]
- CockroachDB now hints that internal errors should be [reported as bugs by users](../v2.1/file-an-issue.html). Additionally, internal errors are now collected internally and submitted (anonymized) with other node statistics when statistic collection is enabled. [#31272][#31272]
- It is now possible to force a specific index for `DELETE` or `UPDATE`. [#31279][#31279]
- Handle binary fields dumped by `mysqldump v5.7.23` with `_binary` prefix. [#31305][#31305]
- `EXPLAIN ANALYZE <statement>` is now a valid equivalent of [`EXPLAIN ANALYZE (DISTSQL) <statement>`](../v2.1/explain-analyze.html) [#31278][#31278]
- When a query references a table in [`information_schema`](../v2.1/information-schema.html) and `pg_catalog` that is not yet implemented, this will be reported as telemetry if statistics reporting is enabled. This will help determine which features should be implemented next for compatibility. [#31357][#31357]

<h3 id="v2.1.0-rc.1-admin-ui-changes">Admin UI changes</h3>

- The **Service latency: {90,99}th percentile** graphs on the [**Overview**](../v2.1/admin-ui-overview-dashboard.html) and [**SQL**](../v2.1/admin-ui-sql-dashboard.html) dashboards, as well as the P50 and P99 latency numbers in the time series area sidebar, now reflect latencies of both local and distributed queries. Previously, they only included local queries. [#31116][#31116]
- Links to documentation pages now open in a new tab. [#31132][#31132]
- Improved the view of databases with no tables. [#31231][#31231]
- Updated [**Jobs**](../v2.1/admin-ui-jobs-page.html) dashboard to make each row expandable, allowing the user to see the error message for failed jobs. [#31237][#31237]

<h3 id="v2.1.0-rc.1-bug-fixes">Bug fixes</h3>

- Fixed schema change rollback caused by GC TTL threshold error. [#31153][#31153]
- Fixed the `_admin/v1/enqueue_range` debug endpoint to always respect its `node_id` parameter. [#31087][#31087]
- CockroachDB now reports an unimplemented error when a common table expression containing [`INSERT`](../v2.1/insert.html)/[`UPDATE`](../v2.1/update.html)/[`UPSERT`](../v2.1/upsert.html)/[`DELETE`](../v2.1/delete.html) is not otherwise used in the remainder of the query. [#31051][#31051]
- CockroachDB does not silently ignore `WITH` clauses within parentheses anymore. [#31051][#31051]
- Fixed a rare scenario where a [backup](../v2.1/backup.html) could incorrectly include a key for an aborted transaction. [#31316][#31316]
- CockroachDB now avoids repeatedly trying a replica that was found to be in the process of being added. [#31250][#31250]
- CockroachDB will no longer fail in unexpected ways or write invalid data when the type of input values provided to [`INSERT`](../v2.1/insert.html)/[`UPSERT`](../v2.1/upsert.html) does not match the type of the target columns. [#31280][#31280]
- [`UPDATE`](../v2.1/update.html) now verifies the column constraints before [`CHECK`](../v2.1/check.html) constraints, for compatibility with PostgreSQL. [#31280][#31280]
- It is no longer possible to use not-fully-added-yet columns in the `RETURNING` clause of [`UPDATE`](../v2.1/update.html) statements. [#31280][#31280]
- CockroachDB no longer (incorrectly and silently) accepts a [computed column](../v2.1/computed-columns.html) on the left side of the assignment in an [`ON CONFLICT`](../v2.1/insert.html#on-conflict-clause) clause. [#31280][#31280]
- CockroachDB no longer (incorrectly and silently) accepts a not-fully-added-yet column on the left side of the assignment in an [`ON CONFLICT`](../v2.1/insert.html#on-conflict-clause) clause. [#31280][#31280]
- CockroachDB no longer (incorrectly and silently) ignores the `HAVING` clause on [`SELECT`](../v2.1/select-clause.html) without `FROM`. [#31347][#31347]
- The **Range Debug** page now handle cases in which there is no lease start or expiration time. [#31367][#31367]

<h3 id="v2.1.0-rc.1-build-changes">Build changes</h3>

- CockroachDB can now be built from source on macOS 10.14 (Mojave). [#31308][#31308]

<h3 id="v2.1.0-rc.1-doc-updates">Doc Updates</h3>

- Updated the documentation for [encryption at rest](../v2.1/encryption.html). [#3848](https://github.com/cockroachdb/docs/pull/3848)
- Updated the documentation on how to [orchestrate CockroachDB across multiple Kubernetes clusters](../v2.1/orchestrate-cockroachdb-with-kubernetes-multi-cluster.html). [#3845](https://github.com/cockroachdb/docs/pull/3845) [#3847](https://github.com/cockroachdb/docs/pull/3847)
- Updated the documentation on the [cost-based optimizer](../v2.1/cost-based-optimizer.html). [#3784](https://github.com/cockroachdb/docs/pull/3784)
- Added documentation for [fast path deletes for interleaved tables](../v2.1/interleave-in-parent.html). [#3834](https://github.com/cockroachdb/docs/pull/3834)

<h3 id="v2.1.0-rc.1-contributors">Contributors</h3>

This release includes 55 merged PRs by 21 authors.

[#31008]: https://github.com/cockroachdb/cockroach/pull/31008
[#31051]: https://github.com/cockroachdb/cockroach/pull/31051
[#31087]: https://github.com/cockroachdb/cockroach/pull/31087
[#31116]: https://github.com/cockroachdb/cockroach/pull/31116
[#31132]: https://github.com/cockroachdb/cockroach/pull/31132
[#31143]: https://github.com/cockroachdb/cockroach/pull/31143
[#31153]: https://github.com/cockroachdb/cockroach/pull/31153
[#31165]: https://github.com/cockroachdb/cockroach/pull/31165
[#31186]: https://github.com/cockroachdb/cockroach/pull/31186
[#31231]: https://github.com/cockroachdb/cockroach/pull/31231
[#31237]: https://github.com/cockroachdb/cockroach/pull/31237
[#31250]: https://github.com/cockroachdb/cockroach/pull/31250
[#31272]: https://github.com/cockroachdb/cockroach/pull/31272
[#31278]: https://github.com/cockroachdb/cockroach/pull/31278
[#31279]: https://github.com/cockroachdb/cockroach/pull/31279
[#31280]: https://github.com/cockroachdb/cockroach/pull/31280
[#31305]: https://github.com/cockroachdb/cockroach/pull/31305
[#31308]: https://github.com/cockroachdb/cockroach/pull/31308
[#31316]: https://github.com/cockroachdb/cockroach/pull/31316
[#31347]: https://github.com/cockroachdb/cockroach/pull/31347
[#31357]: https://github.com/cockroachdb/cockroach/pull/31357
[#31367]: https://github.com/cockroachdb/cockroach/pull/31367
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.0-rc.2-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-rc.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-rc.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0-rc.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-rc.2-docker-image">Docker Image</h3>

{% include copy-clipboard.html %}
~~~ shell
$ docker pull cockroachdb/cockroach-unstable:v2.1.0-rc.2
~~~

<h3 id="v2.1.0-rc.2-bug-fixes">Bug Fixes</h3>

- Fixed a panic when setting some `kv.bulk_io_write` [cluster settings](../v2.1/cluster-settings.html) to a value < 1. [#31603][#31603]
- Fixed a bug where entry application on Raft followers could fall behind entry application on the leader, causing stalls during splits. [#31619][#31619]
- Fixed a panic caused by an incorrect assumption in the SQL optimizer code that `ROWS FROM` clauses contain only functions. [#31769][#31769]
- Fixed a bug causing committed read-only transactions to be counted as aborted in metrics. [#31608][#31608]
- Fixed a bug where [`CHANGEFEED`s](../v2.1/create-changefeed.html) may not correctly retry temporary errors when communicating with a sink. [#31559][#31559]

<h3 id="v2.1.0-rc.2-contributors">Contributors</h3>

This release includes 18 merged PRs by 9 authors.

[#31559]: https://github.com/cockroachdb/cockroach/pull/31559
[#31603]: https://github.com/cockroachdb/cockroach/pull/31603
[#31608]: https://github.com/cockroachdb/cockroach/pull/31608
[#31619]: https://github.com/cockroachdb/cockroach/pull/31619
[#31769]: https://github.com/cockroachdb/cockroach/pull/31769
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

With the release of CockroachDB v2.1, we’ve made it easier than ever to migrate from MySQL and Postgres, improved our scalability on transactional workloads by 5x, enhanced our troubleshooting workflows in the Admin UI, and launched a managed offering to help teams deploy low-latency, multi-region clusters with minimal operator overhead.

- Check out a [summary of the most significant user-facing changes](#summary).
- Then [upgrade to CockroachDB v2.1](../v2.1/upgrade-cockroach-version.html).

<h3 id="v2.1.0-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.0.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.0-docker-image">Docker Image</h3>

{% include copy-clipboard.html %}
~~~ shell
$ docker pull cockroachdb/cockroach:v2.1.0
~~~

<h3 id="v2.1.0-summary">Summary</h3>

This section summarizes the most significant user-facing changes in v2.1.0. For a complete list of features and changes, including bug fixes and performance improvements, see the [release notes](index.html#testing-releases) for previous testing releases.

- [Managed Offering](#managed-offering)
- [Enterprise Features](#enterprise-features)
- [Core Features](#core-features)
- [Known Limitations](#known-limitations)
- [Documentation](#documentation)

<style>
    table td:first-child {
        min-width: 225px;
    }
</style>

<h3 id="v2.1.0-managed-offering">Managed Offering</h3>

The Managed CockroachDB offering is currently in Limited Availability and accepting customers on a qualified basis. The offering provides a running CockroachDB cluster suitable to your needs, fully managed by Cockroach Labs on GCP or AWS. Benefits include:

- No provisioning or deployment efforts for you
- Daily full backups and hourly incremental backups of your data
- Upgrades to the latest stable release of CockroachDB
- Monitoring to provide SLA-level support

For more details, see the [Managed CockroachDB](../cockroachcloud/quickstart.html) docs.

<h3 id="v2.1.0-enterprise-features">Enterprise Features</h3>

These new features require an [enterprise license](../v2.1/enterprise-licensing.html). Register for a 30-day trial license [here](https://www.cockroachlabs.com/get-cockroachdb/enterprise).

Feature | Description
--------|------------
[Change Data Capture](../v2.1/change-data-capture.html) (Beta)|  Change data capture (CDC) provides efficient, distributed, row-level change feeds into Apache Kafka for downstream processing such as reporting, caching, or full-text indexing. Use the [`CREATE CHANGEFEED`](../v2.1/create-changefeed.html) statement to create a new changefeed, which provides row-level change subscriptions.
[Encryption at Rest](../v2.1/encryption.html) (Experimental) | Encryption at Rest provides transparent encryption of a node's data on the local disk.
[`EXPORT`](../v2.1/export.html) (Beta)| The `EXPORT` statement exports tabular data or the results of arbitrary SELECT statements to CSV files. Using the CockroachDB [distributed execution engine](../v2.1/architecture/sql-layer.html#distsql), `EXPORT` parallelizes CSV creation across all nodes in the cluster, making it possible to quickly get large sets of data out of CockroachDB in a format that can be ingested by downstream systems.

<h3 id="v2.1.0-core-features">Core Features</h3>

These new features are freely available in the core version and do not require an enterprise license.

<h3 id="v2.1.0-sql">SQL</h3>

Feature | Description
--------|------------
[`ALTER TABLE ... ALTER TYPE`](../v2.1/alter-type.html) | The `ALTER TABLE ... ALTER TYPE` statement changes a column's [data type](../v2.1/data-types.html). Only type changes that neither require data checks nor data conversion are supported at this time.
[`ALTER COLUMN ... DROP STORED`](../v2.1/alter-column.html#convert-a-computed-column-into-a-regular-column) | The `ALTER TABLE ... ALTER COLUMN ... DROP STORED` statement converts a stored, [computed column](../v2.1/computed-columns.html) into a regular column.
[`CANCEL JOB`](../v2.1/cancel-job.html) | The `CANCEL JOB` statement can now be executed on long-running schema change jobs, causing them to terminate early and roll back. Also, the `CANCEL JOBS` variant of the statement lets you cancel multiple jobs at once.
[`CANCEL QUERIES`](../v2.1/cancel-query.html) | The `CANCEL QUERIES` variant of the `CANCEL QUERY` statement lets you cancel multiple queries at once.
[`CANCEL SESSIONS`](../v2.1/cancel-session.html) | The `CANCEL SESSIONS` variant of the `CANCEL SESSION` statement lets you stop multiple long-running sessions. `CANCEL SESSION` will attempt to cancel the currently active query and end the session.
[Cost-Based Optimizer](../v2.1/cost-based-optimizer.html) | The cost-based optimizer seeks the lowest cost for a query, usually related to time. In versions 2.1 and later, CockroachDB's cost-based optimizer is enabled by default.
[`CREATE STATISTICS`](../v2.1/create-statistics.html) (Experimental) | The `CREATE STATISTICS` statement generates table statistics for the [cost-based optimizer](../v2.1/cost-based-optimizer.html) to use.
[`EXPLAIN (DISTSQL)`](../v2.1/explain.html#distsql-option) | The `DISTSQL` option generates a physical query plan for a query. Query plans provide information around SQL execution, which can be used to troubleshoot slow queries.
[`EXPLAIN ANALYZE`](../v2.1/explain-analyze.html) | The `EXPLAIN ANALYZE` statement executes a SQL query and returns a physical query plan with execution statistics.
[Fast Deletes for Interleaved Tables](../v2.1/interleave-in-parent.html#benefits) | Under certain conditions, deleting rows from interleave tables that use [`ON DELETE CASCADE`](../v2.1/add-constraint.html#add-the-foreign-key-constraint-with-cascade) will use an optimized code path and run much faster.
[Lookup Joins](../v2.1/joins.html#lookup-joins) (Experimental) | A lookup join is beneficial to use when there is a large imbalance in size between the two tables, as it only reads the smaller table and then looks up matches in the larger table. A lookup join requires that the right-hand (i.e., larger) table is indexed on the equality column.
[`public` Role](../v2.1/authorization.html#create-and-manage-roles) | All users now belong to the `public` role, to which you can [grant](../v2.1/grant.html) and [revoke](../v2.1/revoke.html) privileges.
[`SET` (session variable)](../v2.1/set-vars.html)<br>[`SHOW` (session variable)](../v2.1/show-vars.html) | Added the following options: <ul><li>`statement_timeout`: The amount of time a statement can run before being stopped.</li><li>`optimizer`: The mode in which a query execution plan is generated. If set to `on`, the cost-based optimizer is enabled by default and the heuristic planner will only be used if the query is not supported by the cost-based optimizer; if set to `off`, all queries are run through the legacy heuristic planner.</li></ul>
[`SHOW STATISTICS`](../v2.1/show-statistics.html) (Experimental) | The `SHOW STATISTICS` statement lists [table statistics](../v2.1/create-statistics.html) used by the [cost-based optimizer](../v2.1/cost-based-optimizer.html).
[`SNAPSHOT` isolation level](../v2.1/transactions.html#isolation-levels) | **Removed.** Transactions that request to use `SNAPSHOT` are now mapped to [`SERIALIZABLE`](../v2.1/demo-serializable.html).
[Subquery Support](../v2.1/subqueries.html#correlated-subqueries) | CockroachDB's [cost-based optimizer](../v2.1/cost-based-optimizer.html) supports several common types of correlated subqueries. A subquery is said to be "correlated" when it uses table or column names defined in the surrounding query.

<h3 id="v2.1.0-cli">CLI</h3>

Feature | Description
--------|------------
[`cockroach demo`](../v2.1/cockroach-demo.html) | The `cockroach demo` command starts a temporary, in-memory, single-node CockroachDB cluster and opens an [interactive SQL shell](../v2.1/use-the-built-in-sql-client.html) to it.
[`cockroach start`](../v2.1/start-a-node.html) | The new `--advertise-addr` flag recognizes both a hostname/address and port and replaces the `--advertise-host` and `--advertise-port` flags, which are now deprecated.<br><br>The new `--listen-addr` flag recognizes both a hostname/address and port and replaces the `--host` and `--port` flags, which are now deprecated for `cockroach start` but remain valid for other client commands.<br><br>The new `--http-addr` flag recognizes both a hostname/address and port and replaces the `--http-host` flag, which is now deprecated.
[`cockroach sql`](../v2.1/use-the-built-in-sql-client.html) | The `cockroach sql` command and other client commands that display SQL results now use the new table result formatter by default, replacing the previous formatter called `pretty`. This provides more compact and more reusable results.
`cockroach zone` | **Deprecated.** The `cockroach zone` command has been deprecated. To manage [replication zones](../v2.1/configure-replication-zones.html), use the [`CONFIGURE ZONE`](../v2.1/configure-zone.html) statement to [add](../v2.1/configure-replication-zones.html#create-a-replication-zone-for-a-system-range), [modify](../v2.1/configure-replication-zones.html#edit-the-default-replication-zone), [reset](../v2.1/configure-replication-zones.html#reset-a-replication-zone), and [remove](../v2.1/configure-replication-zones.html#remove-a-replication-zone) replication zones.

<h3 id="v2.1.0-operations">Operations</h3>

Feature | Description
--------|------------
[Controlling Leaseholder Location](../v2.1/configure-replication-zones.html#constrain-leaseholders-to-specific-datacenters) | Using replication zones, you can now specify preferences for where a range's leaseholders should be placed to increase performance in some scenarios.
[DBeaver Support](../v2.1/third-party-database-tools.html) | DBeaver, a cross-platform database GUI, has been thoroughly vetted and tested with CockroachDB v2.1.
[Load-based Rebalancing](../v2.1/architecture/replication-layer.html#membership-changes-rebalance-repair) | In addition to the rebalancing that occurs when nodes join or leave a cluster, leases and replicas are rebalanced automatically based on the relative load across the nodes within a cluster. Note that depending on the needs of your deployment, you can exercise additional control over the location of leases and replicas by [configuring replication zones](../v2.1/configure-replication-zones.html).
[Migration from Postgres and MySQL](../v2.1/migration-overview.html) | The `IMPORT` command now supports importing dump files from Postgres and MySQL.
[Monitoring Kubernetes Deployments](../v2.1/orchestrate-cockroachdb-with-kubernetes.html) | Kubernetes tutorials now feature steps on how to integrate with[Prometheus](https://prometheus.io/), an open source tool for storing, aggregating, and querying timeseries data, and set up [Alertmanager](https://prometheus.io/docs/alerting/alertmanager/).
[Multi-Cluster Kubernetes Deployments](../v2.1/orchestrate-cockroachdb-with-kubernetes-multi-cluster.html) | You can now orchestrate a secure CockroachDB deployment across three Kubernetes clusters, each in a different geographic region, using the StatefulSet feature to manage the containers within each cluster and linking them together via DNS.
[Pipelining of Transactional Writes](../v2.1/architecture/transaction-layer.html#transaction-pipelining) | Transactional writes are pipelined when being replicated and when being written to disk, dramatically reducing the latency of transactions that perform multiple writes.
[Preferring Local Networks](../v2.1/start-a-node.html)| The new `--locality-advertise-addr` flag on [`cockroach start`](../v2.1/start-a-node.html#networking) can be used to tell nodes in specific localities to prefer local or private interfaces. This flag is useful when running a cluster across multiple networks, where nodes in a given network have access to a private or local interface while nodes outside the network do not.
[Rolling Upgrade Auto-finalization](../v2.1/upgrade-cockroach-version.html) | By default, as soon as all nodes are running CockroachDB v2.1, the upgrade process will be **auto-finalized**. This will enable certain performance improvements and bug fixes introduced in the new version.
[Viewing Node Status for an Unavailable Cluster](../v2.1/view-node-details.html) | The `cockroach node status` command can now be run even when majority of nodes are down. Running the command now shows an additional field: `is_available.`

<h3 id="v2.1.0-admin-ui">Admin UI</h3>

Feature | Description
--------|------------
[Advanced Debugging Page](../v2.1/admin-ui-debug-pages.html) (Experimental) | The **Advanced Debugging** page provides links to advanced monitoring and troubleshooting reports and cluster configuration details.
[Hardware Dashboard](../v2.1/admin-ui-hardware-dashboard.html) | The **Hardware** dashboard lets you monitor CPU usage, disk throughput, network traffic, storage capacity, and memory.
[Statements page](../v2.1/admin-ui-statements-page.html) | The **Statements** page helps you identify frequently executed or high latency SQL statements. It also allows you to view the details of SQL statement fingerprints, which are groupings of similar SQL statements with literal values replaced by underscores.
[User Authentication](../v2.1/admin-ui-access-and-navigate.html) | As of v2.1, users must have a [username and password](../v2.1/create-user.html) to access the Admin UI in a secure cluster.

<h3 id="v2.1.0-known-limitations">Known Limitations</h3>

For information about limitations we've identified in CockroachDB v2.1, with suggested workarounds where applicable, see [Known Limitations](../v2.1/known-limitations.html).

<h3 id="v2.1.0-documentation">Documentation</h3>

Topic | Description
------|------------
[Experimental Features](../v2.1/experimental-features.html) | This new page lists the experimental features that are available in CockroachDB v2.1.
[Client Connection Parameters](../v2.1/connection-parameters.html) | This new page describes the parameters used to establish a client connection. The client connection parameters determine which CockroachDB cluster they connect to, and how to establish this network connection.
[Deploying CockroachDB with `systemd`](../v2.1/manual-deployment.html) | The on-premises and cloud deployment tutorials now include instructions for using `systemd` to start the nodes of a cluster.  
[Manual and Automated Backups](../v2.1/backup-and-restore.html#automated-full-and-incremental-backups) | This page has been updated to provide both manual and automated backup guidance.
[Migration Guide](../v2.1/migration-overview.html) | This new guide provides an [overview of migrating to CockroachDB](../v2.1/migration-overview.html), as well as specific instructions for [migrating from Postgres](../v2.1/migrate-from-postgres.html), [migrating from MySQL](../v2.1/migrate-from-mysql.html), and [migrating from CSV](../v2.1/migrate-from-csv.html).
[Networking Guidance](../v2.1/recommended-production-settings.html#networking) | The Production Checklist now provides a detailed explanation of network flags and scenarios.
[Online Schema Changes](../v2.1/online-schema-changes.html) | This new page explains how CockroachDB updates table schema without imposing any downtown or negative consequences on applications.
[Performance Benchmarking](../v2.1/performance-benchmarking-with-tpc-c.html) | This page walks you through [TPC-C](http://www.tpc.org/tpcc/) performance benchmarking on CockroachDB. It measures tpmC (new order transactions/minute) on two TPC-C datasets: 1,000 warehouses (for a total dataset size of 200GB) on 3 nodes and 10,000 warehouses (for a total dataset size of 2TB) on 30 nodes.
[Performance Tuning](../v2.1/performance-tuning.html) | This new tutorial shows you essential techniques for getting fast reads and writes in CockroachDB, starting with a single-region deployment and expanding into multiple regions.
[Secure "Build an App"](../v2.1/build-an-app-with-cockroachdb.html) | Most client driver and ORM tutorials now provide code samples and guidance for secure clusters.
[Serializable Transactions](../v2.1/demo-serializable.html) | This new tutorial goes through a hypothetical scenario that demonstrates the importance of `SERIALIZABLE` isolation for data correctness.
[Window Functions](../v2.1/window-functions.html) | This new page provides information about window function support in CockroachDB.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.1-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.1
~~~

<h3 id="v2.1.1-sql-language-changes">SQL language changes</h3>

- Renamed the first column name returned by [`SHOW STATISTICS`](../v2.1/show-statistics.html) to `statistics_name`. [#32045][#32045] {% comment %}doc{% endcomment %}
- CockroachDB now de-correlates and successfully executes many queries containing correlated `EXISTS` subqueries. Previously, these queries caused a de-correlation error. [#32026][#32026] {% comment %}doc{% endcomment %}
- If [diagnostics reporting](../v2.1/diagnostics-reporting.html) is enabled, attempts to use `CREATE/DROP SCHEMA`, `DEFERRABLE`, `CREATE TABLE (LIKE ...)`, `CREATE TABLE ... WITH`, and the "fetch limit" parameter (e.g., via JDBC) will now be collected as telemetry to gauge demand for these currently unsupported features. Also, the name of SQL [built-in functions](../v2.1/functions-and-operators.html) will be collected upon evaluation errors. [#31638][#31638] {% comment %}doc{% endcomment %}

<h3 id="v2.1.1-bug-fixes">Bug fixes</h3>

- Fixed a small memory leak when running distributed queries. [#31759][#31759]
- The `confkey` column of `pg_catalog.pg_constraint` no longer includes columns that were not involved in the foreign key reference. [#31895][#31895]
- The [cost-based optimizer](../v2.1/cost-based-optimizer.html) no longer chooses the wrong index for a scan because of incorrect selectivity estimation. [#32011][#32011]
- Fixed a bug that caused transactions to unnecessarily return a "too large" error. [#31821][#31821]
- Fixed rare deadlocks during [`IMPORT`](../v2.1/import.html), [`RESTORE`](../v2.1/restore.html), and [`BACKUP`](../v2.1/backup.html). [#32016][#32016]
- Fixed a panic caused by incorrectly encoded Azure credentials. [#32016][#32016]
- Fixed a bug in the [cost-based optimizer](../v2.1/cost-based-optimizer.html) that sometimes prevented passing ordering requirements through aggregations. [#32089][#32089]
- Fixed a bug that sometimes caused invalid results or an "incorrectly ordered stream" error with streaming aggregations. [#32097][#32097]
- Fixed a bug that caused some queries with `DISTINCT ON` and `ORDER BY` with descending columns to return an error incorrectly. [#32175][#32175]
- Fixed a bug that caused queries with `GROUP BY` or `DISTINCT ON` to return incorrect results or an "incorrectly ordered stream" error. Also improved performance of some aggregations by utilizing streaming aggregation in more cases. [#32175][#32175]
- Fixed a panic caused by an incorrect assumption in the SQL optimizer code that `ROWS FROM` clauses contain only functions. [#32168][#32168]
- Fix an error returned by [`cockroach node status`](../v2.1/view-node-details.html) after a new node is added to the cluster at a previous node's address. [#32198][#32198]
- Fixed a mismatch between lookup join planning and execution, which could cause queries to fail with the error "X lookup columns specified, expecting at most Y". [#31896][#31896]
- Fixed a bug that caused transactions to appear partially committed. CockroachDB was sometimes claiming to have failed to commit a transaction when some (or all) of its writes were actually persisted. [#32220][#32220]
- Prevented long stalls that can occur in contended transactions. [#32217][#32217]
- Non-superusers can no longer see other users' sessions and queries via the `ListSessions` and `ListLocalSessions` status server API methods. [#32284][#32284]
- The graphite metrics sender now collects and sends only the latest data point instead of all data points since startup. [#31888][#31888]

<h3 id="v2.1.1-performance-improvements">Performance improvements</h3>

- Improved the performance of [`AS OF SYSTEM TIME`](../v2.1/as-of-system-time.html) queries by letting them use the table descriptor cache. [#31756][#31756]
- The [cost-based optimizer](../v2.1/cost-based-optimizer.html) can now determine more keys in certain cases involving unique indexes, potentially resulting in better plans. [#32044][#32044]
- Within a transaction, when performing a schema change after the table descriptor has been modified, accessing the descriptor should be faster. [#31756][#31756]

<h3 id="v2.1.1-doc-updates">Doc updates</h3>

- Corrected the flow control logic of the transaction code sample in the [Build a Java App with CockroachDB](../v2.1/build-a-java-app-with-cockroachdb.html) tutorial. [#4047](https://github.com/cockroachdb/docs/pull/4047)
- Expanded the [Running in a DaemonSet](../v2.1/kubernetes-performance.html#running-in-a-daemonset) instruction to cover both insecure and secure deployments. [#4037](https://github.com/cockroachdb/docs/pull/4037)
- Made it easier to find and link to specific [installation methods](../v2.1/install-cockroachdb.html), and updated the Homebrew instructions to note potential conflicts in cases where CockroachDB was previously installed using a different method. [#4032](https://github.com/cockroachdb/docs/pull/4032), [#4036](https://github.com/cockroachdb/docs/pull/4036)
- Updated the [`IMPORT`](../v2.1/import.html) documentation to cover [importing CockroachDB dump files](../v2.1/import.html#import-a-cockroachdb-dump-file). [#4029](https://github.com/cockroachdb/docs/pull/4029)

<h3 id="v2.1.1-contributors">Contributors</h3>

This release includes 27 merged PRs by 18 authors. We would like to thank the following contributors from the CockroachDB community:

- Vijay Karthik
- neeral

[#31638]: https://github.com/cockroachdb/cockroach/pull/31638
[#31756]: https://github.com/cockroachdb/cockroach/pull/31756
[#31759]: https://github.com/cockroachdb/cockroach/pull/31759
[#31821]: https://github.com/cockroachdb/cockroach/pull/31821
[#31845]: https://github.com/cockroachdb/cockroach/pull/31845
[#31873]: https://github.com/cockroachdb/cockroach/pull/31873
[#31888]: https://github.com/cockroachdb/cockroach/pull/31888
[#31895]: https://github.com/cockroachdb/cockroach/pull/31895
[#31896]: https://github.com/cockroachdb/cockroach/pull/31896
[#32011]: https://github.com/cockroachdb/cockroach/pull/32011
[#32016]: https://github.com/cockroachdb/cockroach/pull/32016
[#32026]: https://github.com/cockroachdb/cockroach/pull/32026
[#32044]: https://github.com/cockroachdb/cockroach/pull/32044
[#32045]: https://github.com/cockroachdb/cockroach/pull/32045
[#32089]: https://github.com/cockroachdb/cockroach/pull/32089
[#32097]: https://github.com/cockroachdb/cockroach/pull/32097
[#32168]: https://github.com/cockroachdb/cockroach/pull/32168
[#32175]: https://github.com/cockroachdb/cockroach/pull/32175
[#32198]: https://github.com/cockroachdb/cockroach/pull/32198
[#32217]: https://github.com/cockroachdb/cockroach/pull/32217
[#32220]: https://github.com/cockroachdb/cockroach/pull/32220
[#32284]: https://github.com/cockroachdb/cockroach/pull/32284
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.10-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.10.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.10.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.10.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.10-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.10
~~~

<h3 id="v2.1.10-security-updates">Security updates</h3>

- CockroachDB previously allowed non-authenticated access to privileged HTTP endpoints like `/_admin/v1/events`, which operate using `root` user permissions and can thus access (and sometimes modify) any and all data in the cluster. This security vulnerability has been patched by disallowing non-authenticated access to these endpoints and restricting access to admin users only.

    {{site.data.alerts.callout_info}}
    Users who have built monitoring automation using these HTTP endpoints must modify their automation to work using an HTTP session token for an admin user.
    {{site.data.alerts.end}}

- Some Admin UI screens (e.g., Jobs) were previously incorrectly displayed using `root` user permissions, regardless of the logged-in user's credentials. This enabled insufficiently privileged users to access privileged information. This security vulnerability has been patched by using the credentials of the logged-in user to display all Admin UI screens.

- Privileged HTTP endpoints and certain Admin UI screens require an admin user. However, `root` is disallowed from logging in via HTTP and it is not possible to create additional admin accounts without an Enterprise license. This is further discussed [here](https://github.com/cockroachdb/cockroach/issues/43870) and will be addressed in an upcoming patch revision.

    {{site.data.alerts.callout_info}}
    Users without an Enterprise license can create an additional admin user using a temporary evaluation license, until an alternative is available. A user created this way will persist beyond the license expiry.
    {{site.data.alerts.end}}

- Some Admin UI screens currently display an error or a blank page when viewed by a non-admin user (e.g., Table Details). This is a known limitation mistakenly introduced by the changes described above. This situation is discussed further [here](https://github.com/cockroachdb/cockroach/issues/44033) and will be addressed in an upcoming patch revision. The list of UI pages affected includes but is not limited to:

  - Job details
  - Database details
  - Table details
  - Zone configurations

    {{site.data.alerts.callout_info}}
    Users can access these Admin UI screens using an admin user until a fix is available.
    {{site.data.alerts.end}}

The list of HTTP endpoints affected by the first change above includes:

| HTTP Endpoint                                          | Description                       | Sensitive information revealed                     | Special (see below) |
|--------------------------------------------------------|-----------------------------------|----------------------------------------------------|---------------------|
| `/_admin/v1/data_distribution`                         | Database-table-node mapping       | Database and table names                           |                     |
| `/_admin/v1/databases/{database}/tables/{table}/stats` | Table stats histograms            | Stored table data  via PK values                   |                     |
| `/_admin/v1/drain`                                     | API to shut down a node           | Can cause DoS on cluster                           |                     |
| `/_admin/v1/enqueue_range`                             | Force range rebalancing           | Can cause DoS on cluster                           |                     |
| `/_admin/v1/events`                                    | Event log                         | Usernames, stored object names, privilege mappings |                     |
| `/_admin/v1/nontablestats`                             | Non-table statistics              | Stored table data via PK values                    |                     |
| `/_admin/v1/rangelog`                                  | Range log                         | Stored table data via PK values                    |                     |
| `/_admin/v1/settings`                                  | Cluster settings                  | Organization name                                  |                     |
| `/_status/allocator/node/{node_id}`                    | Rebalance simulator               | Can cause DoS on cluster                           | yes                 |
| `/_status/allocator/range/{range_id}`                  | Rebalance simulatoor              | Can cause DoS on cluster                           | yes                 |
| `/_status/certificates/{node_id}`                      | Node and user certificates        | Credentials                                        |                     |
| `/_status/details/{node_id}`                           | Node details                      | Internal IP addresses                              |                     |
| `/_status/enginestats/{node_id}`                       | Storage statistics                | Operational details                                |                     |
| `/_status/files/{node_id}`                             | Retrieve heap and goroutine dumps | Operational details                                | yes                 |
| `/_status/gossip/{node_id}`                            | Gossip details                    | Internal IP addresses                              | yes                 |
| `/_status/hotranges`                                   | Ranges with active requests       | Stored table data via PK values                    |                     |
| `/_status/local_sessions`                              | SQL sessions                      | Cleartext SQL queries                              | yes                 |
| `/_status/logfiles/{node_id}`                          | List of log files                 | Operational details                                | yes                 |
| `/_status/logfiles/{node_id}/{file}`                   | Server logs + entries             | Many: names, application data, credentials, etc.   | yes                 |
| `/_status/logs/{node_id}`                              | Log entries                       | Many: names, application data, credentials, etc.   | yes                 |
| `/_status/profile/{node_id}`                           | Profiling data                    | Operational details                                |                     |
| `/_status/raft`                                        | Raft details                      | Stored table data via PK values                    |                     |
| `/_status/range/{range_id}`                            | Range details                     | Stored table data via PK values                    |                     |
| `/_status/ranges/{node_id}`                            | Range details                     | Stored table data via PK values                    |                     |
| `/_status/sessions`                                    | SQL sessions                      | Cleartext SQL queries                              | yes                 |
| `/_status/span`                                        | Statistics per key span           | Whether certain table rows exist                   |                     |
| `/_status/stacks/{node_id}`                            | Stack traces                      | Application data, stored table data                |                     |
| `/_status/stores/{node_id}`                            | Store details                     | Operational details                                |                     |

{{site.data.alerts.callout_info}}
"Special" endpoints are subject to the [cluster setting](../v2.1/cluster-settings.html) `server.remote_debugging.mode`. Unless the setting was customized, clients are only able to connect from the same machine as the node.
{{site.data.alerts.end}}

<h3 id="v2.1.10-admin-ui-changes">Admin UI changes</h3>

- Certain web UI pages (like the list of databases or tables) now restrict their content to match the privileges of the logged-in user. [#42910][#42910]
- The event log now presents all cluster settings changes, unredacted, when an admin user uses the page. [#42910][#42910]
- Customization of the UI by users is now only properly saved if the user has write privilege to `system.ui` (i.e., is an admin user). Also, all authenticated users share the same customizations. This is a known limitation and should be lifted in a future version. [#42910][#42910]
- Access to table statistics are temporarily blocked from access by non-admin users until further notice, for security reasons. [#42910][#42910]
- Certain debug pages have been blocked from non-admin users for security reasons. [#42910][#42910]

<h3 id="v2.1.10-bug-fixes">Bug fixes</h3>

- Fixed a rare data corruption bug in RocksDB caused by newer Linux kernel's handling of i_generation on certain file systems. [#41394][#41394]
- Fixed a bug causing the `cluster_logical_timestamp()` function to sometimes return incorrect results. [#41442][#41442]
- Fixed a bug causing rapid network disconnections to lead to cluster unavailability because goroutines waited for a connection which would never be initialized to send its first heartbeat. [#42166][#42166]
- Fixed a case where we incorrectly determine that a query (or part of a query) which contains an `IS NULL` constraint on a unique index column returns at most one row, possibly ignoring a `LIMIT 1` clause. [#42793][#42793]
- [`ALTER INDEX IF EXISTS`](../v2.1/alter-index.html) no longer fails when using an unqualified index name that does not match any existing index. Now it is a no-op. [#42841][#42841]
- The `CommandQueue` no longer holds on to buffers if they become too large. This prevents unbounded growth of memory that may never be reclaimed. [#42961][#42961]
- The `CommandQueue` now clears references to objects in its buffers to allow those objects to be reclaimed by the garbage collector. [#42961][#42961]
- Fixed a bug causing disk stalls to allow a node to continue heartbeating its liveness record and prevent other nodes from taking over its leases, despite being completely unresponsive. [#41734][#41734]

<h3 id="v2.1.10-contributors">Contributors</h3>

This release includes 8 merged PRs by 9 authors.

[#42910]: https://github.com/cockroachdb/cockroach/pull/42910
[#41734]: https://github.com/cockroachdb/cockroach/pull/41734
[#41394]: https://github.com/cockroachdb/cockroach/pull/41394
[#41442]: https://github.com/cockroachdb/cockroach/pull/41442
[#42166]: https://github.com/cockroachdb/cockroach/pull/42166
[#42793]: https://github.com/cockroachdb/cockroach/pull/42793
[#42841]: https://github.com/cockroachdb/cockroach/pull/42841
[#42961]: https://github.com/cockroachdb/cockroach/pull/42961
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.11-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.11.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.11.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.11.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.11-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.11
~~~

<h3 id="v2.1.11-admin-ui-changes">Admin UI changes</h3>

- CockroachDB v2.1.0 included [security updates](v2.1.10.html#security-updates) that inadvertently caused some Admin UI pages requiring table details to not display. These pages display properly once again. [#44194][#44194]

<h3 id="v2.1.11-bug-fixes">Bug fixes</h3>

- Fixed panics caused by certain window functions that operate on tuples. [#43118][#43118]
- Prevented rare cases of infinite looping on database files written with a CockroachDB version earlier than v2.1.9. [#43255][#43255]
- [`EXPLAIN`](../v2.1/explain.html) can now be used with statements that use [`AS OF SYSTEM TIME`](../v2.1/as-of-system-time.html). [#43306][#43306] {% comment %}doc{% endcomment %}
- Fixed a panic when a log truncation took place concurrently with a replica being added to a Raft group. [#43314][#43314]
- Migrating the privileges on the `system.lease` table no longer creates a deadlock during a cluster upgrade. [#43633][#43633]

<h3 id="v2.1.11-contributors">Contributors</h3>

This release includes 6 merged PRs by 7 authors.

[#43118]: https://github.com/cockroachdb/cockroach/pull/43118
[#43255]: https://github.com/cockroachdb/cockroach/pull/43255
[#43306]: https://github.com/cockroachdb/cockroach/pull/43306
[#43314]: https://github.com/cockroachdb/cockroach/pull/43314
[#43633]: https://github.com/cockroachdb/cockroach/pull/43633
[#44194]: https://github.com/cockroachdb/cockroach/pull/44194
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.2-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.2-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.2
~~~

<h3 id="v2.1.2-backward-incompatible-changes">Backward-incompatible changes</h3>

- The `CHANGEFEED` [`experimental-avro` option](../v2.1/create-changefeed.html#options) has been renamed `experimental_avro`. [#32235][#32235]

<h3 id="v2.1.2-sql-language-changes">SQL language changes</h3>

- The [`IMPORT format (file)`](../v2.1/import.html) syntax is deprecated in favor of `IMPORT format file`. Similarly, `IMPORT TABLE ... FROM format (file)` is deprecated in favor of `IMPORT TABLE ... FROM format file`. [#31301][#31301] {% comment %}doc{% endcomment %}
- CockroachDB now accepts ordinary string values for placeholders of type `BPCHAR`, for compatibility with PostgreSQL clients that use them. [#32661][#32661]

<h3 id="v2.1.2-command-line-changes">Command-line changes</h3>

- The [`cockroach workload`](../v2.1/cockroach-workload.html) command now includes the `kv` load generator. [#32756][#32756] {% comment %}doc{% endcomment %}

<h3 id="v2.1.2-bug-fixes">Bug fixes</h3>

- Fixed a panic on [`UPDATE ... RETURNING *`](../v2.1/update.html) during a schema change. [#32591][#32591]
- Fixed a panic on [`UPSERT`](../v2.1/upsert.html) in the middle of a schema change adding a non-nullable column. [#32730][#32730]
- Fixed a bug that prevents adding [computed columns](../v2.1/computed-columns.html) with the [`NOT NULL`](../v2.1/not-null.html) constraint. [#32730][#32730]
- Fixed a deadlock when using [`ALTER TABLE ... VALIDATE CONSTRAINT`](../v2.1/validate-constraint.html) in a transaction with a schema change. [#32850][#32850]
- Prevented a performance degradation related to overly aggressive Raft log truncations that could occur during [`RESTORE`](../v2.1/restore.html) or [`IMPORT`](../v2.1/import.html) operations.
- Prevented a stall in the processing of Raft snapshots when many snapshots are requested at the same time. [#32414][#32414]
- [`CHANGEFEED`s](../v2.1/create-changefeed.html) now escape Kafka topic names, when necessary. [#32235][#32235] {% comment %}doc{% endcomment %}
- [`CHANGEFEED`s](../v2.1/create-changefeed.html) now spend dramatically less time flushing Kafka writes. [#32235][#32235]
- [`CHANGEFEED`s](../v2.1/create-changefeed.html) with the `experimental_avro` option now work with column `WIDTH`s and `PRECISION`s. [#32484][#32484] {% comment %}doc{% endcomment %}
- Fixed a bug where Raft proposals could get stuck if forwarded to a leader who could not itself append a new entry to its log. [#32600][#32600]
- Fixed a bug where calling [`CREATE STATISTICS`](../v2.1/create-statistics.html) on a large table could cause the server to crash due to running out of memory. [#32635][#32635]
- Fixed a bug that could cause data loss bug when a disk becomes temporarily full. [#32633][#32633]
- CockroachDB now reports an unimplemented error when a `WHERE` clause is used after [`INSERT ... ON CONFLICT`](../v2.1/insert.html). [#32558][#32558] {% comment %}doc{% endcomment %}
- CockroachDB now properly handles [foreign key cascading actions](../v2.1/foreign-key.html#foreign-key-actions) `SET DEFAULT` and `SET NULL` in [`SHOW CREATE`](../v2.1/show-create.html) and [`cockroach dump`](../v2.1/sql-dump.html). [#32630][#32630]
- Fixed a crash that could occur during or after a data import on Windows. [#32666][#32666]
- Lookup joins now properly preserve ordering for outer joins. Previously, under specific conditions, `LEFT JOIN` queries could produce results that did not respect the `ORDER BY` clause. [#32678][#32678]
- CockroachDB once again enables `admin` users, including `root`, to list all user sessions besides their own. [#32709][#32709]
- CockroachDB now properly rejects queries that use an invalid function (e.g., an aggregation) in the `SET` clause of an [`UPDATE`](../v2.1/update.html) statement. [#32506][#32506]
- Dates no longer have a time component in their text encoding over the wire. [#32661][#32661]
- Corrected binary decimal encoding for `NaN`. [#32661][#32661]
- Prevented a panic when encountering an internal error related to invalid entries in the output of [`SHOW SESSIONS`](../v2.1/show-sessions.html). [#32742][#32742]
- Prevented a panic when running certain subqueries that get planned in a distributed fashion. [#32670][#32670]
- [`CHANGEFEED`s](../v2.1/create-changefeed.html) emitting into Kafka more quickly notice new partitions. [#32757][#32757]
- CockroachDB now properly records statistics for sessions where the value of `application_name` is given by the client during initialization instead of `SET`. [#32755][#32755]
- CockroachDB now properly evaluates [`CHECK`](../v2.1/check.html) constraints after a row conflict in [`INSERT ... ON CONFLICT`](../v2.1/insert.html) when the `CHECK` constraint depends on a column not assigned by `DO UPDATE SET`. [#32780][#32780]
- The [`cockroach workload run`](../v2.1/cockroach-workload.html) subcommand no longer applies to data-only generators. [#32827][#32827] {% comment %}doc{% endcomment %}
- Fixed a bug where metadata about contended keys was inadvertently ignored, in rare cases allowing for a failure in transaction cycle detection and transaction deadlocks. [#32853][#32853]

<h3 id="v2.1.2-performance-improvements">Performance improvements</h3>

- Changed the default value for the `kv.transaction.write_pipelining_max_batch_size` [cluster setting](../v2.1/cluster-settings.html) to `128`. This speeds up bulk write operations. [#32621][#32621] {% comment %}doc{% endcomment %}

<h3 id="v2.1.2-doc-updates">Doc updates</h3>

- Documented the [`cockroach workload`](../v2.1/cockroach-workload.html) command, which provides built-in load generators for simulating different types of client workloads, and updated various tutorials to use these workloads. [#4087](https://github.com/cockroachdb/docs/pull/4087)
- Expanded the [`cockroach demo`](../v2.1/cockroach-demo.html) documentation to explain the use of built-in datasets. [#4087](https://github.com/cockroachdb/docs/pull/4087)
- Added a secure version of the [Performance Tuning](../v2.1/performance-tuning.html) tutorial. [#4123](https://github.com/cockroachdb/docs/pull/4123)
- Clarified that primary key columns cannot be [stored with a secondary index](../v2.1/create-index.html). [#4098](https://github.com/cockroachdb/docs/pull/4098)  
- Clarified when to use [`DELETE`](../v2.1/delete.html) vs. [`TRUNCATE`](../v2.1/truncate.html). [#4094](https://github.com/cockroachdb/docs/pull/4094)
- Added important considerations when setting up [clock synchronization](../v2.1/recommended-production-settings.html#clock-synchronization).
- Clarified the documentation on [automatic transaction retries](../v2.1/transactions.html#automatic-retries). [#4044](https://github.com/cockroachdb/docs/pull/4044)

<h3 id="v2.1.2-contributors">Contributors</h3>

This release includes 41 merged PRs by 15 authors.

[#31301]: https://github.com/cockroachdb/cockroach/pull/31301
[#32235]: https://github.com/cockroachdb/cockroach/pull/32235
[#32412]: https://github.com/cockroachdb/cockroach/pull/32412
[#32414]: https://github.com/cockroachdb/cockroach/pull/32414
[#32484]: https://github.com/cockroachdb/cockroach/pull/32484
[#32506]: https://github.com/cockroachdb/cockroach/pull/32506
[#32558]: https://github.com/cockroachdb/cockroach/pull/32558
[#32591]: https://github.com/cockroachdb/cockroach/pull/32591
[#32600]: https://github.com/cockroachdb/cockroach/pull/32600
[#32621]: https://github.com/cockroachdb/cockroach/pull/32621
[#32630]: https://github.com/cockroachdb/cockroach/pull/32630
[#32633]: https://github.com/cockroachdb/cockroach/pull/32633
[#32635]: https://github.com/cockroachdb/cockroach/pull/32635
[#32661]: https://github.com/cockroachdb/cockroach/pull/32661
[#32666]: https://github.com/cockroachdb/cockroach/pull/32666
[#32670]: https://github.com/cockroachdb/cockroach/pull/32670
[#32678]: https://github.com/cockroachdb/cockroach/pull/32678
[#32709]: https://github.com/cockroachdb/cockroach/pull/32709
[#32730]: https://github.com/cockroachdb/cockroach/pull/32730
[#32742]: https://github.com/cockroachdb/cockroach/pull/32742
[#32755]: https://github.com/cockroachdb/cockroach/pull/32755
[#32756]: https://github.com/cockroachdb/cockroach/pull/32756
[#32757]: https://github.com/cockroachdb/cockroach/pull/32757
[#32780]: https://github.com/cockroachdb/cockroach/pull/32780
[#32827]: https://github.com/cockroachdb/cockroach/pull/32827
[#32850]: https://github.com/cockroachdb/cockroach/pull/32850
[#32853]: https://github.com/cockroachdb/cockroach/pull/32853
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.3-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.3.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.3.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.3.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.3-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.3
~~~

<h3 id="v2.1.3-enterprise-edition-changes">Enterprise edition changes</h3>

- Added timeseries metrics for debugging [`CHANGEFEED`](../v2.1/create-changefeed.html) performance issues. [#32872][#32872] {% comment %}doc{% endcomment %}

<h3 id="v2.1.3-bug-fixes">Bug fixes</h3>

- Resolved a cluster degradation scenario that could occur during [`IMPORT`](../v2.1/import.html)/[`RESTORE`](../v2.1/restore.html) operations, which manifested through a high number of pending Raft snapshots. [#33015][#33015]
- Fixed a bug that could cause under-replication or unavailability in 5-node clusters and those using high replication factors. [#33047][#33047]
- Fixed an infinite loop in a low-level scanning routine that could be hit in unusual circumstances. [#33065][#33065]

<h3 id="v2.1.3-build-changes">Build changes</h3>

- `ncurses` is now linked statically so that the `cockroach` binary no longer requires a particular version of the `ncurses` shared library to be available on deployment machines. [#32960][#32960] {% comment %}doc{% endcomment %}

<h3 id="v2.1.3-contributors">Contributors</h3>

This release includes 10 merged PRs by 8 authors.

[#32872]: https://github.com/cockroachdb/cockroach/pull/32872
[#32960]: https://github.com/cockroachdb/cockroach/pull/32960
[#33015]: https://github.com/cockroachdb/cockroach/pull/33015
[#33047]: https://github.com/cockroachdb/cockroach/pull/33047
[#33065]: https://github.com/cockroachdb/cockroach/pull/33065
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.4-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.4.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.4.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.4.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.4-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.4
~~~

<h3 id="v2.1.4-enterprise-edition-changes">Enterprise edition changes</h3>

- It is now possible to use AWS S3 temporary credentials for [`BACKUP`](../v2.1/backup.html)/[`RESTORE`](../v2.1/restore.html) and [`IMPORT`](../v2.1/import.html)/[`EXPORT`](../v2.1/export.html) using the `AWS_SESSION_TOKEN` parameter in the URL. [#33046][#33046] {% comment %}doc{% endcomment %}}

<h3 id="v2.1.4-sql-language-changes">SQL language changes</h3>

- Added support for the `pg_catalog` introspection table `pg_am` for both PostgreSQL versions 9.5 and 9.6, which changed the table significantly. [#33276][#33276]
- Previously, CockroachDB did not consider the value of the right operand for `<<` and `>>` operators, resulting in potentially very large results and excessive RAM consumption. This has been fixed to restrict the range of these values to that supported for the left operand. [#33247][#33247]
- Attempts to use some PostgreSQL built-in functions that are not yet supported in CockroachDB now cause a clearer error message, and also become reported in [diagnostics reporting](../v2.1/diagnostics-reporting.html), if diagnostics reporting is enabled, so as to gauge demand. [#33427][#33427] {% comment %}doc{% endcomment %}}

<h3 id="v2.1.4-bug-fixes">Bug fixes</h3>

- Fixed a bug where schema changes could get stuck for 5 minutes when executed immediately after a server restart. [#33062][#33062]
- Fixed a bug with returning dropped unique columns in [`DELETE`](../v2.1/delete.html) statements with `RETURNING`. [#33541][#33541]
- [`CHANGEFEED`](../v2.1/create-changefeed.html)s and incremental [`BACKUP`](../v2.1/backup.html)s no longer indefinitely hang under an infrequent condition. [#33141][#33141]
- The output of [`cockroach node status --ranges`](../v2.1/view-node-details.html) previously listed the count of under-replicated ranges in the `ranges_unavailable` column and the number of unavailable ranges in the `ranges_underreplicated` column. This fixes that mix-up. [#32951][#32951]
- Fixed a possible goroutine leak when canceling queries. [#33137][#33137]
- Cancel requests (via the pgwire protocol) now close quickly with an EOF instead of hanging but still do not cancel the request. [#33246][#33246]
- Fixed pgwire binary decoding of decimal `NaN` and `NULL` values in arrays. [#33306][#33306]
- The [`UPSERT`](../v2.1/upsert.html) and [`INSERT ON CONFLICT`](../v2.1/insert.html) statements now properly check that the user has the `SELECT` privilege on the target table. [#33359][#33359]
- CockroachDB does not crash upon running [`SHOW SESSIONS`](../v2.1/show-sessions.html), [`SHOW QUERIES`](../v2.1/show-queries.html), and inspections of some `crdb_internal` tables when certain SQL sessions are issuing internal SQL queries. [#33261][#33261]
- CockroachDB no longer reports under-replicated ranges corresponding to replicas that are waiting to be deleted. [#33407][#33407]
- Fixed a panic that could result from not supplying a nullable column in an [`INSERT ON CONFLICT ... DO UPDATE`](../v2.1/insert.html) statement. [#33309][#33309]
- Resolved a cluster degradation scenario that could occur during [`IMPORT`](../v2.1/import.html)/[`RESTORE`](../v2.1/restore.html) operations, which manifested through a high number of pending Raft snapshots.  [#33587][#33587]
- Fixed a panic caused by some queries involving lookup joins where an input ordering must be preserved. [#33522][#33522]
- Prevented a panic with certain queries that use the statement source (square bracket) syntax. [#33723][#33723]
- [Window functions](../v2.1/window-functions.html) with non-empty `PARTITION BY` and `ORDER BY` clauses are now handled correctly when invoked via an external driver. [#33671][#33671]

<h3 id="v2.1.4-performance-improvements">Performance improvements</h3>

- Improved the execution plans of some queries using `LIKE`. [#33072][#33072]

<h3 id="v2.1.4-doc-updates">Doc updates</h3>

- The new [Life of a Distributed Transaction](../v2.1/architecture/life-of-a-distributed-transaction.html) details the path that a query takes through CockroachDB's architecture, starting with a SQL client and progressing all the way to RocksDB (and then back out again). [#4281](https://github.com/cockroachdb/docs/pull/4281)
- Updated the [Production Checklist](../v2.1/recommended-production-settings.html) with more current hardware recommendations and additional guidance on storage, file systems, and clock synch. [#4153](https://github.com/cockroachdb/docs/pull/4153)
- Expanded the [SQLAlchemy tutorial](../v2.1/build-a-python-app-with-cockroachdb-sqlalchemy.html) to provide code for transaction retries and best practices for using SQLAlchemy with CockroachDB. [#4142](https://github.com/cockroachdb/docs/pull/4142)

<h3 id="v2.1.4-contributors">Contributors</h3>

This release includes 33 merged PRs by 17 authors. We would especially like to thank first-time contributor shakeelrao.

[#32951]: https://github.com/cockroachdb/cockroach/pull/32951
[#33046]: https://github.com/cockroachdb/cockroach/pull/33046
[#33062]: https://github.com/cockroachdb/cockroach/pull/33062
[#33072]: https://github.com/cockroachdb/cockroach/pull/33072
[#33137]: https://github.com/cockroachdb/cockroach/pull/33137
[#33141]: https://github.com/cockroachdb/cockroach/pull/33141
[#33246]: https://github.com/cockroachdb/cockroach/pull/33246
[#33247]: https://github.com/cockroachdb/cockroach/pull/33247
[#33261]: https://github.com/cockroachdb/cockroach/pull/33261
[#33276]: https://github.com/cockroachdb/cockroach/pull/33276
[#33306]: https://github.com/cockroachdb/cockroach/pull/33306
[#33309]: https://github.com/cockroachdb/cockroach/pull/33309
[#33359]: https://github.com/cockroachdb/cockroach/pull/33359
[#33407]: https://github.com/cockroachdb/cockroach/pull/33407
[#33427]: https://github.com/cockroachdb/cockroach/pull/33427
[#33522]: https://github.com/cockroachdb/cockroach/pull/33522
[#33541]: https://github.com/cockroachdb/cockroach/pull/33541
[#33587]: https://github.com/cockroachdb/cockroach/pull/33587
[#33671]: https://github.com/cockroachdb/cockroach/pull/33671
[#33723]: https://github.com/cockroachdb/cockroach/pull/33723
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.5-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.5.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.5.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.5.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.5-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.5
~~~

<h3 id="v2.1.5-enterprise-edition-changes">Enterprise edition changes</h3>

- Added support for standard HTTP proxy environment variables in HTTP and S3 storage. [#34535][#34535] {% comment %}doc{% endcomment %}

<h3 id="v2.1.5-sql-language-changes">SQL language changes</h3>

- It is now possible to force a reverse scan of a specific index using `table@{FORCE_INDEX=index,DESC}`. [#34121][#34121] {% comment %}doc{% endcomment %}
- The value of `information_schema.columns.character_maximum_column` is set to `NULL` for all integer types, for compatibility with PostgreSQL. [#34201][#34201] {% comment %}doc{% endcomment %}

<h3 id="v2.1.5-command-line-changes">Command-line changes</h3>

- Fixed a bug in [`cockroach node status`](../v2.1/view-node-details.html) that prevented it from displaying down nodes in the cluster in some circumstances. [#34503][#34503]

<h3 id="v2.1.5-bug-fixes">Bug fixes</h3>

- Lookup joins now properly preserve their input order even if more than one row of the input corresponds to the same row of the lookup table. [#33730][#33730]
- Fixed a goroutine leak that would occur while a cluster was unavailable (or a subset of nodes partitioned away from the cluster) and would cause a resource spike to resolve. [#34144][#34144]
- Fixed panics or incorrect results in some cases when grouping on constant columns (either with `GROUP BY` or `DISTINCT ON`). [#34168][#34168]
- The values reported in `information_schema.columns` for integer columns created prior to CockroachDB v2.1 as `BIT` are now fixed and consistent with other integer types. [#34201][#34201]
- Fixed a bug that would delay Raft log truncations. [#34284][#34284]
- Prevented down-replicating widely replicated ranges when nodes in the cluster are temporarily down. [#34199][#34199]
- CockroachDB now enables re-starting a node at an address previously allocated for another node. [#34198][#34198]
- [`CHANGEFEED`](../v2.1/create-changefeed.html)s now can be started on tables that have been backfilled by schema changes. [#34362][#34362]
- Fixed a back up in flow creation observed by "no inbound stream connection" caused by not releasing a lock before attempting a possibly blocking operation. [#34364][#34364]
- Fixed a panic when updating a job that doesn't exist. [#34672][#34672]
- Fixed a bug in [`RESTORE`](../v2.1/restore.html) that prevented restoring some [`BACKUP`](../v2.1/backup.html)s containing previously dropped or truncated interleaved tables. [#34719][#34719]
- The value of the `attnum` column in `pg_catalog.pg_attribute` now remains stable across column drops. [#34734][#34734]
- Prevented a problem that would cause the Raft log to grow very large, which in turn could prevent replication changes. [#34774][#34774]
- Prevented down nodes from obstructing Raft log truncation on ranges they are a member of. This problem could cause replication to fail due to an overly large Raft log. [#34774][#34774]
- Fixed a bug that would incorrectly cause JSON field access equality comparisons to be true when they should be false. [#32214][#32214]

<h3 id="v2.1.5-performance-improvements">Performance improvements</h3>

- Index joins, lookup joins, foreign key checks, cascade scans, zig zag joins, and `UPSERT`s no longer needlessly scan over child interleaved tables when searching for keys. [#33652][#33652]

<h3 id="v2.1.5-doc-updates">Doc updates</h3>

- Updated the [SQL Performance Best Practices](../v2.1/performance-best-practices-overview.html#interleave-tables) with caveats around interleaving tables. [#4273](https://github.com/cockroachdb/docs/pull/4273)
- Added a note that when a table that was previously [split](../v2.1/split-at.html) is truncated, the table must be pre-split again. [#4274](https://github.com/cockroachdb/docs/pull/4274)
- Added guidance on [removing `UNIQUE` constraints](../v2.1/constraints.html#remove-constraints). [#4276](https://github.com/cockroachdb/docs/pull/4276)
- Added a [warning about cross-store rebalancing](../v2.1/start-a-node.html#store) not working as expected in 3-node clusters with multiple stores per node. [#4320](https://github.com/cockroachdb/docs/pull/4320)

<h3 id="v2.1.5-contributors">Contributors</h3>

This release includes 26 merged PRs by 12 authors.

[#32214]: https://github.com/cockroachdb/cockroach/pull/32214
[#33652]: https://github.com/cockroachdb/cockroach/pull/33652
[#33730]: https://github.com/cockroachdb/cockroach/pull/33730
[#34121]: https://github.com/cockroachdb/cockroach/pull/34121
[#34144]: https://github.com/cockroachdb/cockroach/pull/34144
[#34168]: https://github.com/cockroachdb/cockroach/pull/34168
[#34198]: https://github.com/cockroachdb/cockroach/pull/34198
[#34199]: https://github.com/cockroachdb/cockroach/pull/34199
[#34201]: https://github.com/cockroachdb/cockroach/pull/34201
[#34284]: https://github.com/cockroachdb/cockroach/pull/34284
[#34362]: https://github.com/cockroachdb/cockroach/pull/34362
[#34364]: https://github.com/cockroachdb/cockroach/pull/34364
[#34503]: https://github.com/cockroachdb/cockroach/pull/34503
[#34535]: https://github.com/cockroachdb/cockroach/pull/34535
[#34672]: https://github.com/cockroachdb/cockroach/pull/34672
[#34719]: https://github.com/cockroachdb/cockroach/pull/34719
[#34734]: https://github.com/cockroachdb/cockroach/pull/34734
[#34774]: https://github.com/cockroachdb/cockroach/pull/34774
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.6-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.6.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.6.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.6.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.6-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.6
~~~

<h3 id="v2.1.6-bug-fixes">Bug fixes</h3>

- Fixed a panic when the subquery in `UPDATE SET (a,b) = (...subquery...)` returns no rows. [#34805][#34805]
- CockroachDB now only lists tables in `pg_catalog.pg_tables`, for compatibility with PostgreSQL. [#34858][#34858]
- Fixed a panic during some `UNION ALL` operations with projections, filters, or renders directly on top of the `UNION ALL`. [#34913][#34913]
- Fixed a planning bug that caused incorrect aggregation results on multi-node aggregations with implicit, partial orderings on the inputs to the aggregations. [#35259][#35259]

<h3 id="v2.1.6-doc-updates">Doc updates</h3>

- Added much more guidance on [troubleshooting cluster setup](../v2.1/cluster-setup-troubleshooting.html) and [troubleshooting SQL behavior](../v2.1/query-behavior-troubleshooting.html). [#4223](https://github.com/cockroachdb/docs/pull/4223)

<h3 id="v2.1.6-contributors">Contributors</h3>

This release includes 9 merged PRs by 7 authors.

[#34805]: https://github.com/cockroachdb/cockroach/pull/34805
[#34858]: https://github.com/cockroachdb/cockroach/pull/34858
[#34913]: https://github.com/cockroachdb/cockroach/pull/34913
[#35259]: https://github.com/cockroachdb/cockroach/pull/35259
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.7-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.7.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.7.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.7.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.7-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.7
~~~

<h3 id="v2.1.7-bug-fixes">Bug fixes</h3>

- Fixed a bug in [`RESTORE`](../v2.1/restore.html) where some unusual range boundaries in [interleaved tables](../v2.1/interleave-in-parent.html) caused an error. [#36006][#36006]
- CockroachDB now properly applies column width and nullability constraints on the result of conflict resolution in [`UPSERT`](../v2.1/upsert.html) and [`INSERT ON CONFLICT`](../v2.1/insert.html). [#35373][#35373]
- Subtracting `0` from a [`JSONB`](../v2.1/jsonb.html) array now correctly removes its first element. [#35619][#35619]
- Fixed an on-disk inconsistency that could result from a crash during a range merge. [#35752][#35752]
- While a cluster is unavailable (e.g., during a network partition), memory and goroutines used for authenticating connections no longer leak when the client closes said connections. [#36231][#36231]
- Single column family [`JSONB`](../v2.1/jsonb.html) columns are now decoded correctly. [#36628][#36628]
- Fixed a rare inconsistency that could occur on overloaded clusters. [#36960][#36960]
- Fixed a possible panic while recovering from a WAL on which a sync operation failed. [#37214][#37214]
- Reduced the risk of data unavailability during AZ/region failure. [#37336][#37336]

<h3 id="v2.1.7-build-changes">Build changes</h3>

- CockroachDB will provisionally refuse to build with go 1.12, as this is known to produce incorrect code inside CockroachDB. [#35639][#35639]
- Release Docker images are now built on Debian 9.8. [#35737][#35737]

<h3 id="v2.1.7-contributors">Contributors</h3>

This release includes 15 merged PRs by 12 authors.

[#35373]: https://github.com/cockroachdb/cockroach/pull/35373
[#35619]: https://github.com/cockroachdb/cockroach/pull/35619
[#35639]: https://github.com/cockroachdb/cockroach/pull/35639
[#35737]: https://github.com/cockroachdb/cockroach/pull/35737
[#35752]: https://github.com/cockroachdb/cockroach/pull/35752
[#36006]: https://github.com/cockroachdb/cockroach/pull/36006
[#36231]: https://github.com/cockroachdb/cockroach/pull/36231
[#36628]: https://github.com/cockroachdb/cockroach/pull/36628
[#36960]: https://github.com/cockroachdb/cockroach/pull/36960
[#37214]: https://github.com/cockroachdb/cockroach/pull/37214
[#37336]: https://github.com/cockroachdb/cockroach/pull/37336
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.8-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.8.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.8.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.8.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.8-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.8
~~~

<h3 id="v2.1.8-bug-fixes">Bug fixes</h3>

- Fixed crashes when trying to run certain `SHOW` commands via the pgwire prepare path. [#37891][#37891]
- Fixed a rare crash ("close of closed channel") that would occur when shutting down a server. [#37893][#37893]
- Previously, due to a bug when estimating result set sizes in the [Optimizer](../v2.1/cost-based-optimizer.html), queries involving large `INT` ranges could result in poor plans being generated. [#38039][#38039]
- `NULL`s are now correctly handled by `MIN`, `SUM`, and `AVG` when used as [window functions](../v2.1/window-functions.html). [#38357][#38357]
- Prevented a possible missing row from queries that involved iterator reuse and seeking into the gap between stables bridged by a range tombstone. [#37694][#37694]

<h3 id="v2.1.8-security-improvements">Security improvements</h3>

- Only check `CommonName` on first certificate in file. [#38166][#38166]
- Stack memory used by CockroachDB is now marked as non-executable, improving security and compatibility with SELinux. [#38134][#38134]

<h3 id="v2.1.8-contributors">Contributors</h3>

This release includes 12 merged PRs by 11 authors.

[#37694]: https://github.com/cockroachdb/cockroach/pull/37694
[#37891]: https://github.com/cockroachdb/cockroach/pull/37891
[#37893]: https://github.com/cockroachdb/cockroach/pull/37893
[#38039]: https://github.com/cockroachdb/cockroach/pull/38039
[#38134]: https://github.com/cockroachdb/cockroach/pull/38134
[#38166]: https://github.com/cockroachdb/cockroach/pull/38166
[#38357]: https://github.com/cockroachdb/cockroach/pull/38357
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v2.1.9-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.9.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.9.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.9.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v2.1.9-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.9
~~~

<h3 id="v2.1.9-bug-fixes">Bug fixes</h3>

- Fixed a bug that could lead to data inconsistencies and crashes with the message `consistency check failed with N inconsistent replicas`. [#40353][#40353]
- Fixed incorrect results, or "unordered span" errors, in some cases involving exclusive inequalities with non-numeric types. [#38897][#38897]
- Fixed a potential infinite loop in queries involving reverse scans. [#39105][#39105]
- Unary negatives in constant arithmetic expressions are no longer ignored. [#39368][#39368]
- Fix wrong comparator used in RocksDB compaction picker, which can lead to infinite compaction loop. [#40752][#40752]
- Fix bug where MVCC value at future timestamp is returned after a transaction restart. [#40632][#40632]
- Consider intents in a read's uncertainty interval to be uncertain just as if they were committed values. This removes the potential for stale reads when a causally dependent transaction runs into the not-yet resolved intents from a causal ancestor. [#40632][#40632]

<h3 id="v2.1.9-contributors">Contributors</h3>

This release includes 8 merged PRs by 4 authors.

[#38897]: https://github.com/cockroachdb/cockroach/pull/38897
[#39105]: https://github.com/cockroachdb/cockroach/pull/39105
[#39368]: https://github.com/cockroachdb/cockroach/pull/39368
[#40353]: https://github.com/cockroachdb/cockroach/pull/40353
[#40632]: https://github.com/cockroachdb/cockroach/pull/40632
[#40680]: https://github.com/cockroachdb/cockroach/pull/40680
[#40711]: https://github.com/cockroachdb/cockroach/pull/40711
[#40752]: https://github.com/cockroachdb/cockroach/pull/40752
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

Since our initial launch, Cockroach Labs has used semantic versioning in our release cycle guidelines. Two years, one major release, and n-patch fixes later, we're making the switch to Calendar Versioning. This means subscribers to our release notes will see quite the jump in today's version numbering, from last week's 2.1.5 to today's 19.1 beta. You can read more about the switch [here](https://www.cockroachlabs.com/blog/calendar-versioning).

<h3 id="v19.1.0-beta.20190225-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-beta.20190225.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-beta.20190225.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-beta.20190225.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

{{site.data.alerts.callout_danger}}This release has a deadlock bug that may result in nodes getting stuck in certain situations. This bug will be fixed in next week's beta. In the meantime, restart stuck nodes to recover.{{site.data.alerts.end}}

<h3 id="v19.1.0-beta.20190225-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.1.0-beta.20190225
~~~

<h3 id="v19.1.0-beta.20190225-general-changes">General changes</h3>

- Records for completed jobs are cleaned up automatically after two weeks. [#34725][#34725]
- [`SHOW JOBS`](../v19.1/show-jobs.html) now returns only running and recently finished jobs. Older jobs can still be inspected via the `crdb_internal.jobs` table. [#34829][#34829] {% comment %}doc{% endcomment %}

<h3 id="v19.1.0-beta.20190225-enterprise-edition-changes">Enterprise edition changes</h3>

- `nodelocal://` storage paths for [`BACKUP`](../v19.1/backup.html), [`RESTORE`](../v19.1/restore.html), and [`IMPORT`](../v19.1/import.html) may include a node-ID in the Host part of the URI. It is not currently used (any node can get sent work and will look in its local IO directory) but will likely be required in the future. [#34797][#34797] {% comment %}doc{% endcomment %}
- [`CHANGEFEED`s](../v19.1/create-changefeed.html) targeting cloud sinks now partition files into date folders. [#34813][#34813] {% comment %}doc{% endcomment %}
- The new `kv.rangefeed.concurrent_catchup_iterators` [cluster setting](../v19.1/cluster-settings.html) limits the number of rangefeed catchup iterators a store will allow concurrently before queueing. [#34890][#34890] {% comment %}doc{% endcomment %}
- The [`CHANGEFEED` `experimental_avro`](../v19.1/create-changefeed.html#options) format now supports SQL columns of type `DATE`, `TIME`, `UUID`, `INET`, and `JSONB`. [#34918][#34918] {% comment %}doc{% endcomment %}

<h3 id="v19.1.0-beta.20190225-sql-language-changes">SQL language changes</h3>

- Virtual tables in `pg_catalog` and `information_schema` now support `COMMENT ON` like regular tables. [#33697][#33697]

<h3 id="v19.1.0-beta.20190225-bug-fixes">Bug fixes</h3>

- Fixed a bug that could cause a Raft log to grow very large, which in turn could prevent replication changes. [#34502][#34502]
- Prevented down nodes from obstructing log truncation on ranges they are a member of. This problem could cause replication to fail due to an overly large Raft log. [#34712][#34712]
- Fixed a panic when subtracting an array containing null from a JSON datum. [#34757][#34757]
- Fixed a panic during some `UNION ALL` operations with projections, filters, or renders directly on top of the `UNION ALL`. [#34762][#34762]
- Fixed a panic when the subquery in `UPDATE SET (a,b) = (...subquery...)` returns no rows. [#34804][#34804]
- Fixed a rare panic ("close of closed channel") when shutting down a server. [#34823][#34823]
- Fixed a deadlock during [`IMPORT`](../v19.1/import.html) and [`RESTORE`](../v19.1/restore.html) that caused all writes on a node to be stopped. [#34830][#34830]
- Fixed a panic during planning of certain complex join queries. [#34843][#34843]
- Fixed a panic when [`CREATE STATISTICS`](../v19.1/create-statistics.html) is run on clusters containing nodes with different versions of CockroachDB. [#34842][#34842]
- Fixed a bug where servers would endlessly try to refresh table statistics on dropped tables. [#34884][#34884]
- CockroachDB now only lists tables in `pg_catalog.pg_tables`, for compatibility with PostgreSQL. [#34857][#34857]
- Fixed a panic when using [`EXPLAIN ANALYZE`](../v19.1/explain-analyze.html) with certain mutation queries. [#34991][#34991]

<h3 id="v19.1.0-beta.20190225-performance-improvements">Performance improvements</h3>

- [Subqueries](../v19.1/subqueries.html) used with `EXISTS` or as a scalar value now avoid fetching more rows than needed to decide the outcome. [#34801][#34801]

<h3 id="v19.1.0-beta.20190225-doc-updates">Doc updates</h3>

- Documented the built-in [`ycsb` workload](../v19.1/cockroach-workload.html). [#4343][#4343]

<h3 id="v19.1.0-beta.20190225-contributors">Contributors</h3>

This release includes 102 merged PRs by 22 authors. We would like to thank the following contributors from the CockroachDB community:

- Jaewan Park

[#33697]: https://github.com/cockroachdb/cockroach/pull/33697
[#34301]: https://github.com/cockroachdb/cockroach/pull/34301
[#34502]: https://github.com/cockroachdb/cockroach/pull/34502
[#34712]: https://github.com/cockroachdb/cockroach/pull/34712
[#34725]: https://github.com/cockroachdb/cockroach/pull/34725
[#34757]: https://github.com/cockroachdb/cockroach/pull/34757
[#34762]: https://github.com/cockroachdb/cockroach/pull/34762
[#34797]: https://github.com/cockroachdb/cockroach/pull/34797
[#34801]: https://github.com/cockroachdb/cockroach/pull/34801
[#34804]: https://github.com/cockroachdb/cockroach/pull/34804
[#34813]: https://github.com/cockroachdb/cockroach/pull/34813
[#34823]: https://github.com/cockroachdb/cockroach/pull/34823
[#34829]: https://github.com/cockroachdb/cockroach/pull/34829
[#34830]: https://github.com/cockroachdb/cockroach/pull/34830
[#34842]: https://github.com/cockroachdb/cockroach/pull/34842
[#34843]: https://github.com/cockroachdb/cockroach/pull/34843
[#34857]: https://github.com/cockroachdb/cockroach/pull/34857
[#34884]: https://github.com/cockroachdb/cockroach/pull/34884
[#34890]: https://github.com/cockroachdb/cockroach/pull/34890
[#34906]: https://github.com/cockroachdb/cockroach/pull/34906
[#34918]: https://github.com/cockroachdb/cockroach/pull/34918
[#34991]: https://github.com/cockroachdb/cockroach/pull/34991
[#4343]: https://github.com/cockroachdb/docs/pull/4343
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v19.1.0-beta.20190304-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-beta.20190304.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-beta.20190304.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-beta.20190304.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

{{site.data.alerts.callout_success}}
To upgrade a running cluster to the latest version of CockroachDB, see [Cluster Upgrade](../v19.1/upgrade-cockroach-version.html).
{{site.data.alerts.end}}

<h3 id="v19.1.0-beta.20190304-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.1.0-beta.20190304
~~~

<h3 id="v19.1.0-beta.20190304-enterprise-edition-changes">Enterprise edition changes</h3>

- Added a GSS auth method configurable by the `server.host_based_authentication.configuration` [cluster setting](../v19.1/cluster-settings.html). This supports the new ability to use an external enterprise directory system like Active Directory for authentication in a CockroachDB cluster. Detailed usage guidance is coming soon. [#34772][#34772] {% comment %}doc{% endcomment %}

<h3 id="v19.1.0-beta.20190304-sql-language-changes">SQL language changes</h3>

- CockroachDB now supports the syntax [`TIME(6)`](../v19.1/time.html), [`TIMESTAMP(6)`](../v19.1/timestamp.html) and `TIMESTAMPTZ(6)` / `TIMESTAMP(6) WITH TIME ZONE`, for compatibility with PostgreSQL. Only the value `6` is supported, which is also the default in PostgreSQL. When used for a table column definition, the precision is not stored, and it is not possible to distinguish types with and without specified precisions in the introspection metadata. [#35128][#35128] {% comment %}doc{% endcomment %}
- [`CHECK`](../v19.1/check.html) constraints can now be applied to columns when they are first added to a table with [`ALTER TABLE ... ADD COLUMN`](../v19.1/add-column.html). [#35018][#35018] {% comment %}doc{% endcomment %}
- CockoachDB no longer supports `AS OF SYSTEM TIME` interval expressions less than 1 microsecond in the past. [#34547][#34547] {% comment %}doc{% endcomment %}
- When the JSON `?` [operator](../v19.1/functions-and-operators.html) is used to compare a JSON string and a string that are equal, CockroachDB now returns `true`, for compatibility with PostgreSQL. [#35005][#35005]
- Specific implementations of join can now be forced by inserting `HASH`, `MERGE`, or `LOOKUP` between the type of join (`INNER | LEFT | RIGHT | FULL`) and the `JOIN` keyword. [#35183][#35183] {% comment %}doc{% endcomment %}
- CockroachDB now supports `SHOW SEQUENCES` to list the sequences in a given database or the current database, alongside `SHOW TABLES`, which was already able to list both tables and views. [#35215][#35215]
- Added the `sql.stats.experimental_automatic_collection.fraction_idle` [cluster setting](../v19.1/cluster-settings.html) to control the throttling of automatic statistics. [#34928][#34928] {% comment %}doc{% endcomment %}

<h3 id="v19.1.0-beta.20190304-admin-ui-changes">Admin UI changes</h3>

- Added a [debug page](../v19.1/admin-ui-debug-pages.html) that breaks down CPU usage by query (some restrictions apply). [#35147][#35147]

<h3 id="v19.1.0-beta.20190304-bug-fixes">Bug fixes</h3>

- The columns `confupdtype`, `confdeltype` and `confmatchtype` in `pg_constraint` now report the [foreign key constraint](../v19.1/foreign-key.html) parameters properly, for compatibility with PostgreSQL clients that use them. [#35052][#35052]
- Fixed a panic that could occur when using `logspy` tracing in some circumstances. [#34936][#34936]
- Fixed a panic related to cached plans. [#35027][#35027]
- Fixed [`CREATE STATISTICS`](../v19.1/create-statistics.html) to run at the correct timestamp when it is specified with [`AS OF SYSTEM TIME`](../v19.1/as-of-system-time.html). [#35139][#35139]
- CockroachDB again properly reports when a database used during `PREPARE` does not exist any more when `EXECUTE` is used. [#35151][#35151]
- The logical plans collected for display in the web UI now hide the details of which key ranges are scanned in table lookups. [#34902][#34902]
- Fixed a panic that could occur via certain patterns of folding `CASE` statements containing `NULL` values. [#35188][#35188]
- Fixed a bug that would return errors when handling valid [`UPDATE`](../v19.1/update.html)s during periods of an index creation schema change. [#35157][#35157]

<h3 id="v19.1.0-beta.20190304-performance-improvements">Performance improvements</h3>

- Increased write throughput for workloads that write large numbers of intents by coalescing intent resolution requests across transactions. [#34803][#34803]
- Reduced write-amplification during bulk-loading ([`IMPORT`](../v19.1/import.html) and [`RESTORE`](../v19.1/restore.html)). [#34886][#34886]
- Increased the rebalancing and up-replication default rate from 2MB to 8MB. [#35100][#35100]
- Reduced the impact of bulk data ingestion on foreground traffic by controlling RocksDB flushes. [#34800][#34800]

<h3 id="v19.1.0-beta.20190304-doc-updates">Doc updates</h3>

- Added much more guidance on [troubleshooting cluster setup](../v19.1/cluster-setup-troubleshooting.html) and [troubleshooting SQL behavior](../v19.1/query-behavior-troubleshooting.html). [#4223](https://github.com/cockroachdb/docs/pull/4223)
- Added a summary of [Enterprise features](../v19.1/enterprise-licensing.html#enterprise-features). [#4418](https://github.com/cockroachdb/docs/pull/4418)
- Documented CockroachDB's partial support for the [Intellij IDEA](../v19.1/intellij-idea.html). [#4391](https://github.com/cockroachdb/docs/pull/4391)
- Clarified the guidance on [preparing to decommission nodes](../v19.1/remove-nodes.html). [#4406](https://github.com/cockroachdb/docs/pull/4406)

<h3 id="v19.1.0-beta.20190304-contributors">Contributors</h3>

This release includes 89 merged PRs by 18 authors. We would like to thank the following contributors from the CockroachDB community:

- David López (first-time contributor)
- lanzao (first-time contributor)

[#34547]: https://github.com/cockroachdb/cockroach/pull/34547
[#34772]: https://github.com/cockroachdb/cockroach/pull/34772
[#34800]: https://github.com/cockroachdb/cockroach/pull/34800
[#34803]: https://github.com/cockroachdb/cockroach/pull/34803
[#34886]: https://github.com/cockroachdb/cockroach/pull/34886
[#34902]: https://github.com/cockroachdb/cockroach/pull/34902
[#34928]: https://github.com/cockroachdb/cockroach/pull/34928
[#34936]: https://github.com/cockroachdb/cockroach/pull/34936
[#35005]: https://github.com/cockroachdb/cockroach/pull/35005
[#35018]: https://github.com/cockroachdb/cockroach/pull/35018
[#35027]: https://github.com/cockroachdb/cockroach/pull/35027
[#35052]: https://github.com/cockroachdb/cockroach/pull/35052
[#35100]: https://github.com/cockroachdb/cockroach/pull/35100
[#35128]: https://github.com/cockroachdb/cockroach/pull/35128
[#35139]: https://github.com/cockroachdb/cockroach/pull/35139
[#35147]: https://github.com/cockroachdb/cockroach/pull/35147
[#35151]: https://github.com/cockroachdb/cockroach/pull/35151
[#35157]: https://github.com/cockroachdb/cockroach/pull/35157
[#35183]: https://github.com/cockroachdb/cockroach/pull/35183
[#35188]: https://github.com/cockroachdb/cockroach/pull/35188
[#35200]: https://github.com/cockroachdb/cockroach/pull/35200
[#35215]: https://github.com/cockroachdb/cockroach/pull/35215
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

In addition to bug fixes and various general, enterprise, SQL, and Admin UI enhancements, this release includes several major highlights:

- [**Managed CockroachDB Console**](https://cockroachlabs.cloud/): Paid managed CockroachDB customers can now sign into their organization's account, view the connection string details, add and edit thier list of allowed IPs on the management console.
- [**GSSAPI with Kerberos Authentication**](../v19.1/gssapi_authentication.html): CockroachDB now supports the Generic Security Services API (GSSAPI) with Kerberos authentication, which lets you use an external enterprise directory system that supports Kerberos, such as Active Directory. This feature requires an [Enterprise License](../v19.1/enterprise-licensing.html).
- [**Query Optimizer Hints**](../v19.1/cost-based-optimizer.html#join-hints): The cost-based optimizer now supports hint syntax to force the use of a merge, hash, or lookup join. This let you override the cost-based optimizer's join algorithm selection in cases where you have information about your data that the cost-based optimizer does not yet have.
- [**Correlated Subqueries**](../v19.1/subqueries.html#correlated-subqueries): Most correlated subqueries are decorrelated and processed by the cost-based-optimizer. However, for those that cannot be decorrelated, CockroachDB now emits an "apply" operator that executes a sub-plan for every row in its input. This allows CockroachDB to execute a large number of additional correlated subqueries that were not able to be executed in v2.1.  

<h3 id="v19.1.0-beta.20190318-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-beta.20190318.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-beta.20190318.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-beta.20190318.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.0-beta.20190318-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.1.0-beta.20190318
~~~

<h3 id="v19.1.0-beta.20190318-general-changes">General changes</h3>

- The [cluster settings](../v19.1/cluster-settings.html) `timeseries.storage.10s_resolution_ttl` and `timeseries.storage.30m_resolution_ttl` have been renamed to `timeseries.storage.resolution_10s.ttl` and `timeseries.storage.resolution_30m.ttl` for ease of use in SQL clients. Any value set using the previous setting name in existing clusters is migrated over to the new name; subsequent changes using the old name will be ignored. [#34248][#34248] {% comment %}doc{% endcomment %}

<h3 id="v19.1.0-beta.20190318-enterprise-edition-changes">Enterprise edition changes</h3>

- Added the `debug encryption-active-key` command. [#35234][#35234]
- The `changefeed.min_high_water` metric has been deprecated in favor of `changefeed.max_behind_nanos`, which is easier to alert on. The **Changefeed** dashboard in the Admin UI now contains a graph of this metric. [#35257][#35257] {% comment %}doc{% endcomment %}
- Added the `rocksdb.encryption.algorithm` per-store metric, which describes the encryption cipher in use. [#35506][#35506]
- In exchange for increased correctness confidence, [`CHANGEFEED`s](../v19.1/create-changefeed.html) using `changefeed.push.enabled` (the default) now take slightly more resources on startup and range rebalancing/splits. [#35470][#35470]

<h3 id="v19.1.0-beta.20190318-sql-language-changes">SQL language changes</h3>

- Changed the default set of column statistics created by [CREATE STATISTICS](../v19.1/create-statistics.html) to include up to 100 regular table columns in addition to all indexed columns. [#35192][#35192] {% comment %}doc{% endcomment %}
- Added the ability to pause all automatic statistics jobs by pausing the currently running job. [#35243][#35243] {% comment %}doc{% endcomment %}
- Automatic statistics are now enabled by default. [#35291][#35291] {% comment %}doc{% endcomment %}
- CockroachDB now supports many more correlated subqueries. [#34546][#34546]
- Schema changes now trigger automatic statistics collection for the affected table. [#35252][#35252] {% comment %}doc{% endcomment %}
- The `pg_catalog.current_setting()` and `pg_catalog.set_config()` [built-in functions](../v19.1/functions-and-operators.html) are now supported for compatibility with PostgreSQL. Note that only session-scoped configuration changes remain supported (`set_config(_, _, false)`). [#35121][#35121] {% comment %}doc{% endcomment %}
- The [`RENAME COLUMN`](../v19.1/rename-column.html) command can now be used alongside other table commands in a single [`ALTER TABLE`](../v19.1/alter-table.html) statement. This makes it possible to, for example, atomically add a computed column based on an existing column, and rename the columns so that the computed column "replaces" the original column. [#35091][#35091] {% comment %}doc{% endcomment %}
- CockroachDB now supports `ALTER TABLE ... RENAME CONSTRAINT`. Only indexes that are not depended on by views can be renamed. [#35091][#35091] {% comment %}doc{% endcomment %}
- [`SHOW JOBS`](../v19.1/show-jobs.html) now returns an extra `statement` column, which is populated when the description is not the statement. [#35439][#35439] {% comment %}doc{% endcomment %}
- [`SHOW QUERIES`](../v19.1/show-queries.html) and [`SHOW SESSIONS`](../v19.1/show-sessions.html) now omit internal queries and sessions by default. Use `SHOW ALL QUERIES` or `SHOW ALL SESSIONS` to include internal queries in the output. [#35504][#35504] {% comment %}doc{% endcomment %}
- CockroachDB now starts emitting changefeed events immediately for sinkless changefeeds (an experimental feature). The `results_buffer_size` connection string parameter is no longer needed for this purpose. [#35529][#35529] {% comment %}doc{% endcomment %}
- CockroachDB now provides usable comments with optional documentation URLs for the virtual tables in `pg_catalog`, `information_schema`, and `crdb_internal`. Use `SHOW TABLES [FROM ...] WITH COMMENT` to read. Note that `crdb_internal` tables remain an experimental feature subject to change without notice. [#34764][#34764] {% comment %}doc{% endcomment %}
- CockroachDB now reports usage frequency of various SQL scalar operators in telemetry, when telemetry is enabled, so as to guide future optimizations of query performance. [#35616][#35616] {% comment %}doc{% endcomment %}
- CockroachDB now reports how the [`SERIAL`](../v19.1/serial.html) pseudo-type is expanded in table column definitions, when telemetry is enabled. [#35656][#35656] {% comment %}doc{% endcomment %}

<h3 id="v19.1.0-beta.20190318-admin-ui-changes">Admin UI changes</h3>

- [`CREATE STATISTICS`](../v19.1/create-statistics.html) jobs no longer generate events by default. [#35425][#35425]
- Queries issued internally by CockroachDB are now displayed under a single "(internal)" application name entry in the drop-down menu on the **Statements** page. [#35503][#35503]
- Additional types of transaction restart errors are now tracked on the **Distributed** dashboard. [#35438][#35438]
- Added "Statistics Creation" as a job type on the **Jobs** page. [#35651][#35651]

<h3 id="v19.1.0-beta.20190318-bug-fixes">Bug fixes</h3>

- Fixed a planning bug that caused incorrect aggregation results on multi-node aggregations with implicit, partial orderings on the inputs to the aggregations. [#35221][#35221]
- Fixed a panic that occurred when evaluating certain binary expressions containing operands with different types. [#35247][#35247]
- Prevented a situation in which snapshots would be refused repeatedly over long periods of time, with error messages such as "aborting snapshot because raft log is too large" appearing in the logs, and often accompanied by under-replicated ranges in the UI. [#35136][#35136]
- [`BACKUP`](../v19.1/backup.html) to `nodelocal` now writes files atomically. [#34937][#34937]
- Fixed a crash on `SET TRANSACTION AS OF SYSTEM TIME` with invalid expressions. [#35316][#35316]
- The experimental [`CHANGEFEED`](../v19.1/create-changefeed.html) cloud storage sinks now strip secrets from the job description in the Admin UI and `SHOW JOBS` output. [#35257][#35257]
- Fixed a nil pointer dereference in [`debug zip`](../v19.1/debug-zip.html) when one or more nodes in the cluster are down. [#35366][#35366]
- [Window functions](../v19.1/window-functions.html) are now correctly planned when `UNION ALL` is present in the subquery. [#35430][#35430]
- Fixed panics that could occur in some cases involving joins of the results of mutations. [#35482][#35482]
- CockroachDB now correctly returns an error when window functions include window definitions that contain other window functions. [#35369][#35369]
- CockroachDB now properly applies column width and nullability constraints on the result of conflict resolution in [`UPSERT`](../v19.1/upsert.html) and [`INSERT ON CONFLICT`](../v19.1/insert.html). [#35371][#35371]
- Improved telemetry for error codes. [#35431][#35431]
- CockroachDB now properly preserves the automatically generated name of a newly created index in `system.event_log` when the name is not specified in the `CREATE INDEX` statement. [#35534][#35534]
- CockroachDB now properly reports `bigint` in `information_schema.sequences.type`, for compatibility with PostgreSQL. [#35577][#35577]
- CockroachDB now properly reports the composite foreign key match type in `information_schema.referential_constraints`. [#35575][#35575]
- Subtracting 0 from a JSON array now correctly removes its first element. [#35617][#35617]
- Fixed a "column not in input" crash when `INSERT / UPDATE / UPSERT ... RETURNING` is used inside a clause that requires an ordering. [#35644][#35644]
- Fixed an error when executing some set operations containing only nulls in one of the input columns. [#35321][#35321]
- Fixed an on-disk inconsistency that could result from a crash during a range merge. [#35626][#35626]

<h3 id="v19.1.0-beta.20190318-build-changes">Build changes</h3>

- [Go 1.11.5](https://golang.org/dl/) is now the minimum required version necessary to build CockroachDB. [#35536][#35536] {% comment %}doc{% endcomment %}
- CockroachDB will provisionally refuse to build with Go 1.12, as this is known to produce incorrect code inside CockroachDB. [#35638][#35638]
- Release Docker images are now built on Debian 9.8. [#35517][#35517]

<h3 id="v19.1.0-beta.20190318-doc-updates">Doc updates</h3>

- Updated the [`PARTITION BY RANGE`](../v19.1/partitioning.html#define-table-partitions-by-list) example for geo-partitioning. [#4503](https://github.com/cockroachdb/docs/pull/4503)
- The Docs landing page now provides quick links into various areas of the CockroachDB documentation. [#4476](https://github.com/cockroachdb/docs/pull/4476)
- Documented the [`BIT`](../v19.1/bit.html) data type. [#4454](https://github.com/cockroachdb/docs/pull/4454)
- Documented the `bytea_output` session variable, and fixed the documentation on bytes/string conversions. [#4452](https://github.com/cockroachdb/docs/pull/4452)
- Updated [Configure Replication Zones](../v19.1/configure-replication-zones.html) documentation to reflect that unset variables in a replication zone now inherit their values from the parent zone. [#4446](https://github.com/cockroachdb/docs/pull/4446)

<h3 id="v19.1.0-beta.20190318-contributors">Contributors</h3>

This release includes 157 merged PRs by 29 authors. We would like to thank the following contributors from the CockroachDB community:

- Jaewan Park

[#34248]: https://github.com/cockroachdb/cockroach/pull/34248
[#34546]: https://github.com/cockroachdb/cockroach/pull/34546
[#34764]: https://github.com/cockroachdb/cockroach/pull/34764
[#34937]: https://github.com/cockroachdb/cockroach/pull/34937
[#35091]: https://github.com/cockroachdb/cockroach/pull/35091
[#35121]: https://github.com/cockroachdb/cockroach/pull/35121
[#35136]: https://github.com/cockroachdb/cockroach/pull/35136
[#35192]: https://github.com/cockroachdb/cockroach/pull/35192
[#35221]: https://github.com/cockroachdb/cockroach/pull/35221
[#35234]: https://github.com/cockroachdb/cockroach/pull/35234
[#35243]: https://github.com/cockroachdb/cockroach/pull/35243
[#35247]: https://github.com/cockroachdb/cockroach/pull/35247
[#35252]: https://github.com/cockroachdb/cockroach/pull/35252
[#35257]: https://github.com/cockroachdb/cockroach/pull/35257
[#35291]: https://github.com/cockroachdb/cockroach/pull/35291
[#35316]: https://github.com/cockroachdb/cockroach/pull/35316
[#35321]: https://github.com/cockroachdb/cockroach/pull/35321
[#35350]: https://github.com/cockroachdb/cockroach/pull/35350
[#35366]: https://github.com/cockroachdb/cockroach/pull/35366
[#35369]: https://github.com/cockroachdb/cockroach/pull/35369
[#35371]: https://github.com/cockroachdb/cockroach/pull/35371
[#35425]: https://github.com/cockroachdb/cockroach/pull/35425
[#35430]: https://github.com/cockroachdb/cockroach/pull/35430
[#35431]: https://github.com/cockroachdb/cockroach/pull/35431
[#35438]: https://github.com/cockroachdb/cockroach/pull/35438
[#35439]: https://github.com/cockroachdb/cockroach/pull/35439
[#35470]: https://github.com/cockroachdb/cockroach/pull/35470
[#35482]: https://github.com/cockroachdb/cockroach/pull/35482
[#35503]: https://github.com/cockroachdb/cockroach/pull/35503
[#35504]: https://github.com/cockroachdb/cockroach/pull/35504
[#35506]: https://github.com/cockroachdb/cockroach/pull/35506
[#35517]: https://github.com/cockroachdb/cockroach/pull/35517
[#35529]: https://github.com/cockroachdb/cockroach/pull/35529
[#35534]: https://github.com/cockroachdb/cockroach/pull/35534
[#35536]: https://github.com/cockroachdb/cockroach/pull/35536
[#35575]: https://github.com/cockroachdb/cockroach/pull/35575
[#35577]: https://github.com/cockroachdb/cockroach/pull/35577
[#35616]: https://github.com/cockroachdb/cockroach/pull/35616
[#35617]: https://github.com/cockroachdb/cockroach/pull/35617
[#35626]: https://github.com/cockroachdb/cockroach/pull/35626
[#35638]: https://github.com/cockroachdb/cockroach/pull/35638
[#35644]: https://github.com/cockroachdb/cockroach/pull/35644
[#35651]: https://github.com/cockroachdb/cockroach/pull/35651
[#35656]: https://github.com/cockroachdb/cockroach/pull/35656
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

In addition to bug fixes and various enterprise, SQL, and Admin UI enhancements, with this release, we also want to highlight the following feature:

- [**Prefer the nearest secondary index**](../v19.1/cost-based-optimizer.html#preferring-the-nearest-index): Given multiple identical [indexes](../v19.1/indexes.html) that have different locality constraints using [replication zones](../v19.1/configure-replication-zones.html), the cost-based optimizer will now prefer the index that is closest to the gateway node that is planning the query. In a properly configured geo-distributed cluster, this can lead to performance improvements due to improved data locality and reduced network traffic. This feature enables scenarios where reference data such as a table of postal codes can be replicated to different regions, and queries will use the copy in the same region.
- [**Encryption at Rest**](../v19.1/encryption.html#encryption-at-rest-enterprise): This feature, which provides transparent encryption of a node's data on the local disk, was introduced as an experimental in CockroachDB v2.1. With this release, it is no longer considered experimental and is ready for production use.

<h3 id="v19.1.0-rc.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.0-rc.1-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.1.0-rc.1
~~~

<h3 id="v19.1.0-rc.1-enterprise-edition-changes">Enterprise edition changes</h3>

- [`CHANGEFEED`s](../v19.1/create-changefeed.html) now support TLS connections to Kafka. [#35510][#35510]
- `CHANGEFEED`s now support SASL/PLAIN authentication when connecting to a Kafka sink. [#35800][#35800]
- `CHANGEFEED`s using Kafka now log information to help debug connection issues. [#35661][#35661]

<h3 id="v19.1.0-rc.1-sql-language-changes">SQL language changes</h3>

- The [cost-based optimizer](../v19.1/cost-based-optimizer.html) now picks lookup-joins less frequently. [#35561][#35561]
- CockroachDB now reports uses of [CTEs](../v19.1/common-table-expressions.html) (`WITH ...`) and [subqueries](../v19.1/subqueries.html) in [diagnostics reporting](../v19.1/diagnostics-reporting.html), to guide future product planning. [#35650][#35650]
- It is now possible to specify a `HASH` / `MERGE` / `LOOKUP` [join hint](../v19.1/cost-based-optimizer.html#join-hints) with cross joins (`CROSS <hint> JOIN`). [#35700][#35700]
- The output of [`EXPLAIN`](../v19.1/explain.html) now uses `hash-join` or `merge-join` instead of `join`. [#35688][#35688]
- Added an `EXPLAIN (opt, env)` option, which provides all relevant information for the planning of a query. [#35802][#35802]
- `transaction deadline exceeded` errors are now returned to the client with a retryable code. [#35284][#35284]
- Regular SQL errors that indicate erroneous SQL and for which CockroachDB does not yet populate a well-defined PostgreSQL error code will now be reported with code `XXUUU` instead of code `XX000`. [#35896][#35896] {% comment %}doc{% endcomment %}
- Removed "experimental" from the names of the two existing automatic statistics [cluster settings](../v19.1/cluster-settings.html), and added two new cluster settings to control the target number of stale rows per table that will trigger a statistics refresh. [#36085][#36085] {% comment %}doc{% endcomment %}
- Renamed the `experimental_reorder_joins_limit` [session variable](../v19.1/set-vars.html) to `reorder_joins_limit`. [#36085][#36085] {% comment %}doc{% endcomment %}
- Changed [`SHOW JOBS`](../v19.1/show-jobs.html) to no longer display automatic statistics jobs. `SHOW AUTOMATIC JOBS` can now be used instead to view automatic statistics jobs. [#36112][#36112] {% comment %}doc{% endcomment %}
- The [cost-based optimizer](../v19.1/cost-based-optimizer.html) will now try to select the index having a leaseholder preference that is closest. [#36123][#36123] {% comment %}doc{% endcomment %}
- [Computed columns](../v19.1/computed-columns.html) are now evaluated after rounding any decimal values in input columns. [#36128][#36128]
- Changed the generation algorithm for the OID column of tables in `pg_catalog`. As with previous CockroachDB releases, we guarantee that the OID values are consistent between `pg_catalog` tables (so that tables can be joined together), but we do not guarantee that they are stable across CockroachDB versions. Avoid storing them in client apps. [#33697][#33697]

<h3 id="v19.1.0-rc.1-command-line-changes">Command-line changes</h3>

- The output of [`cockroach debug zip`](../v19.1/debug-zip.html) now contains more information. [#36026][#36026] {% comment %}doc{% endcomment %}

<h3 id="v19.1.0-rc.1-admin-ui-changes">Admin UI changes</h3>

- Improved progress reporting for `CREATE STATISTICS` jobs. [#35684][#35684]
- The **Queries per second** metric in the **Summary** bar now summarizes only the query types displayed in the **SQL Queries** graph and **Node Map**. [#35905][#35905] {% comment %}doc{% endcomment %}
- The **Jobs** screen no longer shows automatic statistics by default. To see these jobs, you must now select **Auto-Statistics Creation** from the **Type** menu. [#36112][#36112]

<h3 id="v19.1.0-rc.1-bug-fixes">Bug fixes</h3>

- Increased speed of automatic statistic jobs on clusters with low load. [#35698][#35698]
- `CHANGEFEED`s connected to a slow sink now error instead of using unbounded amounts of memory. [#35745][#35745]
- Removed historical log entries from Raft snapshots that could lead to failed snapshots. [#35701][#35701]
- Fixed a bug in `RESTORE` where some unusual range boundaries in interleaved tables caused an error. [#36005][#36005]
- Fixed an error that occurred when creating statistics on tables with an inverted index. [#35982][#35982]
- Fixed a panic that occurred when comparing a value to the result of an `EXISTS`. [#36038][#36038]
- Fixed an error caused by incorrect calculation of null counts in `VALUES` clauses. [#35997][#35997]
- Reduced the occurrence of `ASYNC_WRITE_FAILURE` transaction retry errors, especially for the first insert into a newly-created table. [#36104][#36104]
- Fixed panics with the message "unexpected non-pending txn in augmentMetaLocked" caused by distributed queries encountering multiple errors. [#36041][#36041]
- `CHANGEFEED`s with `changefeed.push.enabled = true` (which is the default) no longer fail when run for longer than the garbage collection window of the source data and a range split occurred. They also now emit dramatically fewer duplicates. [#35981][#35981]
- Fixed panics caused by certain window functions that operate on tuples. [#36124][#36124]
- Prevented deadlocks when cancelling distributed queries in some cases. [#36122][#36122]
- Fixed a planning error that occurred with some `IN` expressions containing a list of constant and non-constant items. [#36134][#36134]
- Reduced risk of data unavailability during AZ/region failure. [#36133][#36133]
- Fixed a planning error that occurred when using set operations with multiple columns and many null values. [#36169][#36169]

<h3 id="v19.1.0-rc.1-performance-improvements">Performance improvements</h3>

- Improved performance of the TPC-C benchmark by pre-calculating statistics and injecting them during `IMPORT`. [#35940][#35940]
- Reduced the default frequency of automatic statistics refreshes. [#35992][#35992]
- Improved the selectivity estimation of range predicates during query optimization. [#36093][#36093]

<h3 id="v19.1.0-rc.1-build-changes">Build changes</h3>

- [Go 1.11.6](https://golang.org/dl/) is now the minimum required version necessary to build CockroachDB. [#35909][#35909] {% comment %}doc{% endcomment %}

<h3 id="v19.1.0-rc.1-doc-updates">Doc updates</h3>

- Added a library of common [Cluster Topology Patterns](../v19.1/topology-patterns.html). [#4235](https://github.com/cockroachdb/docs/pull/4235)
- Documented how [reads and writes](../v19.1/architecture/reads-and-writes-overview.html) are affected by the replicated and distributed nature of data in CockroachDB. [#4543](https://github.com/cockroachdb/docs/pull/4543)
- Corrected the syntax for [per-replica replication zone constraints](../v19.1/configure-replication-zones.html#scope-of-constraints). [#4569](https://github.com/cockroachdb/docs/pull/4569)
- Added more thorough documentation on [CockroachDB dependencies](../v19.1/recommended-production-settings.html#dependencies). [#4567](https://github.com/cockroachdb/docs/pull/4567)

<h3 id="v19.1.0-rc.1-contributors">Contributors</h3>

This release includes 104 merged PRs by 23 authors. We would like to thank the following contributors from the CockroachDB community:

- Dong Liang (first-time contributor)

[#33697]: https://github.com/cockroachdb/cockroach/pull/33697
[#35284]: https://github.com/cockroachdb/cockroach/pull/35284
[#35440]: https://github.com/cockroachdb/cockroach/pull/35440
[#35510]: https://github.com/cockroachdb/cockroach/pull/35510
[#35561]: https://github.com/cockroachdb/cockroach/pull/35561
[#35650]: https://github.com/cockroachdb/cockroach/pull/35650
[#35661]: https://github.com/cockroachdb/cockroach/pull/35661
[#35684]: https://github.com/cockroachdb/cockroach/pull/35684
[#35688]: https://github.com/cockroachdb/cockroach/pull/35688
[#35698]: https://github.com/cockroachdb/cockroach/pull/35698
[#35700]: https://github.com/cockroachdb/cockroach/pull/35700
[#35701]: https://github.com/cockroachdb/cockroach/pull/35701
[#35728]: https://github.com/cockroachdb/cockroach/pull/35728
[#35745]: https://github.com/cockroachdb/cockroach/pull/35745
[#35800]: https://github.com/cockroachdb/cockroach/pull/35800
[#35802]: https://github.com/cockroachdb/cockroach/pull/35802
[#35896]: https://github.com/cockroachdb/cockroach/pull/35896
[#35905]: https://github.com/cockroachdb/cockroach/pull/35905
[#35909]: https://github.com/cockroachdb/cockroach/pull/35909
[#35940]: https://github.com/cockroachdb/cockroach/pull/35940
[#35981]: https://github.com/cockroachdb/cockroach/pull/35981
[#35982]: https://github.com/cockroachdb/cockroach/pull/35982
[#35992]: https://github.com/cockroachdb/cockroach/pull/35992
[#35997]: https://github.com/cockroachdb/cockroach/pull/35997
[#36005]: https://github.com/cockroachdb/cockroach/pull/36005
[#36026]: https://github.com/cockroachdb/cockroach/pull/36026
[#36038]: https://github.com/cockroachdb/cockroach/pull/36038
[#36041]: https://github.com/cockroachdb/cockroach/pull/36041
[#36085]: https://github.com/cockroachdb/cockroach/pull/36085
[#36093]: https://github.com/cockroachdb/cockroach/pull/36093
[#36104]: https://github.com/cockroachdb/cockroach/pull/36104
[#36112]: https://github.com/cockroachdb/cockroach/pull/36112
[#36122]: https://github.com/cockroachdb/cockroach/pull/36122
[#36123]: https://github.com/cockroachdb/cockroach/pull/36123
[#36124]: https://github.com/cockroachdb/cockroach/pull/36124
[#36128]: https://github.com/cockroachdb/cockroach/pull/36128
[#36133]: https://github.com/cockroachdb/cockroach/pull/36133
[#36134]: https://github.com/cockroachdb/cockroach/pull/36134
[#36169]: https://github.com/cockroachdb/cockroach/pull/36169
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v19.1.0-rc.2-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.0-rc.2-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.1.0-rc.2
~~~

<h3 id="v19.1.0-rc.2-sql-language-changes">SQL language changes</h3>

- Added the `kv.bulk_io_write.concurrent_addsstable_requests` [cluster setting](../v19.1/cluster-settings.html), which limits the number of SSTables that can be added concurrently during bulk operations. [#36444][#36444]
- Added the `schemachanger.backfiller.buffer_size`, `schemachanger.backfiller.max_sst_size`, and `schemachanger.bulk_index_backfill.batch_size` [cluster settings](../v19.1/cluster-settings.html), which control buffering in index backfills. [#36377][#36377]
- Added the `sql.defaults.reorder_joins_limit` [cluster setting](../v19.1/cluster-settings.html), which defines the default value of the `reorder_joins_limit` [session variable](../v19.1/set-vars.html). [#36382][#36382]

<h3 id="v19.1.0-rc.2-bug-fixes">Bug fixes</h3>

- Fixed a panic that could occur with certain patterns of using `UPDATE` and column families. [#36375][#36375]
- Prevented production server crashes on certain assertion errors. [#36434][#36434]
- Data that was previously omitted from `debug zip` is now included. [#36480][#36480]
- Fixed a planning error that occurred with some `GROUP BY` queries due to errors in null count estimation. [#36528][#36528]
- Fixed inappropriate column renaming in some cases involving single-column SRFs. [#36535][#36535]
- Prevented a panic when running a render expression that produces an error at the very end of a `count_rows` aggregate. [#36538][#36538]
- Prevented a deadlock related to store queue processing. [#36542][#36542]

<h3 id="v19.1.0-rc.2-performance-improvements">Performance improvements</h3>

- CockroachDB now allows oversized ranges to split sooner. [#36368][#36368]
- Reduced memory usage during bulk data ingestion (during `IMPORT`, `RESTORE`, and index creation). [#36420][#36420]
- Prevented rocksdb from slowing down write traffic during bulk data ingestion. [#36512][#36512]
- Sped up bulk data ingestion during index backfills and `IMPORT`. [#36525][#36525]

<h3 id="v19.1.0-rc.2-doc-updates">Doc updates</h3>

- Emphasized the experimental status of [CockroachDB's Windows binary](../v19.1/install-cockroachdb-windows.html). [#4628](https://github.com/cockroachdb/docs/pull/4628)
- Clarified the use of the `ApplicationName` connection string parameter for JDBC clients. [#4623](https://github.com/cockroachdb/docs/pull/4623)
- Documented the [`COMMENT ON`](../v19.1/comment-on.html) statement, for adding comments to databases, tables, and columns. [#4617](https://github.com/cockroachdb/docs/pull/4617)
- Documented the [`RENAME CONSTRAINT`](../v19.1/rename-constraint.html) subcommand of `ALTER TABLE`, and identified the [`ALTER TABLE`](../v19.1/alter-table.html) subcommands that can be used in combination in a single `ALTER TABLE` statement. [#4615](https://github.com/cockroachdb/docs/pull/4615)
- Documented per-statement credential parameters for Google Cloud Storage. [#4606](https://github.com/cockroachdb/docs/pull/4606)
- Clarified the accepted values for the `--duration` flag of [`cockroach workload`](../v19.1/cockroach-workload.html). [#4610](https://github.com/cockroachdb/docs/pull/4610)

<h3 id="v19.1.0-rc.2-contributors">Contributors</h3>

This release includes 36 merged PRs by 16 authors.

[#36368]: https://github.com/cockroachdb/cockroach/pull/36368
[#36375]: https://github.com/cockroachdb/cockroach/pull/36375
[#36377]: https://github.com/cockroachdb/cockroach/pull/36377
[#36382]: https://github.com/cockroachdb/cockroach/pull/36382
[#36420]: https://github.com/cockroachdb/cockroach/pull/36420
[#36434]: https://github.com/cockroachdb/cockroach/pull/36434
[#36444]: https://github.com/cockroachdb/cockroach/pull/36444
[#36480]: https://github.com/cockroachdb/cockroach/pull/36480
[#36512]: https://github.com/cockroachdb/cockroach/pull/36512
[#36525]: https://github.com/cockroachdb/cockroach/pull/36525
[#36528]: https://github.com/cockroachdb/cockroach/pull/36528
[#36535]: https://github.com/cockroachdb/cockroach/pull/36535
[#36538]: https://github.com/cockroachdb/cockroach/pull/36538
[#36542]: https://github.com/cockroachdb/cockroach/pull/36542
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v19.1.0-rc.3-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.3.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.3.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.3.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.0-rc.3-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.1.0-rc.3
~~~

<h3 id="v19.1.0-rc.3-bug-fixes">Bug fixes</h3>

- Fixed a potential crash when constructing certain types of aggregations with post projections. [#36514][#36514]
- CockroachDB now correctly validates [computed columns](../v19.1/computed-columns.html) during [`ALTER TABLE ... ADD COLUMN`](../v19.1/add-column.html). [#36575][#36575]
- Fixed a bug when parsing dates with large years. [#36555][#36555]
- Fixed a bug when decoding single column family `JSONB` columns. [#36626][#36626]
- Fixed a potential crash in a mixed-version cluster with some nodes running `v19.1-beta-x` and others running `19.1-rc.x`. [#36719][#36719]
- Made [`CHANGEFEED`s](../v19.1/create-changefeed.html) more resilient to a class of bugs that manifest as stalls. [#36768][#36768]

<h3 id="v19.1.0-rc.3-performance-improvements">Performance improvements</h3>

- CockroachDB now applies back-pressure to bulk operations before other traffic. [#36738][#36738]

<h3 id="v19.1.0-rc.3-contributors">Contributors</h3>

This release includes 19 merged PRs by 12 authors.

[#36514]: https://github.com/cockroachdb/cockroach/pull/36514
[#36555]: https://github.com/cockroachdb/cockroach/pull/36555
[#36575]: https://github.com/cockroachdb/cockroach/pull/36575
[#36626]: https://github.com/cockroachdb/cockroach/pull/36626
[#36719]: https://github.com/cockroachdb/cockroach/pull/36719
[#36738]: https://github.com/cockroachdb/cockroach/pull/36738
[#36768]: https://github.com/cockroachdb/cockroach/pull/36768
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

<h3 id="v19.1.0-rc.4-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.4.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.4.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0-rc.4.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.0-rc.4-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.1.0-rc.4
~~~

<h3 id="v19.1.0-rc.4-bug-fixes">Bug fixes</h3>

- Fixed a crash caused by running [`COMMENT ON`](../v19.1/comment-on.html) with verbose logging turned on. [#36825][#36825]
- Fixed a panic that can happen while RangeFeeds are active. [#36870][#36870]
- The default value of the `kv.bulk_io_write.max_rate` [cluster setting](../v19.1/cluster-settings.html) is now 1 TB/s, to help prevent incorrect rate limiting behavior due to rounding. [#36912][#36912]
- Fixed a rare inconsistency that could occur on badly overloaded clusters. [#36959][#36959]
- Fixed a bug in write batch decoding that could cause "invalid batch" errors while using [`cockroach debug` commands](../v19.1/cockroach-commands.html) to analyze data. [#36965][#36965]
- Fixed an issue that could cause low-traffic clusters to get stuck after a network outage. [#37064][#37064]

<h3 id="v19.1.0-rc.4-contributors">Contributors</h3>

This release includes 11 merged PRs by 9 authors.

[#36825]: https://github.com/cockroachdb/cockroach/pull/36825
[#36870]: https://github.com/cockroachdb/cockroach/pull/36870
[#36912]: https://github.com/cockroachdb/cockroach/pull/36912
[#36959]: https://github.com/cockroachdb/cockroach/pull/36959
[#36965]: https://github.com/cockroachdb/cockroach/pull/36965
[#37064]: https://github.com/cockroachdb/cockroach/pull/37064
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

With the release of CockroachDB v19.1, we’ve made a variety of security, performance, and usability improvements. A few highlights:

- **Enhanced security**: CockroachDB now supports [transparent data encryption at rest](../v19.1/encryption.html#encryption-at-rest-enterprise) and [integrates with existing LDAP directory services](../v19.1/gssapi_authentication.html) within an organization to simplify user account management.

- **Native Change Data Capture**: CockroachDB extends its streaming data capabilities by enabling data to flow more easily to backend warehouses, with support for [publishing distributed, row-level change feeds directly into cloud storage](../v19.1/change-data-capture.html) for downstream processing.  

- **High-performance multi-region deployments**: Our cost-based optimizer can now [use data locality to optimize queries](../v19.1/cost-based-optimizer.html#preferring-the-nearest-index) so you can get low-latency queries even when your data may be spread across regions. We’ve also added [follower reads](../v19.1/follower-reads.html) to improve read performance for certain geo-distributed workloads.

Check out a comprehensive [summary of the most significant user-facing changes](#summary) and then [upgrade to CockroachDB v19.1](../v19.1/upgrade-cockroach-version.html). You can also read more about these changes in the [v19.1 blog post](https://www.cockroachlabs.com/blog/cockroachdb-19dot1-release).

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.0-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.0.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.0-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~ shell
$ docker pull cockroachdb/cockroach:v19.1.0
~~~

<h3 id="v19.1.0-summary">Summary</h3>

This section summarizes the most significant user-facing changes in v19.1.0. For a complete list of features and changes, including bug fixes and performance improvements, see the [release notes](index.html#testing-releases) for previous testing releases.

- [Managed service offering](#managed-service-offering)
- [Enterprise features](#enterprise-features)
- [Core features](#core-features)
- [Backward-incompatible changes](#backward-incompatible-changes)
- [Known limitations](#known-limitations)
- [Documentation](#documentation)

<style>
    table td:first-child {
        min-width: 225px;
    }
</style>

<h3 id="v19.1.0-managed-service-offering">Managed service offering</h3>

Feature | Description
--------|------------
[**Managed CockroachDB Console**](../cockroachcloud/quickstart.html) | Paid managed CockroachDB customers can now sign into their organization's account, view the connection string details, add and edit their list of allowed IPs on the management console.

<h3 id="v19.1.0-enterprise-features">Enterprise features</h3>

These features require an [enterprise license](../v19.1/enterprise-licensing.html). Register for a 30-day trial license [here](https://www.cockroachlabs.com/get-cockroachdb/enterprise).

Feature | Description
--------|------------
[**Encryption at Rest**](../v19.1/encryption.html#encryption-at-rest-enterprise) | Encryption at rest provides transparent encryption of a node's data on the local disk. This feature was introduced as experimental in v2.1 and is now ready for production use.
[**GSSAPI with Kerberos Authentication**](../v19.1/gssapi_authentication.html) | CockroachDB now supports the Generic Security Services API (GSSAPI) with Kerberos authentication, which lets you use an external enterprise directory system that supports Kerberos, such as Active Directory.
[**Follower Reads**](../v19.1/follower-reads.html) | This feature reduces read latencies by allowing queries to perform historical reads of the closest replica of a given piece of data rather than reading from the more distant "leaseholder" replica. To enable follower reads on a query, use the `experimental_follower_read_timestamp()` [built-in function](../v19.1/functions-and-operators.html) in conjunction with the `AS OF SYSTEM TIME` clause.
[**Prefer Closest Secondary Index**](../v19.1/cost-based-optimizer.html#preferring-the-nearest-index) | Given multiple identical [indexes](../v19.1/indexes.html) that have different locality constraints using [replication zones](../v19.1/configure-replication-zones.html), the cost-based optimizer will now prefer the index that is closest to the gateway node that is planning the query. In a properly configured geo-distributed cluster, this can lead to performance improvements due to improved data locality and reduced network traffic. This feature enables scenarios where reference data such as a table of postal codes can be replicated to different regions, and queries will use the copy in the same region.
[**Change Data Capture**](../v19.1/change-data-capture.html) | CDC in v19.1 includes many improvements to production-readiness. [`CHANGEFEED`s](../v19.1/create-changefeed.html) delivering data to Apache Kafka/Confluent Platform are now fully supported, and a new cloud storage sink allows `CHANGEFEED`s to deliver table updates as JSON files to endpoints like Google Storage or AWS S3. A new push-based internal data delivery mechanism called _rangefeeds_ helps deliver data with increased reliability and lower latency.

<h3 id="v19.1.0-core-features">Core features</h3>

These features are freely available in the core version and do not require an enterprise license.

Feature | Description
--------|------------
[**Load-Based Splitting**](../v19.1/load-based-splitting.html) | CockroachDB now automatically splits frequently accessed keys into smaller ranges to optimize your cluster’s performance.
[**Query Optimizer Hints**](../v19.1/cost-based-optimizer.html#join-hints) | The cost-based optimizer now supports hint syntax to force the use of merge, hash, or lookup joins. This let you override the cost-based optimizer's join algorithm selection in cases where you have information about your data that the cost-based optimizer does not yet have.
[**Correlated Subqueries**](../v19.1/subqueries.html#correlated-subqueries) | Most correlated subqueries are now decorrelated and processed by the cost-based-optimizer. For those that cannot be decorrelated, CockroachDB now emits an "apply" operator that executes a sub-plan for every row in its input. This allows CockroachDB to execute a large number of additional correlated subqueries that were not able to be executed in v2.1.  
[**Core Changefeeds**](../v19.1/changefeed-for.html) | CockroachDB now offers a non-enterprise version of change data capture, via the `EXPERIMENTAL CHANGEFEED FOR` statement, to consume table updates over a streaming Postgres connection.
[**Cost-Based Optimizer**](../v19.1/cost-based-optimizer.html) | The cost-based optimizer now supports almost all read-only queries (except window functions) and almost all mutations (e.g., `CREATE TABLE AS`, `INSERT`, `UPDATE`, `UPSERT`, `DELETE`). In addition, the cost-based optimizer now reorders up to 4 joins in a query to attempt to find the most performant ordering (via the new `reorder_joins_limit` [session variable](../v19.1/set-vars.html)) and takes advantage of [automatically generated table statistics](../v19.1/cost-based-optimizer.html#table-statistics) without impacting foreground traffic. Note that statistics are created by default on all indexed columns when a user upgrades to this version. Finally, a [query plan cache](../v19.1/cost-based-optimizer.html#query-plan-cache) now saves a portion of the planning time for frequent queries used in the cost-based optimizer.
[**Logical Plans in the Admin UI**](../v19.1/admin-ui-statements-page.html#logical-plan) | The **Statement Details** page in the Admin UI now shows the ordered steps CockroachDB will take to execute a query (i.e., the [`EXPLAIN`](../v19.1/explain.html) output). This helps you identify bottlenecks caused by how queries are planned by our heuristic and cost-based optimizers.
[**Cascading Replication Zones**](../v19.1/configure-replication-zones.html) | Newly created replication zones will now inherit empty values from their parent. For example, if the replication zone for a table is not explicitly set with `num_replicas`, it will inherit that value from its direct parent, whether that's the `.default` replication zone from the entire cluster or the replication zone for the database containing the table.
[**Custom Savepoints**](../v19.1/savepoint.html#customizing-the-savepoint-name) | CockroachDB now supports custom naming of `SAVEPOINT`s for compatibility with ORMs and other third-party tools.

<h3 id="v19.1.0-backward-incompatible-changes">Backward-incompatible changes</h3>

Before [upgrading to CockroachDB v19.1.0](../v19.1/upgrade-cockroach-version.html), be sure to review the following backward-incompatible changes and adjust your application as necessary.

- CockroachDB no longer supports the `B'abcde'` notation to express [byte array literals](../v19.1/sql-constants.html#byte-array-literals). This notation now expresses **bit** array literals like in PostgreSQL. The `b'...'` notation remains for byte array literals.

- The normalized results of certain timestamp + duration operations involving year or month durations have been adjusted to agree with the values returned by PostgreSQL.

- The `CHANGEFEED` [`experimental-avro` option](../v19.1/create-changefeed.html#options) has been renamed `experimental_avro`.

- Timezone abbreviations, such as `EST`, are no longer allowed when parsing or converting to a date/time type. Previously, an abbreviation would be accepted if it were an alias for the session's timezone.

- The way composite [foreign key](../v19.1/foreign-key.html) matches are evaluated has changed to match the Postgres behavior. If your schema currently uses composite keys, it may require updates, since this change may affect your foreign key constraints and cascading behavior. For more details and guidance, see [this note](v2.2.0-alpha.20190114.html#composite-foreign-key-matching).

- Mutation statements like [`UPDATE`](../v19.1/update.html), [`INSERT`](../v19.1/insert.html), and [`DELETE`](../v19.1/delete.html) no longer attempt to guarantee mutation or output ordering when an `ORDER BY` clause is present. It is now an error to use `ORDER BY` without `LIMIT` with the `UPDATE` statement.

<h3 id="v19.1.0-known-limitations">Known limitations</h3>

For information about limitations we've identified in CockroachDB v19.1, with suggested workarounds where applicable, see [Known Limitations](../v19.1/known-limitations.html).

<h3 id="v19.1.0-documentation">Documentation</h3>

Topic | Description
------|------------
**Geo-Partitioning** | Added a [video and tutorial on using geo-partitioning](../v19.1/demo-geo-partitioning.html) to get very fast reads and writes in a broadly distributed cluster.
**Security** | Added an [overview of CockroachDB security](../v19.1/security-overview.html), with a dedicated page on [authentication](../v19.1/authentication.html), [encryption](../v19.1/encryption.html), [authorization](../v19.1/authorization.html), and [SQL audit logging](../v19.1/sql-audit-logging.html).
**Troubleshooting** | Added much more guidance on [troubleshooting cluster setup](../v19.1/cluster-setup-troubleshooting.html) and [troubleshooting SQL behavior](../v19.1/query-behavior-troubleshooting.html).
**Architecture** | Added the [Life of a Distributed Transaction](../v19.1/architecture/life-of-a-distributed-transaction.html), which details the path that a query takes through CockroachDB's architecture, starting with a SQL client and progressing all the way to RocksDB (and then back out again). Also added [Reads and Writes in CockroachDB](../v19.1/architecture/reads-and-writes-overview.html), which explains how reads and writes are affected by the replicated and distributed nature of data in CockroachDB.
**Production Guidance** | Expanded the [Production Checklist](../v19.1/recommended-production-settings.html) with more current hardware recommendations and additional guidance on storage, file systems, and clock synchronization. Also added a library of common [Cluster Topology Patterns](../v19.1/topology-patterns.html).
**ORMs** | Expanded the [SQLAlchemy tutorial](../v19.1/build-a-python-app-with-cockroachdb-sqlalchemy.html) to provide code for transaction retries and best practices for using SQLAlchemy with CockroachDB.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.1.1 since v19.1.0.

- For a comprehensive summary of features in v19.1, see the [v19.1 GA release notes](v19.1.0.html).
- To upgrade to v19.1, see [Upgrade to CockroachDB v19.1](../v19.1/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.1-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.1.1
~~~

<h3 id="v19.1.1-enterprise-edition-changes">Enterprise edition changes</h3>

- [`CHANGEFEED`s](../v19.1/create-changefeed.html) now accept a `key_in_value` option; this is automatically used for cloud storage sinks, making the primary key of deleted rows recoverable. [#37328][#37328] {% comment %}doc{% endcomment %}

<h3 id="v19.1.1-sql-language-changes">SQL language changes</h3>

- `EXPLAIN (DISTSQL) CREATE STATISTICS` now shows the DistSQL plan used by the [`CREATE STATISTICS`](../v19.1/create-statistics.html) job. [#37237][#37237] {% comment %}doc{% endcomment %}
- Added missing columns to [`information_schema.columns`](../v19.1/information-schema.html). [#37283][#37283] {% comment %}doc{% endcomment %}

<h3 id="v19.1.1-bug-fixes">Bug fixes</h3>

- Prevented panics when adding [comments](../v19.1/comment-on.html) to database objects at high verbosity. [#37325][#37325]
- Fixed panics when trying to run certain `SHOW` commands via the pgwire prepare path. [#37325][#37325]
- Fixed a regression in 19.1 that prevented empty arrays from being accepted over pgwire. [#37398][#37398]
- While a cluster is unavailable (e.g., during a network partition), memory and goroutines used for authenticating connections no longer leak when the client closes said connections. [#36177][#36177]
- Fixed a possible panic while recovering from a WAL on which a sync operation failed. [#37109][#37109]
- Fixed an error which could occur when a zigzag join was performed against a table with dropped columns. [#37245][#37245]
- Fixed incorrect query plans/results when non-validated FK constraints are not satisfied by the data. [#37253][#37253]
- `CHANGEFEED`s now retry instead of causing errors in more situations. [#37092][#37092]
- Fixed a bug where `CHANGEFEED` job progress would regress when the job was restarted. [#37091][#37091]
- The `changefeed.max_behind_nanos` metric now has fewer false positives of changefeeds falling behind. [#37048][#37048]
- Corrected the names of some columns for tables created with [`CREATE TABLE <name> AS <query>`](../v19.1/create-table-as.html). [#37238][#37238]
- Fixed a bug causing unvalidated check constraints to disappear from the output of [`SHOW CONSTRAINTS`](../v19.1/show-constraints.html) and to not be referenced in [`ALTER TABLE`](../v19.1/alter-table.html) after upgrading to 19.1. [#37462][#37462]

<h3 id="v19.1.1-performance-improvements">Performance improvements</h3>

- Improved the performance of some queries containing predicates with constant functions, since these functions are now evaluated earlier during query optimization. [#37234][#37234]
- Improved the performance of some queries by teaching the optimizer to always prefer constrained scans over unconstrained scans. [#37235][#37235]

<h3 id="v19.1.1-doc-updates">Doc updates</h3>

- Updated the [Kubernetes tutorials](../v19.1/orchestrate-cockroachdb-with-kubernetes.html) for running CockroachDB on GKE to specify a reasonable machine type. Also updated the Helm-specific instructions for maintenance tasks (adding/removing nodes, upgrading a cluster).[#4813](https://github.com/cockroachdb/docs/pull/4813) [#4805](https://github.com/cockroachdb/docs/pull/4805)
- Fixed the code sample in [Build a PHP App with CockroachDB](../v19.1/build-a-php-app-with-cockroachdb.html) to not create new connections for each query. [#4804](https://github.com/cockroachdb/docs/pull/4804).

<h3 id="v19.1.1-contributors">Contributors</h3>

This release includes 28 merged PRs by 14 authors.

[#36177]: https://github.com/cockroachdb/cockroach/pull/36177
[#37048]: https://github.com/cockroachdb/cockroach/pull/37048
[#37091]: https://github.com/cockroachdb/cockroach/pull/37091
[#37092]: https://github.com/cockroachdb/cockroach/pull/37092
[#37109]: https://github.com/cockroachdb/cockroach/pull/37109
[#37234]: https://github.com/cockroachdb/cockroach/pull/37234
[#37235]: https://github.com/cockroachdb/cockroach/pull/37235
[#37237]: https://github.com/cockroachdb/cockroach/pull/37237
[#37238]: https://github.com/cockroachdb/cockroach/pull/37238
[#37245]: https://github.com/cockroachdb/cockroach/pull/37245
[#37253]: https://github.com/cockroachdb/cockroach/pull/37253
[#37283]: https://github.com/cockroachdb/cockroach/pull/37283
[#37325]: https://github.com/cockroachdb/cockroach/pull/37325
[#37328]: https://github.com/cockroachdb/cockroach/pull/37328
[#37398]: https://github.com/cockroachdb/cockroach/pull/37398
[#37462]: https://github.com/cockroachdb/cockroach/pull/37462
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.1.10 since v19.1.9.

- For a comprehensive summary of features in v19.1, see the [v19.1 GA release notes](v19.1.0.html).
- To upgrade to the latest production release of CockroachDB, see this [article](../{{site.versions["stable"]}}/upgrade-cockroach-version.html).

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.10-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.10.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.10.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.10.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.10.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.10-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.1.10
~~~

<h3 id="v19.1.10-security-updates">Security updates</h3>

- HTTP endpoints beginning with `/debug/` now require a valid [`admin`](../v19.1/authorization.html) login session. [#50491][#50491]

<h3 id="v19.1.10-bug-fixes">Bug fixes</h3>

- Previously, HTTP requests would start to fail with error 503 "`transport: authentication handshake failed: io: read/write on closed pipe`" and never become possible again until restarting the node. This has been fixed. This bug has existed since v2.1 or earlier. [#48483][#48483]
- Previously, when the value passed to `--drain-wait` was very small, but non-zero, [`cockroach quit`](../v19.1/stop-a-node.html) in certain cases would not proceed to perform a hard shutdown. This has been corrected. This bug was present in v19.1.9, v19.2.7, and v20.1.1. [#49365][#49365]
- Fixed a RocksDB bug that could result in inconsistencies in rare circumstances. [#50510][#50510]

<h3 id="v19.1.10-build-changes">Build changes</h3>

- Release Docker images are now built on Debian 9.12. [#50480][#50480]

<h3 id="v19.1.10-doc-updates">Doc updates</h3>

- Updated guidance on [node decommissioning](../v19.1/remove-nodes.html). [#7304][#7304]
- Renamed "whitelist/blacklist" terminology to "allowlist/blocklist". [#7535][#7535]
- Updated the Releases navigation in the sidebar to expose the latest Production and Testing releases. [#7550][#7550]
- Fixed scrollbar visibility on Chrome. [#7487][#7487]

<h3 id="v19.1.10-contributors">Contributors</h3>

This release includes 10 merged PRs by 6 authors.
We would like to thank the following contributors from the CockroachDB community:

- Drew Kimball (first-time contributor, CockroachDB team member)
- Jackson Owens (first-time contributor, CockroachDB team member)
- James H. Linder (first-time contributor, CockroachDB team member)

[#48483]: https://github.com/cockroachdb/cockroach/pull/48483
[#49365]: https://github.com/cockroachdb/cockroach/pull/49365
[#50480]: https://github.com/cockroachdb/cockroach/pull/50480
[#50491]: https://github.com/cockroachdb/cockroach/pull/50491
[#50510]: https://github.com/cockroachdb/cockroach/pull/50510
[#7304]: https://github.com/cockroachdb/docs/pull/7304
[#7550]: https://github.com/cockroachdb/docs/pull/7550
[#7535]: https://github.com/cockroachdb/docs/pull/7535
[#7487]: https://github.com/cockroachdb/docs/pull/7487
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.1.11 since v19.1.10.

- For a comprehensive summary of features in v19.1, see the [v19.1 GA release notes](v19.1.0.html).
- To upgrade to the latest production release of CockroachDB, see this [article](../{{site.versions["stable"]}}/upgrade-cockroach-version.html).

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.11-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.11.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.11.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.11.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.11.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.11-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~ shell
$ docker pull cockroachdb/cockroach-unstable:v19.1.11
~~~

<h3 id="v19.1.11-bug-fixes">Bug fixes</h3>

- Fixed a bug in [`TRUNCATE`](../v19.1/truncate.html) that could leave tables in a state where they could not be renamed. [#50766][#50766]

<h3 id="v19.1.11-contributors">Contributors</h3>

This release includes 1 merged PR by 1 author.

[#50766]: https://github.com/cockroachdb/cockroach/pull/50766
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.1.2 since v19.1.1.

- For a comprehensive summary of features in v19.1, see the [v19.1 GA release notes](v19.1.0.html).
- To upgrade to v19.1, see [Upgrade to CockroachDB v19.1](../v19.1/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.2-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.2-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.1.2
~~~

<h3 id="v19.1.2-enterprise-edition-changes">Enterprise edition changes</h3>

- You can now alter the zone configuration for a secondary index partition using the syntax `ALTER PARTITION OF INDEX <tablename>@<indexname> CONFIGURE ZONE ...`. [#36883][#36883] {% comment %}doc{% endcomment %}

<h3 id="v19.1.2-bug-fixes">Bug fixes</h3>

- CockroachDB now computes the result of shifting bit arrays to the right properly and avoids generating invalid bit arrays. [#36751][#36751]
- `SHOW ZONE CONFIGURATION` no longer emits invalid `ALTER` syntax in its output when displaying the zone configuration for a table or index partition that is inheriting from the database or the default configuration. [#36883][#36883]
- `SHOW ZONE CONFIGURATION FOR TABLE t PARTITION p` no longer ignores the clause `PARTITION p` and now properly displays the zone configuration for that partition instead. [#36883][#36883]
- Automated table statistics no longer encounter "batch timestamp must be after replica GC threshold" errors on configurations with low TTL. [#37588][#37588]
- Fixed type inference of columns in subqueries for some expressions of the form `scalar IN (subquery)`. [#37598][#37598]
- Fixed a panic when constructing the error message for an invalid partitioning. [#37703][#37703]
- Fixed a potential source of (faux) replica inconsistencies that can be reported while running a mixed v19.1 / v2.1 cluster. This error (in that situation only) is benign and can be resolved by upgrading to the latest v19.1 patch release. Every time this error occurs, a "checkpoint" is created which will occupy a large amount of disk space and which needs to be removed manually (see `<store directory>/auxiliary/checkpoints`). [#37722][#37722]
- Fixed a case in which [`cockroach quit`](../v19.1/stop-a-node.html) would return successfully even though the server process was still running in a severely degraded state. [#37722][#37722]
- Fixed incorrect results or "incorrectly ordered stream" errors in response to some queries with aggregations, and improved the `EXPLAIN` output for aggregations. [#37792][#37792]
- A `NULL` right operand now causes the sub-operator expression to return `NULL`. [#37886][#37886]
- The `age()` function is now correctly marked as impure, causing it to be unavailable in certain contexts. [#37922][#37922]
- Certain binary encodings of numeric/decimal values no longer result in values that are an order of magnitude off. [#37921][#37921]
- Fixed a race condition that could cause a panic during query planning. [#37974][#37974]
- Fixed `GROUP BY` for empty arrays. [#37940][#37940]
- Fixed a bug when estimating result set sizes in the optimizer that caused queries involving very large integer ranges to have poor plans. [#38038][#38038]
- The [`cockroach` commands](../v19.1/cockroach-commands.html) that internally use a RPC connection (e.g., `cockroach quit`, `cockroach init`, etc.) once again properly support passing an IPv6 address literal via the `--host` argument. [#37982][#37982]
- The [`cockroach init`](../v19.1/initialize-a-cluster.html) command will now always properly report when a cluster is already initialized, even after the node that it's connecting to is restarted. [#37593][#37593]

<h3 id="v19.1.2-security-improvements">Security improvements</h3>

- Stack memory used by CockroachDB is now marked as non-executable, improving security and compatibility with SELinux. [#38011][#38011]

<h3 id="v19.1.2-contributors">Contributors</h3>

This release includes 25 merged PRs by 18 authors. We would like to thank the following contributors from the CockroachDB community:

- Simo Kinnunen (first-time contributor)

[#36751]: https://github.com/cockroachdb/cockroach/pull/36751
[#36883]: https://github.com/cockroachdb/cockroach/pull/36883
[#37573]: https://github.com/cockroachdb/cockroach/pull/37573
[#37588]: https://github.com/cockroachdb/cockroach/pull/37588
[#37598]: https://github.com/cockroachdb/cockroach/pull/37598
[#37703]: https://github.com/cockroachdb/cockroach/pull/37703
[#37722]: https://github.com/cockroachdb/cockroach/pull/37722
[#37792]: https://github.com/cockroachdb/cockroach/pull/37792
[#37886]: https://github.com/cockroachdb/cockroach/pull/37886
[#37921]: https://github.com/cockroachdb/cockroach/pull/37921
[#37922]: https://github.com/cockroachdb/cockroach/pull/37922
[#37940]: https://github.com/cockroachdb/cockroach/pull/37940
[#37974]: https://github.com/cockroachdb/cockroach/pull/37974
[#38011]: https://github.com/cockroachdb/cockroach/pull/38011
[#38038]: https://github.com/cockroachdb/cockroach/pull/38038
[#37982]: https://github.com/cockroachdb/cockroach/pull/37982
[#37593]: https://github.com/cockroachdb/cockroach/pull/37593
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.1.3 since v19.1.2.

- For a comprehensive summary of features in v19.1, see the [v19.1 GA release notes](v19.1.0.html).
- To upgrade to v19.1, see [Upgrade to CockroachDB v19.1](../v19.1/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.3-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.3.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.3.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.3.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.3-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.1.3
~~~

<h3 id="v19.1.3-bug-fixes">Bug fixes</h3>

- Fixed help text that erroneously labeled [Encryption at Rest](../v19.1/encryption.html) as experimental. [#38237][#38237]
- Fixed an incorrect type mismatch error when empty [`ARRAY`](../v19.1/array.html) values are used as [`DEFAULT` values](../v19.1/default-value.html) (and potentially in other contexts). [#38300][#38300]
- Fixed a panic that could occur when decoding decimals as query parameters. [#38330][#38330]
- `NULL`s are now correctly handled by `MIN`, `SUM`, and `AVG` when used as [window functions](../v19.1/window-functions.html). [#38356][#38356]
- Fixed an issue that prevented [restoring](../v19.1/restore.html) some backups if they included tables that were partitioned by columns of a certain types while also interleaved by child tables. [#38494][#38494]
- Fixed possible deadlock when storage engine write fails. [#38478][#38478]
- Fixed potential reappearance of deleted timeseries data, which could trip the consistency checker. [#38478][#38478]
- Removed dependency on `sync_file_range` on Linux platforms on which it returns ENOSYS, such as WSL (Windows Subsystem for Linux). [#38478][#38478]
- Nodes that have been down now recover quicker when they rejoin, assuming they weren't down for much more than the value of the `server.time_until_store_dead` [cluster setting](../v19.1/cluster-settings.html) (which defaults to 5 minutes). [#38642][#38642]
- Checking the "skip should queue" checkbox in the Manual Enqueue Range advanced debuggging page now works for the GC Queue. [#38296][#38296]
- The YCSB workload no longer ignores the `--db `option. [#38238][#38238]
- Fixed the auto-retry counter in stats and now logs it in the statement/audit logs. [#38035][#38035]

<h3 id="v19.1.3-security-improvements">Security improvements</h3>

- Only check `CommonName` on first certificate in file. [#38165][#38165]

<h3 id="v19.1.3-doc-updates">Doc updates</h3>

- Added the [Build a Python app with Kubernetes on CockroachCloud](../cockroachcloud/deploy-a-python-to-do-app-with-flask-kubernetes-and-cockroachcloud.html) tutorial for running a Python app on a CockroachCloud cluster using a local Kubernetes cluster. [#4918](https://github.com/cockroachdb/docs/pull/4918)
- Expanded the recommended [Topology Patterns](../v19.1/topology-patterns.html) for running CockroachDB in a cloud environment, each with required configurations and latency and resiliency characteristics. [#4820](https://github.com/cockroachdb/docs/pull/4820)
- Made the Java code samples in [Build a Java App with CockroachDB](../v19.1/build-a-java-app-with-cockroachdb.html) simpler and more idiomatic. [#4855](https://github.com/cockroachdb/docs/pull/4855)
- Documented [what happens when a node runs out of disk space](../v19.1/operational-faqs.html#what-happens-when-a-node-runs-out-of-disk-space) and how to [create a ballast file](../v19.1/debug-ballast.html) to prepare for this case. [#5000](https://github.com/cockroachdb/docs/pull/5000)

<h3 id="v19.1.3-contributors">Contributors</h3>

This release includes 17 merged PRs by 14 authors.

[#38035]: https://github.com/cockroachdb/cockroach/pull/38035
[#38165]: https://github.com/cockroachdb/cockroach/pull/38165
[#38237]: https://github.com/cockroachdb/cockroach/pull/38237
[#38238]: https://github.com/cockroachdb/cockroach/pull/38238
[#38296]: https://github.com/cockroachdb/cockroach/pull/38296
[#38300]: https://github.com/cockroachdb/cockroach/pull/38300
[#38330]: https://github.com/cockroachdb/cockroach/pull/38330
[#38356]: https://github.com/cockroachdb/cockroach/pull/38356
[#38478]: https://github.com/cockroachdb/cockroach/pull/38478
[#38494]: https://github.com/cockroachdb/cockroach/pull/38494
[#38642]: https://github.com/cockroachdb/cockroach/pull/38642
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.1.4 since v19.1.3.

- For a comprehensive summary of features in v19.1, see the [v19.1 GA release notes](v19.1.0.html).
- To upgrade to v19.1, see [Upgrade to CockroachDB v19.1](../v19.1/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.4-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.4.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.4.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.4.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.4-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.1.4
~~~

<h3 id="v19.1.4-enterprise-edition-changes">Enterprise edition changes</h3>

- The new `skip_missing_views` option for [`RESTORE`](../v19.1/restore.html) skips restoring views that cannot be restored because their dependencies are not being restored at the same time. [#38773][#38773] {% comment %}doc{% endcomment %}

<h3 id="v19.1.4-sql-language-changes">SQL language changes</h3>

- CockroachDB now ignores non-fatal errors updating jobs during [`DROP TABLE`](../v19.1/drop-table.html). [#38821][#38821]
- The first statement of a transaction no longer returns a transaction retry error if it is an [`UPDATE`](../v19.1/update.html) or [`DELETE`](../v19.1/delete.html) (this was already true for [`INSERT`](../v19.1/insert.html)). [#39087][#39087]

<h3 id="v19.1.4-bug-fixes">Bug fixes</h3>

- Fixed a bug that prevented [inverted indexes](../v19.1/inverted-indexes.html) from being created on [`JSONB`](../v19.1/jsonb.html) columns containing `NULL` values. [#38747][#38747]
- Ranges consisting of only one row (and historical versions of that row) are now correctly up-replicated. [#38588][#38588]
- Fixed a planning error that caused valid queries to fail with the error "rowCount passed in was too small". [#38793][#38793]
- Fixed incorrect results, or "unordered span" errors, in some cases involving exclusive inequalities with non-numeric types. [#38896][#38896]
- Fixed a bug in the [cost-based optimizer](../v19.1/cost-based-optimizer.html) causing a bad index for [lookup joins](../v19.1/joins.html#lookup-joins) in some cases. [#39028][#39028]
- Fixed a potential infinite loop in queries involving reverse scans. [#39101][#39101]
- [`UPSERT`s](../v19.1/upsert.html) planned by the [cost-based optimizer](../v19.1/cost-based-optimizer.html) that use [lookup joins](../v19.1/joins.html#lookup-joins) run during column mutations on the table being updated no longer cause crashes or other issues. [#38917][#38917]
- `crdb_internal.ranges` can now be used inside [views](../v19.1/views.html). Note that such views can become invalid in future releases if `crdb_internal.ranges` changes. [#39213][#39213]

<h3 id="v19.1.4-contributors">Contributors</h3>

This release includes 15 merged PRs by 11 authors.

[#38588]: https://github.com/cockroachdb/cockroach/pull/38588
[#38747]: https://github.com/cockroachdb/cockroach/pull/38747
[#38773]: https://github.com/cockroachdb/cockroach/pull/38773
[#38793]: https://github.com/cockroachdb/cockroach/pull/38793
[#38821]: https://github.com/cockroachdb/cockroach/pull/38821
[#38896]: https://github.com/cockroachdb/cockroach/pull/38896
[#38917]: https://github.com/cockroachdb/cockroach/pull/38917
[#39028]: https://github.com/cockroachdb/cockroach/pull/39028
[#39087]: https://github.com/cockroachdb/cockroach/pull/39087
[#39101]: https://github.com/cockroachdb/cockroach/pull/39101
[#39213]: https://github.com/cockroachdb/cockroach/pull/39213
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.1.5 since v19.1.4.

- For a comprehensive summary of features in v19.1, see the [v19.1 GA release notes](v19.1.0.html).
- To upgrade to v19.1, see [Upgrade to CockroachDB v19.1](../v19.1/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.5-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.5.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.5.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.5.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.5-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.1.5
~~~

<h3 id="v19.1.5-sql-language-changes">SQL language changes</h3>

- Add `check_constraints` table to the `information_schema`. [#39688][#39688]

<h3 id="v19.1.5-bug-fixes">Bug fixes</h3>

- Unary negatives in constant arithmetic expressions are no longer ignored. [#39367][#39367]
- Propagate [zone configuration](../v19.1/configure-replication-zones.html) to non-gossiped system tables. [#39691][#39691]
- Prevent unlimited memory usage during SQL range deletions. [#39733][#39733]
- A crash caused by the presence of [window functions](../v19.1/window-functions.html) in the source of the [`CREATE TABLE AS`](../v19.1/create-table-as.html) statement is fixed. [#40430][#40430]
- Fix a planning error that could occur when a [common table expression](../v19.1/common-table-expressions.html) with an [`ORDER BY`](../v19.1/query-order.html) was used inside of a [subquery](../v19.1/subqueries.html). [#40490][#40490]
- Fixed an optimizer panic when building array access expressions. [#40513][#40513]
- Fix bug where an MVCC value at a future timestamp is returned after a transaction restart. [#40611][#40611]
- Consider intents in a read's uncertainty interval to be uncertain just as if they were committed values. This removes the potential for stale reads when a causally dependent transaction runs into the not-yet resolved intents from a causal ancestor. [#40611][#40611]
- Prevent problems on mixed-version 19.1 clusters that are also performing a lookup join on a table that has an ongoing index backfill. [#40739][#40739]
- The `cockroach` [CLI client commands](../v19.1/cockroach-commands.html) are now able to connect to a server via the environment variable `COCKROACH_URL`. [#40848][#40848]
- Fix a crash in apply joins. [#40829][#40829]
- Detailed crash reports ("panic messages") could previously be reported in the wrong file, if SQL audit reporting or statement logging had been activated. This has been corrected and crash reports will now properly always appear in the main log file. [#40942][#40942]

<h3 id="v19.1.5-contributors">Contributors</h3>

This release includes 14 merged PRs by 10 authors.

[#39367]: https://github.com/cockroachdb/cockroach/pull/39367
[#39688]: https://github.com/cockroachdb/cockroach/pull/39688
[#39691]: https://github.com/cockroachdb/cockroach/pull/39691
[#39733]: https://github.com/cockroachdb/cockroach/pull/39733
[#40430]: https://github.com/cockroachdb/cockroach/pull/40430
[#40490]: https://github.com/cockroachdb/cockroach/pull/40490
[#40513]: https://github.com/cockroachdb/cockroach/pull/40513
[#40611]: https://github.com/cockroachdb/cockroach/pull/40611
[#40739]: https://github.com/cockroachdb/cockroach/pull/40739
[#40829]: https://github.com/cockroachdb/cockroach/pull/40829
[#40848]: https://github.com/cockroachdb/cockroach/pull/40848
[#40942]: https://github.com/cockroachdb/cockroach/pull/40942
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.1.6 since v19.1.5.

- For a comprehensive summary of features in v19.1, see the [v19.1 GA release notes](v19.1.0.html).
- To upgrade to v19.1, see [Upgrade to CockroachDB v19.1](../v19.1/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.6-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.6.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.6.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.6.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.6-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.1.6
~~~

<h3 id="v19.1.6-security-updates">Security updates</h3>

- CockroachDB previously allowed non-authenticated access to privileged HTTP endpoints like `/_admin/v1/events`, which operate using `root` user permissions and can thus access (and sometimes modify) any and all data in the cluster. This security vulnerability has been patched by disallowing non-authenticated access to these endpoints and restricting access to admin users only.

    {{site.data.alerts.callout_info}}
    Users who have built monitoring automation using these HTTP endpoints must modify their automation to work using an HTTP session token for an admin user.
    {{site.data.alerts.end}}

- Some Admin UI screens (e.g., Jobs) were previously incorrectly displayed using `root` user permissions, regardless of the logged-in user's credentials. This enabled insufficiently privileged users to access privileged information. This security vulnerability has been patched by using the credentials of the logged-in user to display all Admin UI screens.

- Privileged HTTP endpoints and certain Admin UI screens require an admin user. However, `root` is disallowed from logging in via HTTP and it is not possible to create additional admin accounts without an Enterprise license. This is further discussed [here](https://github.com/cockroachdb/cockroach/issues/43870) and will be addressed in an upcoming patch revision.

    {{site.data.alerts.callout_info}}
    Users without an Enterprise license can create an additional admin user using a temporary evaluation license, until an alternative is available. A user created this way will persist beyond the license expiry.
    {{site.data.alerts.end}}

- Some Admin UI screens currently display an error or a blank page when viewed by a non-admin user (e.g., Table Details). This is a known limitation mistakenly introduced by the changes described above. This situation is discussed further [here](https://github.com/cockroachdb/cockroach/issues/44033) and will be addressed in an upcoming patch revision. The list of UI pages affected includes but is not limited to:

  - Job details
  - Database details
  - Table details
  - Zone configurations

    {{site.data.alerts.callout_info}}
    Users can access these Admin UI screens using an admin user until a fix is available.
    {{site.data.alerts.end}}

The list of HTTP endpoints affected by the first change above includes:

| HTTP Endpoint                                          | Description                       | Sensitive information revealed                     | Special (see below) |
|--------------------------------------------------------|-----------------------------------|----------------------------------------------------|---------------------|
| `/_admin/v1/data_distribution`                         | Database-table-node mapping       | Database and table names                           |                     |
| `/_admin/v1/databases/{database}/tables/{table}/stats` | Table stats histograms            | Stored table data  via PK values                   |                     |
| `/_admin/v1/drain`                                     | API to shut down a node           | Can cause DoS on cluster                           |                     |
| `/_admin/v1/enqueue_range`                             | Force range rebalancing           | Can cause DoS on cluster                           |                     |
| `/_admin/v1/events`                                    | Event log                         | Usernames, stored object names, privilege mappings |                     |
| `/_admin/v1/nontablestats`                             | Non-table statistics              | Stored table data via PK values                    |                     |
| `/_admin/v1/rangelog`                                  | Range log                         | Stored table data via PK values                    |                     |
| `/_admin/v1/settings`                                  | Cluster settings                  | Organization name                                  |                     |
| `/_status/allocator/node/{node_id}`                    | Rebalance simulator               | Can cause DoS on cluster                           | yes                 |
| `/_status/allocator/range/{range_id}`                  | Rebalance simulatoor              | Can cause DoS on cluster                           | yes                 |
| `/_status/certificates/{node_id}`                      | Node and user certificates        | Credentials                                        |                     |
| `/_status/details/{node_id}`                           | Node details                      | Internal IP addresses                              |                     |
| `/_status/enginestats/{node_id}`                       | Storage statistics                | Operational details                                |                     |
| `/_status/files/{node_id}`                             | Retrieve heap and goroutine dumps | Operational details                                | yes                 |
| `/_status/gossip/{node_id}`                            | Gossip details                    | Internal IP addresses                              | yes                 |
| `/_status/hotranges`                                   | Ranges with active requests       | Stored table data via PK values                    |                     |
| `/_status/local_sessions`                              | SQL sessions                      | Cleartext SQL queries                              | yes                 |
| `/_status/logfiles/{node_id}`                          | List of log files                 | Operational details                                | yes                 |
| `/_status/logfiles/{node_id}/{file}`                   | Server logs + entries             | Many: names, application data, credentials, etc.   | yes                 |
| `/_status/logs/{node_id}`                              | Log entries                       | Many: names, application data, credentials, etc.   | yes                 |
| `/_status/profile/{node_id}`                           | Profiling data                    | Operational details                                |                     |
| `/_status/raft`                                        | Raft details                      | Stored table data via PK values                    |                     |
| `/_status/range/{range_id}`                            | Range details                     | Stored table data via PK values                    |                     |
| `/_status/ranges/{node_id}`                            | Range details                     | Stored table data via PK values                    |                     |
| `/_status/sessions`                                    | SQL sessions                      | Cleartext SQL queries                              | yes                 |
| `/_status/span`                                        | Statistics per key span           | Whether certain table rows exist                   |                     |
| `/_status/stacks/{node_id}`                            | Stack traces                      | Application data, stored table data                |                     |
| `/_status/stores/{node_id}`                            | Store details                     | Operational details                                |                     |

{{site.data.alerts.callout_info}}
"Special" endpoints are subject to the [cluster setting](../v19.1/cluster-settings.html) `server.remote_debugging.mode`. Unless the setting was customized, clients are only able to connect from the same machine as the node.
{{site.data.alerts.end}}

<h3 id="v19.1.6-sql-language-changes">SQL language changes</h3>

- [`EXPLAIN (OPT,ENV)`](../v19.1/explain.html) now returns a URL with the data encoded in the fragment portion. Opening the URL shows a page with the decoded data. Note that the data is processed in the local browser session and is never sent out. [#41092][#41092]
- `EXPLAIN ANALYSE` can now be used as an alias to [`EXPLAIN ANALYZE`](../v19.1/explain-analyze.html). [#41093][#41093]
- Mutations under `UNION` or `UNION ALL` are now disallowed. This restriction is temporary and will be lifted in a future release. [#41496][#41496]

<h3 id="v19.1.6-admin-ui-changes">Admin UI changes</h3>

- Certain web UI pages (like the list of databases or tables) now restrict their content to match the privileges of the logged-in user. [#42727][#42727]
- The event log now presents all cluster settings changes, unredacted, when an admin user uses the page. [#42727][#42727]
- Customization of the UI by users is now only properly saved if the user has write privilege to `system.ui` (i.e., is an admin user). Also, all authenticated users share the same customizations. This is a known limitation and should be lifted in a future version. [#42727][#42727]
- Access to table statistics are temporarily blocked from access by non-admin users until further notice, for security reasons. [#42727][#42727]
- Certain debug pages have been blocked from non-admin users for security reasons. [#42727][#42727]

<h3 id="v19.1.6-bug-fixes">Bug fixes</h3>
- The experimental cloud storage changefeed sink previously violated some of the changefeed invariants under rare conditions. A number of these have been fixed, but some fixes require changes to the format of the filenames output by the cloud storage changefeed. This is unsuitable for inclusion in a patch release, so users of cloud storage changefeed sinks are highly encouraged to upgrade to CockroachDB 19.2 or later. [#42907][#42907]
- Fixed a crash that occurs when a suboperator with a `LIKE` comparison has a _NULL_ left-hand side. [#41073][#41073]
- Reduced write amplification by avoiding forcing files through compactions unnecessarily. [#41301][#41301]
- Fixed a rare data corruption bug in RocksDB caused by newer Linux kernel's handling of i_generation on certain file systems. [#41393][#41393]
- Fixed a bug causing the `cluster_logical_timestamp()` function to sometimes return incorrect results. [#41441][#41441]
- Fixed internal errors generated during the execution of some complicated cases of correlated subqueries. [#41667][#41667]
- Fixed a bug causing zone configuration changes on tables with existing index zone configurations to not take effect unless the `num_replicas` field was also set. [#41682][#41682]
- Fixed bug causing zone configuration application on indexes to leak into configurations on partitions. [#41679][#41679]
- Fixed multiple bugs relating to zone configurations and `COPY FROM PARENT`. Previously, `COPY FROM PARENT` was ignored when using it on partitions and indexes, and when using it on a zone that had an existing value for the field that was being changed. [#41699][#41699]
- Fixed a bug causing rapid network disconnections to lead to cluster unavailability because goroutines waited for a connection which will never be initialized to send its first heartbeat. [#42165][#42165]
- Fixed an internal error in a rare case involving `UNION` and tuples inside `VALUES` clauses. [#42266][#42266]
- CockroachDB now permits planning of window functions within mutation statements, and other statements that cannot be distributed. [#42617][#42617]
- Fixed a bug that would produce a spurious failure with the error message "incompatible COALESCE expressions" when adding or validating `MATCH FULL` foreign key constraints involving composite keys with columns of differing types. [#42652][#42652]
- Fixed a case where we incorrectly determine that a query (or part of a query) which contains an `IS NULL` constraint on a unique index column returns at most one row, possibly ignoring a `LIMIT 1` clause. [#42792][#42792]
- It is now possible to transfer range leases to lagging replicas. [#42764][#42764]
- [`ALTER INDEX IF EXISTS`](../v19.1/alter-index.html) no longer fails when using an unqualified index name that does not match any existing index. Now it is a no-op. [#42839][#42839]
- CockroachDB now prevents a number of panics from the SQL layer caused by an invalid range split. These would usually manifest with messages mentioning encoding errors ("found null on not null column" but also possibly various others). [#42860][#42860]
- Other callers to `acquireNodeLease` will not get erroneously cancelled just because the context of the first caller was cancelled. [#43028][#43028]
- Fixed a bug in poller causing it to emit row updates at a timestamp less than or equal to an already forwarded resolved timestamp. [#43027][#43027]
- Fixed a bug in cloud storage sink file naming that violates ordering in presence of a schema changes. [#43027][#43027]
- Fixed a bug causing disk stalls to allow a node to continue heartbeating its liveness record and prevent other nodes from taking over its leases, despite being completely unresponsive. [#41765][#41765]
- CockroachDB now properly removes excess secondary log files (SQL audit logging, statement execution logging, and RocksDB events). [#41034][#41034]
- [`cockroach debug zip`](../v19.1/debug-zip.html), [`cockroach node`](../v19.1/view-node-details.html) and [`cockroach user`](../v19.1/create-and-manage-users.html) now work properly if the `defaultdb` database has been manually dropped and the connection URL does not specify a database. [#41131][#41131]

<h3 id="v19.1.6-contributors">Contributors</h3>

This release includes 34 merged PRs by 19 authors.

[#42727]: https://github.com/cockroachdb/cockroach/pull/42727
[#41131]: https://github.com/cockroachdb/cockroach/pull/41131
[#41034]: https://github.com/cockroachdb/cockroach/pull/41034
[#41765]: https://github.com/cockroachdb/cockroach/pull/41765
[#41073]: https://github.com/cockroachdb/cockroach/pull/41073
[#41092]: https://github.com/cockroachdb/cockroach/pull/41092
[#41093]: https://github.com/cockroachdb/cockroach/pull/41093
[#41301]: https://github.com/cockroachdb/cockroach/pull/41301
[#41393]: https://github.com/cockroachdb/cockroach/pull/41393
[#41441]: https://github.com/cockroachdb/cockroach/pull/41441
[#41496]: https://github.com/cockroachdb/cockroach/pull/41496
[#41667]: https://github.com/cockroachdb/cockroach/pull/41667
[#41679]: https://github.com/cockroachdb/cockroach/pull/41679
[#41682]: https://github.com/cockroachdb/cockroach/pull/41682
[#41699]: https://github.com/cockroachdb/cockroach/pull/41699
[#42165]: https://github.com/cockroachdb/cockroach/pull/42165
[#42266]: https://github.com/cockroachdb/cockroach/pull/42266
[#42617]: https://github.com/cockroachdb/cockroach/pull/42617
[#42652]: https://github.com/cockroachdb/cockroach/pull/42652
[#42764]: https://github.com/cockroachdb/cockroach/pull/42764
[#42792]: https://github.com/cockroachdb/cockroach/pull/42792
[#42839]: https://github.com/cockroachdb/cockroach/pull/42839
[#42860]: https://github.com/cockroachdb/cockroach/pull/42860
[#42907]: https://github.com/cockroachdb/cockroach/pull/42907
[#43027]: https://github.com/cockroachdb/cockroach/pull/43027
[#43028]: https://github.com/cockroachdb/cockroach/pull/43028
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.1.7 since v19.1.6.

- For a comprehensive summary of features in v19.1, see the [v19.1 GA release notes](v19.1.0.html).
- To upgrade to v19.1, see [Upgrade to CockroachDB v19.1](../v19.1/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.7-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.7.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.7.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.7.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.7-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.1.7
~~~

<h3 id="v19.1.7-bug-fixes">Bug fixes</h3>

- Some incorrect issue links referenced to by error hints have been corrected. [#43234][#43234]
- Prevented rare cases of infinite looping on database files written with a CockroachDB version earlier than v2.1.9. [#43253][#43253]
- [Changefeeds](../v19.1/create-changefeed.html) now emit backfill row updates for a dropped column when the table descriptor drops that column. [#43037][#43037] {% comment %}doc{% endcomment %}
- [`EXPLAIN`](../v19.1/explain.html) can now be used with statements that use [`AS OF SYSTEM TIME`](../v19.1/as-of-system-time.html). [#43305][#43305] {% comment %}doc{% endcomment %}
- Fixed a bug that caused some jobs to be left indefinitely in a pending state and never run. [#43416][#43416]
- Migrating the privileges on the `system.lease` table no longer creates a deadlock during a [cluster upgrade](../v19.1/upgrade-cockroach-version.html). [#43508][#43508]
- Fixed a bug in the parsing logic for `server.host_based_authentication.configuration`, where both single-character strings and quoted strings containing spaces and separated by commas were not properly parsed. This would cause rules for usernames consisting of a single character or usernames containing spaces to apply improperly. [#43812][#43812]
- A SQL row write that is re-issued after already succeeding no longer throws a duplicate key error when the previous write in its transaction deleted the row. [#43942][#43942]
- Fixed a changefeed bug  where a resolved timestamp might be published before all events that precede it have been published in the presence of a range merge. [#44082][#44082]
- Converted a panic when using collated strings to an error. [#44119][#44119]

<h3 id="v19.1.7-performance-improvements">Performance improvements</h3>

- A transaction running into multiple intents from an abandoned conflicting transaction now cleans them up more efficiently. [#43589][#43589]

<h3 id="v19.1.7-contributors">Contributors</h3>

This release includes 11 merged PRs by 7 authors.

[#43037]: https://github.com/cockroachdb/cockroach/pull/43037
[#43234]: https://github.com/cockroachdb/cockroach/pull/43234
[#43253]: https://github.com/cockroachdb/cockroach/pull/43253
[#43305]: https://github.com/cockroachdb/cockroach/pull/43305
[#43416]: https://github.com/cockroachdb/cockroach/pull/43416
[#43508]: https://github.com/cockroachdb/cockroach/pull/43508
[#43589]: https://github.com/cockroachdb/cockroach/pull/43589
[#43812]: https://github.com/cockroachdb/cockroach/pull/43812
[#43942]: https://github.com/cockroachdb/cockroach/pull/43942
[#44082]: https://github.com/cockroachdb/cockroach/pull/44082
[#44119]: https://github.com/cockroachdb/cockroach/pull/44119
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.1.8 since v19.1.7.

- For a comprehensive summary of features in v19.1, see the [v19.1 GA release notes](v19.1.0.html).
- To upgrade to v19.1, see [Upgrade to CockroachDB v19.1](../v19.1/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.8-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.8.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.8.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.8.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.8-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.1.8
~~~

<h3 id="v19.1.8-security-updates">Security updates</h3>

- Previous versions of CockroachDB were incorrectly enabling non-admin SQL users to use the [statements details](../v19.1/admin-ui-statements-page.html) in the Admin UI and the HTTP endpoint `/_status/statements`. This information is sensitive because the endpoint does not hide data that the requester does not have privilege over. This has been corrected by requiring a [SQL `admin` user](../v19.1/authorization.html) to access the statements details page and the HTTP endpoint. [#44355][#44355]

<h3 id="v19.1.8-admin-ui-changes">Admin UI changes</h3>

- We previously introduced a fix on the admin UI to prevent non-admin SQL users from executing queries - however, this accidentally made certain pages requiring table details not to display. This error has now been fixed. [#44193][#44193]

<h3 id="v19.1.8-bug-fixes">Bug fixes</h3>

- Fixed a bug where repeated use of [`COPY FROM PARENT`](../v19.1/configure-replication-zones.html#replication-zone-variables) on an index or partition could cause an unexpected validation error. [#44266][#44266]
- Fixed a planning bug related to [`FULL` joins](../v19.1/joins.html#full-outer-joins) between single-row relations. [#44242][#44242]
- Fixed incorrect plans in very rare cases involving filters that aren't constant folded in the optimizer but that can be evaluated statically when running a given query. [#44602][#44602]
- Fixed "no output column equivalent to.." and "column not in input" errors in some cases involving [`DISTINCT ON`](../v19.1/select-clause.html#eliminate-duplicate-rows) and [`ORDER BY`](../v19.1/query-order.html). [#44598][#44598]
- Fixed "expected constant FD to be strict" internal error. [#44599][#44599]
- Fixed a bug where running a query with the [`LIKE`](../v19.1/functions-and-operators.html) operator using the custom `ESCAPE` symbol when the pattern contained Unicode characters could result in an internal error in CockroachDB. [#44649][#44649]
- Fixed possibly incorrect query results in various cornercases, especially when [`SELECT DISTINCT`](../v19.1/select-clause.html#eliminate-duplicate-rows) is used. [#44606][#44606]
- Fixed an internal error that could happen in the planner when table statistics were collected manually using [`CREATE STATISTICS`](../v19.1/create-statistics.html) for different columns at different times. [#44443][#44443]
- CockroachDB no longer repeatedly looks for non-existing jobs, which may cause  high memory usage, when cleaning up schema changes. [#44824][#44824]

<h3 id="v19.1.8-contributors">Contributors</h3>

This release includes 12 merged PRs by 9 authors.
We would like to thank the following contributors from the CockroachDB community:

- Oliver Tan (first-time contributor, CockroachDB team member)

[#44193]: https://github.com/cockroachdb/cockroach/pull/44193
[#44242]: https://github.com/cockroachdb/cockroach/pull/44242
[#44266]: https://github.com/cockroachdb/cockroach/pull/44266
[#44355]: https://github.com/cockroachdb/cockroach/pull/44355
[#44443]: https://github.com/cockroachdb/cockroach/pull/44443
[#44599]: https://github.com/cockroachdb/cockroach/pull/44599
[#44602]: https://github.com/cockroachdb/cockroach/pull/44602
[#44606]: https://github.com/cockroachdb/cockroach/pull/44606
[#44649]: https://github.com/cockroachdb/cockroach/pull/44649
[#44824]: https://github.com/cockroachdb/cockroach/pull/44824
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.1.9 since v19.1.8.

- For a comprehensive summary of features in v19.1, see the [v19.1 GA release notes](v19.1.0.html).
- To upgrade to v19.1, see [Upgrade to CockroachDB v19.1](../v19.1/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.1/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.1.9-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.9.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.9.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.1.9.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.1.9-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.1.9
~~~

<h3 id="v19.1.9-backward-incompatible-changes">Backward-incompatible changes</h3>

- Previously, the phase of server shutdown responsible for range lease transfers to other nodes would give up after 10,000 attempts of transferring replica leases away, regardless of the value of `server.shutdown.lease_transfer_wait`. The limit of 10,000 attempts has been removed, so that now only the maximum duration `server.shutdown.lease_transfer_wait` applies. [#47698][#47698]
- The textual error and warning messages displayed by [`cockroach quit`](../v19.1/stop-a-node.html) under various circumstances have been updated. Meanwhile, the message "`ok`" remains as indicator that the operation has likely succeeded. [#47698][#47698]
- [`cockroach quit`](../v19.1/stop-a-node.html) now prints out progress details on its standard error stream, even when `--logtostderr` is not specified. Previously, nothing was printed on standard error. Scripts that wish to ignore this output can redirect the `stderr` stream. [#47698][#47698]

<h3 id="v19.1.9-security-updates">Security updates</h3>

- Non-licensed users are now able to [add more principals](../v19.1/grant-roles.html) to the special superuser role/group `admin`. Note: [Creation of additional roles](../v19.1/create-role.html) is still a licensed feature. [#45396][#45396]

<h3 id="v19.1.9-general-changes">General changes</h3>

- Previously, the phase of server shutdown responsible for range lease transfers to other nodes had a hard timeout of 5 seconds. This patch makes this timeout configurable via the new cluster setting `server.shutdown.lease_transfer_wait`. [#47698][#47698]

<h3 id="v19.1.9-sql-language-changes">SQL language changes</h3>

- It is now possible to use [`GRANT`](../v19.1/grant.html) and [`REVOKE`](../v19.1/revoke.html) to add users to the `admin` role without a valid license. This change aims to enable use of the Admin UI and other privileged features without a license. [#45396][#45396]
- The type checking code now prefers aggregate overloads with string inputs if there are multiple possible candidates due to arguments of unknown type. [#46902][#46902]
- Added a new "unimplemented" error when attempting to [`ADD CONSTRAINT `](../v19.1/add-constraint.html) with the `EXCLUDE USING` syntax. [#46912][#46912]
- Added support for using [`CREATE INDEX ... INCLUDE (col1, col2, ...)`](../v19.1/create-index.html), which is an alias that PostgreSQL uses that is analogous to our `STORING (col1, col2, ...)` syntax. [#46912][#46912]
- Added support for parsing the `REINDEX` syntax, which results in an "unimplemented" error that explains that `REINDEX`ing is not required in CockroachDB. [#46912][#46912]
- CockroachDB now parses the `CREATE INDEX CONCURRENTLY` and `DROP INDEX CONCURRENTLY` syntaxes, which return errors when used. [#46808][#46808]

<h3 id="v19.1.9-command-line-changes">Command-line changes</h3>

- [`cockroach debug zip`](../v19.1/debug-zip.html) now avoids creating invalid zip files if some of its requests encounter an error. [#46637][#46637]
- The time that [`cockroach quit`](../v19.1/stop-a-node.html) waits client-side for the node to drain (remove existing clients and push range leases away) is now configurable via the command-line flag `--drain-wait`. Note that separate server-side timeouts also apply separately; check the `server.shutdown.*` [cluster settings](../v19.1/cluster-settings.html) for details. [#47698][#47698]
- It is now possible to drain a node without shutting down the process, using [`cockroach node drain`](../v19.1/view-node-details.html). This makes it easier to integrate with service managers and orchestration: it now becomes safe to issue `cockroach node drain` and then separately stop the service via a process manager or orchestrator. Without this new mode, there is a risk to misconfigure the service manager to auto-restart the node after it shuts down via `quit`, in a way that's surprising or unwanted. The new command `node drain` also recognizes the new `--drain-wait` flag. [#47698][#47698]
- The default value of the parameter `--drain-wait` for [`cockroach quit`](../v19.1/stop-a-node.html) has been increased from 1 minute to 10 minutes, to give more time for nodes with thousands of ranges to migrate their leases away. [#47698][#47698]
- The commands [`cockroach quit`](../v19.1/stop-a-node.html) and [`cockroach node drain`](../v19.1/view-node-details.html) now report a "work remaining" metric on their standard error stream. The value reduces until it reaches `0`, to indicate that the graceful shutdown has completed server-side. An operator can now rely on `cockroach node drain` to obtain confidence of a graceful shutdown prior to terminating the server process. [#47698][#47698]

<h3 id="v19.1.9-admin-ui-changes">Admin UI changes</h3>

- Metrics relating to [SQL transaction](../v19.1/admin-ui-sql-dashboard.html) restarts and rollbacks are now properly captured and exported. [#46273][#46273]

<h3 id="v19.1.9-bug-fixes">Bug fixes</h3>

- Fixed a "cannot map variable" error in some rare cases involving [joins](../v19.1/joins.html). [#44860][#44860]
- Fixed incorrect de-duplication of impure expressions (like `gen_random_uuid`) in projections and default values. [#44916][#44916]
- Fixed an internal error that could occur when `NULLIF` was called with one null argument. [#45391][#45391]
- It is now possible to create [inverted indexes](../v19.1/inverted-indexes.html) on columns whose names are mixed-case. [#45678][#45678]
- Previously, drivers that did not truncate trailing zeroes for decimals in the binary format ended up having inaccuracies of up to 10^4 during the decode step. Fixed this error by truncating the trailing zeroes as appropriate. This fixes known incorrect decoding cases with Postgrex in Elixir. [#45671][#45671]
- Fixed a name resolution error that could occur when a [common table expression](../v19.1/common-table-expressions.html) (CTE) was referenced in the [`SELECT`](../v19.1/selection-queries.html) list of a query using the syntax `<cte-name>.<col-name>`. [#45782][#45782]
- Previously, CockroachDB could crash when computing [window functions](../v19.1/window-functions.html) with `RANGE` mode of framing when one of the bounds was either of `offset PRECEDING` or `offset FOLLOWING` type when there were `NULL` values in the single column from `ORDER BY` clause. Additionally, in `RANGE` mode bounds `0 PRECEDING` and `0 FOLLOWING` could be handled incorrectly. Now this has been fixed. [#45806][#45806]
- Fixed an internal error that could occur in the [optimizer](../v19.1/cost-based-optimizer.html) when a `WHERE` filter contained at least one correlated subquery and one non-correlated subquery. [#46168][#46168]
- CockroachDB now properly supports using `--url` with query options (e.g., `application_name`) without specifying `sslmode`. The default of `sslmode=disable` is assumed in that case. [#46480][#46480]
- Fixed a bug where operations on an index that contained a collated string in descending order would fail. [#46579][#46579]
- Fixed an incorrect query result that could occur when a scalar aggregate was called with a null input. [#46902][#46902]
- Fixed a data race on AST nodes for [`SELECT`](../v19.1/selection-queries.html) statements that include a `WINDOW` clause. It is unclear whether this could have resulted in incorrect results being returned for these queries. [#47177][#47177]
- Fixed incorrect results that could occur when casting negative [intervals](../v19.1/interval.html) or [timestamps](../v19.1/timestamp.html) to type [decimal](../v19.1/decimal.html). [#47524][#47524]
- Previously, CockroachDB was incorrectly releasing memory used by hash aggregation. This could lead to a crash (which was more likely when hash aggregation had store on the order of 100k of groups) and is now fixed. [#47520][#47520]
- Fixed a bug that could lead to data corruption or data loss if a replica was both the source of a snapshot and was being concurrently removed from the range. This scenario is rare, but possible. [#48317][#48317]

<h3 id="v19.1.9-contributors">Contributors</h3>

This release includes 27 merged PRs by 10 authors.

[#44860]: https://github.com/cockroachdb/cockroach/pull/44860
[#44916]: https://github.com/cockroachdb/cockroach/pull/44916
[#45391]: https://github.com/cockroachdb/cockroach/pull/45391
[#45396]: https://github.com/cockroachdb/cockroach/pull/45396
[#45671]: https://github.com/cockroachdb/cockroach/pull/45671
[#45678]: https://github.com/cockroachdb/cockroach/pull/45678
[#45782]: https://github.com/cockroachdb/cockroach/pull/45782
[#45806]: https://github.com/cockroachdb/cockroach/pull/45806
[#46168]: https://github.com/cockroachdb/cockroach/pull/46168
[#46273]: https://github.com/cockroachdb/cockroach/pull/46273
[#46480]: https://github.com/cockroachdb/cockroach/pull/46480
[#46579]: https://github.com/cockroachdb/cockroach/pull/46579
[#46637]: https://github.com/cockroachdb/cockroach/pull/46637
[#46808]: https://github.com/cockroachdb/cockroach/pull/46808
[#46902]: https://github.com/cockroachdb/cockroach/pull/46902
[#46912]: https://github.com/cockroachdb/cockroach/pull/46912
[#47177]: https://github.com/cockroachdb/cockroach/pull/47177
[#47520]: https://github.com/cockroachdb/cockroach/pull/47520
[#47524]: https://github.com/cockroachdb/cockroach/pull/47524
[#47698]: https://github.com/cockroachdb/cockroach/pull/47698
[#48317]: https://github.com/cockroachdb/cockroach/pull/48317
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

In addition to various enhancements and bug fixes, with this first alpha release of the v19.2.0 series, we would like to highlight the following changes:

- **Parallel Commit**: The parallel commit feature is a major optimization that halves the latency of distributed transactions, including those caused by secondary indexes. Previously, transactions would involve two synchronous rounds of replication consensus - one for write operations performed in parallel via [transaction pipelining](../v19.2/architecture/transaction-layer.html#transaction-pipelining) and then another for the commit. Now, replication for the commit runs in parallel with other write operations, avoiding an extra synchronous round trip and dramatically increasing overall transaction performance. This is achieved via a new "implicit" commit status that is distributed yet atomic and durable and that resolves to an "explicit" centralized status quickly for the efficiency of conflicting transactions. Detailed documentation is coming soon; in the meantime, see the [Parallel Commit RFC](https://github.com/cockroachdb/cockroach/blob/master/docs/RFCS/20180324_parallel_commit.md).

- **Business Source License (BSL)**: This release uses the Business Source License instead of the Apache 2.0 License. For more information on why we changed our licensing approach and some practical questions and implications, see our [blog post](https://www.cockroachlabs.com/blog/oss-relicensing-cockroachdb/) and [Licensing FAQs](../v19.2/licensing-faqs.html). The full details of the license can be found on [Github](https://github.com/cockroachdb/cockroach/blob/master/licenses/BSL.txt).

<h3 id="v19.2.0-alpha.20190606-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-alpha.20190606.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-alpha.20190606.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-alpha.20190606.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.0-alpha.20190606-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.0-alpha.20190606
~~~

<h3 id="v19.2.0-alpha.20190606-backward-incompatible-changes">Backward-incompatible changes</h3>

- Removed the deprecated `changefeed.min_high_water` metric; use `changefeed.max_behind_nanos` instead. [#36915][#36915]

<h3 id="v19.2.0-alpha.20190606-general-changes">General changes</h3>

- Added the `kv.range_merge.manual_split_ttl` [cluster setting](../v19.2/cluster-settings.html). [#37728][#37728] {% comment %}doc{% endcomment %}
- CockroachDB now uses the Business Source License instead of the Apache License. See our [blog post](https://www.cockroachlabs.com/blog/oss-relicensing-cockroachdb/) for details. [#38007][#38007]

<h3 id="v19.2.0-alpha.20190606-enterprise-edition-changes">Enterprise edition changes</h3>

- You can now alter the zone configuration for a secondary index partition using the syntax `ALTER PARTITION OF INDEX <tablename>@<indexname> CONFIGURE ZONE ...`. [#36868][#36868] {% comment %}doc{% endcomment %}

<h3 id="v19.2.0-alpha.20190606-sql-language-changes">SQL language changes</h3>

- Zigzag joins will now be planned by the optimizer in certain cases. They were previously available via the `experimental_enable_zigzag_join` session variable and can still be disabled by setting that value to `false`. [#35911][#35911] {% comment %}doc{% endcomment %}
- The `LATERAL` keyword in a `FROM` clause is now supported. [#36613][#36613] {% comment %}doc{% endcomment %}
- The `information_schema.columns` table now gives more conformant output for `varbit`, `char`, `timestamp`, and `time` types. [#36598][#36598] {% comment %}doc{% endcomment %}
- Extended the list of advertised OIDs in `pg_type` to include additional array-related types, such as `_int2vector`, `_regproc`, etc. [#36598][#36598]
- CockroachDB now displays correct array type `oids` for `oidvector` and `int2vector` types in the `pg_type` table, for better PG compatibility. [#36598][#36598]
- CockroachDB now uses the Postgres-compatible name when auto-generating a column alias for a `CAST` expression. [#36598][#36598]
- Locale names in `COLLATE` clauses now have dash characters mapped to underscore when printed as part of SQL syntax. [#36598][#36598] {% comment %}doc{% endcomment %}
- Parallel statement execution has been removed because the performance improvement it provided was absorbed by transactional pipelining, which doesn't require client buy in. The `RETURNING NOTHING` syntax will still be accepted but becomes a no-op. [#35959][#35959] {% comment %}doc{% endcomment %}
- Only `SELECT`, `INSERT`, `UPDATE`, `UPSERT`, `DELETE`, `SHOW`, `EXPLAIN` are now supported as data sources using the `SELECT ...  FROM [ ... ]` syntax. [#36977][#36977] {% comment %}doc{% endcomment %}
- The `atttypmod` column of the `pg_attribute` catalog table is now supported. [#37230][#37230]
- Dates are now fully Postgres-compatible, including support for sentinel values (`+/- infinity`) and the Postgres date range (`4714-11-24 BC` to `5874897-12-31`). Existing dates outside of this range will be converted to the `+/- infinity` dates. [#36938][#36938] {% comment %}doc{% endcomment %}
- Added an overload for `now()` that returns a date. [#37284][#37284]
- Added supported for the empty `default_tablespace` session variable for Postgres compatibility. [#37333][#37333]
- Permitted casting empty arrays to any array type. [#37356][#37356]
- Removed the legacy batch-by-batch index backfiller, as well as the `schemachanger.bulk_index_backfill.enabled` [cluster setting](../v19.2/cluster-settings.html) that could be disabled to activate it. [#37213][#37213] {% comment %}doc{% endcomment %}
- Removed the `transform` option from [`IMPORT`](../v19.2/import.html). [#37338][#37338] {% comment %}doc{% endcomment %}
- Added a new `locality_value` [built-in function](../v19.2/functions-and-operators.html) that returns the value of the locality key given as its argument. [#37369][#37369] {% comment %}doc{% endcomment %}
- CockroachDB now returns `NaN` instead of an error during invalid decimal operations. [#36964][#36964]
- Foreign keys that are added to an existing table using `ALTER TABLE` will now be validated for existing rows, with improved performance compared to running `ADD CONSTRAINT` followed by `VALIDATE CONSTRAINT` previously. [#37433][#37433] {% comment %}doc{% endcomment %}
- `SHOW COLUMNS ... WITH COMMENTS` now supports printing out column comments using the optional phrase `WITH COMMENT`, e.g `SHOW COLUMNS FROM mytable WITH COMMENT`. [#37174][#37174] {% comment %}doc{% endcomment %}
- `SHOW DATABASES WITH COMMENTS` now supports printing out database comments using the optional phrase `WITH COMMENT`, e.g `SHOW DATABASES WITH COMMENT`. [#37175][#37175] {% comment %}doc{% endcomment %}
- `CREATE TABLE` statements now always trigger automatic statistics collection on a newly created table. [#37611][#37611] {% comment %}doc{% endcomment %}
- Added the `split_time` column to `crdb_internal.ranges` and `crdb_internal.ranges_no_leases`. [#37610][#37610]
- Corrected interval math when multiplying or dividing by floats or ints. [#37744][#37744]
- Added the `ALTER TABLE/INDEX ... UNSPLIT AT ...` statement. [#37603][#37603] {% comment %}doc{% endcomment %}
- Added support for the time value `24:00` and variants. [#37898][#37898]
- CockroachDB now reports a dedicated SQL error code in the particular situation where a multi-statement transaction is committed but one of the schema change (DDL) operations failed. As in previous versions, CockroachDB leaves the transaction partly committed and partly aborted in that case; the new error code aims to facilitate the recognition of this case in client code. [#37791][#37791] {% comment %}doc{% endcomment %}
- Added support for a `SHOW INDEXES FROM DATABASE` command. [#37942][#37942] {% comment %}doc{% endcomment %}

<h3 id="v19.2.0-alpha.20190606-command-line-changes">Command-line changes</h3>

- Included collected goroutine dumps in [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html). [#36813][#36813] {% comment %}doc{% endcomment %}
- Added the `movr` workload to the `cockroach workload` command. This workload simulates a fictional ride sharing company and is based on our open-source [MovR GitHub repository](https://github.com/cockroachdb/movr). [#37709][#37709] {% comment %}doc{% endcomment %}

<h3 id="v19.2.0-alpha.20190606-admin-ui-changes">Admin UI changes</h3>

- CockroachDB now includes only successfully executed statements in the statement counters. [#37264][#37264]

<h3 id="v19.2.0-alpha.20190606-bug-fixes">Bug fixes</h3>

- Fixed a roundtrip typecasting issue where an `INET` casted to a `STRING` and back to an `INET` would fail. [#37938][#37938]
- Fixed a panic when `json_build_object` is called with `BIT`/`VARBIT` values. [#37057][#37057]
- Fixed a panic when planning zigzag joins against unique indexes. [#36139][#36139]
- `RESTORE` now balances the work of ingesting data more evenly between nodes. [#36665][#36665]
- `IMPORT` now balances the work of ingesting data more evenly between nodes. [#36665][#36665]
- CockroachDB now computes the result of shifting bit arrays to the right properly and avoids generating invalid bit arrays. [#36715][#36715]
- `SHOW ZONE CONFIGURATION` no longer emits invalid `ALTER` syntax in its output when displaying the zone configuration for a table or index partition that is inheriting from the database or the default configuration. [#36868][#36868]
- `SHOW ZONE CONFIGURATION FOR TABLE t PARTITION p` no longer ignores the clause `PARTITION p` and now properly displays the zone configuration for that partition instead. [#36868][#36868] {% comment %}doc{% endcomment %}
- When a node is restarted with another node's address, CockroachDB now performs fewer attempts to communicate with the wrong node. [#34197][#34197]
- It is now possible to write to columns of type `name[]`. [#37170][#37170]
- Permitted planning of window functions within mutation statements (and others that cannot be distributed). [#37171][#37171]
- Avoided a source of internal connectivity problems that would resolve after restarting the affected node. [#37204][#37204]
- Permitted arrays and other sequences to be type-checkable in certain contexts when all of their elements are null. [#36673][#36673]
- CockroachDB now correctly escapes non-finite JSON number values when marshaling to text. [#37331][#37331]
- The [`cockroach init`](../v19.2/cockroach-init.html) command will now always properly report when a cluster is already initialized, even after the node that it's connecting to is restarted. [#37399][#37399] {% comment %}doc{% endcomment %}
- Automated table statistics no longer encounter "batch timestamp must be after replica GC threshold" errors on configurations with low TTL. [#36500][#36500]
- Fixed type inference of columns in subqueries for some expressions of the form `scalar IN (subquery)`. [#37578][#37578]
- Fixed a crash in apply join. [#37597][#37597]
- The `age()` function is now correctly marked as impure, causing it to be unavailable in certain contexts. [#37609][#37609]
- Fixed a panic when constructing the error message for an invalid partitioning. [#37689][#37689]
- Fixed incorrect multiplication of `float` and `interval` types. [#37582][#37582]
- Fixed a case in which [`cockroach quit`](../v19.2/cockroach-quit.html) would return success even though the server process was still running in a severely degraded state. [#37668][#37668]
- Fixed a potential source of (faux) replica inconsistencies that can be reported while running a mixed v19.1 / v2.1 cluster. This error (in that situation only) is benign and can be resolved by upgrading to the latest v19.1 patch release. Every time this error occurs a "checkpoint" is created which will occupy a large amount of disk space and which needs to be removed manually (see `<store directory>/auxiliary/checkpoints`). [#37668][#37668]
- Prevented unlimited memory usage during SQL range deletions [#36728][#36728]
- Dividing floats by zero now returns an error instead of `-Inf`. [#37774][#37774]
- Fixed incorrect results or "incorrectly ordered stream" error in some cases of queries with aggregations. [#37713][#37713]
- A null right operand now causes the sub-operator expression to return null. [#37775][#37775]
- Certain binary encodings of numeric/decimal values no longer result in values that are an order of magnitude off. [#35115][#35115]
- Fixed `GROUP BY` for empty arrays. [#37901][#37901]
- Fixed a race condition that could cause a panic during query planning. [#37972][#37972]
- The `cockroach` command line utilities that internally use a RPC connection (e.g., `cockroach quit`, `cockroach init`, etc.) once again properly support passing an IPv6 address literal via the `--host` argument. [#37977][#37977]

<h3 id="v19.2.0-alpha.20190606-performance-improvements">Performance improvements</h3>

- Improved memory efficiency of bulk ingestion and index backfills buffering. [#36743][#36743]
- Fixed a significant performance regression when building CockroachDB with go1.12. [#37967][#37967]

<h3 id="v19.2.0-alpha.20190606-security-improvement">Security improvement</h3>

- Stack memory used by CockroachDB is now marked as non-executable, improving security and compatibility with SELinux. [#37939][#37939]

<h3 id="v19.2.0-alpha.20190606-contributors">Contributors</h3>

This release includes 728 merged PRs by 50 authors. We would like to thank the following contributors from the CockroachDB community:

- George Papadrosou
- Jaewan Park
- Simo Kinnunen (first-time contributor)
- Txiaozhe
- Vijay Karthik
- joowon (first-time contributor)
- lanzao

[#34197]: https://github.com/cockroachdb/cockroach/pull/34197
[#35115]: https://github.com/cockroachdb/cockroach/pull/35115
[#35861]: https://github.com/cockroachdb/cockroach/pull/35861
[#35911]: https://github.com/cockroachdb/cockroach/pull/35911
[#35959]: https://github.com/cockroachdb/cockroach/pull/35959
[#36000]: https://github.com/cockroachdb/cockroach/pull/36000
[#36139]: https://github.com/cockroachdb/cockroach/pull/36139
[#36145]: https://github.com/cockroachdb/cockroach/pull/36145
[#36195]: https://github.com/cockroachdb/cockroach/pull/36195
[#36239]: https://github.com/cockroachdb/cockroach/pull/36239
[#36327]: https://github.com/cockroachdb/cockroach/pull/36327
[#36393]: https://github.com/cockroachdb/cockroach/pull/36393
[#36500]: https://github.com/cockroachdb/cockroach/pull/36500
[#36598]: https://github.com/cockroachdb/cockroach/pull/36598
[#36613]: https://github.com/cockroachdb/cockroach/pull/36613
[#36665]: https://github.com/cockroachdb/cockroach/pull/36665
[#36673]: https://github.com/cockroachdb/cockroach/pull/36673
[#36715]: https://github.com/cockroachdb/cockroach/pull/36715
[#36728]: https://github.com/cockroachdb/cockroach/pull/36728
[#36743]: https://github.com/cockroachdb/cockroach/pull/36743
[#36775]: https://github.com/cockroachdb/cockroach/pull/36775
[#36813]: https://github.com/cockroachdb/cockroach/pull/36813
[#36868]: https://github.com/cockroachdb/cockroach/pull/36868
[#36889]: https://github.com/cockroachdb/cockroach/pull/36889
[#36915]: https://github.com/cockroachdb/cockroach/pull/36915
[#36938]: https://github.com/cockroachdb/cockroach/pull/36938
[#36964]: https://github.com/cockroachdb/cockroach/pull/36964
[#36977]: https://github.com/cockroachdb/cockroach/pull/36977
[#37021]: https://github.com/cockroachdb/cockroach/pull/37021
[#37057]: https://github.com/cockroachdb/cockroach/pull/37057
[#37125]: https://github.com/cockroachdb/cockroach/pull/37125
[#37170]: https://github.com/cockroachdb/cockroach/pull/37170
[#37171]: https://github.com/cockroachdb/cockroach/pull/37171
[#37174]: https://github.com/cockroachdb/cockroach/pull/37174
[#37175]: https://github.com/cockroachdb/cockroach/pull/37175
[#37204]: https://github.com/cockroachdb/cockroach/pull/37204
[#37213]: https://github.com/cockroachdb/cockroach/pull/37213
[#37230]: https://github.com/cockroachdb/cockroach/pull/37230
[#37264]: https://github.com/cockroachdb/cockroach/pull/37264
[#37284]: https://github.com/cockroachdb/cockroach/pull/37284
[#37331]: https://github.com/cockroachdb/cockroach/pull/37331
[#37333]: https://github.com/cockroachdb/cockroach/pull/37333
[#37338]: https://github.com/cockroachdb/cockroach/pull/37338
[#37356]: https://github.com/cockroachdb/cockroach/pull/37356
[#37369]: https://github.com/cockroachdb/cockroach/pull/37369
[#37399]: https://github.com/cockroachdb/cockroach/pull/37399
[#37403]: https://github.com/cockroachdb/cockroach/pull/37403
[#37433]: https://github.com/cockroachdb/cockroach/pull/37433
[#37496]: https://github.com/cockroachdb/cockroach/pull/37496
[#37578]: https://github.com/cockroachdb/cockroach/pull/37578
[#37582]: https://github.com/cockroachdb/cockroach/pull/37582
[#37597]: https://github.com/cockroachdb/cockroach/pull/37597
[#37603]: https://github.com/cockroachdb/cockroach/pull/37603
[#37608]: https://github.com/cockroachdb/cockroach/pull/37608
[#37609]: https://github.com/cockroachdb/cockroach/pull/37609
[#37610]: https://github.com/cockroachdb/cockroach/pull/37610
[#37611]: https://github.com/cockroachdb/cockroach/pull/37611
[#37668]: https://github.com/cockroachdb/cockroach/pull/37668
[#37689]: https://github.com/cockroachdb/cockroach/pull/37689
[#37709]: https://github.com/cockroachdb/cockroach/pull/37709
[#37713]: https://github.com/cockroachdb/cockroach/pull/37713
[#37728]: https://github.com/cockroachdb/cockroach/pull/37728
[#37741]: https://github.com/cockroachdb/cockroach/pull/37741
[#37744]: https://github.com/cockroachdb/cockroach/pull/37744
[#37774]: https://github.com/cockroachdb/cockroach/pull/37774
[#37775]: https://github.com/cockroachdb/cockroach/pull/37775
[#37791]: https://github.com/cockroachdb/cockroach/pull/37791
[#37888]: https://github.com/cockroachdb/cockroach/pull/37888
[#37898]: https://github.com/cockroachdb/cockroach/pull/37898
[#37901]: https://github.com/cockroachdb/cockroach/pull/37901
[#37938]: https://github.com/cockroachdb/cockroach/pull/37938
[#37939]: https://github.com/cockroachdb/cockroach/pull/37939
[#37942]: https://github.com/cockroachdb/cockroach/pull/37942
[#37967]: https://github.com/cockroachdb/cockroach/pull/37967
[#37972]: https://github.com/cockroachdb/cockroach/pull/37972
[#37977]: https://github.com/cockroachdb/cockroach/pull/37977
[#38007]: https://github.com/cockroachdb/cockroach/pull/38007
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

This release contains enhancements and bug fixes to the 19.2.0 series, including:

- Experimental support for using [`IMPORT INTO`](../v19.2/import-into.html) to ingest CSV data into an existing table. Usage: `IMPORT INTO t(a, b) CSV DATA ('gs://acme-co/employees.csv')`.
- Adding non-null constraints to existing columns with `ALTER TABLE ... SET NOT NULL`.
- Various updates to improve Postgres compatibility.

For more information, see below.

<h3 id="v19.2.0-alpha.20190701-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-alpha.20190701.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-alpha.20190701.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-alpha.20190701.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.0-alpha.20190701-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.0-alpha.20190701
~~~

<h3 id="v19.2.0-alpha.20190701-backward-incompatible-changes">Backward-incompatible changes</h3>

- Integer and float columns of less than the max width will now be returned as their own type via the binary protocol. For example, an `int4` column will be returned in 32 bits over the pgwire binary protocol instead of 64 bits. [#37295][#37295]

<h3 id="v19.2.0-alpha.20190701-general-changes">General changes</h3>

- Removed `kv.range_merge.manual_split_ttl` [cluster setting](../v19.2/cluster-settings.html). [#38004][#38004] {% comment %}doc{% endcomment %}
- Go 1.12.5 is now required to build CockroachDB from source. {% comment %}doc{% endcomment %}

<h3 id="v19.2.0-alpha.20190701-sql-language-changes">SQL language changes</h3>

- Added experimental support for using [`IMPORT INTO`](../v19.2/import-into.html) to ingest CSV data into an existing table. Usage: `IMPORT INTO t(a, b) CSV DATA ('gs://acme-co/employees.csv')`. [#37451][#37451]
- Implemented SQL support for timestamp objects to have an optional precision value. [#37920][#37920] {% comment %}doc{% endcomment %}
- The logging format for statement execution (as enabled by `sql.trace.log_statement_execute`) and audit logs (as enabled by [`ALTER TABLE .. EXPERIMENTAL AUDIT SET ...`](../v19.2/experimental-audit.html)) is extended with one column that reports internal execution retries performed automatically by the server. The value `zero` is logged for the first retry attempt and thus corresponds to statements directly received from a client. [#38028][#38028] {% comment %}doc{% endcomment %}
- Added `WITH EXPIRATION` option for [`SPLIT AT`](../v19.2/split-at.html). [#38004][#38004] {% comment %}doc{% endcomment %}
- The `DISTINCT` keyword is now rejected when used in a window function. It was previously accepted, but ignored. [#37912][#37912]
- Added `UNSPLIT ALL` statement. [#38023][#38023] {% comment %}doc{% endcomment %}
- The `relam` column of the `pg_catalog` tables `pg_class` and `pg_index` is now filled in correctly. [#38164][#38164]
- CockroachDB now supports the special case `set timezone = 'utc'` as a special alias for `set timezone = 'UTC'`. The other time zone names are still case-sensitive as previously, pending resolution of issue #36864. [#38195][#38195] {% comment %}doc{% endcomment %}
- Added support for `ALTER TABLE ... ALTER COLUMN ... SET NOT NULL`, which adds a non-null constraint to an existing column. [#37554][#37554] {% comment %}doc{% endcomment %}
- `pg_get_constraintdef` now outputs `CHECK` constraints exactly the same way that Postgres does. [#38318][#38318]
- The `format_type` Postgres builtin now properly respects its second argument. [#38318][#38318]
- [`SHOW CREATE TABLE`](../v19.2/show-create.html) now prints foreign keys more like Postgres does. [#38318][#38318]
- The `pg_type_is_visible` builtin from Postgres is now implemented. [#38318][#38318]
- Casting an `int2vector` to a string now produces a Postgres-compatible result. [#38318][#38318]

<h3 id="v19.2.0-alpha.20190701-command-line-changes">Command-line changes</h3>

- CockroachDB will now print out an error message and an informative hint if the time zone database is unusable. [#38197][#38197]

<h3 id="v19.2.0-alpha.20190701-admin-ui-changes">Admin UI changes</h3>

- The snapshots graph on the [Replication page](../v19.2/admin-ui-replication-dashboard.html) in the Web UI now includes learner snapshots. [#38147][#38147] {% comment %}doc{% endcomment %}
- Removed version information from login screen. [#38140][#38140]
- Added `Implicit Transaction` flag to [Statements](../v19.2/admin-ui-statements-page.html) and [Statement Details](../v19.2/admin-ui-statements-page.html#statement-details-page) page. [#36341][#36341] {% comment %}doc{% endcomment %}
- Checking the "skip should queue" checkbox in the Manual Enqueue Range [advanced debugging page](../v19.2/admin-ui-debug-pages.html) now works for the GC Queue. [#38249][#38249]

<h3 id="v19.2.0-alpha.20190701-bug-fixes">Bug fixes</h3>

- Fixed help text that erroneously labeled [Encryption at Rest](../v19.2/encryption.html) as experimental. [#38228][#38228]
- The `max_retries` column in the statement statistics now properly displays the maximum number of times a statement was retried. [#38028][#38028]
- Previously, due to a bug when estimating result set sizes in the optimizer, queries involving `int` ranges that were very large could result in poor plans being generated. [#38036][#38036]
- Fixed a bug where MVCC value at future timestamp is returned after a transaction restart. [#38085][#38085]
- The YCSB workload will no longer ignore the `--db` option. [#38236][#38236]
- Localities in the `crdb_internal` tables were displayed JSON objects instead of strings. This format stripped them of their order, which is important in localities. This string format now exactly matches what is used in the command line for setting localities. [#37944][#37944]
- Fixed an incorrect type mismatch error when empty array values are used as default values (and potentially in other contexts). [#38294][#38294]
- Fixed a panic that could occur when decoding decimals as query parameters. [#38304][#38304]
- Nulls are now correctly handled by `MIN`, `SUM`, and `AVG` [aggregate functions](../v19.2/functions-and-operators.html#aggregate-functions) when used as [window functions](../v19.2/window-functions.html). [#38110][#38110]
- Prevented a possible panic during [`JSONB`](../v19.2/jsonb.html) binary query parameter parsing. [#38346][#38346]
- Prevented a possible panic during [`INET`](../v19.2/inet.html) binary query parameter parsing. [#38346][#38346]
- Prevented a possible panic during [`VARBIT`](../v19.2/bit.html) binary query parameter parsing. [#38346][#38346]
- Prevented a possible panic during array binary query parameter parsing. [#38346][#38346]
- Fixed possible deadlock when storage engine write fails. [#38170][#38170]
- Fixed potential reappearance of deleted timeseries data, which could trip consistency checker. [#38170][#38170]
- Removed dependency on `sync_file_range` on Linux platforms on which it returns `ENOSYS`, such as WSL (Windows Subsystem for Linux). [#38170][#38170]

<h3 id="v19.2.0-alpha.20190701-build-changes">Build changes</h3>

- A recent `libedit` is now bundled with CockroachDB, which fixes some line editing bugs in the CockroachDB console. On platforms that include libedit as part of the base system, like macOS and FreeBSD, CockroachDB no longer links against the system libedit. [#32623][#32623]

<h3 id="v19.2.0-alpha.20190701-security">Security</h3>

- Only check `CN` on first certificate in file. [#38163][#38163] {% comment %}doc{% endcomment %}

<h3 id="v19.2.0-alpha.20190701-contributors">Contributors</h3>

This release includes 125 merged PRs by 30 authors.
We would like to thank the following contributors from the CockroachDB community:

- Utkarsh Gupta (first-time contributor)

[#32623]: https://github.com/cockroachdb/cockroach/pull/32623
[#36341]: https://github.com/cockroachdb/cockroach/pull/36341
[#37295]: https://github.com/cockroachdb/cockroach/pull/37295
[#37554]: https://github.com/cockroachdb/cockroach/pull/37554
[#37912]: https://github.com/cockroachdb/cockroach/pull/37912
[#37920]: https://github.com/cockroachdb/cockroach/pull/37920
[#37944]: https://github.com/cockroachdb/cockroach/pull/37944
[#37966]: https://github.com/cockroachdb/cockroach/pull/37966
[#38004]: https://github.com/cockroachdb/cockroach/pull/38004
[#38023]: https://github.com/cockroachdb/cockroach/pull/38023
[#38028]: https://github.com/cockroachdb/cockroach/pull/38028
[#38036]: https://github.com/cockroachdb/cockroach/pull/38036
[#38085]: https://github.com/cockroachdb/cockroach/pull/38085
[#38110]: https://github.com/cockroachdb/cockroach/pull/38110
[#38140]: https://github.com/cockroachdb/cockroach/pull/38140
[#38147]: https://github.com/cockroachdb/cockroach/pull/38147
[#38163]: https://github.com/cockroachdb/cockroach/pull/38163
[#38164]: https://github.com/cockroachdb/cockroach/pull/38164
[#38170]: https://github.com/cockroachdb/cockroach/pull/38170
[#38195]: https://github.com/cockroachdb/cockroach/pull/38195
[#38197]: https://github.com/cockroachdb/cockroach/pull/38197
[#38228]: https://github.com/cockroachdb/cockroach/pull/38228
[#38236]: https://github.com/cockroachdb/cockroach/pull/38236
[#38249]: https://github.com/cockroachdb/cockroach/pull/38249
[#38294]: https://github.com/cockroachdb/cockroach/pull/38294
[#38304]: https://github.com/cockroachdb/cockroach/pull/38304
[#38318]: https://github.com/cockroachdb/cockroach/pull/38318
[#38346]: https://github.com/cockroachdb/cockroach/pull/38346
[#37451]: https://github.com/cockroachdb/cockroach/pull/37451
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.0-alpha.20190805-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-alpha.20190805.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-alpha.20190805.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-alpha.20190805.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.0-alpha.20190805-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.0-alpha.20190805
~~~

<h3 id="v19.2.0-alpha.20190805-enterprise-edition-changes">Enterprise edition changes</h3>

- Added a `skip_missing_views` option for [`RESTORE`](../v19.2/restore.html) to skip restoring views which cannot be restored because their dependencies are not being restored at the same time. [#38597][#38597]

<h3 id="v19.2.0-alpha.20190805-sql-language-changes">SQL language changes</h3>

- Added support for a table reader that performs a loose index scan over the underlying table. The index scan table reader uses information about the index being scanned to skip unnecessary rows while scanning the table, allowing for some optimizations to be used for some types of queries. [#38216][#38216]
- Enabled automatic detection of compression schemes on filenames in [`IMPORT`](../v19.2/import.html) that have parameters after the path. [#38521][#38521]
- Added `check_constraints` table to the `information_schema` database. [#38545][#38545]
- Added vectorized support for the `IN` selection operator. [#38546][#38546]
- Made some `pgwire` error codes for binary parameter decoding better match Postgres. [#38365][#38365]
- Added support for projection of the `IN` operator. [#38613][#38613]
- [`EXPLAIN`](../v19.2/explain.html) returns more information about lookup joins. [#38748][#38748]
- The first statement of a transaction will no longer return a transaction retry error if it is an [`UPDATE`](../v19.2/update.html) or [`DELETE`](../v19.2/delete.html) (this was already true for [`INSERT`](../v19.2/insert.html)). [#38668][#38668]
- Non-fatal errors updating jobs while [dropping a table](../v19.2/drop-table.html) are now ignored. [#38617][#38617]
- Added support for `NOT VALID` option for [Foreign Key constraints](../v19.2/foreign-key.html). [#38663][#38663]
- Added [cluster setting](../v19.2/set-cluster-setting.html) `sql.stats.histogram_collection.enabled` to enable collection of histograms during statistics collection. [#38812][#38812]
- [Common Table Expressions](../v19.2/common-table-expressions.html) (CTEs) may now be referenced from multiple locations in a query. [#38670][#38670]
- [`CREATE TABLE AS`](../v19.2/create-table-as.html) now allows user-defined primary keys and column families. [#38904][#38904], [#38589][#38589]
- [`EXPLAIN (OPT,ENV)`](../v19.2/explain.html) now returns a URL with the data encoded in the fragment portion. Opening the URL shows a page with the decoded data. Note that the data is processed in the local browser session and is never sent out. [#38973][#38973]

<h3 id="v19.2.0-alpha.20190805-command-line-changes">Command-line changes</h3>

- [`cockroach dump`](../v19.2/cockroach-dump.html) will now more clearly refer to issue [37768](https://github.com/cockroachdb/cockroach/issues/37768) when it encounters a table with no visible columns, which (currently) cannot be dumped successfully. [#38725][#38725]
- CockroachDB now requires square brackets to specify IPv6 addresses in `--join`, `--host`, `--listen-addr` and similar [flags](../v19.2/cockroach-start.html#flags), for example `--listen-addr=[::1]`. The syntax without square brackets had been deprecated since CockroachDB 2.1. [#38924][#38924]

<h3 id="v19.2.0-alpha.20190805-admin-ui-changes">Admin UI changes</h3>

- Dashboard [graphs](../v19.2/admin-ui-overview.html) now offer a "Last 2 days" option in the time selector. [#38852][#38852]
- Corrected the units displayed for the `MVCC Intent Age` and the `MVCC GC Bytes Age` fields in the Range Status page. [#38283][#38283]

<h3 id="v19.2.0-alpha.20190805-bug-fixes">Bug fixes</h3>

- The `ALTER PARTITION x OF INDEX y CONFIGURE ZONE USING` syntax no longer erroneously modifies the entire index's [zone configuration](../v19.2/configure-zone.html). [#38423][#38423]
- Fixed an issue that prevented restoring some backups if they included tables that were partitioned by columns of a certain types while also interleaved by child tables. [#38341][#38341]
- Restoring multi-line CLI histories in the SQL shell no longer produces terminal anomalies when the cursor is on the last line of the screen. [#38505][#38505]
- Fixed a panic where generators in an aggregate function were not appropriately rejected. [#38554][#38554]
- Handled `database_name` and composite primary key for `UNSPLIT ALL`. [#38338][#38338]
- Ranges consisting of only one row (and historical versions of that row) are now correctly up-replicating. [#38529][#38529]
- Nodes that have been down now recover more quickly when they rejoin, assuming they weren't down for much more than the value of the `server.time_until_store_dead` [cluster setting](../v19.2/set-cluster-setting.html) (which defaults to 5 minutes). [#38484][#38484]
- [`cockroach sqlfmt`](../v19.2/cockroach-sqlfmt.html#flags) no longer strips `ORDER BY` from aggregates. [#38623][#38623]
- Corrected issue that caused certain plans that contained both offsets and limits to return more rows than desired. [#38667][#38667]
- Fixed a bug that prevented [inverted indexes](../v19.2/inverted-indexes.html) from being created on JSON columns containing `NULL` values. [#38738][#38738]
- Transaction retries in [schema changes](../v19.2/online-schema-changes.html) are again handled correctly. [#38668][#38668]
- On macOS, the server process can once again start in environments where the `kern.maxfilesperproc` sysctl has been lowered. [#38472][#38472]
- Fixed a bug where [dropping an index](../v19.2/drop-index.html) that a foreign key depends on could cause an inconsistent table state if the schema change were rolled back. [#38783][#38783]
- Fixed an issue where [Cost-based optimizer](../v19.2/cost-based-optimizer.html)-planned upserts that used [lookup join](../v19.2/joins.html#lookup-joins) that were run during column mutations on the table being upserted into could cause crashes or other issues. [#38637][#38637]
- Fixed incorrect results, or "unordered span" errors, in some cases involving exclusive inequalities with non-numeric types. [#38880][#38880]
- Prevented OOM conditions during lookup joins between tables with a very large n:1 relationship. [#38837][#38837]
- `sum_int()` now errors on overflow instead of silently wrapping. [#38921][#38921]
- Fixed bug in the optimizer causing a bad index for lookup join in some cases. [#39016][#39016]
- Backfills are no longer performed when a user explicitly sets the default value of a new column to be `NULL`. [#38910][#38910]

<h3 id="v19.2.0-alpha.20190805-performance-improvements">Performance improvements</h3>

- Introduced new concurrent Raft proposal buffer, which increases the degree of write concurrency supported on a single range. [#38343][#38343]
- Grow stack prior to decoding grpc BatchRequest messages. [#38107][#38107]
- Batched raft entry application and coalesce writes to applied state for the batch. [#38568][#38568]
- Improved performance of the [`BACKUP`](../v19.2/backup.html) process. [#37887][#37887]

<h3 id="v19.2.0-alpha.20190805-build-changes">Build changes</h3>

- Building CockroachDB from source now requires node version 10. This was previously implicitly required. Now the requirement is explicit. [#38955][#38955]
- Building CockroachDB from source now requires Go 1.12 or higher. [#38379][#38379]

<h3 id="v19.2.0-alpha.20190805-doc-updates">Doc updates</h3>

- Expanded single-region Kubernetes [tutorial](../v19.2/orchestrate-cockroachdb-with-kubernetes.html) to cover running on Amazon’s hosted EKS. [#5063](https://github.com/cockroachdb/docs/pull/5063)
- [Build an App with CockroachDB](../v19.2/hello-world-example-apps.html) examples now include [C++](../v19.2/build-a-c++-app-with-cockroachdb.html) and [Clojure](../v19.2/build-a-clojure-app-with-cockroachdb.html) application examples for secure clusters. In addition, the client-side transaction logic has been updated in the [Java](../v19.2/build-a-java-app-with-cockroachdb.html), [Python](../v19.2/build-a-python-app-with-cockroachdb.html), and [Go](../v19.2/build-a-go-app-with-cockroachdb.html) code examples. [#5028](https://github.com/cockroachdb/docs/pull/5028), [#5084](https://github.com/cockroachdb/docs/pull/5084), [#5085](https://github.com/cockroachdb/docs/pull/5085), [#5088](https://github.com/cockroachdb/docs/pull/5088)
- Updated [Common Errors](../v19.2/common-errors.html) document with specific error strings to aid user searches. [#5033](https://github.com/cockroachdb/docs/pull/#5033)
- Documented a [known limitation](../v19.2/known-limitations.html) about hanged requests to a restarted node that needs Raft snapshots. [#5018](https://github.com/cockroachdb/docs/pull/5018)
- Updated the [`BACKUP`](../v19.2/backup.html) and [`RESTORE`](../v19.2/restore.html) docs to specify that the `system.users` table is not included with a backup. To restore the table, you must explicitly include it. [#5072](https://github.com/cockroachdb/docs/pull/5072)

<h3 id="v19.2.0-alpha.20190805-contributors">Contributors</h3>

This release includes 285 merged PRs by 33 authors.
We would like to thank the following contributors from the CockroachDB community:

- Arseni Lapunov (first-time contributor)
- Elliot Courant (first-time contributor)

[#37887]: https://github.com/cockroachdb/cockroach/pull/37887
[#38008]: https://github.com/cockroachdb/cockroach/pull/38008
[#38107]: https://github.com/cockroachdb/cockroach/pull/38107
[#38149]: https://github.com/cockroachdb/cockroach/pull/38149
[#38216]: https://github.com/cockroachdb/cockroach/pull/38216
[#38283]: https://github.com/cockroachdb/cockroach/pull/38283
[#38338]: https://github.com/cockroachdb/cockroach/pull/38338
[#38341]: https://github.com/cockroachdb/cockroach/pull/38341
[#38343]: https://github.com/cockroachdb/cockroach/pull/38343
[#38365]: https://github.com/cockroachdb/cockroach/pull/38365
[#38379]: https://github.com/cockroachdb/cockroach/pull/38379
[#38382]: https://github.com/cockroachdb/cockroach/pull/38382
[#38423]: https://github.com/cockroachdb/cockroach/pull/38423
[#38472]: https://github.com/cockroachdb/cockroach/pull/38472
[#38484]: https://github.com/cockroachdb/cockroach/pull/38484
[#38505]: https://github.com/cockroachdb/cockroach/pull/38505
[#38521]: https://github.com/cockroachdb/cockroach/pull/38521
[#38529]: https://github.com/cockroachdb/cockroach/pull/38529
[#38545]: https://github.com/cockroachdb/cockroach/pull/38545
[#38546]: https://github.com/cockroachdb/cockroach/pull/38546
[#38554]: https://github.com/cockroachdb/cockroach/pull/38554
[#38568]: https://github.com/cockroachdb/cockroach/pull/38568
[#38589]: https://github.com/cockroachdb/cockroach/pull/38589
[#38597]: https://github.com/cockroachdb/cockroach/pull/38597
[#38613]: https://github.com/cockroachdb/cockroach/pull/38613
[#38617]: https://github.com/cockroachdb/cockroach/pull/38617
[#38623]: https://github.com/cockroachdb/cockroach/pull/38623
[#38637]: https://github.com/cockroachdb/cockroach/pull/38637
[#38663]: https://github.com/cockroachdb/cockroach/pull/38663
[#38667]: https://github.com/cockroachdb/cockroach/pull/38667
[#38668]: https://github.com/cockroachdb/cockroach/pull/38668
[#38670]: https://github.com/cockroachdb/cockroach/pull/38670
[#38725]: https://github.com/cockroachdb/cockroach/pull/38725
[#38738]: https://github.com/cockroachdb/cockroach/pull/38738
[#38748]: https://github.com/cockroachdb/cockroach/pull/38748
[#38783]: https://github.com/cockroachdb/cockroach/pull/38783
[#38812]: https://github.com/cockroachdb/cockroach/pull/38812
[#38837]: https://github.com/cockroachdb/cockroach/pull/38837
[#38852]: https://github.com/cockroachdb/cockroach/pull/38852
[#38870]: https://github.com/cockroachdb/cockroach/pull/38870
[#38880]: https://github.com/cockroachdb/cockroach/pull/38880
[#38886]: https://github.com/cockroachdb/cockroach/pull/38886
[#38890]: https://github.com/cockroachdb/cockroach/pull/38890
[#38904]: https://github.com/cockroachdb/cockroach/pull/38904
[#38910]: https://github.com/cockroachdb/cockroach/pull/38910
[#38921]: https://github.com/cockroachdb/cockroach/pull/38921
[#38924]: https://github.com/cockroachdb/cockroach/pull/38924
[#38955]: https://github.com/cockroachdb/cockroach/pull/38955
[#38973]: https://github.com/cockroachdb/cockroach/pull/38973
[#39016]: https://github.com/cockroachdb/cockroach/pull/39016
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

In addition to bug fixes and various general, enterprise, SQL, and command-line enhancements, this release includes several major highlights:

- **Locality-aware backup and restore**: You can now back up or restore a subset of a table's data according to [zone configurations](../v19.2/configure-replication-zones.html) (e.g., send your EU backup partition to an EU cloud storage location).
- [**Import performance improvements**](../v19.2/import.html): Internal improvements have been made to `IMPORT` to enable more efficient loading of large data sets.
- **Show partitions using SQL**: CockroachDB now supports the [`SHOW PARTITIONS`](../v19.2/show-partitions.html) statement, which can be used to identify partitions. It also enhances [`SHOW CREATE TABLE`](../v19.2/show-create.html) to show constraints as described.
- **Vectorized Execution**: Queries are now automatically faster for users. This work expands upon the SQL vectorized execution prototype, and allows it to be used in production. Note that this does not cover the long-tail of features necessary to use vectorization on all queries. Vectorized execution is turned on by default for a subset of queries and defaults back to DistSQL execution for unsupported queries.
- **Improve Streaming Behavior on JDBC Driver**: PostgreSQL wire protocol cursors have been implemented. As a result, PGJDBC is able to use streaming behavior to return pagination-related results. Limitations still apply. For more information, see [Build a Java App with CockroachDB](../v19.2/build-a-java-app-with-cockroachdb.html#retrieve-large-data-sets-in-chunks-using-cursors).
- [**Improve partitioning user experience**](../v19.2/partitioning.html): CockroachDB now prevents users from specifying a non-partitioned secondary index on a partitioned table by default to improve performance. Users will have the ability to override this default as it may be necessary in some rare use cases. Additionally, users can now specify the same name for the partition for tables and for all corresponding indexes.
- [**Improve setting of zone configs via SQL**](../v19.2/configure-replication-zones.html): [`ALTER TABLE`](../v19.2/alter-table.html) now returns an error when users select conflicting or impossible zone constraints due to user error.
- **Make it easy to focus queries on partitioned data**: CockroachDB now automatically limits a query to only the applicable [partition](../v19.2/partitioning.html) without having to specify the particular partition for a geo-distributed table. This prevents the query from conducting a full table scan.
- **Better insight into constraint conformance**: You can now tell if your cluster is in a healthy state based on the status of conformance to constraints like [zone configurations](../v19.2/configure-replication-zones.html), lease preferences, and replica diversification.

<h3 id="v19.2.0-beta.20190930-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-beta.20190930.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-beta.20190930.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-beta.20190930.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.0-beta.20190930-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.0-beta.20190930
~~~

<h3 id="v19.2.0-beta.20190930-general-changes">General changes</h3>

- Replicas are now added using a Raft learner and go through the normal Raft snapshot process to catch them up, eliminating technical debt. No user-facing changes are expected. [#39034][#39034] {% comment %}doc{% endcomment %}
- Atomic replication changes are now enabled by default. [#40464][#40464]
- RocksDB `INFO` logs are now stored with CockroahDB debug logs. [#40681][#40681]

<h3 id="v19.2.0-beta.20190930-backward-incompatible-changes">Backward-incompatible changes</h3>

- Quotes are no longer accepted inside unquoted CSV fields. [#40424][#40424]
- [`CONFIGURE ZONE`](../v19.2/configure-zone.html) statements now fail if the user does not have sufficient privileges. If the target is a `system` range, the `system` database, or a table in the `system` database, the user must have an admin role. For all other databases and tables, the user must have the `CREATE` privilege on the target database or table. This change might be backward-incompatible for users running scripted `CONFIGURE ZONE` statements with restricted permissions. To add the necessary permissions, use [`GRANT` &lt;privileges&gt;](../v19.2/grant.html) or [`GRANT` &lt;roles&gt;](../v19.2/grant-roles.html) as a user with an admin role. For example, to grant a user the admin role, run `GRANT admin TO <user>`. To grant the `CREATE` privilege on a database or table, run `GRANT CREATE ON [DATABASE | TABLE] <name> TO <user>`. [#40879][#40879]

<h3 id="v19.2.0-beta.20190930-enterprise-edition-changes">Enterprise edition changes</h3>

- Added support for client certificates for Kafka changefeed authentication. [#39832][#39832]
- Added support for locality-aware [backups](../v19.2/backup.html) across multiple backup destinations. [#39250][#39250] {% comment %}doc{% endcomment %}
- Added support for displaying creation statements of relations stored in a [backups](../v19.2/backup.html). [#39323][#39323] {% comment %}doc{% endcomment %}
- [Table statistics](../v19.2/create-statistics.html) for the tables that are being backed up are now also backed up. [#39644][#39644] {% comment %}doc{% endcomment %}
- Corrected behavior for unmatched quotes in enclosed fields. [#40960][#40960]
- Added `auth=implicit` setting, which removes access key requirement when listing S3 files for bulk I/O operations. [#40836][#40836]

<h3 id="v19.2.0-beta.20190930-sql-language-changes">SQL language changes</h3>

- [Zone configurations](../v19.2/configure-replication-zones.html) now error out when they conflict with each other. [#39081][#39081] {% comment %}doc{% endcomment %}
- Renamed `SHOW EXPERIMENTAL_RANGES` to [`SHOW RANGES`](../v19.2/show-ranges.html) command, as it is no longer an experimental feature. [#39153][#39153] {% comment %}doc{% endcomment %}
- Added the `SHOW RANGES FROM DATABASE` command. [#39194][#39194] {% comment %}doc{% endcomment %}
- Added partial support for row limits during portal execution in `pgwire`. [#39085][#39085]
- Added the `SHOW LOCALITY` command. [#39058][#39058] {% comment %}doc{% endcomment %}
- Added the `SHOW PARTITIONS` command. [#39053][#39053] {% comment %}doc{% endcomment %}
- [`CREATE VIEW`](../v19.2/create-view.html) now supports all queries supported by the optimizer, including those containing [correlated subqueries](../v19.2/subqueries.html#correlated-subqueries). [#39169][#39169] {% comment %}doc{% endcomment %}
- Mutations are no longer allowed inside [views](../v19.2/views.html). [#39169][#39169] {% comment %}doc{% endcomment %}
- Added the `COLLATION FOR` syntax and `pg_collation_for()` [built-in function](../v19.2/functions-and-operators.html). [#39198][#39198] {% comment %}doc{% endcomment %}
- Implemented the `timezone()` built-in and `AT TIME ZONE` syntax, which allows converting a `timestamptz` into a `timezone` at a specified timezone, and converting a `timestamp` into a `timestamptz` at a specified timezone. [#39186][#39186] {% comment %}doc{% endcomment %}
- The new `vectorize_row_count_threshold` [cluster setting](../v19.2/cluster-settings.html) controls when the vectorized execution engine is used. [#39329][#39329] {% comment %}doc{% endcomment %}
- Added a `VEC` option to the [`EXPLAIN`](../v19.2/explain.html) command, which shows detailed plan information for vectorized plans. [#39280][#39280] {% comment %}doc{% endcomment %}
- Partition names can now be reused between different indexes on the same table. [#39332][#39332] {% comment %}doc{% endcomment %}
- Columns without an explicit default value now support foreign keys with the `SET DEFAULT` action, in the same way as the `SET NULL` and `SET DEFAULT NULL` cases. [#39136][#39136] {% comment %}doc{% endcomment %}
- Added [`SHOW JOB <jobid>`](../v19.2/show-jobs.html), `SHOW JOB <a_expr>`, and `SHOW JOBS <selectclause>`. [#39324][#39324] {% comment %}doc{% endcomment %}
- Added [`SHOW JOB WHEN COMPLETE <a_expr>`](../v19.2/show-jobs.html) and `SHOW JOBS WHEN COMPLETE <selectclause>`. [#39457][#39457] {% comment %}doc{% endcomment %}
- [`IMPORT INTO`](../v19.2/import-into.html) now cleans up any imported rows if it fails. [#39459][#39459]
- Updated [`SHOW CREATE`](../v19.2/show-create.html) to display information about partition and table zone configurations. [#39102][#39102] {% comment %}doc{% endcomment %}
- Explicitly closing portals over the wire after partial use is now supported. [#39639][#39639]
- Added progress tracking for new implementation of [`IMPORT`](../v19.2/import.html). [#39646][#39646] {% comment %}doc{% endcomment %}
- CockroachDB now supports an optional frame exclusion clause in the specification of window frames. [#28262][#28262] {% comment %}doc{% endcomment %}
- Enabled collection of histograms by default during automatic statistics collection. [#39743][#39743]
- The `force_retry()` function, which previously required admin privileges, is now available to all users to test their transaction retry loops. [#39246][#39246] {% comment %}doc{% endcomment %}
- When [`DROP CONSTRAINT`](../v19.2/drop-constraint.html) is executed in a [transaction](../v19.2/transactions.html) on a validated constraint, it no longer takes effect immediately, and subsequent writes will now fail if they violate that constraint. This is to enforce consistency when dropping constraints asynchronously in the schema changer. [#39648][#39648]
- The [`ALTER PARTITION`](../v19.2/configure-zone.html) statement now supports applying a [zone configuration](../v19.2/configure-replication-zones.html) to all the partitions of a table and its indexes that share the same partition name. The syntax for this is `ALTER PARTITION <partition name> OF INDEX <table name>@*`. [#39750][#39750]
- CockroachDB now supports the `FOR UPDATE` modifier on [`SELECT`](../v19.2/select-clause.html) statements for compatibility with third-party tools. It has no effect because `SERIALIZABLE` [transactions](../v19.2/transactions.html) do not require explicit write locks to maintain consistency. However, this means that `SELECT FOR UPDATE` cannot be used as an advisory exclusive lock in CockroachDB, as used by some tools.[#40206][#40206]
- [`SHOW PARTITIONS`](../v19.2/show-partitions.html) now shows the full zone configuration statement used to configure the partition. [#39814][#39814]
- Added the `pg_my_temp_schema()` [built-in](../v19.2/functions-and-operators.html) for Postgres compatibility. [#40194][#40194]
- Added the overlaps (`&&`), contains (`@>`), and contained_by (`<@`) operators for [arrays](../v19.2/array.html). [#40194][#40194]
- Added `pg_get_function_identity_arguments()` [built-in](../v19.2/functions-and-operators.html). [#40194][#40194]
- Added the `width_bucket()` builtin function. [#39263][#39263]
- Added range size information to [`SHOW RANGES`](../v19.2/show-ranges.html). [#40281][#40281]
- Added replica locality information to [`SHOW RANGES`](../v19.2/show-ranges.html). [#39813][#39813]
- Reordered columns in [`SHOW RANGES`](../v19.2/show-ranges.html) output [#40501][#40501]
- [`SHOW CREATE TABLE`](../v19.2/show-create.html) now warns users if they have a partitioned table that does not contain zone configurations [#40475][#40475]
- Added the `replication_constraint_stats`, `replication_stats`, and `replication_critical_localities` system tables. These tables contain information about replication status, constraint conformance, and critical localities. [#40625][#40625]
- [Common table expressions](../v19.2/common-table-expressions.html) that are used a single time no longer create an optimization fence. [#40673][#40673]
- [`EXPLAIN`](../v19.2/explain.html) now has additional output that shows if a query will run with the vectorized execution engine, and if the query will be distributed across nodes. [#40652][#40652]
- Column references are no longer allowed in `ROWS` and `RANGE` clauses in [window functions](../v19.2/window-functions.html). [#40832][#40832]
- Added the `pg_function_is_visible` and `pg_get_function_result` [built-in functions](../v19.2/functions-and-operators.html). [#40902][#40902]
- Added parsing for `FOR UPDATE [ OF tables ]` form. [#40962][#40962]
- Mutations under `UNION` or `UNION ALL` are now disallowed; `WITH` should be used on top of the union operation instead. This restriction is temporary and will be lifted in a future release. [#40975][#40975]
- Added support for the syntax for `oid` wrapper arrays, like `REGCLASS[]`. [#40949][#40949]
- `EXPLAIN ANALYSE` can now be used as an alias to [`EXPLAIN ANALYZE`](../v19.2/explain-analyze.html). [#41090][#41090]
- [`SHOW PARTITIONS`](../v19.2/show-partitions.html) now displays inherited zone configurations. [#40493][#40493]
- Added the `zone_id` and `subzone_id` columns to `crdb_internal.partitions`. These columns form a link to the zone configurations in `crdb_internal.zones` that apply to the partitions. [#40493][#40493]
- Renamed the `config_yaml`, `config_sql`, and `config_proto` columns in `crdb_internal.zones` to `raw_config_yaml`, `raw_config_sql`, and `raw_config_proto`. [#40493][#40493]
- Added the columns `full_config_sql` and `full_config_yaml` to the` crdb_internal.zones` table. [#40493][#40493]
- Added `FOR ROW` clause to [`SHOW RANGES`](../v19.2/show-ranges.html) to show range information for a particular row. [#40954][#40954]

<h3 id="v19.2.0-beta.20190930-command-line-changes">Command-line changes</h3>

- [`cockroach demo`](../v19.2/cockroach-demo.html) now accepts a `--nodes` flag, which permits customization of the size of the demo cluster. The default remains at `1`. [#39088][#39088] {% comment %}doc{% endcomment %}
- [`cockroach demo`](../v19.2/cockroach-demo.html) now accepts a `--demo-locality` flag, which makes it possible to set node localities. [#39454][#39454] {% comment %}doc{% endcomment %}
- [`cockroach demo`](../v19.2/cockroach-demo.html) without an argument is now equivalent to `cockroach demo movr`. The previous behavior (no pre-defined dataset) is still available via `cockroach demo --empty`. [#39298][#39298] {% comment %}doc{% endcomment %}
- [`cockroach start`](../v19.2/cockroach-start.html) now writes the client URL to the file specified via `--listen-url-file` as soon as the server is ready to accept connections. This also happens before the server detaches from the terminal when `--background` is specified. [#39300][#39300] {% comment %}doc{% endcomment %}
- Using [`cockroach start`](../v19.2/cockroach-start.html) without `--join` is now deprecated and this mode of execution will be removed in a later version of CockroachDB. Consider using `cockroach start-single-node` instead or combine `cockroach start` with [`cockroach init`](../v19.2/cockroach-init.html). [#28495][#28495] {% comment %}doc{% endcomment %}
- The advisory/informative check performed by [`cockroach start`](../v19.2/cockroach-start.html) on the validity of addresses contained in the node certificate is now relaxed to focus on the advertised node address, and to tolerate cases when the cert contains an IP address but a hostname is specified as advertised address. [#39166][#39166]
- Added locality information to the output of [`cockroach node status`](../v19.2/cockroach-node.html). [#39059][#39059] {% comment %}doc{% endcomment %}
- Removed the deprecated `cockroach zone` CLI commands. Please use the equivalent [`SHOW ZONE CONFIGURATIONS`](../v19.2/show-zone-configurations.html) and `CONFIGURE ZONE` commands in a SQL client. [#39177][#39177] {% comment %}doc{% endcomment %}
- Added a new `cockroach start-single-node` [command](../v19.2/cockroach-commands.html) to start single-node clusters with replication disabled. [#28495][#28495] {% comment %}doc{% endcomment %}
- The [`cockroach user`](../v19.2/authorization.html) sub-commands are now deprecated. Users and roles can be managed using SQL statements instead. This functionality will be removed in the next release. [#39297][#39297] {% comment %}doc{% endcomment %}
- [`cockroach start`](../v19.2/cockroach-start.html) now accepts a `--cluster-name` flag. If specified, it must match when a node connects to a cluster. This feature is meant for use in combination with the cluster ID, which is still checked in any case, to protect newly created nodes (that do not have a cluster ID yet) from joining the wrong cluster. To introduce a cluster name into an existing cluster without one, the new flag can be temporarily paired with `--disable-cluster-name-verification`. [#39270][#39270] {% comment %}doc{% endcomment %}
- [`cockroach start`](../v19.2/cockroach-start.html) now accepts a `--sql-addr` [flag](../v19.2/cockroach-start.html#flags), which makes it possible to accept connections by clients on a separate TCP address and/or port number from the one used for intra-cluster (node-node) connections. This is aimed to enable firewalling client traffic from server traffic. [#39305][#39305] {% comment %}doc{% endcomment %}
- [`cockroach workload run`](../v19.2/cockroach-workload.html) and `cockroach workload init` now support loading initial table data using [`IMPORT`](../v19.2/import.html). [#35312][#35312] {% comment %}doc{% endcomment %}
- [`cockroach workload`](../v19.2/cockroach-workload.html) now supports additional command-line parameters to customize the output, to facilitate the integration with third-party testing tools:
    - For tools that wish to observe the metrics more frequently than every second, a new flag `--display-every` is now supported, which can be used to specify the period between metric reports. This applies to both the JSON and textual output.
    - For tools that require a different output format than the default, a new `--display-format` argument is supported. For now   only the formats "simple" (original output format) and "incremental-json" ([RFC3339](https://tools.ietf.org/html/rfc3339) timestamps, no summary row) are supported. [#37929][#37929] {% comment %}doc{% endcomment %}
- Added `d`, `dt`, `du`, `l` metacommands to the [cockroach sql](../v19.2/cockroach-sql.html) interactive shell. [#39141][#39141] {% comment %}doc{% endcomment %}
- Added default cluster locality topologies for multi-node [`cockroach demo`](../v19.2/cockroach-demo.html) clusters. [#40221][#40221]
- Errors in [`cockroach demo`](../v19.2/cockroach-demo.html) are no longer logged to the command-line interface. [#40196][#40196]
- Added `d` client-side command with no arguments as an alias for `dt`, for more ease of adoption by `psql` users. [#40309][#40309]
- Added a [MovR](../v19.2/movr.html) workload to run with [`cockroach demo`](../v19.2/cockroach-demo.html). [#40271][#40271]
- Added location information for default localities to populate Admin UI for [`cockroach demo`](../v19.2/cockroach-demo.html). [#40229][#40229]
- [`cockroach demo`](../v19.2/cockroach-demo.html) now attempts to contact a license server to obtain a temporary license for demo usage. [#40273][#40273]
- [`cockroach demo`](../v19.2/cockroach-demo.html) now enables telemetry for demo clusters. You can opt out of telemetry by setting the `COCKROACH_SKIP_ENABLING_DIAGNOSTIC_REPORTING` environment variable. For more information, see [Diagnostics Reporting](../v19.2/diagnostics-reporting.html). [#40273][#40273]
- Deprecated the `--init` flag on the [`workload run`](../v19.2/cockroach-workload.html#subcommands) command. Use `workload init` instead. [#40426][#40426]
- Added support for a new `DELIMITED` data format to the [`IMPORT`](../v19.2/import.html) statement. [#40482][#40482]
- Added an option for [`cockroach demo`](../v19.2/cockroach-demo.html) to automatically apply the geo-partitioned replicas topology to the `movr` dataset using the `--geo-partitioned-replicas` flag. [#40355][#40355]
- [`cockroach sql`](../v19.2/cockroach-commands.html) now supports the `--watch` flag. When used to specified a duration, the client will repeat the statement(s) specified by `-e` until an error occurs. This is intended for simple monitoring scenarios during development and testing. [#40594][#40594]
- Added support for redirecting license acquisition to a replacement server (e.g., a suitably configured HTTP proxy), with the environment variable `COCKROACH_DEMO_LICENSE_URL`. This enables [`cockroach demo`](../v19.2/cockroach-demo.html) with enterprise features in firewalled network environments. [#41029][#41029]

<h3 id="v19.2.0-beta.20190930-admin-ui-changes">Admin UI changes</h3>

- Metrics about p90 and p99 percentiles of per-application average transaction time are now exposed in the [Admin UI](../v19.2/admin-ui-access-and-navigate.html). [#39429][#39429]

<h3 id="v19.2.0-beta.20190930-bug-fixes">Bug fixes</h3>

- Fixed a potential infinite loop in queries involving reverse scans. [#39084][#39084]
- Upgraded the `grpc` library to fix connection state management bug. [#39041][#39041]
- Properly initialize proposal quota tracking to prevent quota leak which can hang imports or other AddSSTable operations. [#39135][#39135]
- `crdb_internal.ranges` can now be used inside [views](../v19.2/views.html). Note that such views can become invalid in future releases if `crdb_internal.ranges` changes. [#39195][#39195]
- Prevented panic due to recording into finished tracing spans caused by acknowledging an earlier failed re-proposal when a later re-proposal exists. [#39203][#39203]
- CockroachDB now properly computes the default port number if an IPv6 address is provided without port number with `--locality-advertise-addr`. [#39334][#39334]
- Unary negatives in constant arithmetic expressions are no longer ignored. [#39245][#39245]
- `pg_catalog` now shows correct type lengths for [`INT`](../v19.2/int.html) and [`FLOAT`](../v19.2/float.html). [#39337][#39337]
- Fixed a rare panic (message: `"raft group deleted"`) that could occur during splits. [#39571][#39571]
- Fixed a panic due to incorrect type inference of some `ARRAY(...)` expressions. [#39469][#39469]
- [Zone configurations](../v19.2/configure-replication-zones.html) now propagate to non-gossiped system tables. [#39638][#39638]
- [`cockroach dump`](../v19.2/cockroach-dump.html) now works properly when handling [`INTERLEAVED`](../v19.2/interleave-in-parent.html) tables, printing them outside of [`CREATE TABLE`](../v19.2/create-table.html) statements. [#39486][#39486]
- Fixed internal errors generated during execution of some complicated cases of [correlated subqueries](../v19.2/subqueries.html#correlated-subqueries). [#39818][#39818]
- Using `ORDER BY` inside aggregation functions is now fully supported. [#40242][#40242]
- [Lookup joins](../v19.2/joins.html#lookup-joins) now spill to disk if the index lookups return more rows than can be stored in memory. [#40208][#40208]
- Fixed an internal planning error that could occur when a `DISTINCT` or `GROUP BY` expression was contained in a subquery. [#40468][#40468]
- Fixed an optimizer panic when building array access expressions. [#40469][#40469]
- Fixed faulty error when trying to delete a table and an unrelated index in the same transaction. [#40516][#40516]
- `ordinal_position` in `information_schema.columns` now matches `pg_attribute.attnum` after a column is dropped. [#40485][#40485]
- Fixed fatal error with message `replica descriptor of local store not found`. [#39796][#39796]
- Intents in a read's uncertainty interval are now considered as uncertain as committed values. This removes the potential for stale reads when a causally dependent transaction runs into unresolved intents from a causal ancestor. [#40600][#40600]
- Fixed a cluster migration bug that could occur in clusters running a mixture of v19.1 and v19.2. This bug was signaled by messages of the form: ` X at key /Table/54 failed: unexpected value: ... `  Affected clusters should be updated to 19.2 or, if 19.1 is preferred, recreated from backup. [#40464][#40464]
- Fixed behavior of `SERIAL` columns on mixed-case tables when `experimental_serial_normalization=sql_sequence`. [#40965][#40965]
- `width_bucket` [function](../v19.2/functions-and-operators.html) no longer errors on 0-length arrays [#40626][#40626]
- Fixed an error that could occur when the optimizer creates a plan with a lookup semi- or anti-join nested inside another join. [#40669][#40669]
- Fixed a memory corruption error in the optimizer that could cause stack overflow. [#40644][#40644]
- The [`cockroach` commands](../v19.2/cockroach-commands.html) are now able to connect to a server with the environment variable `COCKROACH_URL`. [#40824][#40824]
- Index hints used with [`DELETE`](../v19.2/delete.html) and [`UPDATE`](../v19.2/update.html) are now taken into consideration. [#40715][#40715]
- Fixed an issue with creating table indexes when the server is running on Windows and the store is on a file system that does not support hard links (e.g., FAT32 or network share) [#40875][#40875]
- Restore correct result generation for queries with index disjunctions on tables with multiple column families. [#40898][#40898]
- Fixed a stack overflow that could occur via use of `WITH`. [#40937][#40937]
- Detailed crash reports now always appear in the main log file. If SQL audit reporting or statement logging was activated, crash reports (i.e., "panic messages") could previously be reported in the wrong file. [#40941][#40941]
- Users must now have admin privileges to cancel, pause, or resume jobs. [#40978][#40978]
- CockroachDB now properly removes excess secondary log files (SQL audit logging, statement execution logging, and RocksDB events). [#41020][#41020]
- CockroachDB now avoids the internal re-use of Replica objects to fix the following crashes:
 - #38772 "`found rXXX:{-} [, next=0, gen=0?] in place of the RHS`"
 - #39796 "`replica descriptor of local store not found in right hand side of split`"
 - #40470 "`split trigger found right-hand side with tombstone`"
 - #40257 "`snapshot widens existing replica, but no replica exists for subsumed key`" [#40892][#40892]
- Fixed panic in [`cockroach workload movr run`](../v19.2/cockroach-workload.html). [#41072][#41072]
- Resolved an issue with server hanging on [`cockroach quit`](../v19.2/cockroach-commands.html) on Windows. [#40994][#40994]
- The `cockroach zip`, `cockroach node` and `cockroach user` [`cockroach` commands](../v19.2/cockroach-commands.html#commands) now work properly when the `defaultdb` database is manually dropped and the connection URL does not specify a database. `cockroach user` is deprecated in 19.2. [#41121][#41121]
- [`cockroach workload init ycsb`](../v19.2/cockroach-workload.html#ycsb-workload) now works with `--data-loader=import`. [#41071][#41071]
- Fixed bug where [zone configurations](../v19.2/configure-replication-zones.html) on indexes could leak into configurations on [partitions](../v19.2/partitioning.html). [#41089][#41089
- Statements inside `[ ... ]` can no longer refer to outer columns or [common table expressions](../v19.2/common-table-expressions.html). [#41158][#41158]
- The SQL for non-`SELECT` [common table expressions](../v19.2/common-table-expressions.html) now shows up in `EXPLAIN` output. [#41159][#41159]
- Fixed bug that prevented changes to `kv.bulk_io_write.concurrent_addsstable_requests` from taking effect. [#41195][#41195]
- Fixed a memory leak that affected secondary logging (SQL audit logs, statement execution, and RocksDB logging). [#41231][#41231]

<h3 id="v19.2.0-beta.20190930-performance-improvements">Performance improvements</h3>

- Sped up file-writing during bulk-ingestion. [#37528][#37528]
- Snapshots sent between replicas are now applied more performantly and use less memory. [#38932][#38932]
- Raft entries no longer wait to be applied to the RocksDB storage engine before signaling their success to clients, they now only wait until they are committed in their Raft log. [#38954][#38954]
- Adjusted load-based splitting QPS threshold to avoid over-splitting. [#39687][#39687]
- [`IMPORT`](../v19.2/import.html) now writes unsorted data directly, reducing `IMPORT`'s overhead (but potentially increasing RocksDB compaction overhead). [#39487][#39487]
- Improved performance for mutation statements with `RETURNING` that are not inside an explicit transaction. [#40871][#40871]

<h3 id="v19.2.0-beta.20190930-doc-updates">Doc updates</h3>

- Added an [Oracle migration guide](../v19.2/migrate-from-oracle.html), which guides users through the process of converting their schema and then exporting their data so they can load it into CockroachDB via [`IMPORT`](../v19.2/import.html). [#5902](https://github.com/cockroachdb/docs/pull/5092)
- Added an [overview of MovR](../v19.2/movr.html), CockroachDB's fictional vehicle-sharing dataset and application, and updated several SQL pages and examples to use the built-in MovR dataset, for example, [Learn CockroachDB SQL](../v19.2/learn-cockroachdb-sql.html). [#5075](https://github.com/cockroachdb/docs/pull/5075), [#5216](https://github.com/cockroachdb/docs/pull/5216)
- Added a tutorial on [how to use `EXPLAIN` to identify and resolve common SQL performance problems](../v19.2/learn-cockroachdb-sql.html). [#5178](https://github.com/cockroachdb/docs/pull/5178)

<h3 id="v19.2.0-beta.20190930-contributors">Contributors</h3>

This release includes 724 merged PRs by 53 authors.
We would like to thank the following contributors from the CockroachDB community:

- Arseni Lapunov
- Elliot Courant
- HyeonGyu Lee (Vazrupe) (first-time contributor)
- Jaewan Park
- Kevin Barbour (first-time contributor)
- Niels Hofmans (first-time contributor)
- Shishir Jaiswal (first-time contributor)
- Taufiq Rahman (first-time contributor)
- Zeming YU (first-time contributor)
- 贾德星 (first-time contributor)

[#28262]: https://github.com/cockroachdb/cockroach/pull/28262
[#28495]: https://github.com/cockroachdb/cockroach/pull/28495
[#35312]: https://github.com/cockroachdb/cockroach/pull/35312
[#37528]: https://github.com/cockroachdb/cockroach/pull/37528
[#37929]: https://github.com/cockroachdb/cockroach/pull/37929
[#38932]: https://github.com/cockroachdb/cockroach/pull/38932
[#38954]: https://github.com/cockroachdb/cockroach/pull/38954
[#39034]: https://github.com/cockroachdb/cockroach/pull/39034
[#39041]: https://github.com/cockroachdb/cockroach/pull/39041
[#39053]: https://github.com/cockroachdb/cockroach/pull/39053
[#39058]: https://github.com/cockroachdb/cockroach/pull/39058
[#39059]: https://github.com/cockroachdb/cockroach/pull/39059
[#39067]: https://github.com/cockroachdb/cockroach/pull/39067
[#39081]: https://github.com/cockroachdb/cockroach/pull/39081
[#39084]: https://github.com/cockroachdb/cockroach/pull/39084
[#39085]: https://github.com/cockroachdb/cockroach/pull/39085
[#39088]: https://github.com/cockroachdb/cockroach/pull/39088
[#39102]: https://github.com/cockroachdb/cockroach/pull/39102
[#39135]: https://github.com/cockroachdb/cockroach/pull/39135
[#39136]: https://github.com/cockroachdb/cockroach/pull/39136
[#39141]: https://github.com/cockroachdb/cockroach/pull/39141
[#39153]: https://github.com/cockroachdb/cockroach/pull/39153
[#39166]: https://github.com/cockroachdb/cockroach/pull/39166
[#39169]: https://github.com/cockroachdb/cockroach/pull/39169
[#39177]: https://github.com/cockroachdb/cockroach/pull/39177
[#39186]: https://github.com/cockroachdb/cockroach/pull/39186
[#39194]: https://github.com/cockroachdb/cockroach/pull/39194
[#39195]: https://github.com/cockroachdb/cockroach/pull/39195
[#39198]: https://github.com/cockroachdb/cockroach/pull/39198
[#39203]: https://github.com/cockroachdb/cockroach/pull/39203
[#39245]: https://github.com/cockroachdb/cockroach/pull/39245
[#39246]: https://github.com/cockroachdb/cockroach/pull/39246
[#39250]: https://github.com/cockroachdb/cockroach/pull/39250
[#39263]: https://github.com/cockroachdb/cockroach/pull/39263
[#39270]: https://github.com/cockroachdb/cockroach/pull/39270
[#39280]: https://github.com/cockroachdb/cockroach/pull/39280
[#39282]: https://github.com/cockroachdb/cockroach/pull/39282
[#39291]: https://github.com/cockroachdb/cockroach/pull/39291
[#39297]: https://github.com/cockroachdb/cockroach/pull/39297
[#39298]: https://github.com/cockroachdb/cockroach/pull/39298
[#39300]: https://github.com/cockroachdb/cockroach/pull/39300
[#39305]: https://github.com/cockroachdb/cockroach/pull/39305
[#39310]: https://github.com/cockroachdb/cockroach/pull/39310
[#39323]: https://github.com/cockroachdb/cockroach/pull/39323
[#39324]: https://github.com/cockroachdb/cockroach/pull/39324
[#39329]: https://github.com/cockroachdb/cockroach/pull/39329
[#39332]: https://github.com/cockroachdb/cockroach/pull/39332
[#39334]: https://github.com/cockroachdb/cockroach/pull/39334
[#39337]: https://github.com/cockroachdb/cockroach/pull/39337
[#39429]: https://github.com/cockroachdb/cockroach/pull/39429
[#39454]: https://github.com/cockroachdb/cockroach/pull/39454
[#39457]: https://github.com/cockroachdb/cockroach/pull/39457
[#39459]: https://github.com/cockroachdb/cockroach/pull/39459
[#39469]: https://github.com/cockroachdb/cockroach/pull/39469
[#39486]: https://github.com/cockroachdb/cockroach/pull/39486
[#39487]: https://github.com/cockroachdb/cockroach/pull/39487
[#39560]: https://github.com/cockroachdb/cockroach/pull/39560
[#39571]: https://github.com/cockroachdb/cockroach/pull/39571
[#39638]: https://github.com/cockroachdb/cockroach/pull/39638
[#39639]: https://github.com/cockroachdb/cockroach/pull/39639
[#39644]: https://github.com/cockroachdb/cockroach/pull/39644
[#39646]: https://github.com/cockroachdb/cockroach/pull/39646
[#39648]: https://github.com/cockroachdb/cockroach/pull/39648
[#39687]: https://github.com/cockroachdb/cockroach/pull/39687
[#39743]: https://github.com/cockroachdb/cockroach/pull/39743
[#39750]: https://github.com/cockroachdb/cockroach/pull/39750
[#39796]: https://github.com/cockroachdb/cockroach/pull/39796
[#39813]: https://github.com/cockroachdb/cockroach/pull/39813
[#39814]: https://github.com/cockroachdb/cockroach/pull/39814
[#39818]: https://github.com/cockroachdb/cockroach/pull/39818
[#39832]: https://github.com/cockroachdb/cockroach/pull/39832
[#40194]: https://github.com/cockroachdb/cockroach/pull/40194
[#40196]: https://github.com/cockroachdb/cockroach/pull/40196
[#40206]: https://github.com/cockroachdb/cockroach/pull/40206
[#40208]: https://github.com/cockroachdb/cockroach/pull/40208
[#40221]: https://github.com/cockroachdb/cockroach/pull/40221
[#40229]: https://github.com/cockroachdb/cockroach/pull/40229
[#40242]: https://github.com/cockroachdb/cockroach/pull/40242
[#40271]: https://github.com/cockroachdb/cockroach/pull/40271
[#40273]: https://github.com/cockroachdb/cockroach/pull/40273
[#40281]: https://github.com/cockroachdb/cockroach/pull/40281
[#40284]: https://github.com/cockroachdb/cockroach/pull/40284
[#40309]: https://github.com/cockroachdb/cockroach/pull/40309
[#40314]: https://github.com/cockroachdb/cockroach/pull/40314
[#40424]: https://github.com/cockroachdb/cockroach/pull/40424
[#40426]: https://github.com/cockroachdb/cockroach/pull/40426
[#40464]: https://github.com/cockroachdb/cockroach/pull/40464
[#40468]: https://github.com/cockroachdb/cockroach/pull/40468
[#40469]: https://github.com/cockroachdb/cockroach/pull/40469
[#40475]: https://github.com/cockroachdb/cockroach/pull/40475
[#40482]: https://github.com/cockroachdb/cockroach/pull/40482
[#40485]: https://github.com/cockroachdb/cockroach/pull/40485
[#40501]: https://github.com/cockroachdb/cockroach/pull/40501
[#40516]: https://github.com/cockroachdb/cockroach/pull/40516
[#40600]: https://github.com/cockroachdb/cockroach/pull/40600
[#40625]: https://github.com/cockroachdb/cockroach/pull/40625
[#40355]: https://github.com/cockroachdb/cockroach/pull/40355
[#40594]: https://github.com/cockroachdb/cockroach/pull/40594
[#40626]: https://github.com/cockroachdb/cockroach/pull/40626
[#40644]: https://github.com/cockroachdb/cockroach/pull/40644
[#40652]: https://github.com/cockroachdb/cockroach/pull/40652
[#40669]: https://github.com/cockroachdb/cockroach/pull/40669
[#40673]: https://github.com/cockroachdb/cockroach/pull/40673
[#40681]: https://github.com/cockroachdb/cockroach/pull/40681
[#40715]: https://github.com/cockroachdb/cockroach/pull/40715
[#40824]: https://github.com/cockroachdb/cockroach/pull/40824
[#40832]: https://github.com/cockroachdb/cockroach/pull/40832
[#40836]: https://github.com/cockroachdb/cockroach/pull/40836
[#40871]: https://github.com/cockroachdb/cockroach/pull/40871
[#40875]: https://github.com/cockroachdb/cockroach/pull/40875
[#40879]: https://github.com/cockroachdb/cockroach/pull/40879
[#40892]: https://github.com/cockroachdb/cockroach/pull/40892
[#40898]: https://github.com/cockroachdb/cockroach/pull/40898
[#40902]: https://github.com/cockroachdb/cockroach/pull/40902
[#40920]: https://github.com/cockroachdb/cockroach/pull/40920
[#40937]: https://github.com/cockroachdb/cockroach/pull/40937
[#40941]: https://github.com/cockroachdb/cockroach/pull/40941
[#40949]: https://github.com/cockroachdb/cockroach/pull/40949
[#40960]: https://github.com/cockroachdb/cockroach/pull/40960
[#40962]: https://github.com/cockroachdb/cockroach/pull/40962
[#40965]: https://github.com/cockroachdb/cockroach/pull/40965
[#40975]: https://github.com/cockroachdb/cockroach/pull/40975
[#40978]: https://github.com/cockroachdb/cockroach/pull/40978
[#40994]: https://github.com/cockroachdb/cockroach/pull/40994
[#41020]: https://github.com/cockroachdb/cockroach/pull/41020
[#41029]: https://github.com/cockroachdb/cockroach/pull/41029
[#41072]: https://github.com/cockroachdb/cockroach/pull/41072
[#41090]: https://github.com/cockroachdb/cockroach/pull/41090
[#41071]: https://github.com/cockroachdb/cockroach/pull/41071
[#41089]: https://github.com/cockroachdb/cockroach/pull/41089
[#41121]: https://github.com/cockroachdb/cockroach/pull/41121
[#40493]: https://github.com/cockroachdb/cockroach/pull/40493
[#40954]: https://github.com/cockroachdb/cockroach/pull/40954
[#41158]: https://github.com/cockroachdb/cockroach/pull/41158
[#41159]: https://github.com/cockroachdb/cockroach/pull/41159
[#41195]: https://github.com/cockroachdb/cockroach/pull/41195
[#41231]: https://github.com/cockroachdb/cockroach/pull/41231
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.0-beta.20191014-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-beta.20191014.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-beta.20191014.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-beta.20191014.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.0-beta.20191014-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.0-beta.20191014
~~~

<h3 id="v19.2.0-beta.20191014-sql-language-changes">SQL language changes</h3>

- The new `SHOW RANGE ... FOR ROW` statement identifies the range containing a specific row of a table or secondary index. This is particularly useful for validating the location of a specific piece of data when using [partitions](../v19.2/topology-geo-partitioned-replicas.html) to control data location for improved performance or GDPR compliance. Note that this new statement is **experimental** and its interface and output are subject to change. [#40954][#40954]
- The [`SHOW PARTITIONS`](../v19.2/show-partitions.html) statement now displays inherited as well as explicitly set zone configurations for partitions. Also, it is now possible to retrieve full zone configurations via the `full_config_sql` column in the `crdb_internal.zones` table, and the new `zone_id` and `subzone_id` columns in the `crdb_internal.partitions` table point to partitions' corresponding zone configurations in `crdb_internal.zones`. [#40493][#40493]

<h3 id="v19.2.0-beta.20191014-command-line-changes">Command-line changes</h3>

- When `vmodule` is set to `exec_logs=2` to [log queries executed by a node](../v19.2/query-behavior-troubleshooting.html#per-node-execution-logs), CockroachDB-generated statements are no longer logged alongside client-generated statements. To log CockroachDB-generated statements as well, you must now use `exec_logs=3`. [#41149][#41149]

<h3 id="v19.2.0-beta.20191014-bug-fixes">Bug fixes</h3>

- Fixed a bug that would cause queries combining SQL mutation statements in sub-queries inside `UNION` to return invalid results or to modify the wrong rows if the transaction is forced to retry. [#41307][#41307]
- Fixed a bug that prevented changes to the `kv.bulk_io_write.concurrent_addsstable_requests` [cluster setting](../v19.2/cluster-settings.html) from taking effect. [#41195][#41195]
- Fixed a memory leak that affected secondary logging (SQL audit logs, statement execution, and RocksDB logging). [#41231][#41231]
- Fixed a bug where zone configuration changes on tables with existing index zone configurations would not take effect unless the `num_replicas` field was also set. [#41261][#41261]
- Fixed a bug where zone configuration changes on secondary indexes wouldn't perform setting verification, such as constraints with lease preferences or setting only one of `min_range_size` and `max_range size`. [#41216][#41216]
- Fixed a rare data corruption bug in RocksDB caused by newer Linux kernels' handling of `i_generation` on certain filesystems. [#41346][#41346]

<h3 id="v19.2.0-beta.20191014-performance-improvements">Performance improvements</h3>

- Stabilized performance of [`IMPORT`](../v19.2/import.html) and [`RESTORE`](../v19.2/restore.html) by changing the default value of the `rocksdb.ingest_backpressure.pending_compaction_threshold` [cluster setting](../v19.2/cluster-settings.html) from 64 GiB to 2 GiB. [#41263][#41263]

<h3 id="v19.2.0-beta.20191014-doc-updates">Doc updates</h3>

- Expanded the architecture documentation to describe the new [Parallel Commits](../v19.2/architecture/transaction-layer.html#parallel-commits) protocol, which cuts the commit latency of a transaction in half, from two rounds of consensus down to one. [#5394][#5394]
- The tutorial on getting [Low Latency Reads and Writes in a Multi-Region Cluster](../v19.2/demo-low-latency-multi-region-deployment.html) now features two of the most important multi-region data topologies, [Geo-Partitioned Replicas](../v19.2/topology-geo-partitioned-replicas.html) and [Duplicate Indexes](../v19.2/topology-duplicate-indexes.html), to dramatically reduce the impact of network latency. [#5558][#5558]
- Documented the new [`cockroach start-single-node`](../v19.2/cockroach-start-single-node.html) cli command, which starts a single-node cluster with replication disabled for quick SQL testing or app development. [#5445][#5445]
- Documented how to use `SPLIT AT ... WITH EXPIRATION` SQL statement to [set an expiration on a range split](../v19.2/split-at.html#set-the-expiration-on-a-split-enforcement) as well as how to remove a split enforcement via [`UNSPLIT AT`](../v19.2/unsplit-at.html). [#5360][#5360]
- Updated hardware recommendations in the [Production Checklist](../v19.2/recommended-production-settings.html#hardware). [#5472][#5472]
- Clarified the benefit of [merge joins over hash joins](../v19.2/joins.html#merge-joins). [#5464][#5464]
- Updated the [recommendations for improving `IMPORT` performance](../v19.2/import.html#performance). [#5452][#5452]
- Documented the [`ALTER COLUMN ... SET NOT NULL`](../v19.2/alter-column.html#set-not-null-constraint) SQL statement, which adds a non-null constraint to an existing column. [#5456][#5456]
- Documented how to use the `pg_collation_for()` built-in function, or its alternative syntax form `COLLATION FOR`, to [return the locale name of a collated string](../v19.2/collate.html#show-collation-for-strings). [#5576][#5576]
- Documented how to use [`SHOW BACKUP SCHEMAS`](../v19.2/show-backup.html#show-a-backup-with-schemas) SQL statement to list the schemas of enterprise backups alongside their contents. [#5455][#5455]
- Updated the [SQL statements that are allowed as row sources for table expressions](../v19.2/table-expressions.html#using-the-output-of-other-statements).
- Documented how to use the [`SHOW JOBS WHEN COMPLETED`](../v19.2/show-jobs.html#show-job-when-complete) SQL statement to list only just that have completed. [#5395][#5395]
- Documented the [`skip_missing_views`](../v19.2/restore.html#skip_missing_views) option for the `RESTORE` SQL statement, which restores a table with a view but does not restore the view's dependencies.
- Documented the [`--display-every` and `--display-format` flags for the `cockroach workload` cli command](../v19.2/cockroach-workload.html#customize-the-frequency-and-format-of-per-operation-statistics), which control the frequency and format of per-operation statistics. [#5424][#5424]
- Documented the [naming requirements for CSR names](../v19.2/orchestrate-cockroachdb-with-kubernetes.html#csr-names) when orchestrating CockroachDB with Kubernetes. [#5422][#5422]
- Documented the [`--watch` flag for the `cockroach sql` cli command](../v19.2/cockroach-sql.html#repeat-a-sql-statement), which repeats the SQL statements specified with `--execute` or `-e` until a SQL error occurs or the process is terminated. [#5543][#5543]
- Documented how to use the JDBC driver to [retrieve large data sets in chunks using cursors](../v19.2/build-a-java-app-with-cockroachdb.html#retrieve-large-data-sets-in-chunks-using-cursors). [#5544][#5544]
- Clarified that [`CHANGEFEED` cursors must be in quotes](../v19.2/create-changefeed.html#options). [#5529][#5529]
- Documented how to [show the locality of a node using the `crdb_internal.locality_value()` built-in function](../v19.2/show-locality.html#show-locality-with-a-built-in-function). [#5540][#5540]
- Documented how to [reference a common table expression (CTE) multiple times in a single query, using a `WITH` operator](../v19.2/common-table-expressions.html#reusing-common-table-expressions). [#5485][#5485]

<h3 id="v19.2.0-beta.20191014-contributors">Contributors</h3>

This release includes 57 merged PRs by 23 authors.

[#40493]: https://github.com/cockroachdb/cockroach/pull/40493
[#40811]: https://github.com/cockroachdb/cockroach/pull/40811
[#40954]: https://github.com/cockroachdb/cockroach/pull/40954
[#41149]: https://github.com/cockroachdb/cockroach/pull/41149
[#41195]: https://github.com/cockroachdb/cockroach/pull/41195
[#41216]: https://github.com/cockroachdb/cockroach/pull/41216
[#41231]: https://github.com/cockroachdb/cockroach/pull/41231
[#41261]: https://github.com/cockroachdb/cockroach/pull/41261
[#41263]: https://github.com/cockroachdb/cockroach/pull/41263
[#41291]: https://github.com/cockroachdb/cockroach/pull/41291
[#41307]: https://github.com/cockroachdb/cockroach/pull/41307
[#41329]: https://github.com/cockroachdb/cockroach/pull/41329
[#41346]: https://github.com/cockroachdb/cockroach/pull/41346
[#5445]: https://github.com/cockroachdb/docs/pull/5445
[#5360]: https://github.com/cockroachdb/docs/pull/5360
[#5472]: https://github.com/cockroachdb/docs/pull/5472
[#5464]: https://github.com/cockroachdb/docs/pull/5464
[#5452]: https://github.com/cockroachdb/docs/pull/5452
[#5456]: https://github.com/cockroachdb/docs/pull/5456
[#5576]: https://github.com/cockroachdb/docs/pull/5576
[#5455]: https://github.com/cockroachdb/docs/pull/5455
[#5393]: https://github.com/cockroachdb/docs/pull/5393
[#5395]: https://github.com/cockroachdb/docs/pull/5395
[#5413]: https://github.com/cockroachdb/docs/pull/5413
[#5424]: https://github.com/cockroachdb/docs/pull/5424
[#5422]: https://github.com/cockroachdb/docs/pull/5422
[#5394]: https://github.com/cockroachdb/docs/pull/5394
[#5558]: https://github.com/cockroachdb/docs/pull/5558
[#5543]: https://github.com/cockroachdb/docs/pull/5543
[#5544]: https://github.com/cockroachdb/docs/pull/5544
[#5529]: https://github.com/cockroachdb/docs/pull/5529
[#5540]: https://github.com/cockroachdb/docs/pull/5540
[#5485]: https://github.com/cockroachdb/docs/pull/5485
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.0-rc.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.0-rc.1-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.0-rc.1
~~~

<h3 id="v19.2.0-rc.1-sql-language-changes">SQL language changes</h3>

- `INTERVAL(6)` is now supported as an alias for [`INTERVAL`](../v19.2/interval.html), for compatibility with third-party tools. [#41447][#41447]
- Added the `pg_available_extensions` table, for compatibility with third-party tools. [#41447][#41447]
- The `pg_attrdef()` and `pg_get_indexdef()` [built-in functions](../v19.2/functions-and-operators.html) no longer include type annotations on default expressions, and `pg_get_indexdef()` now includes the index method in the returned `CREATE INDEX` statement, for compatibility with third-party tools. [#41447][#41447]

<h3 id="v19.2.0-rc.1-bug-fixes">Bug fixes</h3>

- The `generate_subscripts()` [built-in function](../v19.2/functions-and-operators.html) now behaves properly on `int2vector` and `oidvector` types. [#41447][#41447]
- Fixed a bug causing the `cluster_logical_timestamp()` [built-in function](../v19.2/functions-and-operators.html) to sometimes return incorrect results. [#41439][#41439]
- Prevented an unlikely race condition where a WAL pending recycling could be deleted, leading to a crash. This bug was present in past 19.2 alphas/betas only, not in any earlier release. [#41523][#41523]

<h3 id="v19.2.0-rc.1-performance-improvements">Performance improvements</h3>

- Metadata queries that use the `'string'::regclass` form are now much more efficient in the presence of a large number of tables. [#41447][#41447]
- The `pg_get_coldesc()` [built-in function](../v19.2/functions-and-operators.html) now retrieves comments more efficiently. [#41447][#41447]

<h3 id="v19.2.0-rc.1-doc-updates">Doc updates</h3>

- Clarified epoch-based vs. expiration-based leases in the [Replication Layer](../v19.2/architecture/replication-layer.html#epoch-based-leases-table-data) architecture documentation. [#5578][#5578]
- Updated the list of [Enterprise features](../v19.2/enterprise-licensing.html). [#5599][#5599]
- Documented the new [`--geo-partitioned-replicas` flag of the `cockroach demo` command](../v19.2/cockroach-demo.html#start-a-multi-region-demo-cluster-with-automatic-geo-partitioning), which starts a 9-node in-memory cluster with the [Geo-Partitioned Replicas](../v19.2/topology-geo-partitioned-replicas.html) data topology applied to the `movr` database. This lets you quickly simulate one of the most effective data topology patterns for getting low latency in a multi-region cluster. [#5587][#5587]  

<h3 id="v19.2.0-rc.1-contributors">Contributors</h3>

This release includes 12 merged PRs by 10 authors. 

[#41439]: https://github.com/cockroachdb/cockroach/pull/41439
[#41447]: https://github.com/cockroachdb/cockroach/pull/41447
[#41470]: https://github.com/cockroachdb/cockroach/pull/41470
[#41523]: https://github.com/cockroachdb/cockroach/pull/41523
[#41539]: https://github.com/cockroachdb/cockroach/pull/41539
[#5578]: https://github.com/cockroachdb/docs/pull/5578
[#5599]: https://github.com/cockroachdb/docs/pull/5599
[#5587]: https://github.com/cockroachdb/docs/pull/5587
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.0-rc.2-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.0-rc.2-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.0-rc.2
~~~

<h3 id="v19.2.0-rc.2-general-changes">General changes</h3>

- Go 1.12.10 is now required to build CockroachDB from source. [#41647][#41647] {% comment %}doc{% endcomment %}
- Named ports in URLs are no longer supported due to a [URL parsing security fix in Go 1.12.8](https://github.com/golang/go/commit/3226f2d492963d361af9dfc6714ef141ba606713). Use port numbers instead. [#41647][#41647] {% comment %}doc{% endcomment %}

<h3 id="v19.2.0-rc.2-sql-language-changes">SQL language changes</h3>

- Mutations under [`UNION` or `UNION ALL`](../v19.2/selection-queries.html#union-combine-two-queries) are once again supported. [#41500][#41500] {% comment %}doc{% endcomment %}
- Added new `skip` and `nullif` options for [`IMPORT ... DELIMITED DATA`](../v19.2/import.html), which ignore the specified number of lines at the beginning of the file and force all empty string fields to be inserted as `NULL` in the imported table, respectively. [#41656][#41656] {% comment %}doc{% endcomment %}
- It is no longer possible to use [`IMPORT INTO`](../v19.2/import-into.html) with an [interleaved table](../v19.2/interleave-in-parent.html). This restriction is temporary and will be lifted in a future release. [#41651][#41651] {% comment %}doc{% endcomment %}
- [`IMPORT`](../v19.2/import.html) is no longer allowed during a [rolling upgrade](../v19.2/upgrade-cockroach-version.html). [#41733][#41733] {% comment %}doc{% endcomment %}

<h3 id="v19.2.0-rc.2-bug-fixes">Bug fixes</h3>

- Fixed multiple bugs relating to `COPY FROM PARENT` in [replication zones](../v19.2/configure-replication-zones.html). [#41677][#41677]
- The `system.replication_stats` table no longer incorrectly shows some ranges belonging to [table partitions](../v19.2/partitioning.html) as over-replicated. [#41700][#41700]
- Fixed a bug that resulted in some queries returning an "index join must be against primary index" error. [#41723][#41723]
- Fixed a bug where backfills could lead to certain [changefeed](../v19.2/change-data-capture.html) row updates never being emitted. [#41721][#41721]
- Fixed a bug that could cause [changefeed](../v19.2/change-data-capture.html) row updates to be emitted at a timestamp less than or equal to an already forwarded resolved timestamp. [#41714][#41714]
- Fixed a bug in cloud storage sink file naming for [changefeeds](../v19.2/change-data-capture.html) that could violate ordering in the presence of schema changes. [#41693][#41693]

<h3 id="v19.2.0-rc.2-performance-improvements">Performance improvements</h3>

- Increased [`BACKUP`](../v19.2/backup.html) parallelism in some cases. [#41729][#41729]
- Improved the performance of generating the `system.replication_*` tables for large clusters. [#41757][#41757]
- Improved performance of bulk ingestion. [#41768][#41768]

<h3 id="v19.2.0-rc.2-doc-updates">Doc updates</h3>

- Clarified that to upgrade to the next major version [upgrade path for rolling upgrades](../v19.2/upgrade-cockroach-version.html), a cluster must be on a production release of the previous version, as opposed to a testing release (alpha/beta). [#5644][#5644]
- Documented the experimental [`SHOW RANGE FOR ROW`](../v19.2/show-range-for-row.html) statement, which shows information about a range for a particular row of data. This information is useful for verifying how SQL data maps to underlying ranges, and where the replicas for a range are located. [#5612][#5612]
- Improved the usability of the tutorial on [deploying a Python To-Do app with Flask, Kubernetes, and CockroachCloud](../cockroachcloud/deploy-a-python-to-do-app-with-flask-kubernetes-and-cockroachcloud.html). [#5694][#5694]
- Updated [Helm-specific instructions](../v19.2/orchestrate-cockroachdb-with-kubernetes.html) for Kubernetes version 1.16.0 and fixed various errors. [#5657][#5657], [#5659][#5659]
- Documented the [`FOR UPDATE` locking clause](../v19.2/postgresql-compatibility.html#locking-and-for-update), which is supported in [selection queries](../v19.2/selection-queries.html#parameters) for database migration compatibility. [#5658][#5658]
- Documented using `timezone()` and `AT TIME ZONE` functions to convert a `TIMESTAMPTZ` into a [`TIMESTAMP`](../v19.2/timestamp.html), or vice versa, in a specified timezone. [#5614][#5614]
- Clarified the required privileges for the [`CONFIGURE ZONE`](../v19.2/configure-zone.html) statement. [#5609][#5609]

<h3 id="v19.2.0-rc.2-contributors">Contributors</h3>

This release includes 32 merged PRs by 19 authors.

[#41410]: https://github.com/cockroachdb/cockroach/pull/41410
[#41500]: https://github.com/cockroachdb/cockroach/pull/41500
[#41647]: https://github.com/cockroachdb/cockroach/pull/41647
[#41651]: https://github.com/cockroachdb/cockroach/pull/41651
[#41656]: https://github.com/cockroachdb/cockroach/pull/41656
[#41677]: https://github.com/cockroachdb/cockroach/pull/41677
[#41693]: https://github.com/cockroachdb/cockroach/pull/41693
[#41700]: https://github.com/cockroachdb/cockroach/pull/41700
[#41714]: https://github.com/cockroachdb/cockroach/pull/41714
[#41721]: https://github.com/cockroachdb/cockroach/pull/41721
[#41723]: https://github.com/cockroachdb/cockroach/pull/41723
[#41729]: https://github.com/cockroachdb/cockroach/pull/41729
[#41733]: https://github.com/cockroachdb/cockroach/pull/41733
[#41757]: https://github.com/cockroachdb/cockroach/pull/41757
[#41768]: https://github.com/cockroachdb/cockroach/pull/41768
[#5694]: https://github.com/cockroachdb/docs/pull/5694
[#5659]: https://github.com/cockroachdb/docs/pull/5659
[#5657]: https://github.com/cockroachdb/docs/pull/5657
[#5658]: https://github.com/cockroachdb/docs/pull/5658
[#5644]: https://github.com/cockroachdb/docs/pull/5644
[#5614]: https://github.com/cockroachdb/docs/pull/5614
[#5612]: https://github.com/cockroachdb/docs/pull/5612
[#5609]: https://github.com/cockroachdb/docs/pull/5609
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.0-rc.3-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.3.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.3.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.3.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.0-rc.3-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.0-rc.3
~~~

<h3 id="v19.2.0-rc.3-general-changes">General changes</h3>

- Go 1.12.12 is now required to build CockroachDB from source. [#41994][#41994] {% comment %}doc{% endcomment %}

<h3 id="v19.2.0-rc.3-sql-language-changes">SQL language changes</h3>

- Changed the data type of the `system.reports_meta.generated` and `system.replication_constraint_stats.violation_start` columns from `TIMESTAMP` to [`TIMESTAMPTZ`](../v19.2/timestamp.html). [#41915][#41915]

<h3 id="v19.2.0-rc.3-bug-fixes">Bug fixes</h3>

- Fixed a rare corruption bug when files are ingested that do not overlap with the in-memory buffer and compaction has fallen behind. [#42009][#42009]
- CockroachDB no longer erroneously transfers leases to replicas that are in the process of being removed, which could lead to ranges being unavailable due to an invalid lease. [#42079][#42079]

<h3 id="v19.2.0-rc.3-doc-updates">Doc updates</h3>

- Added a [CockroachDB Performance](../v19.2/performance.html) page describing the performance profiles you can expect (scaling, throughout, and latency), based on Cockroach Labs' extensive testing using industry-standard benchmarks like TPC-C and Sysbench. [#5595][#5595]
- Documented how to [run the built-in `movr` workload](../v19.2/cockroach-workload.html#run-the-movr-workload). [#5713][#5713]
- Documented how to [show comments for virtual tables](../v19.2/show-tables.html#show-virtual-tables-with-comments), including links to further documentation. [#5695][#5695]
- Refreshed the [Deploy a Python To-Do App with Flask, Kubernetes, and CockroachCloud](../cockroachcloud/deploy-a-python-to-do-app-with-flask-kubernetes-and-cockroachcloud.html). [#5694][#5694]

<h3 id="v19.2.0-rc.3-contributors">Contributors</h3>

This release includes 4 merged PRs by 3 authors.

[#41915]: https://github.com/cockroachdb/cockroach/pull/41915
[#41994]: https://github.com/cockroachdb/cockroach/pull/41994
[#42009]: https://github.com/cockroachdb/cockroach/pull/42009
[#42079]: https://github.com/cockroachdb/cockroach/pull/42079
[#5595]: https://github.com/cockroachdb/docs/pull/5595
[#5713]: https://github.com/cockroachdb/docs/pull/5713
[#5695]: https://github.com/cockroachdb/docs/pull/5695
[#5694]: https://github.com/cockroachdb/docs/pull/5694
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.0-rc.4-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.4.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.4.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0-rc.4.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.0-rc.4-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.0-rc.4
~~~

<h3 id="v19.2.0-rc.4-sql-language-changes">SQL language changes</h3>

- CockroachDB now uses the zig-zag join algorithm only in cases where it can benefit performance. [#42186][#42186]
- Added the `sql.defaults.zigzag_join.enabled` [cluster setting](../v19.2/cluster-settings.html), which can be used to control the default value of the `enable_zigzag_join` [session variable](../v19.2/set-vars.html) and, thus, whether zig-zag joins are allowed. [#42182][#42182]
- The error message generated when a [transaction](../v19.2/transactions.html) containing DDL is both partially committed and partially rolled back (`XXAOO`) now contains a link to [GitHub issue #42061](https://github.com/cockroachdb/cockroach/issues/42061) where this situation is discussed further. [#42090][#42090]

<h3 id="v19.2.0-rc.4-bug-fixes">Bug fixes</h3>

- CockroachDB now supports [GSSAPI authentication](../v19.2/gssapi_authentication.html) from Postgres 11.5 and 12.0 clients. [#42189][#42189]
- Fixed a "cannot map variable to an indexed var" error for certain queries against [partitioned tables](../v19.2/partitioning.html). [#42183][#42183]
- Fixed "output columnTypes unset after planning" and "inconsistent post-processing" errors for certain queries involving `UNION ALL`. [#42184][#42184]
- Fixed an "invalid indexIdx" error for certain queries involving zig-zag joins. [#42182][#42182]

<h3 id="v19.2.0-rc.4-contributors">Contributors</h3>

This release includes 6 merged PRs by 3 authors.

[#42182]: https://github.com/cockroachdb/cockroach/pull/42182
[#42183]: https://github.com/cockroachdb/cockroach/pull/42183
[#42184]: https://github.com/cockroachdb/cockroach/pull/42184
[#42186]: https://github.com/cockroachdb/cockroach/pull/42186
[#42189]: https://github.com/cockroachdb/cockroach/pull/42189
[#42090]: https://github.com/cockroachdb/cockroach/pull/42090
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

With the release of CockroachDB v19.2, we’ve made a variety of performance, resiliency, and usability improvements. Check out a comprehensive [summary of the most significant user-facing changes](#summary) and then [upgrade to CockroachDB v19.2](../v19.2/upgrade-cockroach-version.html). You can also read more about these changes in the [v19.2 blog post](https://www.cockroachlabs.com/blog/cockroachdb-19dot2-release/) or [watch our 19.2 release demo and overview](https://www.cockroachlabs.com/webinars/19-2-release).

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_success}}
In addition to v19.2, we're launching [**Cockroach University**](https://university.cockroachlabs.com/), a free, online learning tool for developers and architects who want to gain a fundamental understanding of distributed databases and deep knowledge of CockroachDB’s functionality and architecture. The first course, “Getting Started with CockroachDB,” uses videos, exercises, and quizzes to teach the key characteristics of a distributed SQL database, walking you through how to spin up a CockroachDB instance, run basic queries, and test out CockroachDB’s unique capabilities. For additional information or to register, visit [university.cockroachlabs.com](https://university.cockroachlabs.com/).
{{site.data.alerts.end}}

<h3 id="v19.2.0-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.1.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.0.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.0-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~ shell
$ docker pull cockroachdb/cockroach:v19.2.0
~~~

<h3 id="v19.2.0-summary">Summary</h3>

This section summarizes the most significant user-facing changes in v19.2.0. For a complete list of features and changes, including bug fixes and performance improvements, see the [release notes](index.html#testing-releases) for previous testing releases.

- [CockroachCloud](#cockroachcloud)
- [Core features](#core-features)
- [Enterprise features](#enterprise-features)
- [Backward-incompatible changes](#backward-incompatible-changes)
- [Known limitations](#known-limitations)
- [Documentation](#documentation)

{{site.data.alerts.callout_info}}
In addition to the features below, SQL support for timestamp objects with a precision value, present in earlier testing releases of v19.2, has been reverted.
{{site.data.alerts.end}}

<style>
    table td:first-child {
        min-width: 225px;
    }
</style>

<h3 id="v19.2.0-cockroachcloud">CockroachCloud</h3>

[**CockroachCloud**](https://www.cockroachlabs.com/product/cockroachcloud/) will soon offer a completely self-service account creation and management workflow as well as single-region cluster creation in AWS and GCP using a credit card. Sign up for the beta program [here](https://www.cockroachlabs.com/product/cockroachcloud/).

<h3 id="v19.2.0-core-features">Core features</h3>

These features are freely available in the core version and do not require an enterprise license.

{{site.data.alerts.callout_info}}
The core version of CockroachDB v19.2 uses the Business Source License instead of the Apache 2.0 License. For more information on why we changed our licensing approach and some practical questions and implications, see our [blog post](https://www.cockroachlabs.com/blog/oss-relicensing-cockroachdb/) and [Licensing FAQs](../v19.2/licensing-faqs.html). The full details of the license can be found on [Github](https://github.com/cockroachdb/cockroach/blob/master/licenses/BSL.txt).
{{site.data.alerts.end}}

Feature | Description
--------|------------
[**Parallel Commits**](../v19.2/architecture/transaction-layer.html#parallel-commits) | CockroachDB's new optimized atomic commit protocol cuts the commit latency of a transaction in half, from two rounds of consensus down to one. Combined with [transaction pipelining](../v19.2/architecture/transaction-layer.html#transaction-pipelining), parallel commits brings the latency incurred by common OLTP transactions to near the theoretical minimum: the sum of all read latencies plus one round of consensus latency. This especially lowers latency for transactions involving secondary indexes both in multi-region and single-region deployments.
[**Vectorized Query Execution**](../v19.2/vectorized-execution.html) | CockroachDB now supports [column-oriented](https://en.wikipedia.org/wiki/Column-oriented_DBMS#Column-oriented_systems) ("vectorized") query execution for operations that are guaranteed to execute in memory on tables with [supported data types](../v19.2/vectorized-execution.html#supported-data-types).
**Bulk Import Improvements** | CockroachDB now supports efficiently loading large amounts of CSV data into existing tables using the new [`IMPORT INTO`](../v19.2/import-into.html) statement.<br><br>Also, for the previously existing [`IMPORT`](../v19.2/import.html#performance) statement for bulk import of new tables, using as many files as you have nodes and ordering data in imported files by primary key now increases parallelism and performance.
[**Data Replication Reports**](../v19.2/query-replication-reports.html) | Several new and updated system tables can help you query the status of your cluster's data replication, data placement, and replication zone constraint conformance. For example, you can use these reports to see what data is under-replicated or unavailable, to show which of your localities (if any) are vulnerable to data unavailability in more common failure scenarios, and to see if any of your cluster's data placement constraints are being violated.
[**Multi-Use CTEs**](../v19.2/common-table-expressions.html#reusing-common-table-expressions) | Common Table Expressions can now be re-used multiple times in the same query via a `WITH` operator.
[**Comprehensive Cost-Based Optimizer**](../v19.2/cost-based-optimizer.html) | All SQL queries now leverage the cost-based optimizer to choose the lowest cost plans, including DDL statements and window functions that previously leveraged the legacy heuristic planner.
[**Ordering Aggregations**](../v19.2/select-clause.html#order-aggregate-function-input-rows-by-column) | Non-commutative aggregate functions are sensitive to the order in which rows are processed. This order can now be controlled with an [`ORDER BY`](../v19.2/query-order.html) clause within the function argument list.
**Index Hints for `UPDATE` & `DELETE`** | It's now possible to [force the use of a specific index for deleting rows](../v19.2/delete.html#force-index-selection-for-deletes) and [updating rows](../v19.2/update.html#update-with-index-hints).
[**Streaming with JDBC**](../v19.2/build-a-java-app-with-cockroachdb.html#retrieve-large-data-sets-in-chunks-using-cursors) | CockroachDB now provides limited support for Postgres wire-protocol cursors for implicit and explicit transactions executed to completion. The Java JDBC driver can use this protocol to stream queries with large result sets, providing much faster performance than result paginating with [`LIMIT ... OFFSET`](../v19.2/limit-offset.html).
[**Transaction Latency Graphs**](../v19.2/admin-ui-sql-dashboard.html) | The **SQL Dashboard** in the Admin UI now provides timeseries graphs of p90 and p99 transaction latencies to complement the per-statement metrics on the [**Statements** page](../v19.2/admin-ui-statements-page.html).
**`CREATE TABLE AS` Improvements** | When using the `CREATE TABLE AS` statement to create a new table from a selection query, you can now [specify the primary key](../v19.2/create-table-as.html#specify-a-primary-key) and [define column families](../v19.2/create-table-as.html#define-column-families) for the new table. The latter is especially helpful for [modifying the primary key of tables for geo-partitioning](../v19.2/create-table-as.html#specify-a-primary-key-for-partitioning). Also, `CREATE TABLE AS` is now usable for larger tables than before.
[**Adding `NOT NULL` Constraint**](../v19.2/alter-column.html#set-not-null-constraint) | It's now possible to add the `NOT NULL` constraint to an existing column, in addition to the previous ability to set this constraint during table creation.
**Local Testing Improvements** | CockroachDB v19.2 includes several usability improvements to running CockroachDB locally for SQL testing and app development. First, the [`cockroach demo`](../v19.2/cockroach-demo.html) command, which starts a temporary, in-memory CockroachDB cluster with immediate access to an interactive SQL shell, now comes pre-loaded with the `movr` dataset and a temporary enterprise license that expires after an hour. This means users can try out [enterprise features](../v19.2/enterprise-licensing.html) quickly before requesting a license for use in a persistent cluster.<br><br>Also, the `--nodes` flag now lets you specify the number of in-memory nodes to create for the demo, with the new `--demo-locality` flag setting locality information for each node. Alternatively, the `--geo-partitioned-replicas` flag lets you start a 9-node demo cluster with the [Geo-Partitioned Replicas](../v19.2/topology-geo-partitioned-replicas.html) data topology applied automatically to the `movr` database.<br><br>Finally, the `--with-load` command lets you run `movr` as an active workload against the in-memory cluster.
**Cluster Startup Improvements** | There are now distinct methods for starting single-node and multi-node clusters. For multi-node clusters, start each node with the [`cockroach start`](../v19.2/cockroach-start.html) command including a `--join` flag and then run the one-time `cockroach init` command. Using `cockroach start` without the `--join` flag is now deprecated and will be removed in a future release.<br><br>For single-node clusters, use the new [`cockroach start-single-node`](../v19.2/cockroach-start-single-node.html) command to start just a single node with replication disabled and without the need for any extra commands.
[**Built-in Workload Improvements**](../v19.2/cockroach-workload.html) | Cockroach Labs' fictional vehicle-sharing app, [MovR](../v19.2/movr.html), is now available as a sample workload using the `cockroach workload` CLI command. Also, the `--display-every` and `--display-format` flags now make it possible to control the frequency and format for printing per-operation statistics for several workloads.
**Data Type Improvements** | [`DATE`](../v19.2/date.html#syntax) values in CockroachDB are now fully [PostgreSQL-compatible](https://www.postgresql.org/docs/current/datatype-datetime.html), including support for special values (e.g., `+/- infinity`). Existing dates outside of the PostgreSQL date range (`4714-11-24 BC` to `5874897-12-31`) are converted to `+/- infinity` dates.<br><br>Also, you can now use the `timezone()` and `AT TIME ZONE` functions to convert a `TIMESTAMPTZ` into a [`TIMESTAMP`](../v19.2/timestamp.html) at a specified timezone, or vice versa.
[**Interactive SQL Shell Commands**](../v19.2/cockroach-sql.html#commands) | Within the interactive SQL shell, the `l`, `dt`, `d`, and `d <table>` commands now list all databases in the CockroachDB cluster, show the tables of the current schema in the current database, list the users for all databases, and show details about columns in the specified table, respectively.
[**Removing Manual Splits**](../v19.2/unsplit-at.html) | The new `UNSPLIT AT` statement removes a [split enforcement](../v19.2/split-at.html) on a key-value range, at a specified row in a table or index, allowing CockroachDB to [merge the range](../v19.2/range-merges.html) as needed.
[**Locking and `FOR UPDATE`**](../v19.2/postgresql-compatibility.html#locking-and-for-update) | Because CockroachDB only supports `SERIALIZABLE` isolation, locking is not required to order concurrent transactions relative to each other. However, the `FOR UPDATE` locking clause is now supported in selection queries as a no-op for database migration compatibility only.
[**Showing Row Location**](../v19.2/show-range-for-row.html) | The new `SHOW RANGE ... FOR ROW` statement shows information about a range for a particular row of data. This information is useful for verifying how SQL data maps to underlying ranges, and where the replicas for a range are located. However, note that this is an experimental feature, and the interface and output are subject to change.
**Viewing Node Locality** | It's now easy to retrieve the localities of nodes for setting zone configuration constraints via the [`SHOW LOCALITY`](../v19.2/show-locality.html) statement and the [`cockroach node status`](../v19.2/cockroach-node.html) command.
**Viewing Complete Jobs** | By default, the `SHOW JOBS` statement lists all of the types of long-running tasks your cluster has performed in the last 12 hours. You can now use the [`WHEN COMPLETE`](../v19.2/show-jobs.html#show-job-when-complete) option to return only after all specified job ID(s) have completed.
**Viewing Comments for Virtual Tables** | Using [`SHOW TABLES ... WITH COMMENTS` on virtual tables](../v19.2/show-tables.html#show-virtual-tables-with-comments) in the `pg_catalog`, `information_schema`, and `crdb_internal` schemas now returns useful comments, often with links to further documentation.

<h3 id="v19.2.0-enterprise-features">Enterprise features</h3>

These features require an [enterprise license](../v19.2/enterprise-licensing.html). Register for a 30-day trial license [here](https://www.cockroachlabs.com/get-cockroachdb/enterprise), or consider testing enterprise features locally using the [`cockroach demo`](../v19.2/cockroach-demo.html) CLI command, which starts an in-memory CockroachDB cluster with a temporary enterprise license pre-loaded.

Feature | Description
--------|------------
**Backup & Restore Improvements** | CockroachDB now supports [locality-aware backup and restore](../v19.2/backup-and-restore.html#locality-aware-backup-and-restore) such that each node writes to and restores from files in its locality. This can reduce cloud storage data transfer costs by keeping data within cloud regions and help you comply with data domiciling requirements.<br><br>Also, using `SHOW BACKUP` with the new [`SCHEMAS`](../v19.2/show-backup.html#show-a-backup-with-schemas) option adds the number of rows and the schema of the backed up table to the output, and using `RESTORE` with the new [`skip_missing_views`](../v19.2/restore.html#skip_missing_views) option restores a table from a view without restoring the view's dependencies.
**Geo-Partitioning Improvements** | CockroachDB v19.2 includes several usability improvements to geo-partitioning. First, it's now possible to name partitions identically across indexes of a table (e.g., `us-west`, `us-east`) and use a [single command to create zone configurations for all partitions of a given name](../v19.2/configure-zone.html#create-a-replication-zone-for-a-partition), saving you multiple steps.<br><br>Next, it's easy to retrieve the localities of nodes for setting zone configuration constraints via the [`SHOW LOCALITY`](../v19.2/show-locality.html) statement and the [`cockroach node status`](../v19.2/cockroach-node.html) command, both of which do not require an enterprise license.<br><br>There are now also several ways to view the details of partitions and confirm they are in effect, from the outputs of [`SHOW CREATE TABLE`](../v19.2/show-create.html) and the table schemas listed on the [**Databases** page](../v19.2/admin-ui-databases-page.html) in the Admin UI to the output of [`SHOW PARTITIONS`](../v19.2/show-partitions.html).<br><br>Finally, it's now much easier to [efficiently query partitioned data](../v19.2/partitioning.html#querying-partitions); when filtering by the column directly following the partitioned prefix in the primary key, the cost-based optimizer creates a query plan that scans each partition in parallel, rather than performing a costly sequential scan of the entire table. Filtering by the partition value itself can further improve performance by limiting the scan to the specific partition(s) that contain the data that you are querying.

<h3 id="v19.2.0-backward-incompatible-changes">Backward-incompatible changes</h3>

Before [upgrading to CockroachDB v19.2.0](../v19.2/upgrade-cockroach-version.html), be sure to review the following backward-incompatible changes and adjust your application as necessary.

- The `cockroach zone` CLI command has been removed. Use the equivalent [`CONFIGURE ZONE`](../v19.2/configure-zone.html) and [`SHOW ZONE CONFIGURATIONS`](../v19.2/show-zone-configurations.html) SQL statements for managing replication zones instead.

- The [`IMPORT`](../v19.2/import.html) SQL statement no longer accepts quotes inside unquoted CSV fields.

- [`CONFIGURE ZONE`](../v19.2/configure-zone.html) SQL statements now fail if the user does not have sufficient privileges. If the target is a `system` range, the `system` database, or a table in the `system` database, the user must have an admin role. For all other databases and tables, the user must have the `CREATE` privilege on the target database or table.

    This change might be backward-incompatible for users running scripted `CONFIGURE ZONE` statements with restricted permissions. To add the necessary permissions, use [`GRANT` &lt;privileges&gt;](../v19.2/grant.html) or [`GRANT` &lt;roles&gt;](../v19.2/grant-roles.html) as a user with an admin role. For example, to grant a user the admin role, run `GRANT admin TO <user>`. To grant the `CREATE` privilege on a database or table, run `GRANT CREATE ON [DATABASE | TABLE] <name> TO <user>`.

- [`INT`](../v19.2/int.html) and [`FLOAT`](../v19.2/float.html) columns of less than the max width will now be returned as their own type via the binary protocol. For example, an `int4` column will be returned in 32 bits over the pgwire binary protocol instead of 64 bits.

- The `changefeed.min_high_water` metric has been removed from the [Prometheus Endpoint](../v19.2/monitoring-and-alerting.html#prometheus-endpoint). For [detecting high changefeed latency](../v19.2/monitoring-and-alerting.html#changefeed-is-experiencing-high-latency), use the `changefeed.max_behind_nanos` metric instead.

<h3 id="v19.2.0-known-limitations">Known limitations</h3>

For information about new and unresolved limitations in CockroachDB v19.2, with suggested workarounds where applicable, see [Known Limitations](../v19.2/known-limitations.html).

<h3 id="v19.2.0-documentation">Documentation</h3>

Topic | Description
------|------------
**Performance Benchmarking** | Added an [overview of CockroachDB's performance profiles](../v19.2/performance.html) (scaling, throughput, latency), based on Cockroach Labs' extensive testing using industry-standard benchmarks like TPC-C and Sysbench, as well as [detailed instructions for reproducing our TPC-C benchmarking results](../v19.2/performance-benchmarking-with-tpc-c-10-warehouses.html) at different scales.
**Multi-Region Deployment** | Updated the tutorial on getting [low latency reads and writes in a multi-region cluster](../v19.2/demo-low-latency-multi-region-deployment.html) to feature two of the most important multi-region data topologies for dramatically reducing the impact of network latency, [Geo-Partitioned Replicas](../v19.2/topology-geo-partitioned-replicas.html) and [Duplicate Indexes](../v19.2/topology-duplicate-indexes.html).
**Orchestration with Kubernetes** | Expanded the tutorial on [Kubernetes single-region deployment](../v19.2/orchestrate-cockroachdb-with-kubernetes.html) to cover running on Amazon's hosted EKS and [naming CSR naming requirements](../v19.2/orchestrate-cockroachdb-with-kubernetes.html#csr-names) for secure deployments. Also updated and expanded the instructions on using Helm.
**Client-Side Transaction Retries** | Updated and simplified the client-side transaction logic in the [Java](../v19.2/build-a-java-app-with-cockroachdb.html), [Python](../v19.2/build-a-python-app-with-cockroachdb.html), and [Go](../v19.2/build-a-go-app-with-cockroachdb.html) getting started tutorials and code samples. Also added [pseudocode](../v19.2/transactions.html#client-side-intervention-example) to help with the implementation of this logic in other languages as well as [instructions for authors of database drivers and ORMs](../v19.2/advanced-client-side-transaction-retries.html) who would like to implement client-side retries in their database driver or ORM for maximum efficiency and ease of use by application developers.
**SQL Tuning with `EXPLAIN`** | Added a tutorial on [how to use `EXPLAIN` to identify and resolve common SQL performance problems](../v19.2/sql-tuning-with-explain.html).
**Testing with MovR Dataset** | Added an [overview of MovR](../v19.2/movr.html), CockroachDB's fictional vehicle-sharing dataset and application, and updated several SQL pages and examples to use the built-in MovR dataset, for example, [Learn CockroachDB SQL](../v19.2/learn-cockroachdb-sql.html).
**Migration from Oracle** | Added guidance on [migrating from Oracle](../v19.2/migrate-from-oracle.html), including the process of converting schema and exporting data for loading into CockroachDB.
**App Deployment on CockroachCloud** | Added a tutorial on [running a sample To-Do app in Kubernetes with CockroachCloud](../cockroachcloud/deploy-a-python-to-do-app-with-flask-kubernetes-and-cockroachcloud.html) as the datastore. The app is written in Python with Flask as the web framework and SQLAlchemy for working with SQL data, and the code is open-source and forkable.
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.1 since v19.2.0.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to v19.2, see [Upgrade to CockroachDB v19.2](../v19.2/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.1.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.1-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.2.1
~~~

<h3 id="v19.2.1-sql-language-changes">SQL language changes</h3>

- [Dropping a unique index](../v19.2/drop-index.html) that was created with [`CREATE UNIQUE INDEX`](../v19.2/create-index.html) no longer requires the `CASCADE` option. [#42413][#42413] {% comment %}doc{% endcomment %}
- The [vectorized execution engine](../v19.2/vectorized-execution.html) now supports the [`UUID`](../v19.2/uuid.html) and [`TIMESTAMP`](../v19.2/timestamp.html) data types. [#42414][#42414] [#42416][#42416] {% comment %}doc{% endcomment %}
- The vectorized execution engine now supports `IS NULL` and `IS NOT NULL` operators. [#42433][#42433] {% comment %}doc{% endcomment %}

<h3 id="v19.2.1-command-line-changes">Command-line changes</h3>

- When restarting a node, CockroachDB now provides a hint to ensure that all [`cockroach start`](../v19.2/cockroach-start.html) commands include the `--join` flag. [#42325][#42325]

<h3 id="v19.2.1-bug-fixes">Bug fixes</h3>

- Reduced the likelihood of out-of-memory errors during histogram collection. [#42370][#42370]
- Fixed an out-of-memory error that could occur when collecting statistics on tables with a string index column. [#42380][#42380]
- Fixed some casts from `OID` to `TEXT`. [#42257][#42257]
- `OUTER HASH` joins are now executed correctly via the [vectorized engine](../v19.2/vectorized-execution.html) when `NULL` values are present. [#42438][#42438]
- Fixed a bug in the `crdb_internal.encode_key()` built-in function that could cause [`SHOW RANGE FOR ROW`](../v19.2/show-range-for-row.html) statements on tables with dropped indexes to return incorrect results or an error. [#42461][#42461]
- Prevented memory leaks when counting rows during [`BACKUP`](../v19.2/backup.html). [#42535][#42535]

<h3 id="v19.2.1-performance-improvements">Performance improvements</h3>

- The `./cockroach debug check-store` command is now faster. [#42150][#42150]
- Improved statistics estimation during query planning for columns with many `NULL` values. [#42436][#42436]

<h3 id="v19.2.1-contributors">Contributors</h3>

This release includes 12 merged PRs by 8 authors.

[#42150]: https://github.com/cockroachdb/cockroach/pull/42150
[#42257]: https://github.com/cockroachdb/cockroach/pull/42257
[#42370]: https://github.com/cockroachdb/cockroach/pull/42370
[#42380]: https://github.com/cockroachdb/cockroach/pull/42380
[#42413]: https://github.com/cockroachdb/cockroach/pull/42413
[#42414]: https://github.com/cockroachdb/cockroach/pull/42414
[#42416]: https://github.com/cockroachdb/cockroach/pull/42416
[#42433]: https://github.com/cockroachdb/cockroach/pull/42433
[#42436]: https://github.com/cockroachdb/cockroach/pull/42436
[#42438]: https://github.com/cockroachdb/cockroach/pull/42438
[#42461]: https://github.com/cockroachdb/cockroach/pull/42461
[#42535]: https://github.com/cockroachdb/cockroach/pull/42535
[#42325]: https://github.com/cockroachdb/cockroach/pull/42325
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.10 since v19.2.9.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to the latest production release of CockroachDB, see this [article](../{{site.versions["stable"]}}/upgrade-cockroach-version.html).

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.10-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.10.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.10.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.10.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.10.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.10-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.10
~~~

<h3 id="v19.2.10-bug-fixes">Bug fixes</h3>

- Fixed "column not in input" internal error in some corner cases. [#50860][#50860]
- Previously, CockroachDB could crash when internal memory accounting hit a discrepancy. Now it will report an error instead. [#51015][#51015]
- Fixed incorrect results in some cases involving [joins](../v19.2/joins.html) on interleaved tables with limits. [#51435][#51435]
- Previously, CockroachDB could hit an internal error when executing `regexp_replace` [builtin](../v19.2/functions-and-operators.html#built-in-functions). This has been fixed. [#51348][#51348]
- Previously, CockroachDB could hit a "command is too large" error when performing an [`UPSERT`](../v19.2/upsert.html) operation with many values. Internally, we attempt to perform such operation by splitting it into "batches", but the batching mechanism was broken. This has been fixed. [#51612][#51612]
- CockroachDB previously could crash on some queries with [merge joins](../v19.2/joins.html). This has been fixed. [#52074][#52074]
- Fixed an internal error that could occur when an aggregate function argument contained a correlated subquery with another aggregate function referencing the outer scope. This now returns an appropriate user-friendly error, "aggregate function calls cannot be nested". [#52141][#52141]
- Previously, subtracting months from a [`TIMESTAMP` / `TIMESTAMPTZ`](../v19.2/timestamp.html) or [`DATE`](../v19.2/date.html) whose date value is greater than 28 could subtract a further year off. This has been fixed. [#52155][#52155]
- Large write requests no longer have a chance of erroneously throwing a "transaction with sequence has a different value" error. [#52268][#52268]
- Previously, CockroachDB could return incorrect results on query that encountered a `ReadWithinUncertaintyInterval` error. This has been fixed. [#52252][#52252]
- Previously, CockroachDB would erroneously restart the execution of empty, unclosed portals after they had been fully exhausted. This has been fixed. [#52444][#52444]
- Previously, executing a large number of statements in a [transaction](../v19.2/transactions.html) without [committing](../v19.2/commit-transaction.html) could crash a CockroachDB server. This has been fixed. [#52403][#52403]

<h3 id="v19.2.10-performance-improvements">Performance improvements</h3>

- Queries no longer block during planning if cached table statistics have become stale and the new statistics have not yet been loaded. Instead, the stale statistics are used for planning until the new statistics have been loaded. This improves performance because it prevents latency spikes that may occur if there is a delay in loading the new statistics. [#52189][#52189]

<h3 id="v19.2.10-contributors">Contributors</h3>

This release includes 24 merged PRs by 9 authors.

[#50860]: https://github.com/cockroachdb/cockroach/pull/50860
[#51015]: https://github.com/cockroachdb/cockroach/pull/51015
[#51348]: https://github.com/cockroachdb/cockroach/pull/51348
[#51435]: https://github.com/cockroachdb/cockroach/pull/51435
[#51612]: https://github.com/cockroachdb/cockroach/pull/51612
[#52074]: https://github.com/cockroachdb/cockroach/pull/52074
[#52141]: https://github.com/cockroachdb/cockroach/pull/52141
[#52155]: https://github.com/cockroachdb/cockroach/pull/52155
[#52189]: https://github.com/cockroachdb/cockroach/pull/52189
[#52252]: https://github.com/cockroachdb/cockroach/pull/52252
[#52268]: https://github.com/cockroachdb/cockroach/pull/52268
[#52403]: https://github.com/cockroachdb/cockroach/pull/52403
[#52444]: https://github.com/cockroachdb/cockroach/pull/52444
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.11 since v19.2.10.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to the latest production release of CockroachDB, see this [article](../{{site.versions["stable"]}}/upgrade-cockroach-version.html).

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.11-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.11.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.11.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.11.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.11.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.11-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.2.11
~~~

<h3 id="v19.2.11-general-changes">General changes</h3>

- Links to unimplemented issues that are returned in error messages now use the CockroachLabs redirect/short-link server. [#53955][#53955]

<h3 id="v19.2.11-sql-language-changes">SQL language changes</h3>

- Reduced memory used by scans of tables containing [JSON](../v19.2/jsonb.html) data. [#53319][#53319]

<h3 id="v19.2.11-bug-fixes">Bug fixes</h3>

- The [Cluster Node Map](../v19.2/admin-ui-cluster-overview-page.html#node-map-enterprise) and the [Debug Page](../v19.2/admin-ui-debug-pages.html) that lists cluster localities are now available again to non-admin users. This fixes a bug introduced in v19.2.3. [#53332][#53332]
- Fixed a bug that could cause backfills to fail with a vague `TransactionStatus` error as they are completing. [#53765][#53765]
- Fixed a bug that could cause CockroachDB to crash when evaluating queries with [window functions](../v19.2/window-functions.html) with the `GROUPS` mode of framing when `OFFSET FOLLOWING` boundary was used and when the offset was a very large value such that it could result in an integer overflow. [#53758][#53758]
- Fixed a bug that could cause CockroachDB to crash when using a `RANGE`-mode window function with an offset in some cases (e.g, `OVER (PARTITION BY b ORDER BY a RANGE 1 PRECEDING`). [#54074][#54074]
- Adding a [`NOT NULL`](../v19.2/not-null.html) constraint no longer fails with the error `check ... does not exist`. [#54290][#54290]
- A `NOT VALID` [foreign key](../v19.2/foreign-key.html) constraint no longer fails with the internal error `table descriptor is not valid: duplicate constraint name`. [#54290][#54290]
- Fixed a bug that could cause columns used in an index containing foreign key columns as a prefix to lead to all of the index columns being set to [`NULL`](../v19.2/null-handling.html) or [the default value](../v19.2/default-value.html) on `CASCADE`. [#54592][#54592]
- Fixed a rare bug that could lead to index backfills failing on [transaction](../v19.2/transactions.html) restarts. [#54860][#54860]

<h3 id="v19.2.11-contributors">Contributors</h3>

This release includes 18 merged PRs by 11 authors.

[#53319]: https://github.com/cockroachdb/cockroach/pull/53319
[#53332]: https://github.com/cockroachdb/cockroach/pull/53332
[#53758]: https://github.com/cockroachdb/cockroach/pull/53758
[#53765]: https://github.com/cockroachdb/cockroach/pull/53765
[#53955]: https://github.com/cockroachdb/cockroach/pull/53955
[#54074]: https://github.com/cockroachdb/cockroach/pull/54074
[#54290]: https://github.com/cockroachdb/cockroach/pull/54290
[#54592]: https://github.com/cockroachdb/cockroach/pull/54592
[#54860]: https://github.com/cockroachdb/cockroach/pull/54860
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.12 since v19.2.11.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to the latest production release of CockroachDB, see this [article](../{{site.versions["stable"]}}/upgrade-cockroach-version.html).

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.12-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.12.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.12.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.12.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.12.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.12-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.2.12
~~~

<h3 id="v19.2.12-bug-fixes">Bug fixes</h3>

- Fixed a panic in protobuf decoding. [#58876][#58876]
- Fixed a bug where the `age` [function](../v19.2/functions-and-operators.html#date-and-time-functions) did not normalize the duration for large day or `H:M:S` values in the same way PostgreSQL does. [#55528][#55528]

<h3 id="v19.2.12-contributors">Contributors</h3>

This release includes 5 merged PRs by 5 authors.
We would like to thank the following contributors from the CockroachDB community:

- kev (first-time contributor)

[#55528]: https://github.com/cockroachdb/cockroach/pull/55528
[#58876]: https://github.com/cockroachdb/cockroach/pull/58876
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.2 since v19.2.1.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to v19.2, see [Upgrade to CockroachDB v19.2](../v19.2/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.2-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.2.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.2-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.2.2
~~~

<h3 id="v19.2.2-security-updates">Security updates</h3>

- CockroachDB previously allowed non-authenticated access to privileged HTTP endpoints like `/_admin/v1/events`, which operate using `root` user permissions and can thus access (and sometimes modify) any and all data in the cluster. This security vulnerability has been patched by disallowing non-authenticated access to these endpoints and restricting access to admin users only.

    {{site.data.alerts.callout_info}}
    Users who have built monitoring automation using these HTTP endpoints must modify their automation to work using an HTTP session token for an admin user.
    {{site.data.alerts.end}}

- Some Admin UI screens (e.g., Jobs) were previously incorrectly displayed using `root` user permissions, regardless of the logged-in user's credentials. This enabled insufficiently privileged users to access privileged information. This security vulnerability has been patched by using the credentials of the logged-in user to display all Admin UI screens.

- Privileged HTTP endpoints and certain Admin UI screens require an admin user. However, `root` is disallowed from logging in via HTTP and it is not possible to create additional admin accounts without an Enterprise license. This is further discussed [here](https://github.com/cockroachdb/cockroach/issues/43870) and will be addressed in an upcoming patch revision.

    {{site.data.alerts.callout_info}}
    Users without an Enterprise license can create an additional admin user using a temporary evaluation license, until an alternative is available. A user created this way will persist beyond the license expiry.
    {{site.data.alerts.end}}

- Some Admin UI screens currently display an error or a blank page when viewed by a non-admin user (e.g., Table Details). This is a known limitation mistakenly introduced by the changes described above. This situation is discussed further [here](https://github.com/cockroachdb/cockroach/issues/44033) and will be addressed in an upcoming patch revision. The list of UI pages affected includes but is not limited to:

  - Job details
  - Database details
  - Table details
  - Zone configurations

    {{site.data.alerts.callout_info}}
    Users can access these Admin UI screens using an admin user until a fix is available.
    {{site.data.alerts.end}}

The list of HTTP endpoints affected by the first change above includes:

| HTTP Endpoint                                          | Description                       | Sensitive information revealed                     | Special (see below) |
|--------------------------------------------------------|-----------------------------------|----------------------------------------------------|---------------------|
| `/_admin/v1/data_distribution`                         | Database-table-node mapping       | Database and table names                           |                     |
| `/_admin/v1/databases/{database}/tables/{table}/stats` | Table stats histograms            | Stored table data  via PK values                   |                     |
| `/_admin/v1/drain`                                     | API to shut down a node           | Can cause DoS on cluster                           |                     |
| `/_admin/v1/enqueue_range`                             | Force range rebalancing           | Can cause DoS on cluster                           |                     |
| `/_admin/v1/events`                                    | Event log                         | Usernames, stored object names, privilege mappings |                     |
| `/_admin/v1/nontablestats`                             | Non-table statistics              | Stored table data via PK values                    |                     |
| `/_admin/v1/rangelog`                                  | Range log                         | Stored table data via PK values                    |                     |
| `/_admin/v1/settings`                                  | Cluster settings                  | Organization name                                  |                     |
| `/_status/allocator/node/{node_id}`                    | Rebalance simulator               | Can cause DoS on cluster                           | yes                 |
| `/_status/allocator/range/{range_id}`                  | Rebalance simulatoor              | Can cause DoS on cluster                           | yes                 |
| `/_status/certificates/{node_id}`                      | Node and user certificates        | Credentials                                        |                     |
| `/_status/details/{node_id}`                           | Node details                      | Internal IP addresses                              |                     |
| `/_status/enginestats/{node_id}`                       | Storage statistics                | Operational details                                |                     |
| `/_status/files/{node_id}`                             | Retrieve heap and goroutine dumps | Operational details                                | yes                 |
| `/_status/gossip/{node_id}`                            | Gossip details                    | Internal IP addresses                              | yes                 |
| `/_status/hotranges`                                   | Ranges with active requests       | Stored table data via PK values                    |                     |
| `/_status/local_sessions`                              | SQL sessions                      | Cleartext SQL queries                              | yes                 |
| `/_status/logfiles/{node_id}`                          | List of log files                 | Operational details                                | yes                 |
| `/_status/logfiles/{node_id}/{file}`                   | Server logs + entries             | Many: names, application data, credentials, etc.   | yes                 |
| `/_status/logs/{node_id}`                              | Log entries                       | Many: names, application data, credentials, etc.   | yes                 |
| `/_status/profile/{node_id}`                           | Profiling data                    | Operational details                                |                     |
| `/_status/raft`                                        | Raft details                      | Stored table data via PK values                    |                     |
| `/_status/range/{range_id}`                            | Range details                     | Stored table data via PK values                    |                     |
| `/_status/ranges/{node_id}`                            | Range details                     | Stored table data via PK values                    |                     |
| `/_status/sessions`                                    | SQL sessions                      | Cleartext SQL queries                              | yes                 |
| `/_status/span`                                        | Statistics per key span           | Whether certain table rows exist                   |                     |
| `/_status/stacks/{node_id}`                            | Stack traces                      | Application data, stored table data                |                     |
| `/_status/stores/{node_id}`                            | Store details                     | Operational details                                |                     |

{{site.data.alerts.callout_info}}
"Special" endpoints are subject to the [cluster setting](../v19.2/cluster-settings.html) `server.remote_debugging.mode`. Unless the setting was customized, clients are only able to connect from the same machine as the node.
{{site.data.alerts.end}}

<h3 id="v19.2.2-general-changes">General changes</h3>

- Improved the consistency checker's log output. [#42149][#42149]
- Nodes that have been terminated as the result of a failed consistency check now refuse to restart, making it more likely that the operator notices that there is a persistent issue in a timely manner. [#42149][#42149]
- Client usernames can now be defined to start with a digit; in particular, all-digit usernames are now permitted. [#42989][#42989] {% comment %}doc{% endcomment %}
- To curb the spread of corrupted data, outliers are now terminated when the replicas within a range are corrupted. Previously, the leaseholder replica would terminate, regardless of which replicas disagreed with each other. [#42149][#42149]

<h3 id="v19.2.2-enterprise-edition-changes">Enterprise edition changes</h3>

- [`RESTORE`](../v19.2/restore.html) now supports the restoration of empty databases. [#42733][#42733] {% comment %}doc{% endcomment %}

<h3 id="v19.2.2-sql-language-changes">SQL language changes</h3>

- Added the ability to run `avg()` over intervals. [#42679][#42679] {% comment %}doc{% endcomment %}
- Some columns (`typinput`, `typoutput`, `typreceive`, `typsend`, `typmodin`, `typmodout`, `typanalyze`) in `pg_type` were incorrectly typed as `OID` instead of `REGPROC`. This issue has been resolved. [#42784][#42784]
- It is now valid for `SELECT` and `HAVING` to refer to ungrouped columns in the special case when the grouped columns contain the primary key of the table containing the ungrouped column. [#42694][#42694] {% comment %}doc{% endcomment %}
- It is now supported to specify selection target aliases as `GROUP BY` columns. Note that the `FROM` columns take precedence over the aliases, which are only used if there is no column with that name in the current scope. [#42694][#42694] {% comment %}doc{% endcomment %}
- CockroachDB will now report a more accurate error message, hint, and error code if an error is encountered while adding a new column. [#42530][#42530]

<h3 id="v19.2.2-admin-ui-changes">Admin UI changes</h3>

- Certain web UI pages (like the list of databases or tables) now restrict their content to match the privileges of the logged-in user. [#42726][#42726]
- The event log now presents all cluster settings changes, unredacted, when an admin user uses the page. [#42726][#42726]
- Customization of the UI by users is now only properly saved if the user has write privilege to `system.ui` (i.e., is an admin user). Also, all authenticated users share the same customizations. This is a known limitation and should be lifted in a future version. [#42726][#42726]
- Access to table statistics are temporarily blocked from access by non-admin users until further notice, for security reasons. [#42726][#42726]
- Certain debug pages have been blocked from non-admin users for security reasons. [#42726][#42726]

<h3 id="v19.2.2-bug-fixes">Bug fixes</h3>

- The [`TIMESTAMP`](../v19.2/timestamp.html) data type is now fully supported by the [vectorized engine](../v19.2/vectorized-execution.html). Previously, an "unsupported type" error was thrown. [#42576][#42576]
- Previously, casting the same type into two or more different precisions/widths from a table in the same `SELECT` query would result in only the first precision specified. For example, `SELECT a::decimal(10, 3), a::decimal(10, 1) FROM t` would return both results as `a::decimal(10, 3)`. This PR fixes that behavior. [#42578][#42578]
- Fixed a bug that would produce a spurious failure with the error message "incompatible `COALESCE` expressions" when adding or validating `MATCH FULL` foreign key constraints involving composite keys with columns of differing types. [#42651][#42651]
- It is now possible to transfer range leases to lagging replicas. [#42761][#42761]
- Long running transactions which attempt to [`TRUNCATE`](../v19.2/truncate.html) can now be pushed and will commit in cases where they previously failed or retried forever. [#42772][#42772]
- Fixed a case in which CockroachDB incorrectly determined that a query (or part of a query) that contains an `IS NULL` constraint on a unique index column returns at most one row, possibly ignoring a `LIMIT 1` clause. [#42791][#42791]
- [`ALTER INDEX IF EXISTS`](../v19.2/alter-index.html) no longer fails when using an unqualified index name that does not match any existing index. Now it is a no-op. [#42838][#42838]
- Fixed a bug with incorrect handling of Top _K_ sort by the vectorized engine when _K_ is greater than 1024. [#42843][#42843]
- Prevent internal error in some cases when a _NULL_ literal is passed to the `OVERLAPS` operator [#42878][#42878]
- Fixed a bug that caused rare crashes when using built-in functions. [#42674][#42674]
- Other callers to `acquireNodeLease` now do not get erroneously cancelled just because the context of the first caller was cancelled. [#42893][#42893]
- Changefeeds now emit backfill row updates for a dropped column when the table descriptor drops that column. [#42669][#42669]
- Tables that are being restored or imported are no longer considered valid targets in backups and changefeeds. [#42735][#42735]
- Fixed a bug where selecting columns by forcing an `INTERLEAVING` index would return an error instead of returning the correct results. [#42901][#42901]
- CockroachDB now prevents a number of panics from the SQL layer caused by an invalid range split. These would usually manifest with messages containing encoding errors like "found null on not null column". [#42859][#42859]
- Fixed the row count estimate during query planning for some queries with multiple predicates in which the selectivity of one predicate was calculated using a histogram. [#42962][#42962]
- Previously, when executing a built-in function via the vectorized engine that returns an output type unsupported by the vectorized engine, CockroachDB could return an error instead of falling back to the row-by-row execution engine. This is now fixed. [#42990][#42990]
- Empty arrays are now correctly encoded and decoded over the binary protocol. [#42974][#42974]
- Fixed some existing caching issues surrounding role memberships, where users could sometimes see out-of-date role membership information. [#43004][#43004]
- Previously, attempting to parse `0000-01-01 00:00` when involving `time` did not work as `pgdate` does not understand `0000` as a year. This is now fixed. [#42918][#42918]
- The allocator now considers stores with very close diversity scores equal (all other things being the same) and doesn't attempt to rebalance. [#43077][#43077]
- The allocator now considers the new store being added when looking for a target in the case of a rebalance. [#43077][#43077]
- CockroachDB did not previously handle date casts from `TIMESTAMP`/`TIMESTAMPZ` with time attached for times before the UNIX epoch correctly. For example, `'1969-12-30 01:00:00'::timestamp` would round to `'1969-12-31'` instead of `'1969-12-30'`. This is now fixed. [#43022][#43022]
- CockroachDB is now less likely to hang in an inconvenient or inoperative state if it attempts to access an external HTTP server that is blocked or overloaded. Nodes failing to shut down with [`cockroach quit`](../v19.2/cockroach-quit.html) were a symptom of this bug. [#42539][#42539]

<h3 id="v19.2.2-contributors">Contributors</h3>

This release includes 38 merged PRs by 24 authors.
We would like to thank the following contributors from the CockroachDB community:

- Adam Pantel (first-time contributor, CockroachDB team member)
- Oliver Tan (first-time contributor, CockroachDB team member)
- georgebuckerfield (first-time contributor)

[#42530]: https://github.com/cockroachdb/cockroach/pull/42530
[#42726]: https://github.com/cockroachdb/cockroach/pull/42726
[#42539]: https://github.com/cockroachdb/cockroach/pull/42539
[#41938]: https://github.com/cockroachdb/cockroach/pull/41938
[#42149]: https://github.com/cockroachdb/cockroach/pull/42149
[#42576]: https://github.com/cockroachdb/cockroach/pull/42576
[#42578]: https://github.com/cockroachdb/cockroach/pull/42578
[#42651]: https://github.com/cockroachdb/cockroach/pull/42651
[#42669]: https://github.com/cockroachdb/cockroach/pull/42669
[#42674]: https://github.com/cockroachdb/cockroach/pull/42674
[#42679]: https://github.com/cockroachdb/cockroach/pull/42679
[#42694]: https://github.com/cockroachdb/cockroach/pull/42694
[#42733]: https://github.com/cockroachdb/cockroach/pull/42733
[#42735]: https://github.com/cockroachdb/cockroach/pull/42735
[#42761]: https://github.com/cockroachdb/cockroach/pull/42761
[#42772]: https://github.com/cockroachdb/cockroach/pull/42772
[#42784]: https://github.com/cockroachdb/cockroach/pull/42784
[#42791]: https://github.com/cockroachdb/cockroach/pull/42791
[#42838]: https://github.com/cockroachdb/cockroach/pull/42838
[#42843]: https://github.com/cockroachdb/cockroach/pull/42843
[#42859]: https://github.com/cockroachdb/cockroach/pull/42859
[#42878]: https://github.com/cockroachdb/cockroach/pull/42878
[#42893]: https://github.com/cockroachdb/cockroach/pull/42893
[#42901]: https://github.com/cockroachdb/cockroach/pull/42901
[#42918]: https://github.com/cockroachdb/cockroach/pull/42918
[#42962]: https://github.com/cockroachdb/cockroach/pull/42962
[#42974]: https://github.com/cockroachdb/cockroach/pull/42974
[#42989]: https://github.com/cockroachdb/cockroach/pull/42989
[#42990]: https://github.com/cockroachdb/cockroach/pull/42990
[#43004]: https://github.com/cockroachdb/cockroach/pull/43004
[#43022]: https://github.com/cockroachdb/cockroach/pull/43022
[#43072]: https://github.com/cockroachdb/cockroach/pull/43072
[#43077]: https://github.com/cockroachdb/cockroach/pull/43077
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.3 since v19.2.2.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to v19.2, see [Upgrade to CockroachDB v19.2](../v19.2/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.3-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.3.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.3.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.3.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.3.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.3-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.2.3
~~~

<h3 id="v19.2.3-security-updates">Security updates</h3>

- SQL admins can now use the new command `cockroach auth-session login` to create authentication tokens with an arbitrary expiration date. Operators should be careful to monitor `system.web_sessions` and enforce policy-mandated expirations using either SQL queries or the new command `cockroach auth-session logout`. [#44110][#44110]

<h3 id="v19.2.3-enterprise-edition-changes">Enterprise edition changes</h3>

- CockroachDB is now more resilient to connection/network errors when reading data from HTTP servers. CockroachDB now attempts to resume the download after such errors. [#43687][#43687]

<h3 id="v19.2.3-sql-language-changes">SQL language changes</h3>

- [`extract()`](../v19.2/functions-and-operators.html#special-syntax-forms) now supports millennium, century, decade, isoyear, isodow, and julian for [`date`](../v19.2/date.html), [`timestamp`](../v19.2/timestamp.html), and [`timestamptz`](../v19.2/timestamp.html). [`DATE_TRUNC`](../v19.2/functions-and-operators.html#date-and-time-functions) now supports millennium, century, and decade for `date`, `timestamp`, and `timestamptz`. [#42957][#42957]
- The output of [`EXPLAIN`](../v19.2/explain.html) now shows [joins](../v19.2/joins.html) where there are no equality columns as "cross" instead of "hash". Cross joins can be very expensive and should be avoided. [#43239][#43239]
- Previously, we error-coded duplicate foreign key constraint names with `42830` or `23503`. We changed this to be `42710` to be in line with PostgreSQL. [#43425][#43425]
- Vectorized queries that execute only on supported types, even if those types form part of a table with unsupported types are now run through the [vectorized engine](../v19.2/vectorized-execution.html). This would previously fall back to the row-by-row execution engine. [#44014][#44014]
- [`SHOW RANGES`](../v19.2/show-ranges.html) now shows locality information consistent with the range descriptor when node ID and store ID do not match. [#44312][#44312]
- Previously, CockroachDB would return an internal error when using [`SET TRACING`](../v19.2/set-vars.html#supported-variables) with any type other than `STRING`. Now it will return a regular query error. Additionally, boolean arguments are now supported in `SET TRACING`, and `true` is mapped to `on` mode of tracing whereas `false` is mapped to `off`. [#44347][#44347]

<h3 id="v19.2.3-command-line-changes">Command-line changes</h3>

- Telemetry is now recorded for whenever the command [`cockroach demo`](../v19.2/cockroach-demo.html) is used. [#43819][#43819]
- Three new CLI commands, `cockroach auth-session login`, `cockroach auth-session list`, and `cockroach auth-session logout`, are now provided to facilitate the management of web sessions. The command `auth-session login` also produces a HTTP cookie which can be used by non-interactive HTTP-based database management tools. It also can generate such a cookie for the `root` user, who would not otherwise be able to do so using a web browser. [#44110][#44110]

<h3 id="v19.2.3-admin-ui-changes">Admin UI changes</h3>

- We previously introduced a fix on the Admin UI to prevent non-admin users from executing queries. However, this inadvertently caused certain pages requiring table details not to display. This issue has now been resolved. [#44191][#44191]

<h3 id="v19.2.3-bug-fixes">Bug fixes</h3>

- Fixed a bug during planning for some queries that could cause an infinite loop and prevent the query from being cancelled. [#43082][#43082]
- Some incorrect issue links referenced by error hints have been corrected. [#43233][#43233]
- [`EXPLAIN`](../v19.2/explain.html) can now be used with statements that use [`AS OF SYSTEM TIME`](../v19.2/as-of-system-time.html). [#43303][#43303]
- This bug may cause jobs to be left indefinitely in `PENDING` state and never run. [#43421][#43421]
- Fixed a bug that prevented error reporting while generating shell autocomplete scripts. [#43507][#43507]
- Fixed a bug that prevented error reporting while reading from `crdb_internal.gossip_nodes` which could lead to lost writes or other undefined behavior. [#43502][#43502]
- Fixed a bug that prevented error reporting while generating plan diagrams rather than silently reporting no result. [#43506][#43506]
- Fixed a bug where an internal error could occur when [`CASE`](../v19.2/scalar-expressions.html#conditional-expressions) operator operating on distinct although compatible types was executed via the vectorized engine. For example, a query similar to `SELECT CASE WHEN false THEN 0:::INT2 ELSE 1:::INT8 END` previously would error out. [#43566][#43566]
- Fixed a bug that prevented error reporting while looking up table descriptors during schema changes and other transactional interactions with schema which could cause lost writes or other undefined behavior. [#43503][#43503]
- Fixed a bug in the parsing logic for `server.host_based_authentication.configuration`, where both single-character strings, and quoted strings containing spaces and separated by commas, were not properly parsed. [#43714][#43714]
- Fixed a bug that prevented error reporting while failing to parse URIs for multi-locality backup. [#43501][#43501]
- It is now possible to perform [`ALTER COLUMN SET/DROP NULL`](../v19.2/alter-column.html) on multiple (different) columns of the same table inside a single transaction. [#43645][#43645]
- CockroachDB now properly rejects [`ALTER COLUMN DROP NOT NULL`](../v19.2/alter-column.html) on a column that is part of the primary key. [#43645][#43645]
- Fixed a bug where errors from JSON containment operations were silently ignored rather than being returned. [#43505][#43505]
- Previously, CockroachDB could incorrectly report that some values were `NULL` when, in fact, they weren't. This could occur only when vectorized execution engine was used with `vectorize=experimental_on` and now has been fixed. [#43823][#43823]
- Fixed a bug where CockroachDB returned incorrect results for some aggregate functions when used as window functions with non-default window frame. Note that `MIN`, `MAX`, `SUM`, `AVG`, as well as "pure" window functions (i.e., non-aggregates) were not affected. [#43854][#43854]
- Fixed a bug where CockroachDB could, in some cases, return an internal error when running a query with a [`CAST`](../v19.2/data-types.html#data-type-conversions-and-casts) operation (`:::`) if vectorized execution engine is used. [#43890][#43890]
- A SQL row write that is re-issued after already succeeding will no longer throw a duplicate key error when the previous write in its transaction deleted the row. [#43937][#43937]
- On Linux machines, CockroachDB now respects the available memory limit set by the `cgroup` limits which apply to the cockroach process. [#43860][#43860]
- Fixed a bug in which a query shutdown mechanism could fail to fully cleanup the infrastructure when the query was executed via the vectorized engine and the query plan contained wrapped row-by-row processors. [#43944][#43944]
- Fixed a bug introduced in 19.2 that would allow foreign keys to use a unique index on the referenced columns that indexed more columns than were included in the columns used in the foreign key constraint, which allows potentially violating uniqueness in the referenced columns themselves. [#43796][#43796]
- A benign error previously logged at the `ERROR` level is now logged at the `INFO` level behind a verbosity(2) flag. This error might have been observed as `context canceled: readerCtx in Inbox stream handler`. [#44037][#44037]
- Fixed a bug where an internal error could occur when a query with an aggregate function `MIN` or `MAX` was executed via the vectorized engine when the input column was either `INT2` or `INT4` type. [#44055][#44055]
- `cockroach zip` now emits the `goroutine` file in the proper sub-directory when the corresponding call fails with an error. [#44065][#44065]
- `cockroach debug zip` is again able to operate correctly and continue to iterate over all nodes if one of the nodes does not deliver its goroutine dumps. It would previously prematurely and incorrectly stop with an incomplete dump; this was a regression introduced in 19.2. [#44065][#44065]
- [CDC](../v19.2/change-data-capture.html) is no longer susceptible to a bug where a resolved timestamp might be published before all events that precede it have been published in the presence of a range merge. [#44077][#44077]
- Converted a panic in `golang.org/x/text/language/tags.go` when using collated strings to an error. [#44117][#44117]
- CockroachDB now properly supports using `--url` with query options (e.g., `application_name`) but without specifying `sslmode`. The default of `sslmode=disable` is assumed in that case. [#44115][#44115]
- Removed statistics information from backup jobs' payload information to avoid excessive memory utilization when issuing commands such as [`SHOW JOBS`](../v19.2/show-jobs.html). [#44190][#44190]
- Fixed a bug where CockroachDB could crash in special circumstances when vectorized execution engine is used (it was more likely to happen if `vectorize=experimental_on` setting was used). [#44196][#44196]
- Fixed a planning bug related to `FULL` joins between single-row relations. [#44228][#44228]
- Fixed `CopyFrom requires empty destination` internal error. [#44245][#44245]
- Fixed a bug where multiple nodes attempted to populate the results for [`CREATE TABLE ... AS`](../v19.2/create-table-as.html) leading to duplicate rows. [#44300][#44300]
- Fixed internal error when mixed types are used with `BETWEEN`. [#44319][#44319]
- Fixed a bug where CockroachDB would return an internal error when a query with [`CASE`](../v19.2/scalar-expressions.html#conditional-expressions) operator that returns only `NULL` values was executed via the vectorized engine. [#44353][#44353]
- Fixed an internal error in the planner when table statistics were collected manually using `CREATE STATISTICS` for different columns at different times. [#44442][#44442]
- Fixed a bug that prevented `admin` users from using [`BACKUP`](../v19.2/backup.html), [`RESTORE`](../v19.2/restore.html), and [`IMPORT`](../v19.2/import.html). [#44456][#44456]
- Fixed incorrect plans in very rare cases involving filters that aren't constant folded in the optimizer but that can be evaluated statically when running a given query. [#44419][#44419]

<h3 id="v19.2.3-performance-improvements">Performance improvements</h3>

- Adjusted the optimizer's cost of lookup join when the lookup columns aren't a key in the table. This will now cause some queries to switch to using a hash or merge join instead of a lookup join, improving performance in most cases. [#43059][#43059]
- Improved the estimated row count for some lookup joins during planning, leading to better plans in some cases. [#43364][#43364]
- A transaction running into multiple intents from an abandoned conflicting transaction now cleans them up more efficiently. [#43588][#43588]
- Histograms are now collected automatically for all boolean columns, resulting in better query plans in some cases. For tables that aren't being modified frequently, it might be necessary to run [`CREATE STATISTICS`](../v19.2/create-statistics.html) manually to see the benefit. [#44171][#44171]

<h3 id="v19.2.3-allocator">Allocator</h3>

- The kv.allocator.range_rebalance_threshold setting, which controls how far away from the mean a store's range count must be before it is considered for rebalance, is now subject to a 2-replica minimum. If, for example, the mean number of replicas per store is 5.6 and the setting is 5%, the store will not be considered for rebalance unless the number of replicas is lesser than 3 or greater than 8. Previously, the bounds would have been 5 and 6. [#44359][#44359]

<h3 id="v19.2.3-doc-updates">Doc updates</h3>

- Added a [Django app development tutorial](../v19.2/build-a-python-app-with-cockroachdb-django.html). [#6359](https://github.com/cockroachdb/docs/pull/6359) [#6365](https://github.com/cockroachdb/docs/pull/6365)
- Updated the [Hibernate app development tutorial](../v19.2/build-a-java-app-with-cockroachdb-hibernate.html) with client-side retry logic. [#5760](https://github.com/cockroachdb/docs/pull/5760)
- Documented how to [use keyset pagination to iterate through query results](../v19.2/selection-queries.html#paginate-through-limited-results). [#6114](https://github.com/cockroachdb/docs/pull/6114)
- Improved the [GSSAPI authentication](../v19.2/gssapi_authentication.html) instructions for configuring Active Directory and MIT and for configuring the client. [#6115](https://github.com/cockroachdb/docs/pull/6115)
- Expanded the [Kubernetes tutorial](../v19.2/orchestrate-cockroachdb-with-kubernetes.html#step-2-start-cockroachdb) to show how to use a custom CA instead of Kubernetes built-in CA when using manual configs. [#6232](https://github.com/cockroachdb/docs/pull/6232)
- Updated the [Kubernetes tutorial](../v19.2/orchestrate-cockroachdb-with-kubernetes.html) for compatibility with Helm 3.0. [#6121](https://github.com/cockroachdb/docs/pull/6121)
- Added language-specific connection strings to the instructions on [connecting to a CockroachCloud cluster](../cockroachcloud/connect-to-your-cluster.html). [#6077](https://github.com/cockroachdb/docs/pull/6077)
- Added Docker as a download option on the full [release notes list](../releases/#docker). [#5792](https://github.com/cockroachdb/docs/issues/5792)
- Updated the [`IMPORT` documentation](../v20.1/import.html) with an example usage of `DELIMITED` with escaping, a note about `DEFAULT` values, and an explanation of the `strict_quotes` option. [#6244](https://github.com/cockroachdb/docs/pull/6244)
- Added an FAQ on [why Cockroach Labs changed the license for CockroachDB](../v19.2/frequently-asked-questions.html#why-did-cockroach-labs-change-the-license-for-cockroachdb). [#6154](https://github.com/cockroachdb/docs/pull/6154)
- Corrected the description of the [possible result of clock skew outside the configured clock offset bounds](../v19.2/operational-faqs.html#what-happens-when-node-clocks-are-not-properly-synchronized). [#6329](https://github.com/cockroachdb/docs/pull/6329)
- Expanded the [data types overview](../v19.2/data-types.html) to indicate whether or not a type supports [vectorized execution](../v19.2/vectorized-execution.html). [#6327](https://github.com/cockroachdb/docs/pull/6327)

<h3 id="v19.2.3-contributors">Contributors</h3>

This release includes 58 merged PRs by 18 authors.
We would like to thank the following contributors from the CockroachDB community:

- Roga Pria Sembada (first-time contributor)

[#42957]: https://github.com/cockroachdb/cockroach/pull/42957
[#43059]: https://github.com/cockroachdb/cockroach/pull/43059
[#43082]: https://github.com/cockroachdb/cockroach/pull/43082
[#43233]: https://github.com/cockroachdb/cockroach/pull/43233
[#43239]: https://github.com/cockroachdb/cockroach/pull/43239
[#43303]: https://github.com/cockroachdb/cockroach/pull/43303
[#43364]: https://github.com/cockroachdb/cockroach/pull/43364
[#43421]: https://github.com/cockroachdb/cockroach/pull/43421
[#43425]: https://github.com/cockroachdb/cockroach/pull/43425
[#43501]: https://github.com/cockroachdb/cockroach/pull/43501
[#43502]: https://github.com/cockroachdb/cockroach/pull/43502
[#43503]: https://github.com/cockroachdb/cockroach/pull/43503
[#43505]: https://github.com/cockroachdb/cockroach/pull/43505
[#43506]: https://github.com/cockroachdb/cockroach/pull/43506
[#43507]: https://github.com/cockroachdb/cockroach/pull/43507
[#43566]: https://github.com/cockroachdb/cockroach/pull/43566
[#43588]: https://github.com/cockroachdb/cockroach/pull/43588
[#43645]: https://github.com/cockroachdb/cockroach/pull/43645
[#43687]: https://github.com/cockroachdb/cockroach/pull/43687
[#43714]: https://github.com/cockroachdb/cockroach/pull/43714
[#43796]: https://github.com/cockroachdb/cockroach/pull/43796
[#43819]: https://github.com/cockroachdb/cockroach/pull/43819
[#43823]: https://github.com/cockroachdb/cockroach/pull/43823
[#43854]: https://github.com/cockroachdb/cockroach/pull/43854
[#43860]: https://github.com/cockroachdb/cockroach/pull/43860
[#43890]: https://github.com/cockroachdb/cockroach/pull/43890
[#43937]: https://github.com/cockroachdb/cockroach/pull/43937
[#43944]: https://github.com/cockroachdb/cockroach/pull/43944
[#44014]: https://github.com/cockroachdb/cockroach/pull/44014
[#44037]: https://github.com/cockroachdb/cockroach/pull/44037
[#44055]: https://github.com/cockroachdb/cockroach/pull/44055
[#44065]: https://github.com/cockroachdb/cockroach/pull/44065
[#44077]: https://github.com/cockroachdb/cockroach/pull/44077
[#44110]: https://github.com/cockroachdb/cockroach/pull/44110
[#44115]: https://github.com/cockroachdb/cockroach/pull/44115
[#44117]: https://github.com/cockroachdb/cockroach/pull/44117
[#44171]: https://github.com/cockroachdb/cockroach/pull/44171
[#44190]: https://github.com/cockroachdb/cockroach/pull/44190
[#44191]: https://github.com/cockroachdb/cockroach/pull/44191
[#44196]: https://github.com/cockroachdb/cockroach/pull/44196
[#44228]: https://github.com/cockroachdb/cockroach/pull/44228
[#44245]: https://github.com/cockroachdb/cockroach/pull/44245
[#44300]: https://github.com/cockroachdb/cockroach/pull/44300
[#44312]: https://github.com/cockroachdb/cockroach/pull/44312
[#44319]: https://github.com/cockroachdb/cockroach/pull/44319
[#44347]: https://github.com/cockroachdb/cockroach/pull/44347
[#44353]: https://github.com/cockroachdb/cockroach/pull/44353
[#44359]: https://github.com/cockroachdb/cockroach/pull/44359
[#44419]: https://github.com/cockroachdb/cockroach/pull/44419
[#44442]: https://github.com/cockroachdb/cockroach/pull/44442
[#44456]: https://github.com/cockroachdb/cockroach/pull/44456
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.4 since v19.2.3.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to v19.2, see [Upgrade to CockroachDB v19.2](../v19.2/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.4-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.4.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.4.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.4.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.4.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.4-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.2.4
~~~

<h3 id="v19.2.4-security-updates">Security updates</h3>

- Previous versions of CockroachDB were incorrectly enabling non-admin SQL users to use the [statements details](../v19.2/admin-ui-statements-page.html) in the Admin UI and the HTTP endpoint `/_status/statements`. This information is sensitive because the endpoint does not hide data that the requester does not have privilege over. This has been corrected by requiring a [SQL `admin` user](../v19.2/authorization.html) to access the statements details page and the HTTP endpoint. [#44354][#44354]

<h3 id="v19.2.4-bug-fixes">Bug fixes</h3>

- Fixed a bug where CockroachDB would return an internal error when the [`substring` function](../v19.2/functions-and-operators.html#string-and-byte-functions) with a negative length was executed via the vectorized engine. CockroachDB now returns a regular query error on executing the function. [#44629][#44629]
- Fixed "no output column equivalent to.." and "column not in input" errors in some cases involving [`DISTINCT ON`](../v19.2/select-clause.html#eliminate-duplicate-rows) and [`ORDER BY`](../v19.2/query-order.html). [#44598][#44598]
- Fixed "expected constant FD to be strict" internal error. [#44604][#44604]
- Fixed possibly incorrect query results in various cornercases, especially when [`SELECT DISTINCT`](../v19.2/select-clause.html#eliminate-duplicate-rows) is used. [#44604][#44604]
- Fixed a bug where running a query with the [`LIKE`](../v19.2/functions-and-operators.html) operator using the custom `ESCAPE` symbol when the pattern contained Unicode characters could result in an internal error in CockroachDB. [#44648][#44648]
- CockroachDB no longer repeatedly looks for non-existing jobs, which may cause  high memory usage, when cleaning up schema changes. [#44698][#44698]
- Fixed "no indexes" internal error in some cases when we [`GROUP BY`](../v19.2/select-clause.html#create-aggregate-groups) on a virtual table. [#44723][#44723]
- Fixed invalid query results in some corner cases where part of a [`WHERE`](../v19.2/select-clause.html#parameters) clause is incorrectly discarded. [#44749][#44749]
- Fixed a typechecking error where [`BETWEEN`](../v19.2/select-clause.html#filter-aggregate-groups) would sometimes allow boundary expressions of a different type. [#44810][#44810]
- [`CASE`](../v19.2/functions-and-operators.html) operators with an unknown `WHEN` type no longer return an error. [#44818][#44818]

<h3 id="v19.2.4-contributors">Contributors</h3>

This release includes 15 merged PRs by 10 authors.

[#44354]: https://github.com/cockroachdb/cockroach/pull/44354
[#44598]: https://github.com/cockroachdb/cockroach/pull/44598
[#44604]: https://github.com/cockroachdb/cockroach/pull/44604
[#44629]: https://github.com/cockroachdb/cockroach/pull/44629
[#44648]: https://github.com/cockroachdb/cockroach/pull/44648
[#44698]: https://github.com/cockroachdb/cockroach/pull/44698
[#44723]: https://github.com/cockroachdb/cockroach/pull/44723
[#44749]: https://github.com/cockroachdb/cockroach/pull/44749
[#44810]: https://github.com/cockroachdb/cockroach/pull/44810
[#44818]: https://github.com/cockroachdb/cockroach/pull/44818
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.5 since v19.2.4.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to v19.2, see [Upgrade to CockroachDB v19.2](../v19.2/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.5-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.5.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.5.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.5.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.5.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.5-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.2.5
~~~

<h3 id="v19.2.5-security-updates">Security updates</h3>

- Non-licensed users are now able to add more principals to the special superuser role/group `admin`. [Creation of additional roles](../v19.2/create-role.html) is still a licensed feature. [#45395][#45395] {% comment %}doc{% endcomment %}

<h3 id="v19.2.5-sql-language-changes">SQL language changes</h3>

- The SQL:2008 syntax `OFFSET <x> ROWS` and `FETCH FIRST <y> ROWS ONLY` now accepts parameter values. [#45166][#45166] {% comment %}doc{% endcomment %}
- It is now possible to use [`GRANT`](../v19.2/grant.html) and [`REVOKE`](../v19.2/revoke.html) to add users to the `admin` role without a valid license. This change aims to enable use of the Admin UI and other privileged features without a license. [#45395][#45395] {% comment %}doc{% endcomment %}

<h3 id="v19.2.5-command-line-changes">Command-line changes</h3>

- [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) now includes secondary log files (e.g., the RocksDB logs) in the main log directory. Log files in alternate log directories, if different from the main log directory, are not included. [#45202][#45202] {% comment %}doc{% endcomment %}
- [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) now displays its progress differently on the terminal. [#45207][#45207]
- [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) now properly supports special characters in database and table names. [#45207][#45207]
- [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) will now apply the `--timeout` parameters to the SQL queries it performs. Previously, there was no timeout, which could cause `cockroach debug zip` to hang. [#45207][#45207] {% comment %}doc{% endcomment %}
- [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) is now able to tolerate more forms of cluster unavailability. In case system ranges are unavailable, we recommend running `cockroach debug zip` on each node's address, to maximize useful data collection. [#45207][#45207]
- The `debug.zip` file generated by [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) now contains hex a representation of the marshaled jobs payload, progress, and table descriptors. [#46040][#46040]

<h3 id="v19.2.5-admin-ui-changes">Admin UI changes</h3>

- The "Log file list" endpoint now includes secondary log files (e.g., the RocksDB logs) in the main log directory. Log files in alternate log directories, if different from the main log directory, are not included. [#45202][#45202] {% comment %}doc{% endcomment %}

<h3 id="v19.2.5-bug-fixes">Bug fixes</h3>

- Fixed a "cannot map variable" error that could occur in rare cases involving joins. [#44859][#44859]
- Fixed a bug where [`DROP INDEX`](../v19.2/drop-index.html) jobs waiting for GC TTL might be erroneously deleted early. Usually a `DROP INDEX` job would appear as "waiting for GC TTL" to indicate that the data was still on disk. However, this bug might have caused the job to be deleted before the data was actually removed from disk. [#44873][#44873]
- Fixed occasional "concurrent map write" crash. [#44874][#44874]
- Previously, CockroachDB would return an internal error when a [`substring` function](../v19.2/functions-and-operators.html#string-and-byte-functions) with non-`INT8` start and length arguments was executed with the [vectorized execution engine](../v19.2/vectorized-execution.html). This is now fixed. [#44902][#44902]
- Fixed incorrect deduplication of impure expressions (e.g., [`gen_random_uuid`](../v19.2/functions-and-operators.html#id-generation-functions)) in projections and default values. [#44915][#44915]
- Previously, CockroachDB could return an internal error on the queries that return `INT` columns when the default integer size has been changed. This is now fixed. [#44980][#44980]
- Previously, CockroachDB would return an internal error when a merge join operation was performed with the [vectorized execution engine](../v19.2/vectorized-execution.html) in the case when two sides of the join had comparable but different types in the equality columns (e.g., `INT2` on the left and `INT4` on the right). This is now fixed. [#45032][#45032]
- Previously, CockroachDB could crash when running [`EXPLAIN (VEC)`](../v19.2/explain.html#vec-option) in some edge cases. Now, an internal error is returned instead. [#45004][#45004]
- Fixed an internal error that could occur when [`NULLIF`](../v19.2/scalar-expressions.html#nullif-expressions) was called with one null argument. [#45390][#45390]
- Some vectorized execution plans that used lookup joins with `DECIMAL`s would previously return incorrect results. This is now fixed. [#45548][#45548]
- AbortSpan records are now cleaned up more aggressively when it is known to be safe. [#45553][#45553]
- It is now possible to create [inverted indexes](../v19.2/inverted-indexes.html) on columns whose names are mixed-case. [#45660][#45660]
- Fixed a bug causing distributed deadlock detection between transactions to stall and fail to resolve a deadlock. [#45664][#45664]
- Fixed a bug where large ranges with slow send rates would hit the timeout in several storage system queues by making the timeout dynamic based on the current rate limit and the size of the data being sent. This affects several storage system queues: the Raft snapshot queue, the replication queue, and the merge queue. [#44952][#44952]
- Previously, drivers that did not truncate trailing zeroes for decimals in the binary format end up having inaccuracies of up to 10^4 during the decode step. Trailing zeroes are now truncated as appropriate. This fixes known incorrect decoding cases with Postgrex in Elixir. [#45670][#45670]
- Range garbage collection will now trigger based on a large abort span, adding defense-in-depth against ranges growing large and eventually unstable. [#45744][#45744]
- Previously, an internal error could occur in CockroachDB when executing queries that contained unordered synchronizers with the [vectorized execution engine](../v19.2/vectorized-execution.html). This is now fixed. [#45739][#45739]
- Previously, CockroachDB would crash when using a [window function](../v19.2/window-functions.html) with the `RANGE` mode of framing an `offset PRECEDING` or `offset FOLLOWING` boundary where the single column in an `ORDER BY` clause was also in the `PARTITION BY` clause. This is now fixed. [#45805][#45805]
- Previously, CockroachDB could crash when computing [window functions](../v19.2/window-functions.html) with the `RANGE` mode of framing when one of the bounds was either `offset PRECEDING` or `offset FOLLOWING` and there were `NULL` values in the single column of an `ORDER BY` clause. Additionally, `RANGE` mode bounds `0 PRECEDING` and `0 FOLLOWING` could have been handled incorrectly. This is now fixed. [#45805][#45805]
- When considering if a job should be orphaned, CockroachDB used to take the conservative approach when a descriptor ID pointing to non-existent descriptor was found. This caused jobs to hang and be garbage collected. We now disregard these IDs when considering if a job still has work to do. [#45895][#45895]
- The `--set` parameter for [`cockroach sql`](../v19.2/cockroach-sql.html) and [`cockroach demo`](../v19.2/cockroach-demo.html) is now able to properly override all client-side options, as advertised. [#46130][#46130]
- Expected errors from the [vectorized execution engine](../v19.2/vectorized-execution.html) are no longer mistakenly annotated as unexpected errors. [#46092][#46092]

<h3 id="v19.2.5-performance-improvements">Performance improvements</h3>

- Execution plans are now faster in some cases that involve [`IN`/`NOT IN`](../v19.2/scalar-expressions.html#set-membership) with an empty tuple, or [`= ANY`](../v19.2/scalar-expressions.html#multi-valued-comparisons) with an empty array. [#45213][#45213]
- Improved the selectivity estimation of some predicates containing `OR`, leading to better plan selection by the optimizer, in some cases. [#45972][#45972]
- Improved cardinality estimation in the optimizer for relations with a small number of rows. This may lead to the optimizer choosing a better query plan. [#45972][#45972]

<h3 id="v19.2.5-contributors">Contributors</h3>

This release includes 36 merged PRs by 15 authors.

[#44859]: https://github.com/cockroachdb/cockroach/pull/44859
[#44873]: https://github.com/cockroachdb/cockroach/pull/44873
[#44874]: https://github.com/cockroachdb/cockroach/pull/44874
[#44902]: https://github.com/cockroachdb/cockroach/pull/44902
[#44915]: https://github.com/cockroachdb/cockroach/pull/44915
[#44952]: https://github.com/cockroachdb/cockroach/pull/44952
[#44980]: https://github.com/cockroachdb/cockroach/pull/44980
[#45004]: https://github.com/cockroachdb/cockroach/pull/45004
[#45032]: https://github.com/cockroachdb/cockroach/pull/45032
[#45166]: https://github.com/cockroachdb/cockroach/pull/45166
[#45202]: https://github.com/cockroachdb/cockroach/pull/45202
[#45207]: https://github.com/cockroachdb/cockroach/pull/45207
[#45213]: https://github.com/cockroachdb/cockroach/pull/45213
[#45390]: https://github.com/cockroachdb/cockroach/pull/45390
[#45395]: https://github.com/cockroachdb/cockroach/pull/45395
[#45548]: https://github.com/cockroachdb/cockroach/pull/45548
[#45553]: https://github.com/cockroachdb/cockroach/pull/45553
[#45660]: https://github.com/cockroachdb/cockroach/pull/45660
[#45664]: https://github.com/cockroachdb/cockroach/pull/45664
[#45670]: https://github.com/cockroachdb/cockroach/pull/45670
[#45739]: https://github.com/cockroachdb/cockroach/pull/45739
[#45744]: https://github.com/cockroachdb/cockroach/pull/45744
[#45805]: https://github.com/cockroachdb/cockroach/pull/45805
[#45895]: https://github.com/cockroachdb/cockroach/pull/45895
[#45972]: https://github.com/cockroachdb/cockroach/pull/45972
[#46040]: https://github.com/cockroachdb/cockroach/pull/46040
[#46092]: https://github.com/cockroachdb/cockroach/pull/46092
[#46130]: https://github.com/cockroachdb/cockroach/pull/46130
[#46154]: https://github.com/cockroachdb/cockroach/pull/46154
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.6 since v19.2.5.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to v19.2, see [Upgrade to CockroachDB v19.2](../v19.2/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.6-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.6.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.6.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.6.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.6.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.6-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.2.6
~~~

<h3 id="v19.2.6-backward-incompatible-changes">Backward-incompatible changes</h3>

- [`cockroach init`](../v19.2/cockroach-init.html) now waits for server readiness and thus no longer fails when a mistaken server address is provided. [#46477][#46477]

<h3 id="v19.2.6-security-updates">Security updates</h3>

- The non-authenticated `/health` HTTP endpoint was previously exposing the private IP address of the node, which can be privileged information in some deployments. This has been corrected. Deployments using automation to retrieve a node build details and address details should use `/_status/details/local` instead and use a valid admin authentication cookie. [#46477][#46477] {% comment %}doc{% endcomment %}
- All users can now *view* any comments on any object (bypassing other privileges), but modifying comments require write privilege on the target object. Previously, any user could modify any database/table/view/index comment via direct SQL updates to `system.comments`. This was unintended and a form of privilege escalation, and is now prevented. The privileges required for the [`COMMENT`](../v19.2/comment-on.html) statement, `pg_description`, `col_description()`, `obj_description()`, and `shobj_description()` are operating as in PostgreSQL and are unaffected by this change. [#46833][#46833] {% comment %}doc{% endcomment %}

<h3 id="v19.2.6-sql-language-changes">SQL language changes</h3>

- The type checking code now prefers aggregate overloads with string inputs if there are multiple possible candidates due to arguments of unknown type. [#46807][#46807]
- Added an unimplemented error when attempting to `ADD CONSTRAINT` with the `EXCLUDE USING` syntax. [#46910][#46910]
- Added support for `CREATE INDEX .... INCLUDE (col1, col2, ...)`, which is an alias that PostgreSQL uses that is analogous to CockroachDB's `STORING (col1, col2, ...)` syntax. [#46910][#46910]
- Added support for parsing the `REINDEX` syntax, which results in an unimplemented error that explains that `REINDEX`ing is not required in CockroachDB. [#46910][#46910]
- `CREATE INDEX CONCURRENTLY` and `DROP INDEX CONCURRENTLY` are now parsed but return errors. [#46805][#46805]
- Improved the error message for unsupported interactions between correlated subqueries and `WITH` clauses. [#46971][#46971]

<h3 id="v19.2.6-command-line-changes">Command-line changes</h3>

- The [`cockroach init`](../v19.2/cockroach-init.html) command now waits until the node at the provided server address is ready to accept initialization. This also waits for network readiness. This makes it easier to implement initialization scripts by removing the need for a loop. In addition, implementing such a loop is operationally unsafe and is not recommended. [#46477][#46477]
- CockroachDB will now dump the stacks of all goroutines upon receiving `SIGQUIT` prior to terminating. This feature is intended for use while troubleshooting misbehaving nodes. [#46478][#46478]
- The [`cockroach start`](../v19.2/cockroach-start.html) and [`cockroach start-single-node`](../v20.1/cockroach-start-single-node.html) commands no longer initiate a 1-minute hard shutdown countdown after a request to gracefully terminate. This means that graceful shutdowns are now free to take longer than one minute. It also means that deployments where a maximum shutdown time must be enforced must now use a service manager that is suitably configured to do so. [#46483][#46483]
- The [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) command now creates valid zip files even if some of its requests encounter an error. [#46635][#46635]

<h3 id="v19.2.6-admin-ui-changes">Admin UI changes</h3>

- Metrics relating to SQL transaction restarts and rollbacks are now properly captured and exported. [#46272][#46272]
- The display options are now saved separately for each authenticated user. **Note:** When upgrading to a version with this change, all current display customizations for admin users are lost. [#46479][#46479]

<h3 id="v19.2.6-bug-fixes">Bug fixes</h3>

- Fixed a bug where `pg_catalog.pg_indexes` showed the wrong index definition for inverted indexes. [#46564][#46564]
- Fixed a performance bug where `TRUNCATE` would take 2*num columns round trips. This could lead to slow truncate performance in distributed clusters. [#46648][#46648]
- Fixed an internal error that could occur in the optimizer when a `WHERE` filter contained at least one correlated subquery and one non-correlated subquery. [#46167][#46167]
- CockroachDB no longer returns an internal error in some cases when running queries with `CASE`, `AND`, or `OR` operators via the vectorized execution engine. [#46088][#46088]
- Fixed a bug where various session variables could not be set to the values "on" or "off", only true or false. [#46219][#46219]
- Accesses to `/health` using a non-root authentication token no longer hang when a node is currently under load, or if a system range is unavailable. [#46477][#46477]
- Fixed a race in the vectorized execution engine. [#46486][#46486]
- The `cockroach debug zip` command now properly collects heap profiles. [#46482][#46482]
- The goroutine dump facility now functions properly when logging to files is disabled, e.g., via `--log-dir=""` or `--logtostderr`. [#46482][#46482]
- Fixed a bug where the vectorized engine could sometimes give an incorrect result when reading from interleaved parents or children. [#46495][#46495]
- Fixed an internal error that could occur when an aggregate inside the right-hand side of a `LATERAL` join was scoped at the level of the left-hand side. [#46544][#46544]
- Fixed an error that incorrectly occurred when an aggregate was used inside the `WHERE` or `ON` clause of a [subquery](../v19.2/subqueries.html) but was scoped at an outer level of the query. [#46544][#46544]
- Added support for queries with qualified stars that refer to tables in outer scopes. [#46538][#46538]
- Fixed an incorrect "no data source matches prefix" error in some cases involving subqueries that use views. [#46537][#46537]
- Expressions of the form `NOT(a && b)` no longer fail. [#46539][#46539]
- Fixed a bug where operations on an index that contained a collated string in descending order would fail.[#46578][#46578]
- Fixed a bug where the vectorized engine would throw an internal error when executing a query that utilized an inverted index. [#46506][#46506]
- Fixed an internal error that could happen during planning when a column with a histogram was filtered with a predicate of a different data type. [#46667][#46667]
- CockroachDB no longer incorrectly accounts for some RAM usage when computing aggregate functions. [#46622][#46622]
- Fixed an incorrect query result that could occur when a scalar aggregate was called with a null input. [#46807][#46807]
- Benign "outbox next" errors are now only logged when log verbosity is set to 1 or greater. [#46837][#46837]
- Fixed incorrect result with count(*) when grouping on constant columns. [#46894][#46894]
- Customizations of the Admin UI are once again properly saved across sessions. [#46479][#46479]
- Fixed a rare bug causing transactions that have performed schema changes to deadlock after they restart. [#46904][#46904]

<h3 id="v19.2.6-performance-improvements">Performance improvements</h3>

- Less memory is loaded into memory for `crdb_internal.jobs`. [#46452][#46452]
- Virtual tables that access all table descriptors now make fewer round trips. [#46950][#46950]

<h3 id="v19.2.6-contributors">Contributors</h3>

This release includes 42 merged PRs by 16 authors.

[#46088]: https://github.com/cockroachdb/cockroach/pull/46088
[#46167]: https://github.com/cockroachdb/cockroach/pull/46167
[#46219]: https://github.com/cockroachdb/cockroach/pull/46219
[#46272]: https://github.com/cockroachdb/cockroach/pull/46272
[#46452]: https://github.com/cockroachdb/cockroach/pull/46452
[#46477]: https://github.com/cockroachdb/cockroach/pull/46477
[#46478]: https://github.com/cockroachdb/cockroach/pull/46478
[#46479]: https://github.com/cockroachdb/cockroach/pull/46479
[#46482]: https://github.com/cockroachdb/cockroach/pull/46482
[#46483]: https://github.com/cockroachdb/cockroach/pull/46483
[#46486]: https://github.com/cockroachdb/cockroach/pull/46486
[#46495]: https://github.com/cockroachdb/cockroach/pull/46495
[#46506]: https://github.com/cockroachdb/cockroach/pull/46506
[#46537]: https://github.com/cockroachdb/cockroach/pull/46537
[#46538]: https://github.com/cockroachdb/cockroach/pull/46538
[#46539]: https://github.com/cockroachdb/cockroach/pull/46539
[#46544]: https://github.com/cockroachdb/cockroach/pull/46544
[#46564]: https://github.com/cockroachdb/cockroach/pull/46564
[#46578]: https://github.com/cockroachdb/cockroach/pull/46578
[#46622]: https://github.com/cockroachdb/cockroach/pull/46622
[#46635]: https://github.com/cockroachdb/cockroach/pull/46635
[#46648]: https://github.com/cockroachdb/cockroach/pull/46648
[#46667]: https://github.com/cockroachdb/cockroach/pull/46667
[#46805]: https://github.com/cockroachdb/cockroach/pull/46805
[#46807]: https://github.com/cockroachdb/cockroach/pull/46807
[#46833]: https://github.com/cockroachdb/cockroach/pull/46833
[#46837]: https://github.com/cockroachdb/cockroach/pull/46837
[#46894]: https://github.com/cockroachdb/cockroach/pull/46894
[#46904]: https://github.com/cockroachdb/cockroach/pull/46904
[#46910]: https://github.com/cockroachdb/cockroach/pull/46910
[#46950]: https://github.com/cockroachdb/cockroach/pull/46950
[#46971]: https://github.com/cockroachdb/cockroach/pull/46971
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.7 since v19.2.6.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to v19.2, see [Upgrade to CockroachDB v19.2](../v19.2/upgrade-cockroach-version.html)

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.7-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.7.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.7.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.7.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.7.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.7-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v19.2.7
~~~

<h3 id="v19.2.7-backward-incompatible-changes">Backward-incompatible changes</h3>

- Prior to this patch, the phase of server shutdown responsible for range lease transfers to other nodes would give up after 10000 attempts of transferring replica leases away, regardless of the value of `server.shutdown.lease_transfer_wait`. The limit of 10,000 attempts has been removed, so that now only the maximum duration `server.shutdown.lease_transfer_wait` applies. [#47691][#47691]
- The textual error and warning messages displayed by [`cockroach quit`](../v19.2/cockroach-quit.html) under various circumstances have been updated. The message `ok` still indicates that the operation has likely succeeded. [#47691][#47691]
- [`cockroach quit`](../v19.2/cockroach-quit.html) now prints out progress details on its standard error stream, even when `--logtostderr` is not specified. Previously, nothing was printed on standard error. Scripts that wish to ignore this output can redirect the standard error stream. [#47691][#47691]
- The copy of `system` and `crdb_internal` tables extracted by [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) is now written using the TSV format (inside the ZIP file), instead of an ASCII-art table as previously. [#48098][#48098]

<h3 id="v19.2.7-general-changes">General changes</h3>

- Prior to this patch, the phase of server shutdown responsible for range lease transfers to other nodes had a hard timeout of 5 seconds. This timeout is now configurable with the new [cluster setting](../v19.2/set-cluster-setting.html) `server.shutdown.lease_transfer_wait`. [#47691][#47691]

<h3 id="v19.2.7-sql-language-changes">SQL language changes</h3>

- Columns in the process of being added or removed to a table are now always set to their default or computed value if another transaction concurrently [inserts](../v19.2/insert.html), [updates](../v19.2/update.html), or [upserts](../v19.2/upsert.html) a row. This fixes an issue where a column being backfilled would not be properly set by concurrent transactions. [#47411][#47411]
- The `pg_collation`, `pg_proc`, and `pg_type` tables in `pg_catalog` no longer require privileges on any database in order for the data to be visible. [#48081][#48081]
- Histogram collection with [`CREATE STATISTICS`](../v19.2/create-statistics.html) is no longer supported on columns with type [`ARRAY`](../v19.2/array.html). Only row count, distinct count, and null count are collected for `ARRAY`-type columns. [#48344][#48344]
- CockroachDB now correctly reports the type length for the [`CHAR`](../v19.2/string.html) data type. [#48643][#48643]

<h3 id="v19.2.7-command-line-changes">Command-line changes</h3>

- The time that [`cockroach quit`](../v19.2/cockroach-quit.html) waits client-side for the node to drain (i.e., remove existing clients and push range leases away) is now configurable with the flag `--drain-wait`. The default value for `--drain-wait` is `10 minutes`. Note that separate server-side timeouts still apply. Check the `server.shutdown.*` [cluster settings](../v19.2/set-cluster-setting.html) for details. [#47691][#47691]
- It is now possible to drain a node without shutting down the process, using [`cockroach node drain`](../v19.2/cockroach-node.html). This makes it easier to integrate CockroachDB with service managers and orchestration. It is safe to issue `cockroach node drain` and then separately stop the service via a process manager or orchestrator. Without this new command, there is a risk of misconfiguring the service manager to auto-restart the node after it shuts down via [`cockroach quit`](../v19.2/cockroach-quit.html). `cockroach node drain` also recognizes the new `--drain-wait` flag. [#47691][#47691]
- The commands `cockroach quit` and `cockroach node drain` now report a "work remaining" metric on their standard error stream. The value reduces until it reaches 0 to indicate that the graceful shutdown has completed server-side. [#47691][#47691]
- To support clusters that have been configured to use a cluster name, client commands such as [`cockroach init`](../v19.2/cockroach-init.html) and [`cockroach quit`](../v19.2/cockroach-quit.html) now support the `--cluster-name` and `--disable-cluster-name-verification` flags. Previously it was impossible to run such commands against nodes configured with the `--cluster-name` flag. [#48017][#48017]
- [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) now properly skips over fully decommissioned nodes. [#48095][#48095]
- [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) now tries multiple times to retrieve data using SQL if it encounters retry errors. [#48098][#48098]
- [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) now supports two command-line parameters: `--nodes` and `--exclude-nodes`. When specified, they control which nodes are inspected when gathering the data. This makes it possible to focus on a group of nodes of interest in a large cluster, or to exclude nodes that `cockroach debug zip` would have trouble reaching otherwise. Both flags accept a list of individual node IDs or ranges of node IDs, e.g., `--nodes=1,10,13-15`. [#48098][#48098]

<h3 id="v19.2.7-bug-fixes">Bug fixes</h3>

- Previously, CockroachDB could incorrectly consider a non-`NULL` value from an interleaved parent table to be `NULL` when the interleaved child has a `NULL` value in the row with the corresponding index key. This bug has been fixed. [#47104][#47104]
- A data race on AST nodes for [`SELECT` statements](../v19.2/select-clause.html) that include a [`WINDOW` definition](../v19.2/window-functions.html#window-definitions) has been fixed. Previously, these queries could have returned incorrect results. [#47176][#47176]
- Previously, a panic could occur when [`SHOW RANGES`](../v19.2/show-ranges.html) or [`SHOW RANGE FOR ROW`](../v19.2/show-range-for-row.html) was called with a virtual table. This bug has been fixed. [#47516][#47516]
- Fixed incorrect results that could occur when casting negative intervals or timestamps to type decimal. [#47521][#47521]
- Previously, when the query was executed with the [row-by-row engine](../v19.2/vectorized-execution.html), CockroachDB could incorrectly return no output instead of returning a parsing error in queries with `count(*)`. This bug has been fixed. [#47486][#47486]
- Previously, CockroachDB incorrectly released the memory used in hash aggregation operations, which could lead to node crashes. This bug has been fixed. [#47519][#47519]
- Previously, [`PARTITION BY`](../v19.2/partition-by.html) and [`ORDER BY`](../v19.2/query-order.html) columns in window specifications lost qualifications when used inside [views](../v19.2/views.html). This bug has been fixed. [#47716][#47716]
- Fixed a bug where target column specifications in [`IMPORT INTO`](../v19.2/import-into.html) were ignored. [#47796][#47796]
- Columns named with reserved keywords and/or other special characters are now correctly handled. [#47796][#47796]
- CockroachDB will now avoid producing a severe "internal error" upon certain privilege check failures with `pg_catalog` [built-in functions](../v19.2/functions-and-operators.html). [#48243][#48243]
- Fixed a bug causing cascading [deletes](../v19.2/delete.html) to fail when deleting thousands of rows across interleaved tables. [#48287][#48287]
- Fixed a rare bug that could lead to data corruption or data loss if a replica was both the source of a snapshot, was being concurrently removed from the range, and if certain specific conditions exist inside RocksDB. [#48319][#48319]
- Fixed a rare bug where stats were not automatically generated for a new table. [#48028][#48028]
- Fixed a rare bug where stats refreshes could fail. CockroachDB now triggers stats refreshing after completing an [import](../v19.2/import.html) job, after the transaction finishes the [job](../v19.2/show-jobs.html) commits. [#48028][#48028]
- Fixed an error that occurred when statistics collection was explicitly requested on a column with type [`ARRAY`](../v19.2/array.html). [#48344][#48344]
- Fixed a rare bug causing a range to deadlock and all the writes to the respective range to timeout. [#48304][#48304]
- Fixed a bug causing HTTP requests to fail with error 503 "`transport: authentication handshake failed: io: read/write on closed pipe`" and continue failing until the node was restarted. [#48482][#48482]
- [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) can now successfully avoid out-of-memory errors when extracting very large `system` or `crdb_internal` tables. [#48098][#48098]
- [`cockroach debug zip`](../v19.2/cockroach-debug-zip.html) will now properly report an error if an error is encountered while writing the end of the output ZIP file. [#48098][#48098]
- Fixed a bug that caused vectorized queries on composite data types to occasionally return invalid data. [#48464][#48464]
- Previously, [`SHOW STATISTICS USING JSON`](../v19.2/show-statistics.html) output contained incorrect single quotes for strings with spaces inside histograms. This bug has been fixed. [#48545][#48545]
- Fixed a bug preventing [timestamps](../v19.2/timestamp.html) from being closed, which could result in failed follower reads or failure to observe resolved timestamps in [changefeeds](../v19.2/changefeed-for.html). [#48683][#48683]
- Fixed a bug that falsely indicated that `kv.closed_timestamp.max_behind_nanos` was almost always growing. [#48690][#48690]
- CockroachDB now prevents [dropping databases](../v19.2/drop-database.html) that contain tables that are currently offline due to [`IMPORT`](../v19.2/import.html) or [`RESTORE`](../v19.2/restore.html). Previously, dropping a database in this state could lead to a corrupted schema, which prevented running backups. [#48612][#48612]
- Fixed a bug that caused [`cockroach dump`](../v19.2/cockroach-dump.html) to erroneously include an additional [`CREATE UNIQUE INDEX "primary" ... INTERLEAVE IN PARENT`](../v19.2/create-index.html) statement in the dump output on tables with interleaved primary keys. This bug made it impossible to re-import dumped data without manual editing. [#48777][#48777]
- Fixed a bug that caused [`SHOW CREATE`](../v19.2/show-create.html) statements to sometimes show a [partitioning](../v19.2/partitioning.html) step for an index that was previously dropped. [#48767][#48767]
- Fixed a bug that caused [changefeeds](../v19.2/create-changefeed.html) that were created with a cursor, and that encounter a retryable error before writing their first checkpoint, to perform full-table backfills upon restart. [#48752][#48752]
- Fixed a bug that could cause canceled [changefeeds](../v19.2/create-changefeed.html) to not stop. [#48752][#48752]

<h3 id="v19.2.7-performance-improvements">Performance improvements</h3>

- Fixed a bug in the histogram filtering logic of [the optimizer](../v19.2/cost-based-optimizer.html) which was causing inaccurate cardinality estimates for queries with equality predicates on [UUIDs](../v19.2/uuid.html) and [strings](../v19.2/string.html), as well as some other types. This bug has existed since histograms were first introduced into the optimizer in the v19.2.0 release. Fixing it improves the optimizer's cardinality estimates and results in better query plans in some cases. [#48625][#48625]
- Histograms used by the optimizer for query planning now have more accurate row counts per histogram bucket, particularly for columns that have many `NULL` values. This results in better plans in some cases. [#48645][#48645]
- Fixed a performance inefficiency in the [vectorized execution engine](../v19.2/vectorized-execution.html). This fix speeds up all queries that are executed with the vectorized engine, with most noticeable gains on the queries that output many rows. [#48733][#48733]

<h3 id="v19.2.7-contributors">Contributors</h3>

This release includes 47 merged PRs by 21 authors.
We would like to thank the following contributors from the CockroachDB community:

- Artem Barger (first-time contributor)
- Jason Brown (first-time contributor)

[#47104]: https://github.com/cockroachdb/cockroach/pull/47104
[#47176]: https://github.com/cockroachdb/cockroach/pull/47176
[#47411]: https://github.com/cockroachdb/cockroach/pull/47411
[#47486]: https://github.com/cockroachdb/cockroach/pull/47486
[#47516]: https://github.com/cockroachdb/cockroach/pull/47516
[#47519]: https://github.com/cockroachdb/cockroach/pull/47519
[#47521]: https://github.com/cockroachdb/cockroach/pull/47521
[#47665]: https://github.com/cockroachdb/cockroach/pull/47665
[#47691]: https://github.com/cockroachdb/cockroach/pull/47691
[#47716]: https://github.com/cockroachdb/cockroach/pull/47716
[#47796]: https://github.com/cockroachdb/cockroach/pull/47796
[#48017]: https://github.com/cockroachdb/cockroach/pull/48017
[#48028]: https://github.com/cockroachdb/cockroach/pull/48028
[#48081]: https://github.com/cockroachdb/cockroach/pull/48081
[#48095]: https://github.com/cockroachdb/cockroach/pull/48095
[#48098]: https://github.com/cockroachdb/cockroach/pull/48098
[#48243]: https://github.com/cockroachdb/cockroach/pull/48243
[#48287]: https://github.com/cockroachdb/cockroach/pull/48287
[#48304]: https://github.com/cockroachdb/cockroach/pull/48304
[#48319]: https://github.com/cockroachdb/cockroach/pull/48319
[#48344]: https://github.com/cockroachdb/cockroach/pull/48344
[#48464]: https://github.com/cockroachdb/cockroach/pull/48464
[#48482]: https://github.com/cockroachdb/cockroach/pull/48482
[#48545]: https://github.com/cockroachdb/cockroach/pull/48545
[#48612]: https://github.com/cockroachdb/cockroach/pull/48612
[#48625]: https://github.com/cockroachdb/cockroach/pull/48625
[#48643]: https://github.com/cockroachdb/cockroach/pull/48643
[#48645]: https://github.com/cockroachdb/cockroach/pull/48645
[#48683]: https://github.com/cockroachdb/cockroach/pull/48683
[#48690]: https://github.com/cockroachdb/cockroach/pull/48690
[#48733]: https://github.com/cockroachdb/cockroach/pull/48733
[#48752]: https://github.com/cockroachdb/cockroach/pull/48752
[#48767]: https://github.com/cockroachdb/cockroach/pull/48767
[#48777]: https://github.com/cockroachdb/cockroach/pull/48777
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.8 since v19.2.7.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to the latest production release of CockroachDB, see this [article](../{{site.versions["stable"]}}/upgrade-cockroach-version.html).

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.8-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.8.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.8.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.8.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.8.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.8-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.8
~~~

<h3 id="v19.2.8-security-updates">Security updates</h3>

- HTTP endpoints beginning with `/debug/` now require a valid [`admin`](../v19.2/authorization.html) login session. [#50489][#50489]

<h3 id="v19.2.8-sql-language-changes">SQL language changes</h3>

- The `pg_database` table in `pg_catalog` no longer requires privileges on any database in order for the data to be visible. [#48766][#48766]

<h3 id="v19.2.8-bug-fixes">Bug fixes</h3>

- Fixed a bug where [`cockroach dump`](../v19.2/cockroach-dump.html) on a table with collated strings would omit the collation clause for the data insertion statements. [#48833][#48833]
- Manually writing a `NULL` value into the `system.users` table for the "hashedPassword" column will no longer cause a server crash during user authentication. [#48837][#48837]
- Fixed a memory leak which could affect [changefeeds](../v19.2/change-data-capture.html) performing scans of large tables. [#49162][#49162]
- Previously, when the value passed to `--drain-wait` was very small, but non-zero, [`cockroach quit`](../v19.2/cockroach-quit.html) in certain cases would not proceed to perform a hard shutdown. This has been corrected. This bug was present in v19.1.9, v19.2.7, and v20.1.1. [#49364][#49364]
- Previously, some benign errors were reported as unexpected internal errors by the [vectorized execution engine](../v19.2/vectorized-execution.html). This is now fixed. [#49535][#49535]
- Fixed a bug causing file descriptors to be leaked during GSS authentication. [#49655][#49655]
- Casting to width-limited strings now works correctly for strings containing Unicode characters. [#50160][#50160]
- Fixed cases in which casting a string to a width-limited string array was not truncating the string. [#50169][#50169]
- Fixed a RocksDB bug that could result in inconsistencies in rare circumstances. [#50498][#50498]

<h3 id="v19.2.8-performance-improvements">Performance improvements</h3>

- Improved the [optimizer](../v19.2/cost-based-optimizer.html)'s estimation of the selectivity of some filters involving a disjunction (`OR`) of predicates over multiple columns. This results in more accurate cardinality estimation and enables the optimizer to choose better query plans in some cases. [#50473][#50473]

<h3 id="v19.2.8-build-changes">Build changes</h3>

- Release Docker images are now built on Debian 9.12. [#50481][#50481]

<h3 id="v19.2.8-doc-updates">Doc updates</h3>

- Updated guidance on [node decommissioning](../v19.2/remove-nodes.html). [#7304][#7304]
- Renamed "whitelist/blacklist" terminology to "allowlist/blocklist". [#7535][#7535]
- Updated the Releases navigation in the sidebar to expose the latest Production and Testing releases. [#7550][#7550]
- Fixed scrollbar visibility on Chrome. [#7487][#7487]

<h3 id="v19.2.8-contributors">Contributors</h3>

This release includes 19 merged PRs by 16 authors.
We would like to thank the following contributors from the CockroachDB community:

- Drew Kimball (first-time contributor, CockroachDB team member)
- Jackson Owens (first-time contributor, CockroachDB team member)
- James H. Linder (first-time contributor, CockroachDB team member)

[#48766]: https://github.com/cockroachdb/cockroach/pull/48766
[#48833]: https://github.com/cockroachdb/cockroach/pull/48833
[#48837]: https://github.com/cockroachdb/cockroach/pull/48837
[#49162]: https://github.com/cockroachdb/cockroach/pull/49162
[#49364]: https://github.com/cockroachdb/cockroach/pull/49364
[#49535]: https://github.com/cockroachdb/cockroach/pull/49535
[#49655]: https://github.com/cockroachdb/cockroach/pull/49655
[#50160]: https://github.com/cockroachdb/cockroach/pull/50160
[#50169]: https://github.com/cockroachdb/cockroach/pull/50169
[#50473]: https://github.com/cockroachdb/cockroach/pull/50473
[#50481]: https://github.com/cockroachdb/cockroach/pull/50481
[#50489]: https://github.com/cockroachdb/cockroach/pull/50489
[#50498]: https://github.com/cockroachdb/cockroach/pull/50498
[#7304]: https://github.com/cockroachdb/docs/pull/7304
[#7550]: https://github.com/cockroachdb/docs/pull/7550
[#7535]: https://github.com/cockroachdb/docs/pull/7535
[#7487]: https://github.com/cockroachdb/docs/pull/7487
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

This page lists additions and changes in v19.2.9 since v19.2.8.

- For a comprehensive summary of features in v19.2, see the [v19.2 GA release notes](v19.2.0.html).
- To upgrade to the latest production release of CockroachDB, see this [article](../{{site.versions["stable"]}}/upgrade-cockroach-version.html).

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{{site.data.alerts.callout_danger}}
{% include /v19.2/alerts/warning-a63162.md %}
{{site.data.alerts.end}}

<h3 id="v19.2.9-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.9.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.9.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.9.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v19.2.9.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v19.2.9-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~ shell
$ docker pull cockroachdb/cockroach-unstable:v19.2.9
~~~

<h3 id="v19.2.9-general-changes">General changes</h3>

- [Schema changes](../v19.2/online-schema-changes.html) are now logged in greater detail. [#50375][#50375]

<h3 id="v19.2.9-bug-fixes">Bug fixes</h3>

- Fixed a bug that occurred during [incremental backups](../v19.2/backup.html#incremental-backups) with revision history on a database (or full cluster) when a table in the database being backed up was dropped. When other tables were later created, dropped, or altered, future incremental backups would return an error. [#50208][#50208]
- Fixed a bug in [`TRUNCATE`](../v19.2/truncate.html) that could leave tables in a state where they could not be renamed. [#50714][#50714] [#50756][#50756]#50756]

<h3 id="v19.2.9-contributors">Contributors</h3>

This release includes 4 merged PRs by 3 authors.

[#50208]: https://github.com/cockroachdb/cockroach/pull/50208
[#50375]: https://github.com/cockroachdb/cockroach/pull/50375
[#50714]: https://github.com/cockroachdb/cockroach/pull/50714
[#50756]: https://github.com/cockroachdb/cockroach/pull/50756
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v20.1/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

<h3 id="v20.1.0-alpha.20191118-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha.20191118.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha.20191118.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha.20191118.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha.20191118.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v20.1.0-alpha.20191118-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v20.1.0-alpha.20191118
~~~

<h3 id="v20.1.0-alpha.20191118-general-changes">General changes</h3>

- Guidance on [how to contribute to CockroachDB](https://cockroachlabs.atlassian.net/wiki/x/QQFdB) has been moved to the public wiki at [wiki.crdb.io](https://cockroachlabs.atlassian.net/wiki/). [#41542][#41542]
- Removed the `kv.bulk_io_write.addsstable_max_rate` [cluster setting](../v20.1/cluster-settings.html). [#41745][#41745] {% comment %}doc{% endcomment %}
- Improved the consistency checker's log output. [#41893][#41893]
- When the replicas within a range are found to be corrupted, the outliers will be terminated. Previously, the leaseholder replica would terminate, regardless of which replicas disagreed with each other. This is expected to curb the spread of corrupted data better than the previous approach. [#41902][#41902]

<h3 id="v20.1.0-alpha.20191118-backward-incompatible-changes">Backward-incompatible changes</h3>

- The `extract()` [built-in function](../v20.1/functions-and-operators.html) with sub-second arguments (millisecond, microsecond) is now Postgres-compatible, and will return the total number of seconds in addition to sub-seconds. Anyone who was previously relying on `extract()` to return only sub-second data will need to adjust their applications. [#41069][#41069] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-alpha.20191118-enterprise-edition-changes">Enterprise edition changes</h3>

- [`IMPORT`](../v20.1/import.html) statements now support specifying CSV filenames using wildcard characters. This behavior can be disabled with the `WITH disabled_glob_matching` option. [#40714][#40714] {% comment %}doc{% endcomment %}
- When using a `nodelocal` file URL for [`IMPORT`](../v20.1/import.html)/[`BACKUP`](../v20.1/backup.html)/[`RESTORE`](../v20.1/restore.html)/[`EXPORT`](../v20.1/export.html), you can now specify which node's local file system to use by including the node's ID in the URL: `nodelocal://<nodeID>/path/file.csv`. [#41990][#41990] {% comment %}doc{% endcomment %}
- Added the new `WITH experimental_save_rejected` option for skipping faulty rows during `IMPORT`, saving the faulty rows in a file called `<original_csv_file>.rejected`. After fixing the problems in this file, you can use it with `IMPORT INTO`. [#41430][#41430] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-alpha.20191118-sql-language-changes">SQL language changes</h3>

- The `extract()` [built-in function](../v20.1/functions-and-operators.html) now supports millennium, century, decade, isoyear, isodow, and julian for `DATE`, `TIMESTAMP`, and `TIMESTAMPTZ`. The `date_trunct()` function now supports millennium, century, and decade for `DATE`, `TIMESTAMP`, and `TIMESTAMPTZ`. [#41784][#41784] {% comment %}doc{% endcomment %}
- `extract()` now supports a string constant as element argument. [#41429][#41429]
- Added support for the `JOIN LATERAL` syntax. [#40945][#40945] {% comment %}doc{% endcomment %}
- Added support for `WITH RECURSIVE` with `UNION ALL`. [#41368][#41368] {% comment %}doc{% endcomment %}
- Added support for `bit_and()` and `bit_or()` aggregate functions. [#41334][#41334] {% comment %}doc{% endcomment %}
- `NULL` values are now allowed to be among tuples when being compared against a tuple. [#40298][#40298]
- Added syntax-only support for `ORDER BY ... NULLS FIRST | LAST`. [#41544][#41544] {% comment %}doc{% endcomment %}
- Comments can now be associated to indexes with `COMMENT ON INDEX` and can be checked with `SHOW INDEXES FROM ... WITH COMMENT`. [#41555][#41555] {% comment %}doc{% endcomment %}
- `SELECT` and `HAVING` can now refer to ungrouped columns when the grouped columns contain the primary key of the table containing the ungrouped columns. [#41732][#41732] {% comment %}doc{% endcomment %}
- Dropping a unique index that was created via `CREATE UNIQUE INDEX` statement no longer requires the `CASCADE` option. [#42001][#42001] {% comment %}doc{% endcomment %}
- Added the `pg_prepared_statements` table. [#42018][#42018]

<h3 id="v20.1.0-alpha.20191118-command-line-changes">Command-line changes</h3>

- The new `--storage-engine` flag for [`cockroach start`](../v20.1/cockroach-start.html), and equivalent `COCKROACH_STORAGE_ENGINE` environment variable, specify the type of storage engine a node should use. Options are `rocksdb` (default) and `pebble`. [#41453][#41453] {% comment %}doc{% endcomment %}
- Enhanced the error message produced by [`cockroach init`](../v20.1/cockroach-init.html) when it encounters an already-initialized cluster to recommend adding `--join` to the `cockroach start` commands. [#42318][#42318]

<h3 id="v20.1.0-alpha.20191118-bug-fixes">Bug fixes</h3>

- The Admin UI no longer mixes unit sizes in timeseries graph tooltips. [#40970][#40970]
- The `pg_collation_for()` function now correctly quotes its output. [#41545][#41545]
- Fixed an internal error when subqueries are used in arguments to commands like `SET`. [#41581][#41581]
- CockroachDB now properly emits the cluster ID, once known, to all secondary log files (SQL audit logging, statement execution logging, and RocksDB events) and properly removes excess secondary log files. [#40993][#40993]
- Other callers to `acquireNodeLease` will not get erroneously cancelled just because the context of the first caller was cancelled. [#41785][#41785]
- Vectorized execution no longer errors when adding an ordinality column to an expression with a limit. For example, `SELECT * FROM (SELECT * FROM foo LIMIT 1) WITH ORDINALITY` no longer throws an index out of range error. [#41782][#41782]
- Fixed a bug causing rare crashes when using built-in functions. [#41970][#41970]
- The `date_trunc()` function now correctly considers timezones for `TIMESTAMPTZ` and `DATE` types. [#42006][#42006]
- Fixed a bug causing `CREATE TABLE AS` statements to fail with the message "unexpected concurrency for a flow that was forced to be planned locally". [#42013][#42013]
- Fixed a bug where `SHOW ZONE CONFIGURATION` and `crdb_internal.zones` would show results for resources the user does not have permission to view. [#42066][#42066], [#42080][#42080]
- Fixed a bug during planning for some queries that could cause an infinite loop and prevent the query from being cancelled. [#42082][#42082]
- Fixed a bug that caused jobs for dropping tables to report an inaccurate status. [#42121][#42121]
- Fixed a bug where rapid network disconnections could lead to cluster unavailability. [#41533][#41533]
- Fixed a stack overflow that could occur with certain patterns of queries. [#41984][#41984]
- Fixed some casts from `OID` to `TEXT`. [#41928][#41928]
- Fixed a bug where some cluster setting changes were not reflected during currently running `IMPORT`s. [#42268][#42268]
- Fixed bugs where: `<date>:date` would result in the previous day (`<date-1>::date>`) when context local timestamp is set and the timezone is less than UTC+00:00; `date_trunc()` for `TIMESTAMP` would produce incorrect results if a local timezone was set; and `date_trunc()` for `DATE` would produce an incorrect negative timezone offset in a local timezone. [#42267][#42267]
- Casting `TIMESTAMPTZ` data to the `TIME` type NOW properly respects time zone information. [#42269][#42269]
- Fixed a crash when using `EXPLAIN (VEC)` on some index joins. [#40897][#40897]

<h3 id="v20.1.0-alpha.20191118-performance-improvements">Performance improvements</h3>

- Improved performance for some join queries due to improved filter inference during query planning. [#41250][#41250]
- Improved statistics estimation during query planning for columns with many `NULL` values. [#41520][#41520]
- The `cockroach debug check-store` command is now faster. [#41805][#41805]
- Improved the low-level performance of short range reverse scans. [#42092][#42092]
- Individual response messages in a response batch no longer each contain information about transaction state changes. [#42139][#42139]
- `BACKUP` work is now more evenly spread across clusters that have non-uniform leaseholder distributions. [#42274][#42274]

<h3 id="v20.1.0-alpha.20191118-contributors">Contributors</h3>

This release includes 376 merged PRs by 48 authors. We would like to thank the following contributors from the CockroachDB community:

- Aayush Shah (first-time contributor)
- Andrea Sosso (first-time contributor)
- Arber Avdullahu (first-time contributor)
- Elliot Courant
- George Papadrosou
- Roga Pria Sembada (first-time contributor)
- Salvatore Tomaselli (first-time contributor)
- lzhfromustc (first-time contributor)
- sumeerbhola (first-time contributor)

[#40298]: https://github.com/cockroachdb/cockroach/pull/40298
[#40714]: https://github.com/cockroachdb/cockroach/pull/40714
[#40897]: https://github.com/cockroachdb/cockroach/pull/40897
[#40945]: https://github.com/cockroachdb/cockroach/pull/40945
[#40970]: https://github.com/cockroachdb/cockroach/pull/40970
[#40993]: https://github.com/cockroachdb/cockroach/pull/40993
[#41069]: https://github.com/cockroachdb/cockroach/pull/41069
[#41250]: https://github.com/cockroachdb/cockroach/pull/41250
[#41334]: https://github.com/cockroachdb/cockroach/pull/41334
[#41368]: https://github.com/cockroachdb/cockroach/pull/41368
[#41429]: https://github.com/cockroachdb/cockroach/pull/41429
[#41430]: https://github.com/cockroachdb/cockroach/pull/41430
[#41435]: https://github.com/cockroachdb/cockroach/pull/41435
[#41453]: https://github.com/cockroachdb/cockroach/pull/41453
[#41520]: https://github.com/cockroachdb/cockroach/pull/41520
[#41533]: https://github.com/cockroachdb/cockroach/pull/41533
[#41542]: https://github.com/cockroachdb/cockroach/pull/41542
[#41544]: https://github.com/cockroachdb/cockroach/pull/41544
[#41545]: https://github.com/cockroachdb/cockroach/pull/41545
[#41555]: https://github.com/cockroachdb/cockroach/pull/41555
[#41581]: https://github.com/cockroachdb/cockroach/pull/41581
[#41732]: https://github.com/cockroachdb/cockroach/pull/41732
[#41745]: https://github.com/cockroachdb/cockroach/pull/41745
[#41782]: https://github.com/cockroachdb/cockroach/pull/41782
[#41784]: https://github.com/cockroachdb/cockroach/pull/41784
[#41785]: https://github.com/cockroachdb/cockroach/pull/41785
[#41799]: https://github.com/cockroachdb/cockroach/pull/41799
[#41805]: https://github.com/cockroachdb/cockroach/pull/41805
[#41893]: https://github.com/cockroachdb/cockroach/pull/41893
[#41896]: https://github.com/cockroachdb/cockroach/pull/41896
[#41902]: https://github.com/cockroachdb/cockroach/pull/41902
[#41920]: https://github.com/cockroachdb/cockroach/pull/41920
[#41928]: https://github.com/cockroachdb/cockroach/pull/41928
[#41939]: https://github.com/cockroachdb/cockroach/pull/41939
[#41950]: https://github.com/cockroachdb/cockroach/pull/41950
[#41956]: https://github.com/cockroachdb/cockroach/pull/41956
[#41970]: https://github.com/cockroachdb/cockroach/pull/41970
[#41975]: https://github.com/cockroachdb/cockroach/pull/41975
[#41981]: https://github.com/cockroachdb/cockroach/pull/41981
[#41984]: https://github.com/cockroachdb/cockroach/pull/41984
[#41990]: https://github.com/cockroachdb/cockroach/pull/41990
[#42001]: https://github.com/cockroachdb/cockroach/pull/42001
[#42006]: https://github.com/cockroachdb/cockroach/pull/42006
[#42013]: https://github.com/cockroachdb/cockroach/pull/42013
[#42018]: https://github.com/cockroachdb/cockroach/pull/42018
[#42036]: https://github.com/cockroachdb/cockroach/pull/42036
[#42066]: https://github.com/cockroachdb/cockroach/pull/42066
[#42075]: https://github.com/cockroachdb/cockroach/pull/42075
[#42080]: https://github.com/cockroachdb/cockroach/pull/42080
[#42082]: https://github.com/cockroachdb/cockroach/pull/42082
[#42092]: https://github.com/cockroachdb/cockroach/pull/42092
[#42112]: https://github.com/cockroachdb/cockroach/pull/42112
[#42113]: https://github.com/cockroachdb/cockroach/pull/42113
[#42121]: https://github.com/cockroachdb/cockroach/pull/42121
[#42139]: https://github.com/cockroachdb/cockroach/pull/42139
[#42185]: https://github.com/cockroachdb/cockroach/pull/42185
[#42238]: https://github.com/cockroachdb/cockroach/pull/42238
[#42267]: https://github.com/cockroachdb/cockroach/pull/42267
[#42268]: https://github.com/cockroachdb/cockroach/pull/42268
[#42269]: https://github.com/cockroachdb/cockroach/pull/42269
[#42274]: https://github.com/cockroachdb/cockroach/pull/42274
[#42282]: https://github.com/cockroachdb/cockroach/pull/42282
[#42318]: https://github.com/cockroachdb/cockroach/pull/42318
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v20.1/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

In addition to security updates and various enhancements and bug fixes, this v20.1 alpha release includes some major highlights:

- **Cluster backup:** You can now use CockroachDB's [Enterprise `BACKUP`](../v20.1/backup.html) feature to back up an entire cluster's data, including configuration and system information such as user privileges, zone configurations, and cluster settings. At this time, you can restore individual databases and tables from a cluster backup. In a future release, you'll be able to restore an entire cluster as well.       
- **Fresher follower reads:** [Follower reads](../v20.1/follower-reads.html) are now available for reads at least 4.8 seconds in the past, a much shorter window than the previous 48 seconds.
- **Import from Avro format**: You can now use the [`IMPORT`](../v20.1/import.html) and [`IMPORT INTO`](../v20.1/import-into.html) statements to bulk import SQL data from Avro files. This makes it easier to migrate from systems like Spanner that export data in the Avro format.
- **Vectorized execution for `TIMESTAMPTZ`**: [Vectorized execution](../v20.1/vectorized-execution.html) now supports the `TIMESTAMPTZ` data type in addition to several other previously [supported data types](../v20.1/data-types.html).
- **CockroachDB backend for Django**: Developers using the Django framework can now leverage the `django-cockroachdb` adapter to [run their Python apps on CockroachDB](../v20.1/build-a-python-app-with-cockroachdb-django.html).

<h3 id="v20.1.0-alpha.20200123-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha.20200123.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha.20200123.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha.20200123.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha.20200123.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v20.1.0-alpha.20200123-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v20.1.0-alpha.20200123
~~~

<h3 id="v20.1.0-alpha.20200123-security-updates">Security updates</h3>

- The authentication code for new SQL connections has been simplified to always use the HBA configuration defined per `server.host_based_authentication.configuration`. The format of this file generally follows that of [`pg_hba.conf`](https://www.postgresql.org/docs/current/auth-pg-hba-conf.html). This behavior remains equivalent to previous CockroachDB versions, and this change is only discussed here for clarity:

    Upon each configuration change, CockroachDB automatically inserts the entry `host all root all cert` as a first rule, to ensure the root user can always log in with a valid client certificate.

    If the configuration is set to empty or found to be invalid in the cluster setting, the following default configuration is automatically used:

    ~~~
    host all root all cert
    host all all  all cert-password
    ~~~

    At any moment the current configuration on each node can be inspected using the `/debug/hba_conf` URL on the HTTP endpoint. The list of valid [authentication](../v20.1/authentication.html) methods is currently:

    - `cert`, for certificate-based authentication over an SSL connection
    exclusively
    - `cert-password`, which allows either cert-based or password-based
    authentication over an SSL connection
    - `password` for password-based authentication over an SSL connection
    - `gss` for Kerberos-based authentication over an SSL connection,
    enabled when running a CCL binary and an Enterprise license

    In effect, CockroachDB treats all the `host` rules as `hostssl` and behaves as per a default of `hostnossl all all all reject`.

    It is not currently possible to define authentication rules over non-SSL connections. As of this writing, non-SSL connections are only possible when running with `--insecure`, and on insecure nodes all the authentication logic is entirely disabled. [#43726][#43726]

- CockroachDB now supports the [authentication](../v20.1/authentication.html) methods `'trust'` and `'reject'` in the [cluster setting](../v20.1/cluster-settings.html) `server.host_based_authentication.configuration`. They are used to unconditionally allow and deny matching connection attempts. [#43731][#43731]
- Users [`GRANT`ing](../v20.1/grant.html) and [`REVOKE`ing](../v20.1/revoke.html) admin roles must be members of the admin role with `ADMIN OPTION`. This check was previously bypassed. [#41218][#41218]
- Fixed a bug in the parsing logic for `server.host_based_authentication.configuration`, where both single-character strings, and quoted strings containing spaces and separated by commas were not properly parsed. This would cause rules for usernames consisting of a single character or usernames containing spaces to apply improperly. [#43713][#43713]

<h3 id="v20.1.0-alpha.20200123-general-changes">General changes</h3>

- Added system tables `system.protected_ts_meta` and `system.protected_ts_records` to support the implementation of [protected timestamps](https://github.com/cockroachdb/cockroach/blob/master/docs/RFCS/20191009_gc_protected_timestamps.md), a subsystem used to ensure that data required for long-running jobs is not garbage collected. [#42829][#42829]

<h3 id="v20.1.0-alpha.20200123-enterprise-edition-changes">Enterprise edition changes</h3>

- Shortened the default interval for the `kv.closed_timestamp.target_duration` [cluster setting](../v20.1/cluster-settings.html) from `30s` to `3s`, which allows for follower reads at 4.8 seconds in the past rather than the previous 48 seconds. [#43147][#43147]
- CockroachDB now supports [importing](../v20.1/import.html) Avro data. [#43104][#43104]
- Importing data into CockroachDB from external HTTP servers is now more resilient to connection interruption. [#43374][#43374] [#43558][#43558]
- Added `BACKUP TO <location>`, which allows you to [backup](../v20.1/backup.html) all relevant system tables as well as all user data in a cluster. [#43767][#43767]

<h3 id="v20.1.0-alpha.20200123-sql-language-changes">SQL language changes</h3>

- CockroachDB now provides a link to the relevant GitHub issue when clients attempt to use certain features that are not yet implemented. [#42847][#42847]
- [Vectorized queries](../v20.1/vectorized-execution.html) that execute only on supported types (even if those types form part of a table with unsupported types) are now run through the vectorized engine. This would previously fall back to the row-by-row execution engine. [#42616][#42616]
- CockroachDB now allows stored columns in [secondary indexes](../v20.1/indexes.html) to respect the [column family](../v20.1/column-families.html) table definitions that they are based on. [#42073][#42073]
- The error message reported when a client specifies a bulk I/O operation that uses an incompatible SQL function or operator now avoids the confusing and inaccurate term "backfill". This error is also now reported with code `22C01`. [#42941][#42941]
- The `CURRENT_TIME` [function](../v20.1/functions-and-operators.html) was added, which can be used with precision, e.g., `SELECT CURRENT_TIME, CURRENT_TIME(3)`. [#42928][#42928]
- `CREATE TABLE pg_temp.abc(a int)` now creates a temporary table. See [temp tables RFC](https://github.com/cockroachdb/cockroach/blob/master/docs/RFCS/20191009_temp_tables.md) (guide-level explanation) for more details about the search path semantics. [#41977][#41977]
- A new boolean column `'is_inverted'` has been added to `crdb_internal.table_indexes` virtual table which indicates whether the [index](../v20.1/indexes.html) is inverted or not. [#43102][#43102]
- The output of [`EXPLAIN`](../v20.1/explain.html) now shows [joins](../v20.1/joins.html) where there are no equality columns as "cross" instead of "hash". Cross joins can be very expensive and should be avoided. [#43061][#43061]
- The error code for [backups](../v20.1/backup.html), which would overwrite files, changed from class 58 (`"system"`) to class 42 (`"Syntax or Access Rule Violation"`). [#43221][#43221]
- CockroachDB now allows the usage of `TIMETZ` throughout the cluster. [#43023][#43023]
- Column types are now be displayed in the box for the input synchronizer in the flow diagram obtained via [`EXPLAIN (DISTSQL, TYPES)`](../v20.1/explain.html). [#43193][#43193]
- CockroachDB now supports [interval types](../v20.1/interval.html) with precision (e.g., `INTERVAL(5)`, `INTERVAL SECOND(5)`), and storing intervals with duration fields (e.g., `INTERVAL x TO y`). [#43130][#43130]
- When a session that has created temporary tables exits gracefully, the tables and temporary schema are now deleted automatically. [#42742][#42742]
- [Foreign key](../v20.1/foreign-key.html) checks that do not involve cascades are now performed after the mutation is complete, allowing self-referential foreign keys, or referential cycles. The execution plans for foreign key checks are now driven by the [optimizer](../v20.1/cost-based-optimizer.html), which can make better planning decisions. In particular, if there is a suitable duplicated index, the one in the current locality will be used for foreign key checks. [#43263][#43263]
- Better estimates for the number of rows needed by [`SELECT`](../v20.1/select-clause.html) and [`DISTINCT`](../v20.1/select-clause.html#select-distinct-rows) operations may now result in faster queries when the results of these queries are limited (e.g., `SELECT DISTINCT * FROM t LIMIT 10`). [#42895][#42895]
- `MINUTE TO SECOND` is now parsed as `MM:SS` instead of `HH:MM`. Additionally, [interval syntax](../v20.1/interval.html), such as `INTERVAL "01:02.123"`, is now parsed correctly as `MM:SS.fff`. This matches Postgres behavior. [#43292][#43292]
- Previously, CockroachDB returned error code `42830` and `23503` for duplicate [foreign key](../v20.1/foreign-key.html) names. It now returns `42710`, which matches Postgres. [#43210][#43210]
- Clients can now retrieve system user information from the `pg_authid` virtual table, which is Postgres-compatible. [#43437][#43437]
- The [optimizer](../v20.1/cost-based-optimizer.html) can now derive constant [computed columns](../v20.1/computed-columns.html) during [index](../v20.1/indexes.html) selection. This enables more efficient `HASH` indexes. [#43450][#43450]
- [Vectorized engine](../v20.1/vectorized-execution.html) now supports the [`TIMESTAMPTZ`](../v20.1/timestamp.html) data type. [#43514][#43514]
- CockroachDB now provides more descriptive error messages and an error hint when an unsupported rule is provided via `server.host_based_authentication.configuration`. [#43711][#43711] [#43710][#43710]
- Added an experimental prototype for altering the [primary key](../v20.1/primary-key.html) of a table. [#42462][#42462]

<h3 id="v20.1.0-alpha.20200123-command-line-changes">Command-line changes</h3>

- Added a `nodelocal` command that can be used to upload file: `cockroach nodelocal upload location/of/file destination/of/file`. [#42966][#42966]
- The `table` format, used to display the results of CLI shell queries, has been updated. [#43728][#43728]
- Telemetry is now recorded for whenever the command [`cockroach demo`](../v20.1/cockroach-demo.html) is used. [#43795][#43795]

<h3 id="v20.1.0-alpha.20200123-admin-ui-changes">Admin UI changes</h3>

- Added page search and pagination to the [Statements page](../v20.1/admin-ui-statements-page.html). [#41641][#41641]
- A graph of changefeed restarts due to retryable errors is now included in the [Admin UI](../v20.1/admin-ui-debug-pages.html). [#43213][#43213]

<h3 id="v20.1.0-alpha.20200123-bug-fixes">Bug fixes</h3>

- Fixed a bug that caused some jobs to be left indefinitely in a pending state and never run. [#42880][#42880]
- Fixed the row count estimate during query planning for some queries with multiple predicates where the selectivity of one predicate was calculated using a histogram. [#42916][#42916]
- CockroachDB now more reliably produces an error message when a client mistakenly uses a directory name instead of a file name with `nodelocal://` in bulk I/O operations. [#42542][#42542]
- Fixed a bug where an error would occur when trying to export data using a `nodelocal://` URL. CockroachDB now properly handles cases where the system's temporary directory lives on a different filesystem from the external I/O directory. [#42542][#42542]
- CockroachDB now avoids using `$TMPDIR` (often set `/tmp`) during bulk I/O operations. This prevents errors occurring when the `$TMPDIR` disk capacity is small compared to the configured external I/O directory. [#42542][#42542]
- Temporary files created during certain bulk I/O operations are now properly deleted when an error occurs. This prevents left-over temporary files being retained in the system and leaking disk usage over time. [#42542][#42542]
- Empty [arrays](../v20.1/array.html) are now correctly encoded and decoded over the binary protocol. [#42949][#42949]
- CockroachDB now ensures that databases being [restored](../v20.1/restore.html) are dropped if the `RESTORE` is canceled or fails. [#42946][#42946]
- Fixed a bug with some existing caching issues surrounding [role](../v20.1/authorization.html#create-and-manage-roles) memberships, where users could see out-of-date role membership information. [#42998][#42998]
- Fixed a bug where scanning an [index](../v20.1/indexes.html) of an unsupported type with the vectorized engine would lead to an internal error. [#42999][#42999]
- Fixed a bug where comparisons between [`DATE`](../v20.1/date.html) and [`TIMESTAMP`](../v20.1/timestamp.html) vs. [`TIMESTAMPTZ`](../v20.1/timestamp.html) broke because CockroachDB tried to normalize the `TIMESTAMPTZ` to UTC. CockroachDB now  converts the `DATE` and `TIMESTAMP` to the `context` timezone and compares the `TIMESTAMPTZ` without altering its timezone. [#42927][#42927]
- Previously, CockroachDB did not handle `date` casts from `timestamp`/`timestamptz` with time attached to it for times before the unix epoch correctly. For example, `'1969-12-30 01:00:00'::timestamp` would round to `'1969-12-31'` instead of `'1969-12-30'`. This fix addresses that change. [#42952][#42952]
- Fixed a bug where `current_timestamp` did not correctly account for `SET TIME ZONE` in the background when storing results, and stored the timestamp as `UTC` instead. [#43012][#43012]
- The range rebalancing logic now considers stores with very close diversity scores equal (all other things being the same) and does not attempt to rebalance. [#43041][#43041]
- The range rebalancing logic now considers the new store being added when looking for target in case of rebalance. [#43041][#43041]
- Previously, gracefully terminating a node with `SIGINT` printed an error banner to the console. This was misleading, since the node responded to the signal correctly and terminated cleanly. This patch converts the error banner to a less-alarming informational message. [#42848][#42848]
- Fixed a bug that could lead to follower reads or [CDC](../v20.1/change-data-capture.html) updates that did not reflect the full set of data at the timestamp. This bug was never observed in practice and should rarely cause issues, one of the necessary ingredients being an aggressive closed timestamp interval. [#42939][#42939]
- Fixed a bug where a well-timed write could slip in on the right-hand side of a [range merge](../v20.1/range-merges.html). This would allow it to improperly synchronize with reads on the post-merged range. [#43138][#43138]
- Previously, the [optimizer](../v20.1/cost-based-optimizer.html) could panic in a specific situation where it would prune all the columns of multiple scans of the same CTE and then try to define different required physical properties for each scan. This seems to have been a possible bug since the addition of multi-use CTEs in v19.2, but is hard to trigger without the not-yet-released `LimitHint` physical property. This patch makes all CTE scans uniquely identifiable, even after column pruning. [#43161][#43161]
- Some incorrect issue links referenced to by error hints have been corrected. [#43232][#43232]
- CockroachDB no longer fails on an expression of the form `NOT(a && b)`. [#43242][#43242]
- Improved support for `OID` column types in tables. [#42973][#42973]
- [`EXPLAIN`](../v20.1/explain.html) can now be used with statements that use [`AS OF SYSTEM TIME`](../v20.1/as-of-system-time.html). [#43296][#43296]
- Fixed an internal error that could be returned when performing `MIN`/`MAX` aggregation over a [`STRING`](../v20.1/string.html) column that contains `NULL` values when executed via the vectorized engine. Only the previous v20.1 alpha releases were affected. [#43429][#43429]
- Fixed an internal error that could occur when `CASE` operator operating on distinct although compatible types was executed via the vectorized engine. For example, a query similar to `SELECT CASE WHEN false THEN 0:::INT2 ELSE 1:::INT8 END` previously would error out. [#43557][#43557]
- CockroachDB now ensures that a transaction running into multiple intents from an abandoned conflicting transaction cleans them up more efficiently. [#43563][#43563]
- CockroachDB now writes less metadata about aborted transactions to disk. [#42765][#42765]
- The concept of lax constant functional dependencies was [previously removed](https://github.com/cockroachdb/cockroach/pull/43532). There was a left-over case when a key is downgraded: if there was a strong empty key, the result is a lax empty key (which is no longer a concept). This change fixes this by removing the key altogether in this case. [#43722][#43722]
- It is now possible to perform [`ALTER COLUMN SET/DROP NULL`](../v20.1/alter-column.html) on multiple (different) columns of the same table inside a single transaction. [#43644][#43644]
- CockroachDB now properly rejects [`ALTER COLUMN DROP NOT NULL`](../v20.1/alter-column.html) on a column that is part of the primary key. [#43644][#43644]
- When the fourth column of a rule in the setting `server.host_based_authentication.configuration` is an IP address without a mask length (e.g., `1.2.3.4` instead of `1.2.0.0/16`), CockroachDB now properly interprets the fifth column as an IP netmask, as per https://www.postgresql.org/docs/current/auth-pg-hba-conf.html. [#43779][#43779]
- CockroachDB no longer tries to issue HTTP requests as part of an [import](../v20.1/import.html) once the import job has been canceled. [#43789][#43789]

<h3 id="v20.1.0-alpha.20200123-performance-improvements">Performance improvements</h3>

- When resumed, paused [imports](../v20.1/import.html) now continue from their internally recorded progress instead of starting over. [#42476][#42476] [#43053][#43053]
- Adjusted the [optimizer](../v20.1/cost-based-optimizer.html)'s cost of [lookup join](../v20.1/joins.html) when the lookup columns aren't a key in the table. This will cause some queries to switch to using a hash or merge join instead of a lookup join, improving performance in most cases. [#43003][#43003]
- Removed an unused field from Raft command `protobuf`, resulting in a 16% reduction in the overhead of each Raft proposal. [#43042][#43042]
- Range splits are now less disruptive to foreground reads. [#43048][#43048]
- CockroachDB now uses better execution plans when a `VALUES` clause is used as the right-hand side of `IN` or `ANY`. [#43154][#43154]
- The [optimizer](../v20.1/cost-based-optimizer.html) can now infer additional filter conditions in some cases based on transitive equalities between columns. [#43194][#43194]
- Improved the estimated row count for some [lookup joins](../v20.1/joins.html) during planning, which can lead to a better plan. [#43325][#43325]
- The [optimizer](../v20.1/cost-based-optimizer.html) now generates better execution plans in some cases where there is an `ORDER BY` expression that simplifies to a simple variable reference. [#43465][#43465]

<h3 id="v20.1.0-alpha.20200123-build-changes">Build changes</h3>

- Go 1.13.5 is now required to build CockroachDB from source. [#43289][#43289]

<h3 id="v20.1.0-alpha.20200123-doc-updates">Doc Updates</h3>

- Added a [Django app development tutorial](../v20.1/build-a-python-app-with-cockroachdb-django.html). [#6359](https://github.com/cockroachdb/docs/pull/6359) [#6365](https://github.com/cockroachdb/docs/pull/6365)
- Updated the [Hibernate app development tutorial](../v20.1/build-a-java-app-with-cockroachdb-hibernate.html) with client-side retry logic. [#5760](https://github.com/cockroachdb/docs/pull/5760)
- Documented how to [use keyset pagination to iterate through query results](../v20.1/selection-queries.html#paginate-through-limited-results). [#6114](https://github.com/cockroachdb/docs/pull/6114)
- Improved the [GSSAPI authentication](../v20.1/gssapi_authentication.html) instructions for configuring Active Directory and MIT and for configuring the client. [#6115](https://github.com/cockroachdb/docs/pull/6115)
- Expanded the [Kubernetes tutorial](../v20.1/orchestrate-cockroachdb-with-kubernetes.html#step-2-start-cockroachdb) to show how to use a custom CA instead of Kubernetes built-in CA when using manual configs. [#6232](https://github.com/cockroachdb/docs/pull/6232)
- Updated the [Kubernetes tutorial](../v20.1/orchestrate-cockroachdb-with-kubernetes.html) for compatibility with Helm 3.0. [#6121](https://github.com/cockroachdb/docs/pull/6121)
- Added language-specific connection strings to the instructions on [connecting to a CockroachCloud cluster](../cockroachcloud/connect-to-your-cluster.html). [#6077](https://github.com/cockroachdb/docs/pull/6077)
- Added Docker as a download option on the full [release notes list](../releases/#docker). [#5792](https://github.com/cockroachdb/docs/issues/5792)
- Updated the [`IMPORT` documentation](../v20.1/import.html) with an example usage of `DELIMITED` with escaping, a note about `DEFAULT` values, and an explanation of the `strict_quotes` option. [#6244](https://github.com/cockroachdb/docs/pull/6244)
- Added an FAQ on [why Cockroach Labs changed the license for CockroachDB](../v20.1/frequently-asked-questions.html#why-did-cockroach-labs-change-the-license-for-cockroachdb). [#6154](https://github.com/cockroachdb/docs/pull/6154)
- Corrected the description of the [possible result of clock skew outside the configured clock offset bounds](../v20.1/operational-faqs.html#what-happens-when-node-clocks-are-not-properly-synchronized). [#6329](https://github.com/cockroachdb/docs/pull/6329)
- Expanded the [data types overview](../v20.1/data-types.html) to indicate whether or not a type supports [vectorized execution](../v20.1/vectorized-execution.html). [#6327](https://github.com/cockroachdb/docs/pull/6327)

<h3 id="v20.1.0-alpha.20200123-contributors">Contributors</h3>

This release includes 279 merged PRs by 47 authors. We would like to thank the following contributors from the CockroachDB community:

- Akshay Shah (first-time contributor)
- Andrii Vorobiov
- Antoine Grondin
- Jason Brown (first-time contributor)

[#41218]: https://github.com/cockroachdb/cockroach/pull/41218
[#41641]: https://github.com/cockroachdb/cockroach/pull/41641
[#41977]: https://github.com/cockroachdb/cockroach/pull/41977
[#42073]: https://github.com/cockroachdb/cockroach/pull/42073
[#42462]: https://github.com/cockroachdb/cockroach/pull/42462
[#42476]: https://github.com/cockroachdb/cockroach/pull/42476
[#42542]: https://github.com/cockroachdb/cockroach/pull/42542
[#42616]: https://github.com/cockroachdb/cockroach/pull/42616
[#42742]: https://github.com/cockroachdb/cockroach/pull/42742
[#42765]: https://github.com/cockroachdb/cockroach/pull/42765
[#42829]: https://github.com/cockroachdb/cockroach/pull/42829
[#42847]: https://github.com/cockroachdb/cockroach/pull/42847
[#42848]: https://github.com/cockroachdb/cockroach/pull/42848
[#42880]: https://github.com/cockroachdb/cockroach/pull/42880
[#42895]: https://github.com/cockroachdb/cockroach/pull/42895
[#42916]: https://github.com/cockroachdb/cockroach/pull/42916
[#42927]: https://github.com/cockroachdb/cockroach/pull/42927
[#42928]: https://github.com/cockroachdb/cockroach/pull/42928
[#42939]: https://github.com/cockroachdb/cockroach/pull/42939
[#42941]: https://github.com/cockroachdb/cockroach/pull/42941
[#42946]: https://github.com/cockroachdb/cockroach/pull/42946
[#42949]: https://github.com/cockroachdb/cockroach/pull/42949
[#42952]: https://github.com/cockroachdb/cockroach/pull/42952
[#42966]: https://github.com/cockroachdb/cockroach/pull/42966
[#42973]: https://github.com/cockroachdb/cockroach/pull/42973
[#42998]: https://github.com/cockroachdb/cockroach/pull/42998
[#42999]: https://github.com/cockroachdb/cockroach/pull/42999
[#43003]: https://github.com/cockroachdb/cockroach/pull/43003
[#43012]: https://github.com/cockroachdb/cockroach/pull/43012
[#43023]: https://github.com/cockroachdb/cockroach/pull/43023
[#43041]: https://github.com/cockroachdb/cockroach/pull/43041
[#43042]: https://github.com/cockroachdb/cockroach/pull/43042
[#43048]: https://github.com/cockroachdb/cockroach/pull/43048
[#43053]: https://github.com/cockroachdb/cockroach/pull/43053
[#43061]: https://github.com/cockroachdb/cockroach/pull/43061
[#43102]: https://github.com/cockroachdb/cockroach/pull/43102
[#43104]: https://github.com/cockroachdb/cockroach/pull/43104
[#43130]: https://github.com/cockroachdb/cockroach/pull/43130
[#43138]: https://github.com/cockroachdb/cockroach/pull/43138
[#43147]: https://github.com/cockroachdb/cockroach/pull/43147
[#43154]: https://github.com/cockroachdb/cockroach/pull/43154
[#43161]: https://github.com/cockroachdb/cockroach/pull/43161
[#43193]: https://github.com/cockroachdb/cockroach/pull/43193
[#43194]: https://github.com/cockroachdb/cockroach/pull/43194
[#43210]: https://github.com/cockroachdb/cockroach/pull/43210
[#43213]: https://github.com/cockroachdb/cockroach/pull/43213
[#43221]: https://github.com/cockroachdb/cockroach/pull/43221
[#43232]: https://github.com/cockroachdb/cockroach/pull/43232
[#43242]: https://github.com/cockroachdb/cockroach/pull/43242
[#43263]: https://github.com/cockroachdb/cockroach/pull/43263
[#43289]: https://github.com/cockroachdb/cockroach/pull/43289
[#43292]: https://github.com/cockroachdb/cockroach/pull/43292
[#43296]: https://github.com/cockroachdb/cockroach/pull/43296
[#43325]: https://github.com/cockroachdb/cockroach/pull/43325
[#43374]: https://github.com/cockroachdb/cockroach/pull/43374
[#43429]: https://github.com/cockroachdb/cockroach/pull/43429
[#43437]: https://github.com/cockroachdb/cockroach/pull/43437
[#43450]: https://github.com/cockroachdb/cockroach/pull/43450
[#43465]: https://github.com/cockroachdb/cockroach/pull/43465
[#43514]: https://github.com/cockroachdb/cockroach/pull/43514
[#43557]: https://github.com/cockroachdb/cockroach/pull/43557
[#43558]: https://github.com/cockroachdb/cockroach/pull/43558
[#43563]: https://github.com/cockroachdb/cockroach/pull/43563
[#43644]: https://github.com/cockroachdb/cockroach/pull/43644
[#43710]: https://github.com/cockroachdb/cockroach/pull/43710
[#43711]: https://github.com/cockroachdb/cockroach/pull/43711
[#43713]: https://github.com/cockroachdb/cockroach/pull/43713
[#43722]: https://github.com/cockroachdb/cockroach/pull/43722
[#43726]: https://github.com/cockroachdb/cockroach/pull/43726
[#43728]: https://github.com/cockroachdb/cockroach/pull/43728
[#43731]: https://github.com/cockroachdb/cockroach/pull/43731
[#43767]: https://github.com/cockroachdb/cockroach/pull/43767
[#43779]: https://github.com/cockroachdb/cockroach/pull/43779
[#43789]: https://github.com/cockroachdb/cockroach/pull/43789
[#43795]: https://github.com/cockroachdb/cockroach/pull/43795
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v20.1/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

<h3 id="v20.1.0-alpha20191216-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha20191216.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha20191216.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha20191216.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-alpha20191216.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v20.1.0-alpha20191216-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v20.1.0-alpha20191216
~~~

<h3 id="v20.1.0-alpha20191216-security-updates">Security updates</h3>

- CockroachDB previously allowed non-authenticated access to privileged HTTP endpoints like `/_admin/v1/events`, which operate using `root` user permissions and can thus access (and sometimes modify) any and all data in the cluster. This security vulnerability has been patched by disallowing non-authenticated access to these endpoints and restricting access to admin users only.

    {{site.data.alerts.callout_info}}
    Users who have built monitoring automation using these HTTP endpoints must modify their automation to work using an HTTP session token for an admin user.
    {{site.data.alerts.end}}

- Some Admin UI screens (e.g., Jobs) were previously incorrectly displayed using `root` user permissions, regardless of the logged-in user's credentials. This enabled insufficiently privileged users to access privileged information. This security vulnerability has been patched by using the credentials of the logged-in user to display all Admin UI screens.

- Privileged HTTP endpoints and certain Admin UI screens require an admin user. However, `root` is disallowed from logging in via HTTP and it is not possible to create additional admin accounts without an Enterprise license. This is further discussed [here](https://github.com/cockroachdb/cockroach/issues/43870) and will be addressed in an upcoming patch revision.

    {{site.data.alerts.callout_info}}
    Users without an Enterprise license can create an additional admin user using a temporary evaluation license, until an alternative is available. A user created this way will persist beyond the license expiry.
    {{site.data.alerts.end}}

- Some Admin UI screens currently display an error or a blank page when viewed by a non-admin user (e.g., Table Details). This is a known limitation mistakenly introduced by the changes described above. This situation is discussed further [here](https://github.com/cockroachdb/cockroach/issues/44033) and will be addressed in an upcoming patch revision. The list of UI pages affected includes but is not limited to:

  - Job details
  - Database details
  - Table details
  - Zone configurations

    {{site.data.alerts.callout_info}}
    Users can access these Admin UI screens using an admin user until a fix is available.
    {{site.data.alerts.end}}

The list of HTTP endpoints affected by the first change above includes:

| HTTP Endpoint                                          | Description                       | Sensitive information revealed                     | Special (see below) |
|--------------------------------------------------------|-----------------------------------|----------------------------------------------------|---------------------|
| `/_admin/v1/data_distribution`                         | Database-table-node mapping       | Database and table names                           |                     |
| `/_admin/v1/databases/{database}/tables/{table}/stats` | Table stats histograms            | Stored table data  via PK values                   |                     |
| `/_admin/v1/drain`                                     | API to shut down a node           | Can cause DoS on cluster                           |                     |
| `/_admin/v1/enqueue_range`                             | Force range rebalancing           | Can cause DoS on cluster                           |                     |
| `/_admin/v1/events`                                    | Event log                         | Usernames, stored object names, privilege mappings |                     |
| `/_admin/v1/nontablestats`                             | Non-table statistics              | Stored table data via PK values                    |                     |
| `/_admin/v1/rangelog`                                  | Range log                         | Stored table data via PK values                    |                     |
| `/_admin/v1/settings`                                  | Cluster settings                  | Organization name                                  |                     |
| `/_status/allocator/node/{node_id}`                    | Rebalance simulator               | Can cause DoS on cluster                           | yes                 |
| `/_status/allocator/range/{range_id}`                  | Rebalance simulatoor              | Can cause DoS on cluster                           | yes                 |
| `/_status/certificates/{node_id}`                      | Node and user certificates        | Credentials                                        |                     |
| `/_status/details/{node_id}`                           | Node details                      | Internal IP addresses                              |                     |
| `/_status/enginestats/{node_id}`                       | Storage statistics                | Operational details                                |                     |
| `/_status/files/{node_id}`                             | Retrieve heap and goroutine dumps | Operational details                                | yes                 |
| `/_status/gossip/{node_id}`                            | Gossip details                    | Internal IP addresses                              | yes                 |
| `/_status/hotranges`                                   | Ranges with active requests       | Stored table data via PK values                    |                     |
| `/_status/local_sessions`                              | SQL sessions                      | Cleartext SQL queries                              | yes                 |
| `/_status/logfiles/{node_id}`                          | List of log files                 | Operational details                                | yes                 |
| `/_status/logfiles/{node_id}/{file}`                   | Server logs + entries             | Many: names, application data, credentials, etc.   | yes                 |
| `/_status/logs/{node_id}`                              | Log entries                       | Many: names, application data, credentials, etc.   | yes                 |
| `/_status/profile/{node_id}`                           | Profiling data                    | Operational details                                |                     |
| `/_status/raft`                                        | Raft details                      | Stored table data via PK values                    |                     |
| `/_status/range/{range_id}`                            | Range details                     | Stored table data via PK values                    |                     |
| `/_status/ranges/{node_id}`                            | Range details                     | Stored table data via PK values                    |                     |
| `/_status/sessions`                                    | SQL sessions                      | Cleartext SQL queries                              | yes                 |
| `/_status/span`                                        | Statistics per key span           | Whether certain table rows exist                   |                     |
| `/_status/stacks/{node_id}`                            | Stack traces                      | Application data, stored table data                |                     |
| `/_status/stores/{node_id}`                            | Store details                     | Operational details                                |                     |

{{site.data.alerts.callout_info}}
"Special" endpoints are subject to the [cluster setting](../v20.1/cluster-settings.html) `server.remote_debugging.mode`. Unless the setting was customized, clients are only able to connect from the same machine as the node.
{{site.data.alerts.end}}

<h3 id="v20.1.0-alpha20191216-backward-incompatible-changes">Backward-incompatible changes</h3>

- The combination of the [`CHANGEFEED`](../v20.1/change-data-capture.html) options `format=experimental_avro`, `envelope=key_only`, and `updated` is now rejected. This is because the use of `key_only` prevents any rows with updated fields from being emitted, which renders the `updated` option meaningless. [#41793][#41793] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-alpha20191216-general-changes">General changes</h3>

- Client usernames can now be defined to start with a digit; in particular, all-digit usernames are now permitted. [#42464][#42464] {% comment %}doc{% endcomment %}
- Changed the default value of the `--max-sql-memory` limit from 128mb to 25% of system memory. [#42480][#42480] {% comment %}doc{% endcomment %}
- Nodes that have been terminated as the result of a failed consistency check now refuse to restart, making it more likely that the operator notices that there is a persistent issue in a timely manner. [#42401][#42401]
- CockroachDB will now advertise some previously-hidden cluster settings, such as `enterprise.license`, in reports such as the one generated by [`SHOW ALL CLUSTER SETTINGS`](../v20.1/show-cluster-setting.html). Only the names are listed; the values are still redacted out. The values can be accessed/modified using the specific statements `SET`/[`SHOW CLUSTER SETTING`](../v20.1/show-cluster-setting.html) (singular). [#42520][#42520] {% comment %}doc{% endcomment %}
- It is now possible to easily identify cluster settings for which tuning effects are known and documented, via the new column `public` in the output of [`SHOW ALL CLUSTER SETTINGS`](../v20.1/show-cluster-setting.html) and the virtual table `crdb_internal.cluster_settings`. [#42520][#42520] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-alpha20191216-enterprise-edition-changes">Enterprise edition changes</h3>

- [`RESTORE`](../v20.1/restore.html) now supports the restoration of empty databases. [#42005][#42005] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-alpha20191216-sql-language-changes">SQL language changes</h3>

- Filters of the form `x = D` (as in `SELECT * FROM t WHERE x = D AND f(x)`), where `D` is a constant and `x` is a column name, will now cause `D` to be inlined for `x` in other filters. [#42151][#42151] {% comment %}doc{% endcomment %}
- The ID of the current session is now available via a `session_id` variable. Session IDs are also now shown in [`SHOW QUERIES`](../v20.1/show-queries.html) results. [#41622][#41622] {% comment %}doc{% endcomment %}
- The [`extract()` function](../v20.1/functions-and-operators.html) now returns values of type float and includes fractional parts in the values for element 'second', 'millisecond', 'julian', and 'epoch'. This improves compatibility with PostgreSQL's `extract()` which returns values of type double precision. [#42131][#42131] {% comment %}doc{% endcomment %}
- `pg_index.indoption` now correctly conveys ascending/descending order and nulls the first/last positioning of columns in an index. [#42343][#42343] {% comment %}doc{% endcomment %}
- Updated pgwire to send `ParameterStatus` messages when certain server parameters are changed for the given session over pgwire. [#42376][#42376]
- Added the ability to run the `avg()` function over intervals. [#42457][#42457] {% comment %}doc{% endcomment %}
- It is now supported to specify selection target aliases as `GROUP BY` columns. Note that the `FROM` columns take precedence over the aliases, which are only used if there are no columns with those names in the current scope. [#42447][#42447] {% comment %}doc{% endcomment %}
- Updated the error message hint when a client attempts to add a sequence-based column to an existing table (which is an unimplemented feature) to refer to Github issue [#42508](https://github.com/cockroachdb/cockroach/issues/42508). [#42509][#42509]
- CockroachDB now returns a more accurate error message, hint, and error code when an error is encountered while adding a new column. [#42509][#42509]
- `EXPLAIN (VERBOSE)` now indicates if auto-commit will be used for mutations. [#42500][#42500] {% comment %}doc{% endcomment %}
- Mutations in CTEs not at the top level are no longer allowed. This restriction is also implemented by Postgres. [#41033][#41033] {% comment %}doc{% endcomment %}
- `WITH` expressions are now hoisted to the top level in a query when possible. [#41033][#41033]
- Made the [`date_trunc` function](../v20.1/functions-and-operators.html) follow Postgres more closely by truncating to Monday when used with `week`.  Previously, it truncated to Sunday. [#42622][#42622] {% comment %}doc{% endcomment %}
- Introduce precision support for [`TIMESTAMP` and `TIMESTAMPTZ`](../v20.1/timestamp.html), supporting precisions from 0 to 6 inclusive. Previous versions of `TIMESTAMP` and `TIMESTAMPTZ` defaulted to 6 units of precision. Note that if you downgrade while having a precision set, you will have full precision (6) again, but if you re-upgrade you will find your precisions truncated again. [#42580][#42580] {% comment %}doc{% endcomment %}
- [`CREATE/ALTER SEQUENCE`](../v20.1/alter-sequence.html) now support the `OWNED BY` syntax. [#40992][#40992] {% comment %}doc{% endcomment %}
- Changed [`extract()`](../v20.1/functions-and-operators.html) on a `TIMESTAMPTZ` to match the environment's location in which `extract()` is executed. Previously, it would always perform the operation as if it was in UTC. Furthermore, `timezone`, `timezone_hour` and `timezone_minute` are added to the `extract()` command. [#42632][#42632] {% comment %}doc{% endcomment %}
- [`CHANGEFEED`](../v20.1/change-data-capture.html) now supports a `WITH diff` option, which instructs it to include a `before` field in each publication. [#41793][#41793] {% comment %}doc{% endcomment %}
- The fields in the Avro format for [`CHANGEFEED`](../v20.1/change-data-capture.html) records have been re-ordered to allow for optimized parsing. This is a backwards compatible change. [#41793][#41793] {% comment %}doc{% endcomment %}
- Users can now use the [`current_timestamp()` function](../v20.1/functions-and-operators.html) with a given precision from 0-6, e.g., `SELECT current_timestamp(4)`. [#42633][#42633] {% comment %}doc{% endcomment %}
- When executed via the [vectorized engine](../v20.1/vectorized-execution.html), make each buffering operator use at most `sql.distsql.temp_storage.workmem` memory (which is 64MB by default).  Previously, all buffering operators (like hash and merge joins, sorts) could use arbitrary amounts of memory which could lead to OOM panics. [#42468][#42468] {% comment %}doc{% endcomment %}
- Added a new statement `SHOW PUBLIC CLUSTER SETTINGS` (abbreviated as `SHOW CLUSTER SETTINGS`), which can be used to list only the public cluster settings that are supported for tuning and configuration. [#42520][#42520] {% comment %}doc{% endcomment %}
- Added the `kv.allocator.min_lease_transfer_interval` cluster setting, which allows the minimum interval between lease transfers initiated from each node to be configured. [#42724][#42724] {% comment %}doc{% endcomment %}
- Made string to interval conversion more strict. For example, strings such as `'&#123;&#123;'` and `'{1,2}'` were previously interpreted as the 00:00 interval. They are now rejected. [#42739][#42739]
- Some columns in `pg_type` (`typinput`, `typoutput`, `typreceive`, `typsend`, `typmodin`, `typmodout`, `typanalyze`) were incorrectly typed as `OID` instead of `REGPROC`.  This issue has been resolved. [#42782][#42782]
- Users can now use the `cast()` function to cast strings to `int[]` or `decimal[]`, when appropriate. [#42704][#42704] {% comment %}doc{% endcomment %}
- `SET TIME ZONE` now accepts inputs beginning with `GMT` and `UTC`, such as `GMT+5` and `UTC-3:59`. This was previously unsupported. [#42781][#42781] {% comment %}doc{% endcomment %}
- It is now possible to reference tables by table descriptor ID in mutations using `INSERT`/`UPSERT`/`UPDATE`/`DELETE`, in a similar way to what is already allowed in `SELECT` statements. For example: `INSERT INTO [53 AS foo] VALUES (1, 2, 3)`. [#42683][#42683] {% comment %}doc{% endcomment %}
- Added new support for precision for `TIME` types (e.g., `TIME(3)` will truncate to milliseconds). Previously this would raise syntax errors. [#42668][#42668] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-alpha20191216-command-line-changes">Command-line changes</h3>

- Users can now use `cockroach demo` to shut down and restart nodes. This is available in `cockroach demo` only as `demo <decommission|recommission|shutdown|restart> <node_num>`. This command is not available in other CLIs, e.g., `cockroach sql`. **This feature is experimental**. [#42230][#42230] {% comment %}doc{% endcomment %}
- The various CLI commands that use SQL now display errors using a new display format that emphasizes the 5-digit [`SQLSTATE`](https://en.wikipedia.org/wiki/SQLSTATE) code. Users are encouraged to combine these codes together with the error message when seeking help or troubleshooting. [#42779][#42779] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-alpha20191216-admin-ui-changes">Admin UI changes</h3>

- Fixed typo that breaks [statements page](../v20.1/admin-ui-statements-page.html) loading. [#42577][#42577]
- Certain web UI pages (like the list of databases or tables) now restrict their content to match the privileges of the logged-in user. [#42563][#42563] {% comment %}doc{% endcomment %}
- The event log now presents all cluster settings changes, unredacted, when an admin user uses the page. [#42563][#42563] {% comment %}doc{% endcomment %}
- Customization of the UI by users is now only properly saved if the user has write privilege to `system.ui` (i.e., is an admin user). Also, all authenticated users share the same customizations. This is a known limitation and should be lifted in a future version. [#42563][#42563] {% comment %}doc{% endcomment %}
- Access to table statistics are temporarily blocked from access by non-admin users until further notice, for security reasons. [#42563][#42563] {% comment %}doc{% endcomment %}
- Certain debug pages have been blocked from non-admin users for security reasons. [#42563][#42563] {% comment %}doc{% endcomment %}
- The cluster settings page now lists public and reserved settings in two separate tables. [#42520][#42520] {% comment %}doc{% endcomment %}
- Added a new range selector that supports custom time/date ranges. [#41327][#41327] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-alpha20191216-bug-fixes">Bug fixes</h3>

- Reduced the likelihood of out-of-memory errors during histogram collection. [#42357][#42357]
- Fixed a bug which could result in ranges becoming unavailable while a single node is unreachable. The symptoms of this would closely resemble that of a range that has lost a majority of replicas, i.e., the log files would likely include messages of the form "have been waiting [...] for proposing command", except that a majority will be available, though not reflected in the surviving replicas' range status. [#42251][#42251]
- Fixed a Makefile bug that would prevent building CockroachDB from sources in rare circumstances. [#42363][#42363]
- Fixed an out-of-memory error that could occur when collecting statistics on tables with a string index column. [#42372][#42372]
- Changed the return type of (date +- interval) and (interval + date) to be timestamp instead of timestamptz, to be in line with Postgres. Furthermore, this change fixed a bug where these calculations would be incorrect if the current timezone is not UTC. [#42324][#42324]
- Fixed a bug when using `experimental_save_rejected` for CSV [`IMPORT`](../v20.1/import.html) that would cause the rejected row file to overwrite the original input file. [#42398][#42398]
- For tables with dropped indexes, the [`SHOW RANGE FOR ROW`](../v20.1/show-range-for-row.html) command sometimes returned incorrect results or an error. Fixed the underlying issue in the `crdb_internal.encode_key` built-in function. [#42456][#42456]
- Fixed a bug in scenarios where we have `UPDATE` cascades, and we are updating a table that has `CHECK` constraints, and the table is self-referencing or is involved in a reference cycle. In this case an `UPDATE` that cascades back in the original table was not validated with respect to the `CHECK` constraints. [#42231][#42231]
- The [movr workload](../v20.1/movr.html) now populates table columns with randomly generated data instead of nulls. [#42483][#42483]
- Fixed a bug where if a sequence is used by two columns of the same table, the dependency relation with the first column can be lost. [#40900][#40900]
- Fixed a bug where memory was leaking when counting rows during backup. [#42529][#42529]
- Fixed a bug where, if one were to cast the same type into two or more different precisions/widths from a table in the same `SELECT` query, they would only get the first precision specified. For example, `SELECT a::decimal(10, 3), a::decimal(10, 1) FROM t` would return both results as `a::decimal(10, 3)`. [#42574][#42574]
- CockroachDB will now be less likely hang in an inconvenient/inoperative state if it attempts to access an external HTTP server that blocks or is overloaded. A possible symptom of the bug is a node failing to shut down upon `cockroach quit`. This bug is present since at least version 2.0. [#42536][#42536]
- Stopped including tables that are being restored or imported as valid targets in backups and changefeeds. [#42606][#42606]
- Fixed a bug that would produce a spurious failure with the error message "incompatible `COALESCE` expressions" when adding or validating `MATCH FULL` foreign key constraints involving composite keys with columns of differing types. [#42528][#42528]
- When a custom `nullif` is provided during `IMPORT`, always treat it as a null value. [#42635][#42635]
- Changefeeds now emit backfill row updates for a dropped column when the table descriptor drops that column. [#42053][#42053]
- It's now possible to transfer range leases to lagging replicas. [#42379][#42379]
- Long running transactions which attempt to `TRUNCATE` can now be pushed and will commit in cases where they previously could fail or retry forever. [#42650][#42650]
- Fixed multiple existing bugs: a panic on performing cascade updates on tables with  multiple column families; a bug where a self referential foreign key constraint with a `SET DEFAULT` would not be maintained on a cascading update; a bug where multiple self-referential foreign key constraints would cause all the rows in the referenced constraint columns to be set to _NULL_ or a default value on a cascading update. [#42624][#42624]
- Fixed a case where we incorrectly determined that a query (or part of a query) which contains an `IS NULL` constraint on a unique index column returns at most one row, possibly ignoring a `LIMIT 1` clause. [#42760][#42760]
- Fixed a bug with incorrect handling of top _K_ sort by the vectorized engine when _K_ is greater than 1024. [#42831][#42831]
- `ALTER INDEX IF EXISTS` no longer fails when using an unqualified index name that does not match any existing index. Now it is a no-op. [#42797][#42797]
- Prevent internal error in some cases when a _NULL_ literal is passed to the `OVERLAPS` operator. [#42877][#42877]
- CockroachDB now prevents a number of panics from the SQL layer caused by an invalid range split. These would usually manifest with messages mentioning encoding errors (including "found null on not null column", but also possibly various others). [#42833][#42833]
- The result column names for the JSON functions `json{b}_array_elements`, `json{b}_array_elements_text`, `json{b}_each`, `json{b}_each_text` were fixed to be compatible with Postgres. [#41861][#41861]
- Fixed a bug where selecting columns by forcing an `INTERLEAVING` index would error instead of returning the correct results. [#42798][#42798]
- Fixed a bug where attempting to parse `0000-01-01 00:00` when involving `time` did not work, as `pgdate` does not understand `0000` as a year. [#42762][#42762]

<h3 id="v20.1.0-alpha20191216-performance-improvements">Performance improvements</h3>

- Transactions are now able to refresh their read timestamp even after the partial success of a batch. [#35140][#35140]
- Some retryable errors are now avoided by declining to restart transactions on some false conflicts. [#42236][#42236]
- CockroachDB now detects the case when the right-hand side of an `ANY` expression is a _NULL_ array (and determine that the expression is always false). [#42698][#42698]
- CockroachDB now generates better plans in many cases where the query has `LEFT` / `RIGHT JOIN`s and also has a `LIMIT`. [#42718][#42718]

<h3 id="v20.1.0-alpha20191216-build-changes">Build changes</h3>

- Go version 1.12.10+ is now required to build CockroachDB successfully. [#42474][#42474] {% comment %}doc{% endcomment %}
- `make buildshort` is now able to produce valid CCL binaries with all enterprise features (minus UI). [#42541][#42541] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-alpha20191216-contributors">Contributors</h3>

This release includes 195 merged PRs by 44 authors.
We would like to thank the following contributors from the CockroachDB community:

- Adam Pantel (first-time contributor, CockroachDB team member)
- Ananthakrishnan (first-time contributor)
- Andrii Vorobiov (first-time contributor)
- George Papadrosou
- Jaewan Park
- Roga Pria Sembada
- Ryan Kuo (first-time contributor)
- Vlad
- georgebuckerfield (first-time contributor)

[#35140]: https://github.com/cockroachdb/cockroach/pull/35140
[#40900]: https://github.com/cockroachdb/cockroach/pull/40900
[#40992]: https://github.com/cockroachdb/cockroach/pull/40992
[#41033]: https://github.com/cockroachdb/cockroach/pull/41033
[#41327]: https://github.com/cockroachdb/cockroach/pull/41327
[#41622]: https://github.com/cockroachdb/cockroach/pull/41622
[#41788]: https://github.com/cockroachdb/cockroach/pull/41788
[#41793]: https://github.com/cockroachdb/cockroach/pull/41793
[#41861]: https://github.com/cockroachdb/cockroach/pull/41861
[#42005]: https://github.com/cockroachdb/cockroach/pull/42005
[#42053]: https://github.com/cockroachdb/cockroach/pull/42053
[#42131]: https://github.com/cockroachdb/cockroach/pull/42131
[#42151]: https://github.com/cockroachdb/cockroach/pull/42151
[#42210]: https://github.com/cockroachdb/cockroach/pull/42210
[#42230]: https://github.com/cockroachdb/cockroach/pull/42230
[#42231]: https://github.com/cockroachdb/cockroach/pull/42231
[#42236]: https://github.com/cockroachdb/cockroach/pull/42236
[#42251]: https://github.com/cockroachdb/cockroach/pull/42251
[#42277]: https://github.com/cockroachdb/cockroach/pull/42277
[#42324]: https://github.com/cockroachdb/cockroach/pull/42324
[#42343]: https://github.com/cockroachdb/cockroach/pull/42343
[#42357]: https://github.com/cockroachdb/cockroach/pull/42357
[#42363]: https://github.com/cockroachdb/cockroach/pull/42363
[#42372]: https://github.com/cockroachdb/cockroach/pull/42372
[#42376]: https://github.com/cockroachdb/cockroach/pull/42376
[#42379]: https://github.com/cockroachdb/cockroach/pull/42379
[#42390]: https://github.com/cockroachdb/cockroach/pull/42390
[#42398]: https://github.com/cockroachdb/cockroach/pull/42398
[#42401]: https://github.com/cockroachdb/cockroach/pull/42401
[#42447]: https://github.com/cockroachdb/cockroach/pull/42447
[#42456]: https://github.com/cockroachdb/cockroach/pull/42456
[#42457]: https://github.com/cockroachdb/cockroach/pull/42457
[#42463]: https://github.com/cockroachdb/cockroach/pull/42463
[#42464]: https://github.com/cockroachdb/cockroach/pull/42464
[#42468]: https://github.com/cockroachdb/cockroach/pull/42468
[#42474]: https://github.com/cockroachdb/cockroach/pull/42474
[#42480]: https://github.com/cockroachdb/cockroach/pull/42480
[#42483]: https://github.com/cockroachdb/cockroach/pull/42483
[#42500]: https://github.com/cockroachdb/cockroach/pull/42500
[#42509]: https://github.com/cockroachdb/cockroach/pull/42509
[#42520]: https://github.com/cockroachdb/cockroach/pull/42520
[#42528]: https://github.com/cockroachdb/cockroach/pull/42528
[#42529]: https://github.com/cockroachdb/cockroach/pull/42529
[#42536]: https://github.com/cockroachdb/cockroach/pull/42536
[#42541]: https://github.com/cockroachdb/cockroach/pull/42541
[#42545]: https://github.com/cockroachdb/cockroach/pull/42545
[#42549]: https://github.com/cockroachdb/cockroach/pull/42549
[#42555]: https://github.com/cockroachdb/cockroach/pull/42555
[#42563]: https://github.com/cockroachdb/cockroach/pull/42563
[#42574]: https://github.com/cockroachdb/cockroach/pull/42574
[#42577]: https://github.com/cockroachdb/cockroach/pull/42577
[#42580]: https://github.com/cockroachdb/cockroach/pull/42580
[#42606]: https://github.com/cockroachdb/cockroach/pull/42606
[#42622]: https://github.com/cockroachdb/cockroach/pull/42622
[#42624]: https://github.com/cockroachdb/cockroach/pull/42624
[#42632]: https://github.com/cockroachdb/cockroach/pull/42632
[#42633]: https://github.com/cockroachdb/cockroach/pull/42633
[#42635]: https://github.com/cockroachdb/cockroach/pull/42635
[#42636]: https://github.com/cockroachdb/cockroach/pull/42636
[#42650]: https://github.com/cockroachdb/cockroach/pull/42650
[#42668]: https://github.com/cockroachdb/cockroach/pull/42668
[#42683]: https://github.com/cockroachdb/cockroach/pull/42683
[#42698]: https://github.com/cockroachdb/cockroach/pull/42698
[#42704]: https://github.com/cockroachdb/cockroach/pull/42704
[#42718]: https://github.com/cockroachdb/cockroach/pull/42718
[#42724]: https://github.com/cockroachdb/cockroach/pull/42724
[#42739]: https://github.com/cockroachdb/cockroach/pull/42739
[#42746]: https://github.com/cockroachdb/cockroach/pull/42746
[#42754]: https://github.com/cockroachdb/cockroach/pull/42754
[#42760]: https://github.com/cockroachdb/cockroach/pull/42760
[#42762]: https://github.com/cockroachdb/cockroach/pull/42762
[#42779]: https://github.com/cockroachdb/cockroach/pull/42779
[#42781]: https://github.com/cockroachdb/cockroach/pull/42781
[#42782]: https://github.com/cockroachdb/cockroach/pull/42782
[#42785]: https://github.com/cockroachdb/cockroach/pull/42785
[#42797]: https://github.com/cockroachdb/cockroach/pull/42797
[#42798]: https://github.com/cockroachdb/cockroach/pull/42798
[#42831]: https://github.com/cockroachdb/cockroach/pull/42831
[#42833]: https://github.com/cockroachdb/cockroach/pull/42833
[#42877]: https://github.com/cockroachdb/cockroach/pull/42877
[1dc476d4b]: https://github.com/cockroachdb/cockroach/commit/1dc476d4b
[2bc3c4b09]: https://github.com/cockroachdb/cockroach/commit/2bc3c4b09
[65c42ed4f]: https://github.com/cockroachdb/cockroach/commit/65c42ed4f
[68f0afa55]: https://github.com/cockroachdb/cockroach/commit/68f0afa55
[70443483e]: https://github.com/cockroachdb/cockroach/commit/70443483e
[7a0ba1ef1]: https://github.com/cockroachdb/cockroach/commit/7a0ba1ef1
[876ceec0c]: https://github.com/cockroachdb/cockroach/commit/876ceec0c
[8d6b7d37c]: https://github.com/cockroachdb/cockroach/commit/8d6b7d37c
[93a806292]: https://github.com/cockroachdb/cockroach/commit/93a806292
[acf26c006]: https://github.com/cockroachdb/cockroach/commit/acf26c006
[ad4705c87]: https://github.com/cockroachdb/cockroach/commit/ad4705c87
[adb938b76]: https://github.com/cockroachdb/cockroach/commit/adb938b76
[b45e3580e]: https://github.com/cockroachdb/cockroach/commit/b45e3580e
[be0e4164e]: https://github.com/cockroachdb/cockroach/commit/be0e4164e
[c6ba22d7a]: https://github.com/cockroachdb/cockroach/commit/c6ba22d7a
[dd089bab2]: https://github.com/cockroachdb/cockroach/commit/dd089bab2
[e2e30ea51]: https://github.com/cockroachdb/cockroach/commit/e2e30ea51
[e88c2d86e]: https://github.com/cockroachdb/cockroach/commit/e88c2d86e
[e8bbf37f8]: https://github.com/cockroachdb/cockroach/commit/e8bbf37f8
[f5da5fc54]: https://github.com/cockroachdb/cockroach/commit/f5da5fc54
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v20.1/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

In addition to various updates, enhancements, and bug fixes, this first v20.1 beta release includes the following major highlights:

- **Online primary key changes**: You can now change a table’s primary key using the `ALTER TABLE ... ALTER PRIMARY KEY` statement. Changing a table’s primary key rewrites its primary and some secondary indexes behind-the-scenes and can take a while, but the table remains online with no interruption to data access. For now, this feature is considered experimental and is behind a [cluster setting](../v20.1/cluster-settings.html). To try it out, run `SET experimental_enable_primary_key_changes = true`. The syntax is `ALTER TABLE table_name ALTER PRIMARY KEY USING COLUMNS (x, y)`.
- **Full cluster restore**: You can now use CockroachDB's [Enterprise `RESTORE`](../v20.1/restore.html) feature to restore a full cluster `BACKUP` to a new cluster, including all configuration and system information such as [user privileges](../v20.1/authorization.html#privileges), [zone configurations](../v20.1/configure-replication-zones.html), and [cluster settings](../v20.1/cluster-settings.html). Restoring a cluster backup to an existing cluster is not supported.
- **Encrypted backup files**: You can now use an encryption key to encrypt data in [Enterprise `BACKUP`](../v20.1/backup.html) files, and to decrypt the data upon [`RESTORE`](../v20.1/restore.html).

<h3 id="v20.1.0-beta.1-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.1.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.1.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.1.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v20.1.0-beta.1-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v20.1.0-beta.1
~~~

<h3 id="v20.1.0-beta.1-backward-incompatible-changes">Backward-incompatible changes</h3>

- [`cockroach init`](../v20.1/cockroach-init.html) now waits for server readiness and thus no longer fails when a mistaken server address is provided. [#43904][#43904] {% comment %}doc{% endcomment %}
- The `cockroach user` CLI command has been removed. It was previously deprecated in CockroachDB 19.2. Note that a 19.2 client (supporting `cockroach user`) can still operate user accounts in a 20.1 server. [#43903][#43903] {% comment %}doc{% endcomment %}
- CockroachDB now creates files without read permissions for the "others" group. Sites that automate file management (e.g., log collection) using multiple user accounts now must ensure that the CockroachDB server and the management tools running on the same system are part of a shared unix group. [#44043][#44043] {% comment %}doc{% endcomment %}
- Previously, intervals cast to integers and floats would rely on a year being 365 days. To match `extract('epoch' from interval)` behavior in PostgreSQL/CockroachDB to 365.25 days, casting to integers and floats now values a year at 365.25 days in seconds instead of 365 days. [#43923][#43923] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-beta.1-security-updates">Security updates</h3>

- An admin user is now required to access statement details in the Admin UI and HTTP endpoint. Previously, any user could access these details, which could result in users accessing data that they didn't have privileges to see. [#44349][#44349] {% comment %}doc{% endcomment %}
- CockroachDB now properly rejects control characters in the value of the `server.host_based_authentication.configuration` [cluster setting](../v20.1/cluster-settings.html). Previously, these characters were accepted and would silently result in unintended rule matching. Deployments careful to strip control characters from their HBA configurations are not affected. [#43811][#43811] {% comment %}doc{% endcomment %}
- Connections using unix sockets are now subject to the HBA rules defined via the setting `server.host_based_authentication.configuration`, in a way compatible with PostgreSQL: incoming unix connections match `local` rules, whereas incoming TCP connections match `host` rules. The default HBA configuration used when the [cluster setting](../v20.1/cluster-settings.html) is empty is now:

    ~~~
    host      all root all cert
    host      all all  all cert-password     
    local     all all      password
    ~~~
    [#43848][#43848]
- Previously, when setting a user's password to enable password authentication for the user, it was not possible to revert this choice. The only way to disable password authentication was to either drop the user or add a specific per-user HBA rule. This has been fixed and the PostgreSQL-compatible [`ALTER USER WITH PASSWORD NULL`](../v20.1/alter-user.html) statement can now be used to clear the user's password. [#43892][#43892] {% comment %}doc{% endcomment %}
- A CockroachDB node process ([`start`](../v20.1/cockroach-start.html)/[`start-single-node`](../v20.1/cockroach-start-single-node.html)) now configures its umask to create all its files without unix permission bits for "others", so that data/log/etc files do not become world-readable by default in systems that do not otherwise customize umask to enforce log file visibility. The files produced by other `cockroach` commands (e.g., the [CLI commands](../v20.1/cockroach-commands.html)) do not force their umask. Note that after upgrading to this release, in sites where permissions matter, administrators should be careful to run `chmod -R o-rwx` in directories where files were created by a previous version. [#44043][#44043] {% comment %}doc{% endcomment %}
- The new command `cockroach auth-session login` (reserved for administrators) creates authentication tokens with an arbitrary expiration date. Operators should be careful to monitor `system.web_sessions` and enforce policy-mandated expirations by either using SQL queries or the new command `cockroach auth-session logout`. [#43872][#43872] {% comment %}doc{% endcomment %}
- The `root` user can now have a password, like any other member of the admin role. However, as in previous versions, the HBA configuration cannot be overridden to prevent `root` from logging in with a valid TLS client certificate. This special rule remains enforced in order to ensure that users cannot "lock themselves out" of administrating their cluster. [#43893][#43893] {% comment %}doc{% endcomment %}
- The `root` user remains special with regard to [authentication](../v20.1/authentication.html) when some system ranges are unavailable. In that case, password authentication will fail, subject to a timeout set to the minimum of 5 seconds and the configured value of `system.user_login.timeout`, because the password cannot be retrieved from a system table. However, certificate authentication remains available. [#43893][#43893] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-beta.1-general-changes">General changes</h3>

- `SHOW JOBS` and the Jobs page in the Admin UI now show the parameters used for connecting to external storage, with only the values of parameters classified as secrets redacted. [#44737][#44737] {% comment %}doc{% endcomment %}
- It's now possible to disable job execution on a node in emergency cases. To do so, place a `DISABLE_STARTING_BACKGROUND_JOBS` file in the node's first store directory. [#44786][#44786] {% comment %}doc{% endcomment %}
- A node no longer declares itself unready through the [`/health?ready=1`](../v20.1/monitoring-and-alerting.html#health-ready-1) endpoint while in the process of decommissioning. It continues to declare itself unready while draining. [#43889][#43889] {% comment %}doc{% endcomment %}
- CockroachDB will now report a timeout error when a client attempts to connect via SQL or the Admin UI and some system ranges are unavailable. The previous behavior was to wait indefinitely. The timeout is configurable via the [cluster setting](../v20.1/cluster-settings.html) `server.user_login.timeout` and is set to 10 seconds by default. The value "0" means "indefinitely" and can be used to restore the pre-v20.1 behavior. This timeout does not apply to the `root` user, which is always able to login on unavailable clusters. [#44022][#44022] {% comment %}doc{% endcomment %}
- The `kv.allocator.range_rebalance_threshold` [cluster setting](../v20.1/cluster-settings.html), which controls how far away from the mean a store's range count must be before it is considered for rebalance, is now subject to a 2-replica minimum. If, for example, the mean number of replicas per store is 5.6 and the setting is 5%, the store will not be considered for rebalance unless the number of replicas is lesser than 3 or greater than 8. Previously, the bounds would have been 5 and 6. [#44247][#44247] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-beta.1-enterprise-edition-changes">Enterprise edition changes</h3>

- Added the ability to restore a cluster backup to a new cluster, including all configuration and system information such as user privileges, zone configurations, and cluster settings. Restoring a cluster backup to an existing cluster is not supported. [#43828][#43828]
- Added support for encrypting `BACKUP`/`RESTORE` files via the `encryption_passphrase` option. [#44177][#44177]

<h3 id="v20.1.0-beta.1-sql-language-changes">SQL language changes</h3>

- Foreign key checks for insertions performed by [`UPSERT`s](../v20.1/upsert.html) are now handled by the optimizer. [#43824][#43824] {% comment %}doc{% endcomment %}
- Added a rough estimation of execution progress to [`SHOW QUERIES`](../v20.1/show-queries.html). [#42518][#42518] {% comment %}doc{% endcomment %}
- Added `NOT NULL` columns as check constraints to `information_schema.table_constraints`, for PostgreSQL compatibility. [#44731][#44731] {% comment %}doc{% endcomment %}
- Added support for temporary view creation, if temporary tables are enabled. Temporary views disappear at the end of a connection. Views that depend on temporary tables are automatically temporary. [#44729][#44729]
- Added the `require_explicit_primary_keys` and `sql.defaults.require_explicit_primary_keys.enabled` [cluster settings](../v20.1/cluster-settings.html) to control whether CockroachDB should error out when tables are created without explicit primary keys. [#44702][#44702] {% comment %}doc{% endcomment %}
- The `enable_primary_key_changes` [cluster setting](../v20.1/cluster-settings.html) has changed to `experimental_enable_primary_key_changes`. [#43818][#43818]
- Primary key columns are no longer required to be in column family `0`. [#43742][#43742]
- Primary key changes are now enabled on tables with multiple [column families](../v20.1/column-families.html). [#43821][#43821]
- The primary key of a table can now be altered to one that is [interleaved](../v20.1/interleave-in-parent.html) in another table. [#44038][#44038]
- Primary key changes can now be performed on interleaved children. [#44075][#44075]
- Primary key changes are now enabled on tables that have foreign key relationships. [#43830][#43830]
- Extract can now be called on an interval (e.g., `extract(day from interval '254 days')`). This follows the PostgreSQL implementation. Furthermore, this deprecates `extract_duration`, which will be removed at a later date. [#43293][#43293] {% comment %}doc{% endcomment %}
- CockroachDB previously did not support `AT TIME ZONE` parsing for anything other than precise location strings (e.g., `AT TIME ZONE 'Australia/Sydney'`). CockroachDB now supports parsing `AT TIME ZONE` with various other offset behaviors supported by `SET TIME ZONE` (e.g., `AT TIME ZONE '+3'`, `AT TIME ZONE 'GMT+4'`). [#43414][#43414] {% comment %}doc{% endcomment %}
- CockroachDB now supports `SET TIME ZONE` with colons (e.g., `+4:00`). [#43414][#43414] {% comment %}doc{% endcomment %}
- Previously, `SELECT interval '1-2 1' DAY TO HOUR` would fail. This is now permitted as per the SQL standard. [#43379][#43379] {% comment %}doc{% endcomment %}
- Previously, spaces added to intervals with qualifiers (e.g., `SELECT interval '  1  ' YEAR`) would be evaluated as seconds. The qualifier is now used as the multiplier. [#43379][#43379] {% comment %}doc{% endcomment %}
- Previously, adding a decimal point to days (e.g., `SELECT interval '1.5 01:00:00'`) would return `1 day 01:00:00`, unlike PostgreSQL, which returns `1 day 13:00:00`. The behavior now matches PostgreSQL. [#43379][#43379] {% comment %}doc{% endcomment %}
- Previously, using the `Y-M constant` format for intervals (e.g., `SELECT INTERVAL '1-2 3'`) would always resolve the constant component (3) as seconds, even for items such as `SELECT INTERVAL '1-2 3' DAY`. The behavior has been corrected and now matches PostgreSQL. [#43379][#43379] {% comment %}doc{% endcomment %}
- Some tools generate SQL that includes the `fillfactor` storage parameter, e.g., `CREATE TABLE ... WITH (fillfactor=100)`. This syntax is now supported, but has no effect, since the parameter has no meaning in CockroachDB. [#43307][#43307]
- [`SHOW RANGES`](../v20.1/show-ranges.html) now shows locality information consistent with the range descriptor when node ID and store ID do not match. [#43807][#43807] {% comment %}doc{% endcomment %}
- Ranges are now considered under-replicated by the [`system.replication_stats` report](../v20.1/query-replication-reports.html#system-replication_stats) when one of the replicas is unresponsive (or the respective node is not running). [#43825][#43825] {% comment %}doc{% endcomment %}
- [`CREATE USER`](../v20.1/create-user.html) and [`ALTER USER`](../v20.1/alter-user.html) now accept the parameter `[WITH] PASSWORD NULL` to indicate the user's password should be removed, thus preventing them from using password authentication. This is compatible with PostgreSQL. [#43892][#43892] {% comment %}doc{% endcomment %}
- Previously, a panic could occur when a table had a default column and a constraint in the [`CREATE TABLE`](../v20.1/create-table.html) statement. This is now fixed. [#43959][#43959]
- Previously, [`DECIMAL`](../v20.1/decimal.html) types could not be sent over the network when the computation was performed by the [vectorized engine](../v20.1/vectorized-execution.html). This has been fixed, and the vectorized engine now fully supports `DECIMAL` type. [#43311][#43311] {% comment %}doc{% endcomment %}
- Previously, there was a restriction that foreign keys could only reference one outbound column at any given point in time (e.g., in `CREATE TABLE test(a int)`, having two foreign keys on column `a` was not allowed). This restriction is now removed. [#43417][#43417] {% comment %}doc{% endcomment %}
- Invalid usages of `FOR UPDATE` [locking clauses](../v20.1/sql-grammar.html#for_locking_clause) are now rejected by the SQL optimizer. [#43887][#43887]
- Added `to_hex(string)` string functionality. [#44016][#44016] {% comment %}doc{% endcomment %}
- Previously, `to_hex(-1)` would return `-1` instead of the negative hex representation (`FFFFFFFFFFFFFFFF`). This is now fixed. [#44016][#44016]
- The new global default [cluster setting](../v20.1/cluster-settings.html) `sql.defaults.temporary_tables.enabled` can be used to enable temporary tables. [#43816][#43816]
- An optimization has been added to scan over only 1 row when finding the MIN/MAX of a single aggregate group, as long as the correct index is present. [#43547][#43547]
- [`SHOW CREATE TABLE`](../v20.1/show-create.html) now also emits the `COMMENT` statements sufficient to populate the table's user-defined comments, if any, alongside the `CREATE` statement proper. [#43152][#43152] {% comment %}doc{% endcomment %}
- More invalid usages of `FOR UPDATE` [locking clauses](../v20.1/sql-grammar.html#for_locking_clause) are now rejected by the SQL optimizer. [#44015][#44015]
- Added the `timeofday` functionality supported by PostgreSQL, which returns the time on one of the nodes as a formatted string. [#44050][#44050] {% comment %}doc{% endcomment %}
- Added `localtime`, which by default returns the current time as the [`TIME`](../v20.1/time.html) data type (as opposed to `current_time`, which returns the [`TIMETZ`](../v20.1/time.html) data type). [#44042][#44042] {% comment %}doc{% endcomment %}
- Added `localtimestamp`, which by default returns the current timestamp as the [`TIMESTAMP`](../v20.1/timestamp.html) data type (as opposed to `current_timestamp`, which returns the [`TIMESTAMPTZ`](../v20.1/timestamp.html) data type). [#44042][#44042]
- Added support for having `D:H:M`, `D:M:S.fff`, or `D:H:M:S.fff` for interval parsing if the first element is a decimal or empty (e.g., `:04:05` and `1.0:04:05` would be `04:05:00` and `1 day 04:05:00` respectively). [#43924][#43924] {% comment %}doc{% endcomment %}
- Previously, floats were supported in `H:M:S` formats for interval parsing (e.g., `1.0:2.0:3.0`), which did not make sense. Floats are no longer allowed for the M field. [#43924][#43924] {% comment %}doc{% endcomment %}
- Previously, CockroachDB would return an internal error when using [`SET tracing`](../v20.1/set-vars.html#set-tracing) with any type other than string. Now it will return a regular query error. Additionally, boolean arguments are now supported in `SET tracing`, and `true` is mapped to `on` mode of tracing whereas `false` is mapped to `off`. [#44260][#44260] {% comment %}doc{% endcomment %}
- Indexes that reference, or are referenced by, a foreign key constraint can now be dropped if there is another suitable index for the constraint. [#43332][#43332] {% comment %}doc{% endcomment %}
- Added a `log` [builtin](../v20.1/functions-and-operators.html) for any base (e.g., `log(2.0, 4.0)`). [#41848][#41848] {% comment %}doc{% endcomment %}
- Non-admin users can now query [`SHOW JOBS`](../v20.1/show-jobs.html) and `crdb_internal.jobs` and see their own jobs. [#44345][#44345] {% comment %}doc{% endcomment %}
- [Vectorized execution engine](../v20.1/vectorized-execution.html) now supports `DISTINCT` on unordered input. [#42522][#42522] {% comment %}doc{% endcomment %}
- `pg_catalog` access method information is now more accurate. Added inverted index to the access methods listed in `pg_am` and set `pg_class.relam` to zero for sequences and views, which is more consistent with PostgreSQL. [#43715][#43715]
- An overload has been added to the `unnest` [builtin](../v20.1/functions-and-operators.html) function in order to support multiple array arguments. [#41557][#41557]
- Duplicate labels are allowed when declaring a tuple, but a "column reference is ambiguous" error is now returned if a duplicate label is accessed (e.g.,`SELECT ((1, '2') AS a, a);` is successful, but `SELECT (((1,2,3) AS a,b,a)).a;` returns an error). [#41557][#41557]
- Telemetry information is now collected for uses of secondary indexes that use [column families](../v20.1/column-families.html). [#44506][#44506]
- Telemetry information is now collected for uses of the [`SHOW RANGE ... FROM ROW`](../v20.1/show-range-for-row.html) command. [#44502][#44502]
- CockroachDB now supports `AT TIME ZONE` and the `timezone` [builtin](../v20.1/functions-and-operators.html) for `time` and `timetz` methods. [#44099][#44099] {% comment %}doc{% endcomment %}
- `AT TIME ZONE` now supports the POSIX standard. Offsets such as `UTC+3` and `+3` are interpreted to be timezones *west* of UTC instead of *east* of UTC (e.g., `America/New_York` is equivalent to `UTC+5` instead of `UTC-5`). [#44099][#44099]
- CockroachDB supports `timezone(timestamp(tz), str)`, but PostgreSQL supports the inverse `timezone(str, timestamp(tz))`. Both are now supported, and the former version will be deprecated at a later stage. - CockroachDB now supports `str AT TIME ZONE str`, removing the need for an explicit cast. [#44099][#44099] {% comment %}doc{% endcomment %}
- The [vectorized execution engine](../v20.1/vectorized-execution.html) now supports `bool_and`/`bool_or` [builtin](../v20.1/functions-and-operators.html) aggregation functions. [#44164][#44164] {% comment %}doc{% endcomment %}
- Non-admin users can now use the `ZONECONFIG` privilege to create, edit, and delete zone configurations. [#43941][#43941] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-beta.1-command-line-changes">Command-line changes</h3>

- When running [`cockroach demo`](../v20.1/cockroach-demo.html) with multiple nodes, each node now takes up to 128MB for SQL memory and 64MB for cache by default. Previously, each node would take up to 25% of total memory, which could cause OOM problems. These defaults can be modified via the `--max-sql-memory` and `--cache` flags. [#44478][#44478] {% comment %}doc{% endcomment %}
- Connections using unix sockets are now accepted even when the server is running in secure mode. Consult [`cockroach start --help`](../v20.1/cockroach-start.html) for details about the `--socket` parameter. [#43848][#43848] {% comment %}doc{% endcomment %}
- The [`cockroach init`](../v20.1/cockroach-init.html) command now waits until the node at the provided server address is ready to accept initialization. This also waits for network readiness. This makes it easier to implement initialization scripts by removing the need for a loop. In addition, implementing such a loop is operationally unsafe and is not recommended. [#43904][#43904] {% comment %}doc{% endcomment %}
- The MovR dataset will now be split among all nodes in the demo cluster. [#43798][#43798] {% comment %}doc{% endcomment %}
- [`cockroach demo --with-load`](../v20.1/cockroach-demo.html) can now round robin queries to all nodes in the demo cluster. [#43474][#43474] {% comment %}doc{% endcomment %}
- The SQLSmith workload now accepts an argument `error-sensitivity` which controls what types of errors the workload exits on. [#43925][#43925]
- [`cockroach gen haproxy`](../v20.1/cockroach-gen.html) now excludes decommissioned nodes. [#43908][#43908] {% comment %}doc{% endcomment %}
- The [`cockroach node decommission`](../v20.1/cockroach-node.html#node-decommission) and [`cockroach node recommission`](../v20.1/cockroach-node.html#node-recommission) commands now produce a warning on the standard error if one of the node(s) specified is already (d/r)ecommissioned. [#43915][#43915] {% comment %}doc{% endcomment %}
- The [`start`](../v20.1/cockroach-start.html) and [`start-single-node`](../v20.1/cockroach-start-single-node.html) commands no longer initiate a 1-minute hard shutdown countdown after a request to gracefully terminate. This means that graceful shutdowns are now free to take longer than one minute. It also means that deployments where a maximum shutdown time must be enforced must now use a service manager that is suitably configured to do so. [#44074][#44074] {% comment %}doc{% endcomment %}
- The new `cockroach auth-session login`, `cockroach auth-session list`, and `cockroach auth-session logout` commands are now provided to facilitate the management of web sessions. The command `auth-session login` also produces a HTTP cookie which can be used by non-interactive HTTP-based database management tools. It also can generate such a cookie for the `root` user, who would not otherwise be able to do so using a web browser. [#43872][#43872] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-beta.1-admin-ui-changes">Admin UI changes</h3>

- Decommissioned node history is now viewable on a dedicated page. This reduces the amount of information on the [Cluster Overview](../v20.1/admin-ui-cluster-overview-page.html) page. [#42817][#42817] {% comment %}doc{% endcomment %}
- Execution Latency graph is now renamed to "KV Execution Latency". [#43290][#43290] {% comment %}doc{% endcomment %}
- Redesigned the Cluster Overview page. [#43552][#43552] {% comment %}doc{% endcomment %}
- We previously introduced a fix on the Admin UI to prevent non-admin users from executing queries. However, this inadvertently caused certain pages requiring table details not to display. This issue has now been resolved. [#44167][#44167]
- Non-admin users can now use the [Jobs](../v20.1/admin-ui-jobs-page.html) page of the Admin UI to see their own jobs. [#44345][#44345] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-beta.1-bug-fixes">Bug fixes</h3>

- When running a query with the `LIKE` [operator](../v20.1/functions-and-operators.html) using custom `ESCAPE` symbols, patterns containing Unicode characters no longer result in an internal error. [#44633][#44633]
- Fixed a server crash caused by some queries with outer joins and negative limits. [#44590][#44590]
- When cleaning up [schema changes](../v20.1/online-schema-changes.html), CockroachDB no longer repeatedly looks for non-existing jobs, which could cause high memory usage. [#44607][#44607]
- Calling `NULLIF` with one null argument no longer results in an internal error. [#44718][#44718]
- Fixed a "no indexes" internal error in some cases when GROUP BY is used on a virtual table. [#44692][#44692]
- Fixed invalid query results in some cases involving stored columns with `NULL` values. [#44728][#44728]
- Fixed invalid query results in some cases where part of a `WHERE` clause is incorrectly discarded. [#44668][#44668]
- Fixed bugs around [`cockroach dump`](../v20.1/cockroach-dump.html) and [`IMPORT`](../v20.1/import.html)/[`EXPORT`](../v20.1/export.html) where columns of arrays or collated strings were not able to be roundtripped between `cockroach` and the dump. [#44464][#44464]
- `CASE` [operators](../v20.1/functions-and-operators.html) with an unknown `WHEN` type no longer return an error. [#44756][#44756]
- Fixed a type checking error where `BETWEEN` would sometimes allow boundary expressions of a different type. [#44775][#44775]
- Fixed a "cannot map variable" error in some rare cases involving joins. [#44788][#44788]
- Fixed a bug causing lost update transaction anomalies. [#44507][#44507]
- Fixed an occasional "concurrent map write" crash. [#44872][#44872]
- Fixed a bug where [`DROP INDEX`](../v20.1/drop-index.html) jobs waiting for garbage collection might deleted before the data was actually removed from disk. [#44831][#44831]
- CockroachDB no longer returns an internal error when executing a `substring()` function with non-INT8 start and length arguments via the vectorized engine. [#44887][#44887]
- Fixed incorrect deduplication of impure expressions (e.g., `gen_random_uuid`) in projections and default values. [#44890][#44890]
- [`TIMESTAMPTZ`](../v20.1/timestamp.html) operations now correctly take context timezone (set by `SET TIME ZONE`) into account. Previously, not doing so lead to bugs involving daylight saving in arithmetic. For example, with `America/Chicago`, evaluating `'2010-11-06 23:59:00-05'::timestamptz + '1 day'::interval` would return incorrect results as it assumed it was a fixed offset of `-5` instead. Also, text conversion from `TIMESTAMPTZ` TO `STRING` sometimes used the wrong timezone offset if the location of the session did not match the location when the `TIMESTAMPTZ` was parsed, and `to_json()` built-ins with `TIMESTAMPTZ` did not take session timezone into consideration. [#44812][#44812]
- Previously, when [vectorized execution engine](../v20.1/vectorized-execution.html) was used with `vectorize=experimental_on`, CockroachDB could incorrectly report some values as NULL. This has now been fixed. [#43785][#43785]
- When casting a string to bytes, octal escapes greater than `377` will now generate an error, rather than silently wrapping around. [#43806][#43806]
- A job can be running but shown in a pending state. [#43814][#43814]
- On Linux machines, we now respect the available memory limit as dictated by the cgroup limits which apply to the `cockroach` process. [#43137][#43137]
- Previously, CockroachDB would return incorrect results for some aggregate functions when used as [window functions](../v20.1/window-functions.html) with non-default window frame. This is now fixed. Note that MIN, MAX, SUM, AVG, and "pure" window functions (i.e., non-aggregates) were not affected. [#39308][#39308]
- Previously, CockroachDB could return an internal error when running a query with a CAST operation (`:::`) in some cases when using the [vectorized execution engine](../v20.1/vectorized-execution.html). This is now fixed. [#43857][#43857]
- Previously, a query shutdown mechanism could fail to fully cleanup the infrastructure when the query was executed via the [vectorized engine](../v20.1/vectorized-execution.html) and the query plan contained wrapped row-by-row processors (in v19.2, this applies to Lookup joins and Index joins). This is now fixed. [#43579][#43579]
- Fixed a bug introduced in v19.2 that would allow foreign keys to use a unique index on the referenced columns that indexed more columns than were included in the columns used in the FK constraint, which allows potentially violating uniqueness in the referenced columns themselves. [#43793][#43793]
- [`RESTORE`](../v20.1/restore.html) cleanup is now run exactly once. [#43933][#43933]
- A benign error previously logged at the `ERROR` level is now logged at the `INFO` level behind a `verbosity(2)` flag. This error might have been observed as "context canceled: readerCtx in Inbox stream handler". [#44020][#44020]
- A bug causing lost update transaction anomalies was fixed. [#42969][#42969]
- Previously, an internal error could occur when a query with an aggregate function MIN or MAX was executed via the [vectorized engine](../v20.1/vectorized-execution.html) when the input column was either INT2 or INT4 type. This is now fixed. [#43985][#43985]
- [CDC](../v20.1/change-data-capture.html) is no longer susceptible to a bug where a resolved timestamp might be published before all events that precede it have been published in the presence of a Range merge. [#44035][#44035]
- [`cockroach debug zip`](../v20.1/cockroach-debug-zip.html) now emits the `goroutine` file in the proper sub-directory when the corresponding call fails with an error. [#44064][#44064]
- [`cockroach debug zip`](../v20.1/cockroach-debug-zip.html) is again able to operate correctly and continue to iterate over all nodes if one of the nodes does not deliver its goroutine dumps. It would previously prematurely and incorrectly stop with an incomplete dump; this was a regression introduced in v19.2. [#44064][#44064]
- The file generated by [`cockroach gen haproxy`](../v20.1/cockroach-gen.html) no longer gets an executable bit. The executable bit was previously placed in error. [#44043][#44043]
- Fixed internal error of the form "x FK cols, only y cols in index" in some cases when inserting into a table with foreign key references. [#44031][#44031]
- CockroachDB now ensures internal cleanup after [`IMPORT`](../v20.1/backup.html) is only run once. [#43960][#43960]
- Converted a panic in `golang.org/x/text/language/tags.go` when using collated strings to an error. [#44103][#44103]
- SQL mutation statements that target tables with no foreign key relationships now correctly read data as per the state of the database when the statement started execution. This is required for compatibility with PostgreSQL and to ensure deterministic behavior when certain operations are parallelized. Prior to this fix, a statement could incorrectly operate multiple times (i.e., the [Halloween Problem](https://en.wikipedia.org/wiki/Halloween_Problem)) on data that itself was writing, and potentially never terminate. This fix is limited to tables without FK relationships, and for certain operations on tables with FK relationships; in other cases, the fix is not active and the bug is still present. A full fix will be provided in a later release. [#42862][#42862]
- CockroachDB now properly supports using `--url` with query options (e.g., `application_name`) but without specifying `sslmode`. The default of `sslmode=disable` is assumed in that case. This applies to the [CLI commands](../v20.1/cockroach-commands.html) that use SQL, including (but not limited to) [`cockroach sql`](../v20.1/cockroach-sql.html), [`cockroach node`](../v20.1/cockroach-node.html), `cockroach auth-session`, and [`cockroach debug zip`](../v20.1/cockroach-debug-zip.html). [#44113][#44113]
- The GC process has been improved to paginate the key versions of a key to fix OOM crashes, which can occur when there are extremely large numbers of versions for a given key. [#43862][#43862]
- Removed [statistics](../v20.1/cost-based-optimizer.html#table-statistics) information from backup jobs' payload information to avoid excessive memory utilization when issuing commands such as [`SHOW JOBS`](../v20.1/show-jobs.html). [#44180][#44180]
- Previously, CockroachDB could crash in special circumstances when using the [vectorized execution engine](../v20.1/vectorized-execution.html) with the `vectorize=experimental_on` setting. This is now fixed. [#44144][#44144]
- Fixed planning bug related to FULL joins between single-row relations. [#44156][#44156]
- Fixed "CopyFrom requires empty destination" internal error. [#44114][#44114]
- Fix a bug where multiple nodes attempted to populate the results for [`CREATE TABLE ... AS`](../v20.1/create-table-as.html) leading to duplicate rows. [#43840][#43840]
- All admin users are now allowed to use [`BACKUP`](../v20.1/backup.html)/[`RESTORE`](../v20.1/restore.html) and [`IMPORT`](../v20.1/import.html). [#44250][#44250]
- `to_english(-2^63)` previously errored. This is now fixed to return the correct result. [#44251][#44251]
- Fixed internal error when mixed types are used with `BETWEEN`. [#44216][#44216]
- Fixed an error that could occur in very specific scenarios involving mutations and foreign keys. [#44314][#44314]
- Previously, CockroachDB would return an internal error when a query with CASE operator that returns only NULL values was executed via the [vectorized engine](../v20.1/vectorized-execution.html). This is now fixed. [#44346][#44346]
- Fixed a bug when cascade deleting thousands of rows across interleaved tables. [#44159][#44159]
- Fixed incorrect plans in very rare cases involving filters that aren't constant folded in the optimizer but that can be evaluated statically when running a given query. [#44307][#44307]
- Fixed an internal error that could happen in the planner when table statistics were collected manually using [`CREATE STATISTICS`](../v20.1/create-statistics.html) for different columns at different times. [#44430][#44430]
- Fixed "no output column equivalent to" and "column not in input" errors in some cases involving `DISTINCT ON` and `ORDER BY`. [#44543][#44543]
- Fixed possibly incorrect query results in various cornercases, especially when [`SELECT DISTINCT`](../v20.1/select-clause.html) is used. [#44386][#44386]
- Previously, CockroachDB would return an internal error when a `substring` function with a negative length was executed via the [vectorized engine](../v20.1/vectorized-execution.html). This is now fixed (it now returns a regular query error). [#44627][#44627]

<h3 id="v20.1.0-beta.1-performance-improvements">Performance improvements</h3>

- Secondary indexes that store columns on tables with [column families](../v20.1/column-families.html) can now perform reads on only the needed columns in single row reads. [#43567][#43567]
- CockroachDB now uses better execution plans in some cases where there is an ordering on an expression that can be constant-folded to a simple column reference. [#43724][#43724]
- Histograms are now collected automatically for all boolean columns, resulting in better query plans in some cases. For tables that aren't being modified frequently, it might be necessary to run [`CREATE STATISTICS`](../v20.1/create-statistics.html) manually to see the benefit. [#44151][#44151]

<h3 id="v20.1.0-beta.1-build-changes">Build changes</h3>

- Building CockroachDB now requires Node.js version 12 or greater. [#44024][#44024] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-beta.1-doc-updates">Doc updates</h3>

- Added a new [Technical Advisories](../advisories/index.html) section with information about major issues with CockroachDB that may impact security or stability in production environments. [#6492](https://github.com/cockroachdb/docs/pull/6492)
- Added a tutorial on [streaming an Enterprise changefeed from CockroachCloud to Snowflake](../cockroachcloud/stream-changefeed-to-snowflake-aws.html). [#6317](https://github.com/cockroachdb/docs/pull/6317)
- Documented the [`TIMETZ`](../v20.1/time.html) data type. [#6391](https://github.com/cockroachdb/docs/pull/6391)
- Fixed the [JavaScript code sample for connecting to a CockroachCloud cluster](../cockroachcloud/connect-to-your-cluster.html). [#6393](https://github.com/cockroachdb/docs/pull/6393)
- Clarified the behavior of default values when using [`IMPORT INTO`](../v20.1/import-into.html). [#6396](https://github.com/cockroachdb/docs/pull/6396)
- Clarified the behavior of [decommissioning](../v20.1/remove-nodes.html) in clusters of various sizes. [#6402](https://github.com/cockroachdb/docs/pull/6402)
- Documented [`LATERAL` joins](../v20.1/joins.html#lateral-joins) and [subqueries](../v20.1/subqueries.html#lateral-subqueries). [#6425](https://github.com/cockroachdb/docs/pull/6425)
- Improved the [Django "build an app" code sample](../v20.1/build-a-python-app-with-cockroachdb-django.html). [#6404](https://github.com/cockroachdb/docs/pull/6404), [#6412](https://github.com/cockroachdb/docs/pull/6412)
- Updated [Change Data Capture examples](../v20.1/change-data-capture.html#create-a-changefeed-connected-to-kafka) to show more than one table in a changefeed. [#6511](https://github.com/cockroachdb/docs/pull/6511)

<h3 id="v20.1.0-beta.1-contributors">Contributors</h3>

This release includes 420 merged PRs by 68 authors. We would like to thank the following contributors from the CockroachDB community:

- Andrii Vorobiov
- George Papadrosou
- Jaewan Park
- Jason Brown
- Y.Horie (first-time contributor)

[#39308]: https://github.com/cockroachdb/cockroach/pull/39308
[#41557]: https://github.com/cockroachdb/cockroach/pull/41557
[#41848]: https://github.com/cockroachdb/cockroach/pull/41848
[#42522]: https://github.com/cockroachdb/cockroach/pull/42522
[#42644]: https://github.com/cockroachdb/cockroach/pull/42644
[#42817]: https://github.com/cockroachdb/cockroach/pull/42817
[#42862]: https://github.com/cockroachdb/cockroach/pull/42862
[#42969]: https://github.com/cockroachdb/cockroach/pull/42969
[#43137]: https://github.com/cockroachdb/cockroach/pull/43137
[#43152]: https://github.com/cockroachdb/cockroach/pull/43152
[#43288]: https://github.com/cockroachdb/cockroach/pull/43288
[#43290]: https://github.com/cockroachdb/cockroach/pull/43290
[#43293]: https://github.com/cockroachdb/cockroach/pull/43293
[#43307]: https://github.com/cockroachdb/cockroach/pull/43307
[#43311]: https://github.com/cockroachdb/cockroach/pull/43311
[#43332]: https://github.com/cockroachdb/cockroach/pull/43332
[#43379]: https://github.com/cockroachdb/cockroach/pull/43379
[#43414]: https://github.com/cockroachdb/cockroach/pull/43414
[#43417]: https://github.com/cockroachdb/cockroach/pull/43417
[#43474]: https://github.com/cockroachdb/cockroach/pull/43474
[#43547]: https://github.com/cockroachdb/cockroach/pull/43547
[#43552]: https://github.com/cockroachdb/cockroach/pull/43552
[#43567]: https://github.com/cockroachdb/cockroach/pull/43567
[#43579]: https://github.com/cockroachdb/cockroach/pull/43579
[#43715]: https://github.com/cockroachdb/cockroach/pull/43715
[#43724]: https://github.com/cockroachdb/cockroach/pull/43724
[#43742]: https://github.com/cockroachdb/cockroach/pull/43742
[#43785]: https://github.com/cockroachdb/cockroach/pull/43785
[#43793]: https://github.com/cockroachdb/cockroach/pull/43793
[#43798]: https://github.com/cockroachdb/cockroach/pull/43798
[#43806]: https://github.com/cockroachdb/cockroach/pull/43806
[#43807]: https://github.com/cockroachdb/cockroach/pull/43807
[#43811]: https://github.com/cockroachdb/cockroach/pull/43811
[#43814]: https://github.com/cockroachdb/cockroach/pull/43814
[#43815]: https://github.com/cockroachdb/cockroach/pull/43815
[#43816]: https://github.com/cockroachdb/cockroach/pull/43816
[#43818]: https://github.com/cockroachdb/cockroach/pull/43818
[#43821]: https://github.com/cockroachdb/cockroach/pull/43821
[#43825]: https://github.com/cockroachdb/cockroach/pull/43825
[#43830]: https://github.com/cockroachdb/cockroach/pull/43830
[#43840]: https://github.com/cockroachdb/cockroach/pull/43840
[#43848]: https://github.com/cockroachdb/cockroach/pull/43848
[#43857]: https://github.com/cockroachdb/cockroach/pull/43857
[#43862]: https://github.com/cockroachdb/cockroach/pull/43862
[#43869]: https://github.com/cockroachdb/cockroach/pull/43869
[#43872]: https://github.com/cockroachdb/cockroach/pull/43872
[#43875]: https://github.com/cockroachdb/cockroach/pull/43875
[#43887]: https://github.com/cockroachdb/cockroach/pull/43887
[#43889]: https://github.com/cockroachdb/cockroach/pull/43889
[#43892]: https://github.com/cockroachdb/cockroach/pull/43892
[#43893]: https://github.com/cockroachdb/cockroach/pull/43893
[#43903]: https://github.com/cockroachdb/cockroach/pull/43903
[#43904]: https://github.com/cockroachdb/cockroach/pull/43904
[#43908]: https://github.com/cockroachdb/cockroach/pull/43908
[#43914]: https://github.com/cockroachdb/cockroach/pull/43914
[#43915]: https://github.com/cockroachdb/cockroach/pull/43915
[#43923]: https://github.com/cockroachdb/cockroach/pull/43923
[#43924]: https://github.com/cockroachdb/cockroach/pull/43924
[#43925]: https://github.com/cockroachdb/cockroach/pull/43925
[#43933]: https://github.com/cockroachdb/cockroach/pull/43933
[#43941]: https://github.com/cockroachdb/cockroach/pull/43941
[#43948]: https://github.com/cockroachdb/cockroach/pull/43948
[#43959]: https://github.com/cockroachdb/cockroach/pull/43959
[#43960]: https://github.com/cockroachdb/cockroach/pull/43960
[#43985]: https://github.com/cockroachdb/cockroach/pull/43985
[#44015]: https://github.com/cockroachdb/cockroach/pull/44015
[#44016]: https://github.com/cockroachdb/cockroach/pull/44016
[#44020]: https://github.com/cockroachdb/cockroach/pull/44020
[#44022]: https://github.com/cockroachdb/cockroach/pull/44022
[#44024]: https://github.com/cockroachdb/cockroach/pull/44024
[#44031]: https://github.com/cockroachdb/cockroach/pull/44031
[#44035]: https://github.com/cockroachdb/cockroach/pull/44035
[#44038]: https://github.com/cockroachdb/cockroach/pull/44038
[#44042]: https://github.com/cockroachdb/cockroach/pull/44042
[#44043]: https://github.com/cockroachdb/cockroach/pull/44043
[#44050]: https://github.com/cockroachdb/cockroach/pull/44050
[#44064]: https://github.com/cockroachdb/cockroach/pull/44064
[#44072]: https://github.com/cockroachdb/cockroach/pull/44072
[#44074]: https://github.com/cockroachdb/cockroach/pull/44074
[#44075]: https://github.com/cockroachdb/cockroach/pull/44075
[#44099]: https://github.com/cockroachdb/cockroach/pull/44099
[#44103]: https://github.com/cockroachdb/cockroach/pull/44103
[#44113]: https://github.com/cockroachdb/cockroach/pull/44113
[#44114]: https://github.com/cockroachdb/cockroach/pull/44114
[#44144]: https://github.com/cockroachdb/cockroach/pull/44144
[#44151]: https://github.com/cockroachdb/cockroach/pull/44151
[#44156]: https://github.com/cockroachdb/cockroach/pull/44156
[#44159]: https://github.com/cockroachdb/cockroach/pull/44159
[#44163]: https://github.com/cockroachdb/cockroach/pull/44163
[#44164]: https://github.com/cockroachdb/cockroach/pull/44164
[#44167]: https://github.com/cockroachdb/cockroach/pull/44167
[#44172]: https://github.com/cockroachdb/cockroach/pull/44172
[#44180]: https://github.com/cockroachdb/cockroach/pull/44180
[#44216]: https://github.com/cockroachdb/cockroach/pull/44216
[#44224]: https://github.com/cockroachdb/cockroach/pull/44224
[#44246]: https://github.com/cockroachdb/cockroach/pull/44246
[#44247]: https://github.com/cockroachdb/cockroach/pull/44247
[#44250]: https://github.com/cockroachdb/cockroach/pull/44250
[#44251]: https://github.com/cockroachdb/cockroach/pull/44251
[#44260]: https://github.com/cockroachdb/cockroach/pull/44260
[#44307]: https://github.com/cockroachdb/cockroach/pull/44307
[#44314]: https://github.com/cockroachdb/cockroach/pull/44314
[#44345]: https://github.com/cockroachdb/cockroach/pull/44345
[#44346]: https://github.com/cockroachdb/cockroach/pull/44346
[#44350]: https://github.com/cockroachdb/cockroach/pull/44350
[#44381]: https://github.com/cockroachdb/cockroach/pull/44381
[#44386]: https://github.com/cockroachdb/cockroach/pull/44386
[#44430]: https://github.com/cockroachdb/cockroach/pull/44430
[#44441]: https://github.com/cockroachdb/cockroach/pull/44441
[#44452]: https://github.com/cockroachdb/cockroach/pull/44452
[#44502]: https://github.com/cockroachdb/cockroach/pull/44502
[#44506]: https://github.com/cockroachdb/cockroach/pull/44506
[#44543]: https://github.com/cockroachdb/cockroach/pull/44543
[#42518]: https://github.com/cockroachdb/cockroach/pull/42518
[#43824]: https://github.com/cockroachdb/cockroach/pull/43824
[#43828]: https://github.com/cockroachdb/cockroach/pull/43828
[#44177]: https://github.com/cockroachdb/cockroach/pull/44177
[#44344]: https://github.com/cockroachdb/cockroach/pull/44344
[#44349]: https://github.com/cockroachdb/cockroach/pull/44349
[#44445]: https://github.com/cockroachdb/cockroach/pull/44445
[#44464]: https://github.com/cockroachdb/cockroach/pull/44464
[#44478]: https://github.com/cockroachdb/cockroach/pull/44478
[#44507]: https://github.com/cockroachdb/cockroach/pull/44507
[#44590]: https://github.com/cockroachdb/cockroach/pull/44590
[#44607]: https://github.com/cockroachdb/cockroach/pull/44607
[#44618]: https://github.com/cockroachdb/cockroach/pull/44618
[#44633]: https://github.com/cockroachdb/cockroach/pull/44633
[#44668]: https://github.com/cockroachdb/cockroach/pull/44668
[#44670]: https://github.com/cockroachdb/cockroach/pull/44670
[#44671]: https://github.com/cockroachdb/cockroach/pull/44671
[#44692]: https://github.com/cockroachdb/cockroach/pull/44692
[#44702]: https://github.com/cockroachdb/cockroach/pull/44702
[#44705]: https://github.com/cockroachdb/cockroach/pull/44705
[#44718]: https://github.com/cockroachdb/cockroach/pull/44718
[#44719]: https://github.com/cockroachdb/cockroach/pull/44719
[#44728]: https://github.com/cockroachdb/cockroach/pull/44728
[#44729]: https://github.com/cockroachdb/cockroach/pull/44729
[#44731]: https://github.com/cockroachdb/cockroach/pull/44731
[#44737]: https://github.com/cockroachdb/cockroach/pull/44737
[#44756]: https://github.com/cockroachdb/cockroach/pull/44756
[#44775]: https://github.com/cockroachdb/cockroach/pull/44775
[#44786]: https://github.com/cockroachdb/cockroach/pull/44786
[#44788]: https://github.com/cockroachdb/cockroach/pull/44788
[#44790]: https://github.com/cockroachdb/cockroach/pull/44790
[#44812]: https://github.com/cockroachdb/cockroach/pull/44812
[#44827]: https://github.com/cockroachdb/cockroach/pull/44827
[#44831]: https://github.com/cockroachdb/cockroach/pull/44831
[#44872]: https://github.com/cockroachdb/cockroach/pull/44872
[#44887]: https://github.com/cockroachdb/cockroach/pull/44887
[#44890]: https://github.com/cockroachdb/cockroach/pull/44890
[#44790]: https://github.com/cockroachdb/cockroach/pull/44790
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v20.1/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

In addition to various updates, enhancements, and bug fixes, this v20.1 beta release includes the ability to **log slow SQL queries**. By setting the `sql.log.slow_query.latency_threshold` [cluster setting](../v20.1/cluster-settings.html), each node of your cluster will log queries that exceed the specified service latency to a new file called `cockroach-sql-slow.log`.

<h3 id="v20.1.0-beta.2-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.2.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v20.1.0-beta.2-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v20.1.0-beta.2
~~~

<h3 id="v20.1.0-beta.2-security-updates">Security updates</h3>

- Operators can now disable external HTTP access when performing certain operations (`BACKUP`, `IMPORT`, etc.). The external HTTP access, as well as custom HTTP endpoints, are disabled by providing an `--external-io-disable-http` flag. This flag provides a light-weight option to disable external HTTP access in environments where running a full-fledged proxy server may not be feasible. If running a proxy server is acceptable, operators may choose to start the `cockroach` binary while specifying the `HTTP(S)_PROXY` environment variable. [#44900][#44900]

<h3 id="v20.1.0-beta.2-general-changes">General changes</h3>

- Added a slow query log facility to CockroachDB, configurable by setting the `sql.log.slow_query.latency_threshold` [cluster setting](../v20.1/cluster-settings.html). When used, each node of your cluster will record queries that exceed the specified service latency to a new file called `cockroach-sql-slow.log`. [#44816][#44816]
- New clusters will have a larger default range size of 512 MB, which will result in fewer ranges for the same amount of data. [#45209][#45209]

<h3 id="v20.1.0-beta.2-enterprise-edition-changes">Enterprise edition changes</h3>

- Row counts in `BACKUP` and `RESTORE` now include rows in system tables. [#44965][#44965]

<h3 id="v20.1.0-beta.2-sql-language-changes">SQL language changes</h3>

- Disallowed changing the primary key of a table in the same transaction as its `CREATE TABLE` statement. [#44815][#44815]
- Introduced the ability to create views using `CREATE VIEW IF NOT EXISTS`, which does nothing if the view already existed. [#44913][#44913]
- If temporary table creation is enabled, users now have the ability to create temporary sequences as well. [#44806][#44806]
- Added built-in support of hash-sharded indexes with new `USING HASH WITH BUCKET_COUNT = <n>` syntax for indices (including the primary index of a table). This feature allows users to easily relieve write hot-spots caused by sequential insert patterns at the cost of scan time for queries over the hashed dimension. [#42922][#42922]
- Added support for primary key changes into hash sharded indexes. [#44993][#44993]
- Disabled creating a hash sharded index that is also interleaved. [#44996][#44996]
- An `UPDATE` returning a serialization failure error (code `40001`) now leaves behind a lock, helping the transaction succeed if it retries. This prevents starvation of transactions where an `UPDATE` is prone to conflicts. [#44654][#44654]
- Added a builtin function `getdatabaseencoding()`, which returns the current encoding name used by the database. [#45129][#45129]
- The SQL:2008 syntax `OFFSET <x> ROWS` and `FETCH FIRST <y> ROWS ONLY` now accept parameter values. [#45112][#45112]
- Disallowed primary key changes on tables that are currently undergoing a primary key change. [#44784][#44784]
- Added support for the  aggregate function `corr()` [#44628][#44628]
- `INSERT..ON CONFLICT` index column names can now be specified in any order, rather than only in the same order as the index. [#45280][#45280]

<h3 id="v20.1.0-beta.2-command-line-changes">Command-line changes</h3>

- Previously, `cockroach debug zip` would only print an informational message about a piece of data it was retrieving *after* the data was retrieved (or an error was observed). This patch changes it to print a message beforehand as well. This enables better troubleshooting of hanging queries. [#44342][#44342]
- `cockroach debug zip` now properly supports special characters in database and table names. [#44342][#44342]
- `cockroach debug zip` will now apply [the `--timeout` parameter](../v20.1/cockroach-node.html) to the SQL queries it performs (there was no timeout previously, causing `cockroach debug zip` to potentially hang). [#44342][#44342]
- `cockroach debug zip` is now able to tolerate more forms of cluster unavailability. Nonetheless, in case system ranges are unavailable, it is recommended to run `cockroach debug zip` towards each node address in turn to maximize the amount of useful data collected. [#44342][#44342]
- `cockroach debug zip` now includes secondary log files in the main log directory, for example the RocksDB logs. Log files in alternate log directories (e.g., `--sql-audit-dir`, if different from the main log directory) are not included. [#45200][#45200]

<h3 id="v20.1.0-beta.2-admin-ui-changes">Admin UI changes</h3>

- Changed Decommissioned Node History view to accommodate the case when there are no decommissioned nodes. [#44205][#44205]
- Changed styling of the Cluster Overview view. [#44212][#44212]
- Endpoint `/_status/registry/{node_id}` will now display status info about the jobs running on this `node_id`. [#45030][#45030]
- The "Log file list" endpoint now includes secondary log files in the main log directory, for example the RocksDB logs. Log files in alternate log directories (e.g., `--sql-audit-dir`, if different from the main log directory) are not included. [#45200][#45200]

<h3 id="v20.1.0-beta.2-bug-fixes">Bug fixes</h3>

- Fixed a bug where CockroachDB could return an internal error on the queries that return `INT` columns when the default integer size has been changed. [#44930][#44930]
- Fixed a bug where CockroachDB could crash when running `EXPLAIN (VEC)` in some edge cases. Now, an internal error is returned instead. [#44931][#44931]
- Fixed a bug where CockroachDB would return an internal error when the merge join operation was performed via the vectorized execution engine in a case when two sides of the join had comparable but different types in the equality columns (for example, `INT2` on the left and `INT4` on the right). [#44942][#44942]
- Fixed internal query errors in some cases involving negative limits. [#45009][#45009]
- Fixed a bug where the distinct operation in the row execution engine would fail to properly account for its memory usage, potentially leading to OOMs on large tables. [#45254][#45254]
- Correctly handle Avro byte datums when converting them to the expected string column families (such as `VARCHAR`, `CHAR`, etc.). [#45242][#45242]
- Fixed a potential error occurring when loading the movr dataset with a large number of rows in the promo codes column. [#45035][#45035]

<h3 id="v20.1.0-beta.2-performance-improvements">Performance improvements</h3>

- The [cost-based-optimizer](../v20.1/cost-based-optimizer.html) now generates faster execution plans in some cases that involve `IN` / `NOT IN` with an empty tuple (or `= ANY` with an empty array). [#45170][#45170]

<h3 id="v20.1.0-beta.2-doc-updates">Doc updates</h3>

- Added a [tutorial for developing and deploying a multi-region web application](../v20.1/multi-region-overview.html) with Flask, SQLAlchemy, CockroachCloud, and Google Cloud Platform. [#5732][#5732]
- Added a [Developer Guide](../v20.1/developer-guide-overview.html) that shows how to do common application development tasks in several languages: Go, Java, and Python. [#6362][#6362]
- Added [information about how to access the Admin UI on secure clusters](../v20.1/admin-ui-overview.html). [#6640][#6640]
- Overhauled the documentation on [authorization](../v20.1/authorization.html), [roles](../v20.1/create-role.html), and [grants](../v20.1/grant.html). [#6332][#6332]
- Added docs for [troubleshooting node liveness](../v20.1/cluster-setup-troubleshooting.html). [#6322][#6322]
- Added docs for online primary key changes with [`ALTER TABLE ... ALTER PRIMARY KEY`](../v20.1/alter-table.html). [#6513][#6513]
- Added a [tutorial for using PonyORM with CockroachDB](../v20.1/build-a-python-app-with-cockroachdb-pony.html). [#6531][#6531]
- Added a [tutorial for using the jOOQ ORM with CockroachDB](../v20.1/build-a-java-app-with-cockroachdb-jooq.html). [#6684][#6684]

<h3 id="v20.1.0-beta.2-contributors">Contributors</h3>

This release includes 122 merged PRs by 33 authors.
We would like to thank the following contributors from the CockroachDB community:

- Andrii Vorobiov
- Artem Barger (first-time contributor)
- Jaewan Park
- abhishek20123g (first-time contributor)

[#6684]: https://github.com/cockroachdb/docs/pull/6684
[#6640]: https://github.com/cockroachdb/docs/pull/6640
[#6362]: https://github.com/cockroachdb/docs/pull/6362
[#5732]: https://github.com/cockroachdb/docs/pull/5732
[#6332]: https://github.com/cockroachdb/docs/pull/6332
[#6322]: https://github.com/cockroachdb/docs/pull/6322
[#6513]: https://github.com/cockroachdb/docs/pull/6513
[#6531]: https://github.com/cockroachdb/docs/pull/6531
[#42922]: https://github.com/cockroachdb/cockroach/pull/42922
[#44205]: https://github.com/cockroachdb/cockroach/pull/44205
[#44212]: https://github.com/cockroachdb/cockroach/pull/44212
[#44342]: https://github.com/cockroachdb/cockroach/pull/44342
[#44628]: https://github.com/cockroachdb/cockroach/pull/44628
[#44654]: https://github.com/cockroachdb/cockroach/pull/44654
[#44784]: https://github.com/cockroachdb/cockroach/pull/44784
[#44806]: https://github.com/cockroachdb/cockroach/pull/44806
[#44815]: https://github.com/cockroachdb/cockroach/pull/44815
[#44816]: https://github.com/cockroachdb/cockroach/pull/44816
[#44900]: https://github.com/cockroachdb/cockroach/pull/44900
[#44913]: https://github.com/cockroachdb/cockroach/pull/44913
[#44930]: https://github.com/cockroachdb/cockroach/pull/44930
[#44931]: https://github.com/cockroachdb/cockroach/pull/44931
[#44942]: https://github.com/cockroachdb/cockroach/pull/44942
[#44965]: https://github.com/cockroachdb/cockroach/pull/44965
[#44993]: https://github.com/cockroachdb/cockroach/pull/44993
[#44996]: https://github.com/cockroachdb/cockroach/pull/44996
[#45009]: https://github.com/cockroachdb/cockroach/pull/45009
[#45030]: https://github.com/cockroachdb/cockroach/pull/45030
[#45035]: https://github.com/cockroachdb/cockroach/pull/45035
[#45112]: https://github.com/cockroachdb/cockroach/pull/45112
[#45129]: https://github.com/cockroachdb/cockroach/pull/45129
[#45170]: https://github.com/cockroachdb/cockroach/pull/45170
[#45200]: https://github.com/cockroachdb/cockroach/pull/45200
[#45209]: https://github.com/cockroachdb/cockroach/pull/45209
[#45242]: https://github.com/cockroachdb/cockroach/pull/45242
[#45254]: https://github.com/cockroachdb/cockroach/pull/45254
[#45280]: https://github.com/cockroachdb/cockroach/pull/45280
<h2 id="{{ include.release | slugify }}">{{ include.release }}</h2>

Release Date: {{ include.release_date | date: "%B %-d, %Y" }}

{{site.data.alerts.callout_danger}}
{% include /v20.1/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

In addition to various updates, enhancements, and bug fixes, this beta release includes the following major highlights:

- **SELECT FOR UPDATE**: CockroachDB now supports [`SELECT FOR UPDATE`](../v20.1/select-for-update.html) for ordering transactions. Use `SELECT FOR UPDATE` to lock the rows returned by a [selection query](../v20.1/selection-queries.html), to control concurrent access to one or more rows of a table.
- **SQL savepoints**: CockroachDB now fully supports SQL [savepoints](../v20.1/savepoint.html). New syntax for savepoints includes `SAVEPOINT <foo>`, `RELEASE SAVEPOINT <foo>`, and `ROLLBACK TO SAVEPOINT <foo>`. To inspect the current stack of active savepoints, use `SHOW SAVEPOINT STATUS`.  
- **Hash-sharded indexes**: CockroachDB now supports new syntax for defining [hash-sharded indexes](https://www.cockroachlabs.com/blog/hash-sharded-indexes-unlock-linear-scaling-for-sequential-workloads/). Hash-sharded indexes improve write performance to indexes on sequential keys. To define a hash-sharded index, use `CREATE INDEX ... USING HASH WITH BUCKET_COUNT = <number of buckets>`.
- **RBAC now under BSL**: All [role-based access control (RBAC) features](../v20.1/authorization.html#roles) (`CREATE ROLE`, `ALTER ROLE`, `DROP ROLE`, `GRANT ROLE`, `REVOKE ROLE`) are now [BSL features](../v20.1/licensing-faqs.html) and available to non-enterprise users.
- **Improved vectorized execution**: [Vectorized execution](../v20.1/vectorized-execution.html) now supports [hash joins](../v20.1/joins.html#hash-joins), [merge joins](../v20.1/joins.html#merge-joins), and most [window functions](../v20.1/window-functions.html). By default, the `vectorized` [session variable](../v20.1/set-vars.html) is set to `auto`, which uses vectorized execution for all queries except those including unordered [`DISTINCT`](../v20.1/select-clause.html#eliminate-duplicate-rows) clauses or calls to the `percent_rank` or `cume_dist` [window functions](../v20.1/window-functions.html). To turn vectorized execution on for all operations, set `vectorized` to `on`.
- **Statement tracing in the Admin UI**: Statement diagnostic information is now available in the Admin UI. When viewing a statement fingerprint in the Admin UI, you can now trigger a trace on the next query execution matching that statement fingerprint.

<h3 id="v20.1.0-beta.3-downloads">Downloads</h3>

<div id="os-tabs" class="clearfix os-tabs_button-outline-primary">
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.3.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.3.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.3.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v20.1.0-beta.3.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

<h3 id="v20.1.0-beta.3-docker-image">Docker image</h3>

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach-unstable:v20.1.0-beta.3
~~~

<h3 id="v20.1.0-beta.3-backward-incompatible-changes">Backward-incompatible changes</h3>

- The [`GRANT`](../v20.1/grant.html) and [`REVOKE`](../v20.1/revoke.html) statements now require that the requesting user already have the target privileges themselves. For example, `GRANT SELECT ON t TO foo` requires that the requesting user already have the `SELECT` privilege on `t`. [#45697][#45697] {% comment %}doc{% endcomment %}
- During the upgrade process from 19.2 to 20.1, almost all schema changes will now be disallowed on 20.1 nodes until the upgrade has been finalized, as part of ensuring consistency while the cluster undergoes a significant, backward-incompatible change in how schema changes are executed. Attempting these schema changes will return an error to the client. [#45990][#45990]
- To ensure consistency for [schema changes](../v20.1/online-schema-changes.html) throughout the upgrade process to 20.1, schema changes initiated in 19.2 now cannot be adopted, paused, or resumed from 20.1 nodes until an internal migration is run. [#46214][#46214]

<h3 id="v20.1.0-beta.3-security-updates">Security updates</h3>

<h3 id="v20.1.0-beta.3-identity-management-changes">Identity management changes</h3>

- All [role-based access control (RBAC) features](../v20.1/authorization.html#roles) (`CREATE ROLE`, [`ALTER ROLE`], `DROP ROLE`, `GRANT ROLE`, `REVOKE ROLE`) are now available to non-enterprise users. All RBAC features are now [BSL features](../v20.1/licensing-faqs.html). [#46042][#46042]
- [`USER`s](../v20.1/create-user.html) and [`ROLE`s](../v20.1/create-role.html) are now the same (which is PostgreSQL behavior). This means `CREATE`/`ALTER`/`DROP` `ROLE`/`USER` can be used interchangeably. [#44968][#44968] {% comment %}doc{% endcomment %}
- The validation rule for principal names was extended to support periods and thus allow domain name-like principals. For reference, the validation rule is currently the regular expression `^[p{Ll}0-9_][---p{Ll}0-9_.]*$`, and limited to a size of 63 UTF-8 bytes (larger usernames are rejected with an error); for comparison, PostgreSQL allows many more characters and truncates at 63 characters silently. [#45575][#45575] {% comment %}doc{% endcomment %}
- [Usernames](../v20.1/create-user.html) can now contain periods, for compatibility with certificate managers that require domain names to be used as usernames. [#45575][#45575] {% comment %}doc{% endcomment %}
- User and role principals can now be prevented from logging in using the `NOLOGIN` attribute, which can be set using the [`CREATE USER/ROLE`](../v20.1/create-user.html) or [`ALTER USER/ROLE`](../v20.1/alter-user.html). When using the [`CREATE ROLE`](../v20.1/create-user.html) syntax, `NOLOGIN` is enabled by default whereas when using [`CREATE USER`](../v20.1/create-role.html), it is not. [#45541][#45541] {% comment %}doc{% endcomment %}
- The `CREATEROLE` option can now be granted to users/roles using [`CREATE USER/ROLE`](../v20.1/create-user.html) or [`ALTER USER/ROLE`](../v20.1/alter-user.html). This delegates the permission to create additional roles. [#44232][#44232] {% comment %}doc{% endcomment %}
- Any [role](../v20.1/authorization.html#roles) created prior to v20.1 will be able to log into clusters started with `--insecure`, unless/until they are given the `NOLOGIN` attribute. For secure clusters, roles cannot log in by virtue of not having a password nor a client certificate. [#45541][#45541] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-beta.3-authentication-changes">Authentication changes</h3>

- CockroachDB now offers the ability to SQL client connection events (connection established and connection terminated) and SQL client authentication events (authentication method selection, authentication method application, authentication method result, and session termination) to a distinct `cockroach-auth.log` file in each node's main log directory. To enable SQL client connection logging, set the `server.auth_log.sql_connections.enabled` [cluster setting](../v20.1/cluster-settings.html). To enable SQL client authentication event logging, set the new `server.auth_log.sql_sessions.enabled` [cluster setting](../v20.1/cluster-settings.html) cluster setting. Note that this feature is experimental; as such, the interface and output are subject to change. [#45193][#45193] {% comment %}doc{% endcomment %}
- The password field (used exclusively for password-based authentication) can now be configured to have an expiration date using the `VALID UNTIL` attribute, which can be set with [`ALTER USER/ROLE`](../v20.1/alter-user.html). Note that the attribute sets an expiration date for the password, not the user account. This is consistent with PostgreSQL. [#45541][#45541] {% comment %}doc{% endcomment %}
- Client and node certificates are now allowed to specify the principal in either the SubjectCommonName field or the SubjectAlternateNames field. Previously, the principal could only be specified in the SubjectCommonName field. This facilitates the use of Amazon Certificate Manager (ACM) and other Cloud-based certificate management tools. [#45819][#45819]

<h3 id="v20.1.0-beta.3-authorization-changes">Authorization changes</h3>

- Admin users can now [grant](../v20.1/grant.html) `ZONECONFIG` to non-admin users on specific SQL objects (databases/tables). When set, the user is authorized to modify that object's [zone configuration](../v20.1/configure-replication-zones.html) and decide data placement on specific nodes or groups thereof. [#45201][#45201] {% comment %}doc{% endcomment %}
- The [`GRANT`](../v20.1/grant.html) statement has been changed to be more like a capability-based system: it can only propagate privileges that the requesting user already has. Previously, it could be used to grant any other bit to any user, even to the requesting user. Note that the pseudo-privilege `ALL` includes `GRANT`, so `GRANT ALL`, in effect, preserves the previous behavior: it grants `GRANT` and every over privileges, so all privileges can be re-granted transitively. [#45697][#45697] {% comment %}doc{% endcomment %}
- It is now possible for operators to disable the use of implicit credentials when accessing external cloud storage services for various bulk operations (e.g, [`BACKUP`](../v20.1/backup.html), [`IMPORT`](../v20.1/import.html), etc.).  The use of implicit credentials can be disabled by using the `--external-io-disable-implicit-credentials` flag. [#45969][#45969] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-beta.3-security-bug-fixes">Security bug fixes</h3>

-  All users can now *view* any comments on any object (bypassing other privileges), but modifying comments require write privilege on the target object. Previously, any user could modify any database/table/view/index comment via direct SQL updates to `system.comments`. This was unintended and a form of privilege escalation, and is now prevented. The privileges required for the [`COMMENT`](../v20.1/comment-on.html) statement, `pg_description`, `col_description()`, `obj_description()`, and `shobj_description()` are operating as in PostgreSQL and are unaffected by this change.[#45712][#45712] {% comment %}doc{% endcomment %}
- The `--external-io-dir=disabled` now applies to `nodelocal upload` requests. [#45858][#45858] {% comment %}doc{% endcomment %}
- The non-authenticated `/health` HTTP endpoint was previously exposing the private IP address of the node, which can be privileged information in some deployments. This has been corrected. Deployments using automation to retrieve a node build details and address details should use `/_status/details/local` instead and use a valid admin authentication cookie. [#45119][#45119]

<h3 id="v20.1.0-beta.3-enterprise-edition-changes">Enterprise edition changes</h3>

- [CDC](../v20.1/change-data-capture.html) to cloud-storage sinks now supports optional `gzip` compression. [#45326][#45326] {% comment %}doc{% endcomment %}
- [`BACKUP`](../v20.1/backup.html) can be re-run with the same destination path to automatically append an incremental backup to that path. [#45255][#45255] {% comment %}doc{% endcomment %}
- [`RESTORE`](../v20.1/restore.html) now allows using `AS OF SYSTEM TIME` to pick a target backup from a larger list of incremental backups. [#45368][#45368] {% comment %}doc{% endcomment %}
- [Changefeeds](../v20.1/create-changefeed.html) now have new options to control the types of schema change events the changefeed should respond to (`schema_change_events`), and the behavior to take when such an event occurs (`schema_change_policy`). This functionality allows users to halt changefeeds upon schema changes or skip over the logical backfill that is performed by default. [#45652][#45652] {% comment %}doc{% endcomment %}
- Two new [`CHANGEFEED`](../v20.1/create-changefeed.html) options, `initial_scan` and `no_initial_scan`, have been added. The `initial_scan` can be used only if no cursor had been specified (indicating the desire to start the `CHANGEFEED` from `now()`). The new options allow clients to override this default behavior and create changefeeds from the present without an initial scan, or from a point in time with one. You cannot specify both options simultaneously. [#45663][#45663] {% comment %}doc{% endcomment %}
- [`BACKUP`](../v20.1/backup.html) will no longer fail if the GC window for a table is exceeded while backing the table up. [#45859][#45859] {% comment %}doc{% endcomment %}
- Incremental [`BACKUP`](../v20.1/backup.html) can quickly skip unchanged data, making frequent incremental backups 10-100x faster, depending on data size and frequency. [#46108][#46108]

<h3 id="v20.1.0-beta.3-storage-changes">Storage changes</h3>

- Improved the ability of garbage collection to process ranges exhibiting abnormally large numbers of transaction records and/or abort span entries. [#45444][#45444]
- Improved a debug message that is printed when a range is unavailable (i.e., unable to accept writes). [#45580][#45580]
- The timing of garbage collection for historical data is defined by the `gc.ttlseconds` variable in the applicable [zone configuration](../v20.1/configure-replication-zones.html#replication-zone-variables). However, in practice, data is not garbage collected immediately after the TTL passes. The new `kv.gc_ttl.strict_enforcement` [cluster setting](../v20.1/cluster-settings.html) makes sure that `AS OF SYSTEM TIME` queries older than the TTL, but before GC has happened, return an error. [#45826][#45826]
- A bug in the range metrics collection would fail to correctly identify a range that had lost quorum, causing it to not be reported via the "unavailable ranges" metric. This is now fixed. [#45253][#45253]
- Range garbage collection will now trigger based on a large abort span, adding defense-in-depth against ranges growing large (and eventually unstable). [#45573][#45573]
- Fixed a bug that could cause requests to a quiesced range to hang in the KV [replication layer](../v20.1/architecture/replication-layer.html). This bug would cause the message "have been waiting ... for proposing" to appear. even though no loss of quorum occurred. [#46045][#46045]

<h3 id="v20.1.0-beta.3-sql-changes">SQL changes</h3>

<h3 id="v20.1.0-beta.3-sql-language-additions">SQL language additions</h3>

- CockroachDB now supports string and byte array literals using the dollar-quoted notation, as documented [here](https://www.postgresql.org/docs/current/sql-syntax-lexical.html#SQL-SYNTAX-DOLLAR-QUOTING). [#44130][#44130] {% comment %}doc{% endcomment %}
- CockroachDB now supports expanding all columns of a tuple using the `.*` notation, for example: `SELECT (t).* FROM (SELECT (1,'b',2.3) AS t)`. This is a CockroachDB-specific extension. [#45609][#45609] {% comment %}doc{% endcomment %}
- CockroachDB now supports accessing the Nth column in a column with tuple type using the syntax `(...).@N`, for example: `SELECT (t).@2 FROM (SELECT (1,'b',2.3) AS t)`. This is a CockroachDB-specific extension. [#45609][#45609] {% comment %}doc{% endcomment %}
- Duplicate rows in the input to an [`INSERT..ON CONFLICT DO NOTHING`](../v20.1/insert.html) statement will now be ignored rather than triggering an error. [#45443][#45443] {% comment %}doc{% endcomment %}
- SQL [savepoints](../v20.1/savepoint.html) are now supported. `SAVEPOINT <foo>`, `RELEASE SAVEPOINT <foo>`, and `ROLLBACK TO SAVEPOINT <foo>` now work. `SHOW SAVEPOINT STATUS` can be used to inspect the current stack of active savepoints. [#45566][#45566]
- CockroachDB still considers the name `cockroach_restart` special in [`SAVEPOINT`](../v20.1/savepoint.html)s. A savepoint defined with the name `cockroach_restart` is a "restart savepoint" and has different semantics than standard savepoints:  
    1. Restart savepoints must be opened immediately when the transaction starts. Opening a restart savepoint after other statements have been executed is not allowed. In contrast, standard savepoints can be opened after other statements have already been executed.  
    2. After a successful `RELEASE`, a restart savepoint does not allow further use of the transaction. `COMMIT` must immediately follow the RELEASE.
    3. Restart savepoints cannot be nested. Issuing `SAVEPOINT cockroach_restart` two times in a row only creates a single savepoint marker. This can be seen with `SHOW SAVEPOINT STATUS`. Issuing `SAVEPOINT cockroach_restart` after `ROLLBACK TO SAVEPOINT cockroach_restart` reuses the marker instead of creating a new one. In contrast, two `SAVEPOINT` statements with a standard savepoint name, or a `SAVEPOINT` statement immediately after a `ROLLBACK`, create two distinct savepoint markers.

    **Note:** The [session variable](../v20.1/set-vars.html) `force_savepoint_restart` still works and causes every savepoint name to become equivalent to `cockroach_restart` with the special semantics described above. [#46194][#46194]
- [`SELECT FOR UPDATE`](../v20.1/select-for-update.html) now hooks into a new leaseholder-only locking mechanism. This allows the feature to be used to improve performance of [transactions](../v20.1/transactions.html) that read, modify, and write contended to rows. Similarly, [`UPDATE`](../v20.1/update.html) statements now use this new mechanism by default, meaning that their performance under contention is improved. This is only enabled for `UPDATE` statements that can push their filter all the way into their key-value scan. To determine whether an `UPDATE` statement is implicitly using `SELECT FOR UPDATE` locking, look for a `locking strength` field in the `EXPLAIN` output for the statement. [#45701][#45701] {% comment %}doc{% endcomment %}
- The statement `CREATE SCHEMA IF NOT EXISTS` is now accepted, and ignored, if it targets one of the pre-defined schemas (`public`, `pg_temp`, `pg_catalog`, etc.) [#42703][#42703]
- Added the `every` [aggregate function](../v20.1/functions-and-operators.html#aggregate-functions). [#46059][#46059]
- The `ceil` and `floor` [built-in functions](../v20.1/functions-and-operators.html) now accept integer inputs. [#46166][#46166]

<h3 id="v20.1.0-beta.3-query-planning-changes">Query planning changes</h3>

- CockroachDB previously allowed [`TIMESTAMP`/`TIMESTAMPTZ`](../v20.1/timestamp.html) and [`TIME`/`TIMETZ`](../v20.1/time.html) to be converted to `TIMESTAMP(0)`/`TIMESTAMPTZ(0)`, but this does not actually change any of the precision within it. CockroachDB now prohibits converting any precision of `TIMESTAMP`/`TIMESTAMPTZ`/`TIME`/`TIMETZ` to a lower precision value. [#45314][#45314] {% comment %}doc{% endcomment %}
- [Operators](../v20.1/functions-and-operators.html) on two [arrays](../v20.1/array.html) with different element types now fail at type-check time instead of evaluation time. [#45260][#45260]
- Improved the error message for the unsupported interaction between correlated subqueries and `WITH` clauses [#45227][#45227]
- [`UPSERT`](../v20.1/upsert.html) and [`INSERT..ON CONFLICT`](../v20.1/insert.html) statements now (occasionally) need to do an extra check to ensure that they never update the same row twice. This may adversely affect performance in cases where the [optimizer](../v20.1/cost-based-optimizer.html) cannot statically prove the extra check is unnecessary. [#45372][#45372]
- The [optimizer](../v20.1/cost-based-optimizer.html) now considers the likely number of rows an operator will need to provide, and might choose query plans based on this. In particular, the optimizer might prefer [lookup joins](../v20.1/joins.html) over alternatives in some situations where all rows of the join will probably not be needed. [#45604][#45604]
- [JSONB](../v20.1/jsonb.html) columns can now used in `GROUP BY` and `DISTINCT ON` clauses. [#45229][#45229] {% comment %}doc{% endcomment %}
- The [inverted index](../v20.1/inverted-indexes.html) implementation now supports indexing [array](../v20.1/array.html) columns. This permits accelerating containment queries (`@>` and `<@`) on array columns by adding an index to them. [#45157][#45157] {% comment %}doc{% endcomment %}
- [`EXPLAIN BUNDLE`](../v20.1/explain.html) can now be used to run a query and collect execution information in a support bundle, which can be downloaded via the Admin UI. [#45735][#45735] {% comment %}doc{% endcomment %}
- [`EXPLAIN BUNDLE`](../v20.1/explain.html) now works when the client driver prepares the statement. [#46111][#46111]
- Renamed `experimental_optimizer_foreign_keys` [session variable](../v20.1/set-vars.html) and `sql.defaults.optimizer_foreign_keys.enabled` [cluster setting](../v20.1/cluster-settings.html) to remove the experimental prefix. [#46174][#46174]
- Fixed the `"negative limit hint"` internal query error. [#45879][#45879]
- Fixed query errors in cases where a [CTE](../v20.1/common-table-expressions.html) was used inside a recursive CTE. [#45877][#45877]
- Fixed an internal error that could occur in the optimizer when a `WHERE` filter contained at least one [correlated subquery](../v20.1/subqueries.html#correlated-subqueries) and one non-correlated subquery. [#46153][#46153]
- Improvements in session settings reporting in the [`EXPLAIN (OPT,ENV)`](../v20.1/explain.html) output. [#46212][#46212]

<h3 id="v20.1.0-beta.3-execution-changes">Execution changes</h3>

- The new `diagnostics.sql_stat_reset.interval` [cluster setting](../v20.1/cluster-settings.html) controls the rate at which SQL statement statistics are refreshed. Additionally, the setting `diagnostics.forced_stat_reset.interval` was renamed to `diagnostics.forced_sql_stat_reset_interval`. [#45082][#45082] {% comment %}doc{% endcomment %}
- [`UPDATE`](../v20.1/update.html) statements now acquire locks using the `FOR UPDATE` locking mode during their initial row scan, which improves performance for contended workloads. This behavior is configurable using the `enable_implicit_select_for_update` [session variable](../v20.1/set-vars.html) and the `sql.defaults.implicit_select_for_update.enabled` [cluster setting](../v20.1/cluster-settings.html). [#45159][#45159] {% comment %}doc{% endcomment %}
- Hash joins and sorts are now run using the vectorized engine when `vectorize=auto` (default configuration). [#45582][#45582] {% comment %}doc{% endcomment %}
- CockroachDB now collects separate sets of metrics for usage of [`SAVEPOINT`](../v20.1/savepoint.html): one set for regular SQL savepoints and one set for uses dedicated to CockroachDB's client-side transaction retry protocol. [#45566][#45566]
- Vectorized distributed flows and disk spilling now support the [`INTERVAL`](../v20.1/interval.html) type. [#45776][#45776] {% comment %}doc{% endcomment %}
- Queries with [`MERGE` join](../v20.1/joins.html) can now run via the vectorized engine when `vectorize` is set to `auto`. [#45784][#45784] {% comment %}doc{% endcomment %}
- Hash aggregation is now supported in `vectorize=auto` mode. [#45832][#45832] {% comment %}doc{% endcomment %}
- Added telemetry reporting for usages of inverted and hash-sharded indexes. [#46060][#46060]
- The statement tag returned to the client upon success for [`CREATE USER`](../v20.1/create-user.html), [`ALTER USER`](../v20.1/alter-user.html), and [`DROP USER`](../v20.1/drop-user.html) now include the word "ROLE" instead of "USER", for compatibility with PostgreSQL. These three statements are now aliases for `CREATE ROLE`, `ALTER ROLE`, `DROP ROLE`. [#46042][#46042]
- `experimental_on` option for `vectorize` [session variable](../v20.1/set-vars.html) has been renamed to `on`. The only things that will not run with `auto`, but will run with `on`, are unordered [`DISTINCT`](../v20.1/select-clause.html#eliminate-duplicate-rows) and two [window functions](../v20.1/window-functions.html) (`percent_rank` and `cume_dist`). The two options are otherwise identical. [#46080][#46080]
- `NOTICE` commands can now be sent by CockroachDB servers using the Postgres client/server protocol. These notices will print when using the CockroachDB CLI.  These notices can be disabled using the [cluster setting](../v20.1/cluster-settings.html) `sql.notices.enabled = false`. [#45679][#45679] {% comment %}doc{% endcomment %}
- Fixed an internal error that could occur when `NULLIF` was called with one null argument. [#45354][#45354]
- Fix a bug where `EXPERIMENTAL SCRUB TABLE` on a timestamp/timestamptz key does not work. [#45410][#45410]
- Significantly reduced the amount of memory allocated while scanning tables with a large average row size. [#45323][#45323]
- Some vectorized execution plans that used [lookup joins](../v20.1/joins.html) with decimals would previously return incorrect results. This is now fixed. [#45536][#45536]
- Previously, drivers that did not truncate trailing zeroes for decimals in the binary format end up having inaccuracies of up to 10^4 during the decode step. Fixed the error by truncating the trailing zeroes as appropriate. This fixes known incorrect decoding cases with Postgres in Elixir. [#45613][#45613]
- Previously, an internal error could occur in CockroachDB when executing queries via the vectorized engine in queries that contained unordered synchronizers. This has been fixed. [#45690][#45690]
- Fixed a bug where the distinct operation on `ARRAY[NULL]` and `NULL` could sometimes return an incorrect result and omit some tuples. [#45229][#45229]
- Previously, CockroachDB could crash when computing [window functions](../v20.1/window-functions.html) with the `RANGE` mode of framing when one of the bounds was either  `'offset PRECEDING'` or `'offset FOLLOWING'` and when there were `NULL` values in the single column from `ORDER BY` clause. Additionally, also in `RANGE` mode, bounds `'0 PRECEDING'` and `'0 FOLLOWING'` could be handled incorrectly. This is now fixed. [#44666][#44666]
- Verify column is now visible before accessing its datums. [#45801][#45801]
- Expected errors from the vectorized execution engine are no longer mistakenly annotated as unexpected errors. [#45673][#45673]
- Mixed type comparison or binary expressions that could have previously returned wrong results in the vectorized execution engine now fall back to using the row execution engine. [#45724][#45724]
- Fixed [decimal](../v20.1/decimal.html) rounding errors in the vectorized execution engine. [#45950][#45950]
- Fixed a bug where various [session variables](../v20.1/set-vars.html) whose value would display as "`on`" or "`off`" could not be set to the values "`on`" or "`off`", only `true` or `false`. [#46163][#46163]
- Fixed a bug that caused transactions that have performed [schema changes](../v20.1/online-schema-changes.html) to deadlock after they restart. [#46170][#46170]

<h3 id="v20.1.0-beta.3-updates-to-schema-change-ddl-statements">Updates to schema change / DDL statements</h3>

- It is now possible to [create a table](../v20.1/create-table.html) and then add or alter a [primary key](../v20.1/primary-key.html) within the same transaction. [#46015][#46015]
- The [`ALTER TABLE .. ADD PRIMARY KEY ...`](../v20.1/alter-table.html) command can now be used when the target table has the default rowid [primary key](../v20.1/primary-key.html). [#45514][#45514] {% comment %}doc{% endcomment %}
- Fixed a bug where a table without a [primary key](../v20.1/primary-key.html) and a column named `rowid` would throw an error when being created. [#45507][#45507]
- The use of schema changes when a [primary key](../v20.1/primary-key.html) change is in progress is now disabled. This includes the following: (1) running a primary key change in a transaction and then starting another schema change in the same transaction, and (2) starting a primary key change on one connection and then starting a schema change on the same table on another connection while the initial primary key change is currently executing. [#45397][#45397] {% comment %}doc{% endcomment %}
- CockroachDB has now disabled [primary key](../v20.1/primary-key.html) changes when a concurrent schema change is executing on the same table, or if a schema change has been started on the same table in the current transaction. [#45513][#45513] {% comment %}doc{% endcomment %}
- You can now drop a [primary key](../v20.1/primary-key.html) as long as you add another primary key within the same [transaction](../v20.1/transactions.html). This feature is intended to be used when you do not want the existing primary key to be rewritten as a secondary index by [`ALTER PRIMARY KEY`](../v20.1/alter-primary-key.html). [#44511][#44511] {% comment %}doc{% endcomment %}
- The experimental variable gating around usages of online primary key changes is now removed. [#45753][#45753] {% comment %}doc{% endcomment %}
- Previously, when a [database was renamed](../v20.1/rename-database.html), any [table](../v20.1/create-table.html) referencing a [sequence](../v20.1/create-sequence.html) would be blocked from being able to rename the table. This is to block cases where if the table's reference to the sequence contains the database name, and the database name changes, we have no way of overwriting the table's reference to the sequence in the new database. However, if no database name is included in the sequence reference, we should continue to allow the database to rename, as is implemented with this change. [#45502][#45502] {% comment %}doc{% endcomment %}
- Previously, [renaming a database](../v20.1/rename-database.html) with dependent [views](../v20.1/views.html) returned a misleading error message that implies it was a dependent view on a dependent table. Now the error message generically says `cannot rename relation ... as it depends on relation ...` instead. [#45427][#45427]
- Long-running [transactions](../v20.1/transactions.html) which attempt to [`TRUNCATE`](../v20.1/truncate.html) can now be pushed and will commit in cases where they previously could fail or retry forever. [#44091][#44091]
- It is now possible to create [inverted indexes](../v20.1/inverted-indexes.html) on columns whose names are mixed-case. [#45621][#45621]

<h3 id="v20.1.0-beta.3-updates-to-bulk-i-o-statements">Updates to Bulk I/O statements</h3>

- Improved error messages when [importing MySQL dump](../v20.1/migrate-from-mysql.html) data. [#45958][#45958]
- `nodelocal://` URIs now require a node ID be specified in the hostname field. The special node ID of `'self'` is equivalent to the old behavior of when the node ID was unspecified. [#45764][#45764] {% comment %}doc{% endcomment %}
- Fixed cases where target column specifications in [`IMPORT INTO`](../v20.1/import-into.html) were ignored. [#45747][#45747]
- `IMPORT` now correctly handles columns named with reserved keywords and/or other special characters. [#45944][#45944]
- Google storage client is now resilient to transient connection errors. [#46000][#46000]
- The creation of a database and table between incremental cluster backups is now allowed. [#46066][#46066]
- Better error reporting when importing data. [#46165][#46165]

<h3 id="v20.1.0-beta.3-changes-to-background-job-management">Changes to background job management</h3>

- Schema changes are now scheduled and run fully like other [jobs](../v20.1/show-jobs.html): they now can be [canceled](../v20.1/cancel-job.html), [paused](../v20.1/pause-job.html), and [resumed](../v20.1/resume-job.html). Some other UI differences come with this implementation change; notably, all schema changes now have an associated job, failed schema changes are now rolled back within the "Reverting" phase of the same job, and GC for dropped indexes and tables is deferred to a later job. [#45870][#45870]
- Non-running [`jobs`](../v20.1/show-jobs.html) are now considered for adoption in randomized order instead of in a determistic order by creation time, to avoid potential deadlocks when schema change jobs need to execute in a specific order. This is a preemptive change, not a bug fix, but it affects all jobs. [#45870][#45870] {% comment %}doc{% endcomment %}
- On new clusters, the internal `system.jobs` table now uses the default `zoneconfig` and `TTL` (25h). [#45767][#45767] {% comment %}doc{% endcomment %}
- The cleanup job spawned by [`ALTER .. PRIMARY KEY`](../v20.1/alter-primary-key.html) in some cases cannot be cancelled. [#45595][#45595] {% comment %}doc{% endcomment %}
- Introduced a temporary table cleanup job that runs once every periodically per cluster. It removes any temporary schemas and their related objects that did not get removed cleanly when the connection closed. This period can be changed by the [cluster setting](../v20.1/cluster-settings.html) `sql.temp_object_cleaner.cleanup_interval`, which defaults to 30 minutes. [#45669][#45669] {% comment %}doc{% endcomment %}
- Previously, after deleting an index, table, or database, the relevant schema change job would change its running status to waiting for GC TTL. The schema change and the GC process are now decoupled into two jobs. [#45962][#45962]
- Fixed a bug where, in some rare cases, a job was not [cancellable](../v20.1/cancel-job.html) when in state "Reverting". [#45320][#45320]
- When considering if a job should be orphaned, CockroachDB use to take the conservative approach when a descriptor ID pointing to non-existent descriptor was found. This caused jobs to hang forever and be garbage collected. CockroachDB now disregards these IDs when considering if a job has still work to do. [#45353][#45353]
- Logs emitted from [jobs](../v20.1/show-jobs.html) are now tagged with the job ID to improve visibility and aid debugging. [#45728][#45728]
- [`IMPORT INTO`](../v20.1/import-into.html) jobs which are canceled or fail can no longer get stuck in an unrecoverable state if data from the previous state of the table had expired relative to the GC TTL. [#44739][#44739]
- [`CHANGEFEED`](../v20.1/create-changefeed.html) jobs that take a long time to perform backfills will no longer encounter failures due to garbage collection, so long as they begin before the data has expired. [#45778][#45778]

<h3 id="v20.1.0-beta.3-updates-to-apis-and-introspection">Updates to APIs and introspection</h3>

- Telemetry reporting has been added for the commands [`SHOW INDEXES`](../v20.1/show-index.html), [`SHOW QUERIES`](../v20.1/show-queries.html), [`SHOW JOBS`](../v20.1/show-jobs.html), and [`SHOW CONSTRAINTS`](../v20.1/show-constraints.html). [#45897][#45897]
- [`SHOW USERS`](../v20.1/show-users.html) and [`SHOW ROLES`](../v20.1/show-roles.html) are now the same, as `USERS` is now an alias for `ROLES`. `SHOW USERS` and `SHOW ROLES` now match PostgreSQL `du` command. `SHOW ROLES` now displays three columns: `username`, `options`, and `member_of`. [#45827][#45827]
- HTTP endpoints now report status `403 (Forbidden)` instead of `500 (Internal server error)` when the authenticated user has insufficient privileges to use the endpoint. [#45325][#45325] {% comment %}doc{% endcomment %}
- The end point `/_status/job/{job_id}` will now display status info about a job. [#45094][#45094] {% comment %}doc{% endcomment %}
- The pprof endpoints now allow downloading the binary profiles. To do so, attach `?download=true` to the URL. [#45790][#45790] {% comment %}doc{% endcomment %}
- Improved the debuggability of C++-level issues by providing access to thread stack traces via a new `/debug/threads` endpoint, which is exposed on the Admin UI advanced debug page. Now include thread stack traces in the info collected by `debug zip`. Thread stack traces are currently only available on Linux. [#45321][#45321] {% comment %}doc{% endcomment %}
- Accesses to `/health` using a non-root authentication token no longer hang when a node is currently under load, or if a system range is unavailable. [#45119][#45119]
- Statement diagnostics traces now contain processor statistics. [#46132][#46132]

<h3 id="v20.1.0-beta.3-command-line-changes">Command-line changes</h3>

<h3 id="v20.1.0-beta.3-changes-to-operational-workflows">Changes to operational workflows</h3>

- Hostnames from the `cockroach start --join` flag can now be resolved as SRV record. This simplifies cluster deployment in Kubernetes. [#45815][#45815] {% comment %}doc{% endcomment %}
- The `--decommission` flag for [`cockroach quit`](../v20.1/cockroach-quit.html) is now deprecated. It will be removed altogether in a next stable release. Deployments should use [`cockroach node decommission`](../v20.1/cockroach-node.html) followed by either `cockroach quit` or an equivalent form of server shut down. [#45903][#45903] {% comment %}doc{% endcomment %}
- The `--socket` flag for [`cockroach start`](../v20.1/cockroach-start.html) is now deprecated in favor of `--socket-dir`. CockroachDB now automatically chooses a name for the socket in the specified directory based on the configured port number. `--socket` will be removed in a later version. [#45931][#45931] {% comment %}doc{% endcomment %}
- Added the `--cert-principal-map` flag to [`cockroach start`](../v20.1/cockroach-start.html), which specifies a comma-separated list of `cert-principal`:`db-principal` mappings that map the principals found in certificates to DB principals. This allows the usage of "node" and "root" certificates where the common name contains dots or a host name, which allows such certificates to be generated by certificate authorities that place restrictions on the contents of the common name field. [#45819][#45819]

<h3 id="v20.1.0-beta.3-configuration-changes">Configuration changes</h3>

- Added a new `default` option for the `--storage-engine` flag that respects the engine used last. [#45512][#45512] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-beta.3-usability-improvements">Usability improvements</h3>

- Some CLI [commands](../v20.1/cockroach-commands.html) now provide more details and/or a hint when they encounter an error. [#45575][#45575] {% comment %}doc{% endcomment %}
- CockroachDB now refuses to start if named time zones are not properly configured. It is possible to override this behavior for testing purposes, with the understanding that doing so will cause incorrect SQL results and other inconsistencies, using the environment variable `COCKROACH_INCONSISTENT_TIME_ZONES`. [#45640][#45640] {% comment %}doc{% endcomment %}
- The [`cockroach sql`](../v20.1/cockroach-sql.html) and [`cockroach demo`](../v20.1/cockroach-demo.html) client commands now display out-of-band server notices at the end of execution. [#46144][#46144] [#46124][#46124]
- When some result rows have already been received from the server when an error is encountered, the [CockroachDB SQL shell](../v20.1/cockroach-sql.html) now presents both the result rows and the error in the output, regardless of the selected table formatter. Previously, only the error was reported with some formatters, or both with other formatters. [#45872][#45872] {% comment %}doc{% endcomment %}
- Added the flag `--disable-demo-license` to provide another option to disable [`cockroach demo`](../v20.1/cockroach-demo.html) from attempting to acquire a demo license. [#46126][#46126]
- The parameter `--set` for [`cockroach sql`](../v20.1/cockroach-sql.html) and [`cockroach demo`](../v20.1/cockroach-demo.html) is now able to override all client-side options, as advertised. [#46118][#46118]
- Fixed a bug that caused `cockroach demo -e` to display a `connection refused` error. [#46126][#46126]

<h3 id="v20.1.0-beta.3-change-to-troubleshooting-facilities">Change to troubleshooting facilities</h3>

- The [`cockroach debug zip`](../v20.1/cockroach-debug-zip.html) output now contains hex representation of marshaled jobs payload and progress as well table descriptors. This allows you to copy this string and unmarshal it when debugging. [#45721][#45721] {% comment %}doc{% endcomment %}
- CockroachDB will now dump the stacks of all goroutines upon receiving `SIGQUIT` prior to terminating. This feature is intended for use while troubleshooting misbehaving nodes. [#36378][#36378] {% comment %}doc{% endcomment %}

<h3 id="v20.1.0-beta.3-admin-ui-changes">Admin UI changes</h3>

- Removed mention of RocksDB from the Read Amplification, SSTables, Compactions/Flushes, and Compaction Queue graphs. [#45398][#45398]
- The display options are now saved separately for each authenticated user. **Note:** When upgrading to a version with this change, all current display customizations for admin users are lost. [#45127][#45127] {% comment %}doc{% endcomment %}
- Customizations of the Admin UI are again properly saved across sessions. [#45127][#45127]
- Refactored redux data flow in enqueue range. [#45667][#45667]
- Increased enqueue range timeout to an hour to prevent operations from timing out before completion. [#45667][#45667]
- The Admin UI now reports a clearer message when a non-admin user uses an admin-only feature. [#45122][#45122]
- Added the Statement Diagnostics History page. [#45799][#45799]
- You can now access the Activate Diagnostics dialog from the [Statements page](../v20.1/admin-ui-statements-page.html), through the **Activate** link. [#45799][#45799] {% comment %}doc{% endcomment %}
- Added a Release Notes subscription form on the [Cluster Overview page](../v20.1/admin-ui-cluster-overview-page.html). [#45143][#45143]
- The jobs status filter now includes "running", which was previously omitted by mistake. [#45937][#45937]

<h3 id="v20.1.0-beta.3-performance-improvements">Performance improvements</h3>

- [Importing an Avro file](../v20.1/migrate-from-avro.html) is now faster. [#45269][#45269]
- Improved  the execution plans of [foreign key](../v20.1/foreign-key.html) checks for [`UPSERT`](../v20.1/upsert.html) and [`INSERT .. ON CONFLICT`](../v20.1/insert.html) in some cases (in particular multi-region). [#45520][#45520]
- [Importing](../v20.1/import.html) delimited data now has improved throughput. [#45543][#45543]
- Improved the selectivity estimation of some predicates containing `OR`, leading to better plan selection by the [optimizer](../v20.1/cost-based-optimizer.html). [#45732][#45732]
- Improved cardinality estimation in the [optimizer](../v20.1/cost-based-optimizer.html) for relations with a small number of rows. This leads to the optimizer choosing a better query plan in some cases. [#45771][#45771]
- `crdb_internal.jobs` now loads less data into memory. [#45914][#45914]

<h3 id="v20.1.0-beta.3-doc-updates">Doc updates</h3>

- Upgraded the search on the docs site. [#6692][#6692]
- Added docs for `--storage-engine` flag on [node start](../v20.1/cockroach-start.html), which can be `pebble`, `rocksdb`, or `default`, which makes the `--storage-engine` flag sticky for future runs when no engine is specified. [#6769][#6769]
- Added examples of `COMMENT ON TABLE` in `SHOW CREATE TABLE` output to [`COMMENT ON`](../v20.1/comment-on.html), [`SHOW TABLES`](../v20.1/show-tables.html), and [`SHOW CREATE`](../v20.1/show-create.html). [#6789][#6789]
- Added the "Duplicate Indexes" Youtube video to the [Duplicate Indexes Topology doc](../v20.1/topology-duplicate-indexes.html). [#6796][#6796]
- Updated the [`cockroach demo`](../v20.1/cockroach-demo.html) doc to include new flags. [#6841][#6841]

<h3 id="v20.1.0-beta.3-contributors">Contributors</h3>

This release includes 385 merged PRs by 42 authors.
We would like to thank the following contributors from the CockroachDB community:

- Andrii Vorobiov
- Artem Barger
- Damien Hollis (first-time contributor)
- Jaewan Park
- Ziheng Liu (first-time contributor)
- pohzipohzi (first-time contributor)

[#36378]: https://github.com/cockroachdb/cockroach/pull/36378
[#41978]: https://github.com/cockroachdb/cockroach/pull/41978
[#42094]: https://github.com/cockroachdb/cockroach/pull/42094
[#42703]: https://github.com/cockroachdb/cockroach/pull/42703
[#44091]: https://github.com/cockroachdb/cockroach/pull/44091
[#44130]: https://github.com/cockroachdb/cockroach/pull/44130
[#44232]: https://github.com/cockroachdb/cockroach/pull/44232
[#44391]: https://github.com/cockroachdb/cockroach/pull/44391
[#44511]: https://github.com/cockroachdb/cockroach/pull/44511
[#44666]: https://github.com/cockroachdb/cockroach/pull/44666
[#44739]: https://github.com/cockroachdb/cockroach/pull/44739
[#44962]: https://github.com/cockroachdb/cockroach/pull/44962
[#44968]: https://github.com/cockroachdb/cockroach/pull/44968
[#45082]: https://github.com/cockroachdb/cockroach/pull/45082
[#45084]: https://github.com/cockroachdb/cockroach/pull/45084
[#45094]: https://github.com/cockroachdb/cockroach/pull/45094
[#45114]: https://github.com/cockroachdb/cockroach/pull/45114
[#45119]: https://github.com/cockroachdb/cockroach/pull/45119
[#45122]: https://github.com/cockroachdb/cockroach/pull/45122
[#45127]: https://github.com/cockroachdb/cockroach/pull/45127
[#45143]: https://github.com/cockroachdb/cockroach/pull/45143
[#45157]: https://github.com/cockroachdb/cockroach/pull/45157
[#45159]: https://github.com/cockroachdb/cockroach/pull/45159
[#45193]: https://github.com/cockroachdb/cockroach/pull/45193
[#45201]: https://github.com/cockroachdb/cockroach/pull/45201
[#45227]: https://github.com/cockroachdb/cockroach/pull/45227
[#45229]: https://github.com/cockroachdb/cockroach/pull/45229
[#45232]: https://github.com/cockroachdb/cockroach/pull/45232
[#45240]: https://github.com/cockroachdb/cockroach/pull/45240
[#45253]: https://github.com/cockroachdb/cockroach/pull/45253
[#45255]: https://github.com/cockroachdb/cockroach/pull/45255
[#45260]: https://github.com/cockroachdb/cockroach/pull/45260
[#45269]: https://github.com/cockroachdb/cockroach/pull/45269
[#45277]: https://github.com/cockroachdb/cockroach/pull/45277
[#45314]: https://github.com/cockroachdb/cockroach/pull/45314
[#45320]: https://github.com/cockroachdb/cockroach/pull/45320
[#45321]: https://github.com/cockroachdb/cockroach/pull/45321
[#45323]: https://github.com/cockroachdb/cockroach/pull/45323
[#45325]: https://github.com/cockroachdb/cockroach/pull/45325
[#45326]: https://github.com/cockroachdb/cockroach/pull/45326
[#45353]: https://github.com/cockroachdb/cockroach/pull/45353
[#45354]: https://github.com/cockroachdb/cockroach/pull/45354
[#45365]: https://github.com/cockroachdb/cockroach/pull/45365
[#45366]: https://github.com/cockroachdb/cockroach/pull/45366
[#45368]: https://github.com/cockroachdb/cockroach/pull/45368
[#45372]: https://github.com/cockroachdb/cockroach/pull/45372
[#45386]: https://github.com/cockroachdb/cockroach/pull/45386
[#45397]: https://github.com/cockroachdb/cockroach/pull/45397
[#45398]: https://github.com/cockroachdb/cockroach/pull/45398
[#45410]: https://github.com/cockroachdb/cockroach/pull/45410
[#45420]: https://github.com/cockroachdb/cockroach/pull/45420
[#45423]: https://github.com/cockroachdb/cockroach/pull/45423
[#45427]: https://github.com/cockroachdb/cockroach/pull/45427
[#45443]: https://github.com/cockroachdb/cockroach/pull/45443
[#45444]: https://github.com/cockroachdb/cockroach/pull/45444
[#45465]: https://github.com/cockroachdb/cockroach/pull/45465
[#45482]: https://github.com/cockroachdb/cockroach/pull/45482
[#45493]: https://github.com/cockroachdb/cockroach/pull/45493
[#45502]: https://github.com/cockroachdb/cockroach/pull/45502
[#45507]: https://github.com/cockroachdb/cockroach/pull/45507
[#45512]: https://github.com/cockroachdb/cockroach/pull/45512
[#45513]: https://github.com/cockroachdb/cockroach/pull/45513
[#45514]: https://github.com/cockroachdb/cockroach/pull/45514
[#45520]: https://github.com/cockroachdb/cockroach/pull/45520
[#45530]: https://github.com/cockroachdb/cockroach/pull/45530
[#45531]: https://github.com/cockroachdb/cockroach/pull/45531
[#45532]: https://github.com/cockroachdb/cockroach/pull/45532
[#45535]: https://github.com/cockroachdb/cockroach/pull/45535
[#45536]: https://github.com/cockroachdb/cockroach/pull/45536
[#45541]: https://github.com/cockroachdb/cockroach/pull/45541
[#45543]: https://github.com/cockroachdb/cockroach/pull/45543
[#45566]: https://github.com/cockroachdb/cockroach/pull/45566
[#45567]: https://github.com/cockroachdb/cockroach/pull/45567
[#45568]: https://github.com/cockroachdb/cockroach/pull/45568
[#45573]: https://github.com/cockroachdb/cockroach/pull/45573
[#45575]: https://github.com/cockroachdb/cockroach/pull/45575
[#45580]: https://github.com/cockroachdb/cockroach/pull/45580
[#45582]: https://github.com/cockroachdb/cockroach/pull/45582
[#45588]: https://github.com/cockroachdb/cockroach/pull/45588
[#45595]: https://github.com/cockroachdb/cockroach/pull/45595
[#45601]: https://github.com/cockroachdb/cockroach/pull/45601
[#45603]: https://github.com/cockroachdb/cockroach/pull/45603
[#45604]: https://github.com/cockroachdb/cockroach/pull/45604
[#45609]: https://github.com/cockroachdb/cockroach/pull/45609
[#45613]: https://github.com/cockroachdb/cockroach/pull/45613
[#45621]: https://github.com/cockroachdb/cockroach/pull/45621
[#45633]: https://github.com/cockroachdb/cockroach/pull/45633
[#45635]: https://github.com/cockroachdb/cockroach/pull/45635
[#45636]: https://github.com/cockroachdb/cockroach/pull/45636
[#45639]: https://github.com/cockroachdb/cockroach/pull/45639
[#45640]: https://github.com/cockroachdb/cockroach/pull/45640
[#45650]: https://github.com/cockroachdb/cockroach/pull/45650
[#45651]: https://github.com/cockroachdb/cockroach/pull/45651
[#45652]: https://github.com/cockroachdb/cockroach/pull/45652
[#45656]: https://github.com/cockroachdb/cockroach/pull/45656
[#45663]: https://github.com/cockroachdb/cockroach/pull/45663
[#45667]: https://github.com/cockroachdb/cockroach/pull/45667
[#45669]: https://github.com/cockroachdb/cockroach/pull/45669
[#45673]: https://github.com/cockroachdb/cockroach/pull/45673
[#45679]: https://github.com/cockroachdb/cockroach/pull/45679
[#45690]: https://github.com/cockroachdb/cockroach/pull/45690
[#45697]: https://github.com/cockroachdb/cockroach/pull/45697
[#45701]: https://github.com/cockroachdb/cockroach/pull/45701
[#45705]: https://github.com/cockroachdb/cockroach/pull/45705
[#45706]: https://github.com/cockroachdb/cockroach/pull/45706
[#45708]: https://github.com/cockroachdb/cockroach/pull/45708
[#45712]: https://github.com/cockroachdb/cockroach/pull/45712
[#45721]: https://github.com/cockroachdb/cockroach/pull/45721
[#45724]: https://github.com/cockroachdb/cockroach/pull/45724
[#45727]: https://github.com/cockroachdb/cockroach/pull/45727
[#45728]: https://github.com/cockroachdb/cockroach/pull/45728
[#45732]: https://github.com/cockroachdb/cockroach/pull/45732
[#45733]: https://github.com/cockroachdb/cockroach/pull/45733
[#45735]: https://github.com/cockroachdb/cockroach/pull/45735
[#45747]: https://github.com/cockroachdb/cockroach/pull/45747
[#45749]: https://github.com/cockroachdb/cockroach/pull/45749
[#45753]: https://github.com/cockroachdb/cockroach/pull/45753
[#45755]: https://github.com/cockroachdb/cockroach/pull/45755
[#45764]: https://github.com/cockroachdb/cockroach/pull/45764
[#45766]: https://github.com/cockroachdb/cockroach/pull/45766
[#45767]: https://github.com/cockroachdb/cockroach/pull/45767
[#45771]: https://github.com/cockroachdb/cockroach/pull/45771
[#45776]: https://github.com/cockroachdb/cockroach/pull/45776
[#45778]: https://github.com/cockroachdb/cockroach/pull/45778
[#45784]: https://github.com/cockroachdb/cockroach/pull/45784
[#45790]: https://github.com/cockroachdb/cockroach/pull/45790
[#45791]: https://github.com/cockroachdb/cockroach/pull/45791
[#45799]: https://github.com/cockroachdb/cockroach/pull/45799
[#45801]: https://github.com/cockroachdb/cockroach/pull/45801
[#45815]: https://github.com/cockroachdb/cockroach/pull/45815
[#45819]: https://github.com/cockroachdb/cockroach/pull/45819
[#45824]: https://github.com/cockroachdb/cockroach/pull/45824
[#45826]: https://github.com/cockroachdb/cockroach/pull/45826
[#45827]: https://github.com/cockroachdb/cockroach/pull/45827
[#45830]: https://github.com/cockroachdb/cockroach/pull/45830
[#45832]: https://github.com/cockroachdb/cockroach/pull/45832
[#45858]: https://github.com/cockroachdb/cockroach/pull/45858
[#45859]: https://github.com/cockroachdb/cockroach/pull/45859
[#45870]: https://github.com/cockroachdb/cockroach/pull/45870
[#45872]: https://github.com/cockroachdb/cockroach/pull/45872
[#45877]: https://github.com/cockroachdb/cockroach/pull/45877
[#45879]: https://github.com/cockroachdb/cockroach/pull/45879
[#45897]: https://github.com/cockroachdb/cockroach/pull/45897
[#45903]: https://github.com/cockroachdb/cockroach/pull/45903
[#45914]: https://github.com/cockroachdb/cockroach/pull/45914
[#45917]: https://github.com/cockroachdb/cockroach/pull/45917
[#45931]: https://github.com/cockroachdb/cockroach/pull/45931
[#45937]: https://github.com/cockroachdb/cockroach/pull/45937
[#45944]: https://github.com/cockroachdb/cockroach/pull/45944
[#45950]: https://github.com/cockroachdb/cockroach/pull/45950
[#45958]: https://github.com/cockroachdb/cockroach/pull/45958
[#45962]: https://github.com/cockroachdb/cockroach/pull/45962
[#45969]: https://github.com/cockroachdb/cockroach/pull/45969
[#45987]: https://github.com/cockroachdb/cockroach/pull/45987
[#45990]: https://github.com/cockroachdb/cockroach/pull/45990
[#46000]: https://github.com/cockroachdb/cockroach/pull/46000
[#46004]: https://github.com/cockroachdb/cockroach/pull/46004
[#46014]: https://github.com/cockroachdb/cockroach/pull/46014
[#46015]: https://github.com/cockroachdb/cockroach/pull/46015
[#46019]: https://github.com/cockroachdb/cockroach/pull/46019
[#46039]: https://github.com/cockroachdb/cockroach/pull/46039
[#46042]: https://github.com/cockroachdb/cockroach/pull/46042
[#46045]: https://github.com/cockroachdb/cockroach/pull/46045
[#46059]: https://github.com/cockroachdb/cockroach/pull/46059
[#46060]: https://github.com/cockroachdb/cockroach/pull/46060
[#46066]: https://github.com/cockroachdb/cockroach/pull/46066
[#46080]: https://github.com/cockroachdb/cockroach/pull/46080
[#46085]: https://github.com/cockroachdb/cockroach/pull/46085
[#46091]: https://github.com/cockroachdb/cockroach/pull/46091
[#46098]: https://github.com/cockroachdb/cockroach/pull/46098
[#46101]: https://github.com/cockroachdb/cockroach/pull/46101
[#46108]: https://github.com/cockroachdb/cockroach/pull/46108
[#46111]: https://github.com/cockroachdb/cockroach/pull/46111
[#46118]: https://github.com/cockroachdb/cockroach/pull/46118
[#46124]: https://github.com/cockroachdb/cockroach/pull/46124
[#46126]: https://github.com/cockroachdb/cockroach/pull/46126
[#46132]: https://github.com/cockroachdb/cockroach/pull/46132
[#46144]: https://github.com/cockroachdb/cockroach/pull/46144
[#46153]: https://github.com/cockroachdb/cockroach/pull/46153
[#46163]: https://github.com/cockroachdb/cockroach/pull/46163
[#46165]: https://github.com/cockroachdb/cockroach/pull/46165
[#46166]: https://github.com/cockroachdb/cockroach/pull/46166
[#46170]: https://github.com/cockroachdb/cockroach/pull/46170
[#46174]: https://github.com/cockroachdb/cockroach/pull/46174
[#46194]: https://github.com/cockroachdb/cockroach/pull/46194
[#46212]: https://github.com/cockroachdb/cockroach/pull/46212
[#46214]: https://github.com/cockroachdb/cockroach/pull/46214
[#6692]: https://github.com/cockroachdb/docs/pull/6692
[#6769]: https://github.com/cockroachdb/docs/pull/6769
[#6789]: https://github.com/cockroachdb/docs/pull/6789
[#6796]: https://github.com/cockroachdb/docs/pull/6796
